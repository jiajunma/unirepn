\documentclass[12pt,a4paper]{amsart}
\usepackage[margin=2.5cm,marginpar=2cm]{geometry}



% \usepackage{showkeys}
% \makeatletter
%   \SK@def\Cref#1{\SK@\SK@@ref{#1}\SK@Cref{#1}}
%   \SK@def\cref#1{\SK@\SK@@ref{#1}\SK@cref{#1}}
% \makeatother

\usepackage[bookmarksopen,bookmarksdepth=3]{hyperref}
\usepackage[nameinlink]{cleveref}

\usepackage{array}
%% FONTS
\usepackage{amssymb}
%\usepackage{boisik}
%\usepackage{amsmath}
\usepackage{mathrsfs}
%\usepackage{amsrefs}
\usepackage{mathbbol,mathabx}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{braket}
%\usepackage[pointedenum]{paralist}
%\usepackage{paralist}

\usepackage{mathtools}

\usepackage{amsrefs}

\usepackage[all,cmtip]{xy}
\usepackage{rotating}
\usepackage{leftidx}
%\usepackage{arydshln}

\DeclareSymbolFont{bbold}{U}{bbold}{m}{n}
\DeclareSymbolFontAlphabet{\mathbbold}{bbold}


%\usepackage[dvipdfx,rgb,table]{xcolor}
\usepackage[rgb,table,dvipsnames]{xcolor}
%\usepackage{color}
%\usepackage{mathrsfs}

\setcounter{tocdepth}{1}
\setcounter{secnumdepth}{3}

%\usepackage[abbrev,shortalphabetic]{amsrefs}


\usepackage{imakeidx}
\def\idxemph#1{\emph{#1}\index{#1}}
\makeindex


\usepackage[normalem]{ulem}

% circled number
\usepackage{pifont}
\makeatletter
\newcommand*{\circnuma}[1]{%
  \ifnum#1<1 %
    \@ctrerr
  \else
    \ifnum#1>20 %
      \@ctrerr
    \else
      \mbox{\ding{\numexpr 171+(#1)\relax}}%
     \fi
  \fi
}
\makeatother

\usepackage[centertableaux]{ytableau}

%\usepackage[mathlines,pagewise]{lineno}
%\linenumbers

\usepackage{enumitem}
%% Enumitem
\newlist{enumC}{enumerate}{1} % Conditions in Lemma/Theorem/Prop
\setlist[enumC,1]{label=(\alph*),wide,ref=(\alph*)}
\crefname{enumCi}{condition}{conditions}
\Crefname{enumCi}{Condition}{Conditions}
\newlist{enumT}{enumerate}{3} % "Theorem"=conclusions in Lemma/Theorem/Prop
\setlist[enumT]{label=(\roman*),wide}
\setlist[enumT,1]{label=(\roman*),wide}
\setlist[enumT,2]{label=(\alph*),ref ={(\roman{enumTi}.\alph*)},left=2em}
\setlist[enumT,3]{label*=.(\arabic*), ref ={(\roman{enumTi}.\alph{enumTii}.\alph*)}}
\crefname{enumTi}{}{}
\Crefname{enumTi}{Item}{Items}
\crefname{enumTii}{}{}
\Crefname{enumTii}{Item}{Items}
\crefname{enumTiii}{}{}
\Crefname{enumTiii}{Item}{Items}
\newlist{enumPF}{enumerate}{3}
%\setlist[enumPF]{label=(\alph*),wide}
\setlist[enumPF,1]{label=(\roman*),wide}
\setlist[enumPF,2]{label=(\alph*),left=2em}
\setlist[enumPF,3]{label=\arabic*).,left=1em}
\newlist{enumS}{enumerate}{3} % Statement outside Lemma/Theorem/Prop
\setlist[enumS]{label=\roman*)}
\setlist[enumS,1]{label=\roman*)}
\setlist[enumS,2]{label=\alph*)}
\setlist[enumS,3]{label=\arabic*.}
\newlist{enumI}{enumerate}{3} % items
\setlist[enumI,1]{label=\roman*),leftmargin=*}
\setlist[enumI,2]{label=\alph*), leftmargin=*}
\setlist[enumI,3]{label=\arabic*), leftmargin=*}
\newlist{enumIL}{enumerate*}{1} % inline enum
\setlist*[enumIL]{label=\roman*)}
\newlist{enumR}{enumerate}{1} % remarks
\setlist[enumR]{label=\arabic*.,wide,labelwidth=!, labelindent=0pt}
\crefname{enumRi}{remark}{remarks}


%\definecolor{srcol}{RGB}{255,255,51}

%\definecolor{srcol}{RGB}{255,255,51}
\colorlet{srcol}{black!15}

\crefname{equation}{}{}
\Crefname{equation}{Equation}{Equations}
\Crefname{lem}{Lemma}{Lemma}
\Crefname{thm}{Theorem}{Theorem}

\newlist{des}{enumerate}{1}
\setlist[des]{font=\upshape\sffamily\bfseries, label={}}
%\setlist[des]{before={\renewcommand\makelabel[1]{\sffamily \bfseries ##1 }}}

% editing macros.
%\blendcolors{!80!black}
\long\def\okay#1{\ifcsname highlightokay\endcsname
{\color{red} #1}
\else
{#1}
\fi
}
\long\def\editc#1{{\color{red} #1}}
\long\def\mjj#1{{{\color{blue}#1}}}
\long\def\mjjr#1{{\color{red} (#1)}}
\long\def\mjjd#1#2{{\color{blue} #1 \sout{#2}}}
\def\mjjb{\color{blue}}
\def\mjje{\color{black}}
\def\mjjcb{\color{green!50!black}}
\def\mjjce{\color{black}}

\long\def\sun#1{{{\color{cyan}#1}}}
\long\def\sund#1#2{{\color{cyan}#1  \sout{#2}}}
\long\def\mv#1{{{\color{red} {\bf move to a proper place:} #1}}}
\long\def\delete#1{}

%\reversemarginpar
\newcommand{\lokec}[1]{\marginpar{\color{blue}\tiny #1 \mbox{--loke}}}
\newcommand{\mjjc}[1]{\marginpar{\color{green}\tiny #1 \mbox{--ma}}}


%\def\showtrivial{\relax}

\newcommand{\trivial}[2][]{\if\relax\detokenize{#1}\relax
  {%\hfill\break
   % \begin{minipage}{\textwidth}
      \color{orange} \vspace{0em} $[$  #2 $]$
  %\end{minipage}
  %\break
      \color{black}
  }
  \else
\ifx#1h
\ifcsname showtrivial\endcsname
{%\hfill\break
 % \begin{minipage}{\textwidth}
    \color{orange} \vspace{0em}  $[$ #2 $]$
%\end{minipage}
%\break
    \color{black}
}
\fi
\else {\red Wrong argument!} \fi
\fi
}

\newcommand{\byhide}[2][]{\if\relax\detokenize{#1}\relax
{\color{orange} \vspace{0em} Plan to delete:  #2}
\else
\ifx#1h\relax\fi
\fi
}



\newcommand{\Rank}{\mathrm{rk}}
\newcommand{\cqq}{\mathscr{D}}
\newcommand{\rsym}{\mathrm{sym}}
\newcommand{\rskew}{\mathrm{skew}}
\newcommand{\fraksp}{\mathfrak{sp}}
\newcommand{\frakso}{\mathfrak{so}}
\newcommand{\frakm}{\mathfrak{m}}
\newcommand{\frakp}{\mathfrak{p}}
\newcommand{\pr}{\mathrm{pr}}
\newcommand{\rhopst}{\rho'^*}
\newcommand{\Rad}{\mathrm{Rad}}
\newcommand{\Res}{\mathrm{Res}}
\newcommand{\Hol}{\mathrm{Hol}}
\newcommand{\AC}{\mathrm{AC}}
%\newcommand{\AS}{\mathrm{AS}}
\newcommand{\WF}{\mathrm{WF}}
\newcommand{\AV}{\mathrm{AV}}
\newcommand{\AVC}{\mathrm{AV}_\bC}
\newcommand{\VC}{\mathrm{V}_\bC}
\newcommand{\bfv}{\mathbf{v}}
\newcommand{\depth}{\mathrm{depth}}
\newcommand{\wtM}{\widetilde{M}}
\newcommand{\wtMone}{{\widetilde{M}^{(1,1)}}}

\newcommand{\nullpp}{N(\fpp'^*)}
\newcommand{\nullp}{N(\fpp^*)}
%\newcommand{\Aut}{\mathrm{Aut}}
%\usepackage{mnsymbol}


\def\YD{{\mathsf{YD}}}
\def\SYD{{\mathsf{SYD}}}
\def\MYD{{\mathsf{MYD}}}

\def\KM{{\mathcal{K_{\mathsf{M}}}}}

\newcommand{\bfonenp}{\mathbf{1}^{-,+}}
\newcommand{\bfonepn}{\mathbf{1}^{+,-}}
\newcommand{\bfone}{\mathbf{1}}
\newcommand{\piSigma}{\pi_\Sigma}
\newcommand{\piSigmap}{\pi'_\Sigma}


\newcommand{\sfVprime}{\mathsf{V}^\prime}
\newcommand{\sfVdprime}{\mathsf{V}^{\prime \prime}}
\newcommand{\gminusone}{\mathfrak{g}_{-\frac{1}{m}}}

\newcommand{\eva}{\mathrm{eva}}

% \newcommand\iso{\xrightarrow{
%    \,\smash{\raisebox{-0.65ex}{\ensuremath{\scriptstyle\sim}}}\,}}

\def\Ueven{{U_{\rm{even}}}}
\def\Uodd{{U_{\rm{odd}}}}
\def\ttau{\tilde{\tau}}
\def\Wcp{W}
\def\Kur{{K^{\mathrm{u}}}}

\def\Im{\operatorname{Im}}


\providecommand{\bcN}{{\overline{\cN}}}



\makeatletter

\def\gen#1{\left\langle
    #1
      \right\rangle}
\makeatother

\makeatletter
\def\inn#1#2{\left\langle
      \def\ta{#1}\def\tb{#2}
      \ifx\ta\@empty{\;} \else {\ta}\fi ,
      \ifx\tb\@empty{\;} \else {\tb}\fi
      \right\rangle}
\def\binn#1#2{\left\lAngle
      \def\ta{#1}\def\tb{#2}
      \ifx\ta\@empty{\;} \else {\ta}\fi ,
      \ifx\tb\@empty{\;} \else {\tb}\fi
      \right\rAngle}
\makeatother

\makeatletter
\def\binn#1#2{\overline{\inn{#1}{#2}}}
\makeatother


\def\innwi#1#2{\inn{#1}{#2}_{W_i}}
\def\innw#1#2{\inn{#1}{#2}_{\bfW}}
\def\innv#1#2{\inn{#1}{#2}_{\bfV}}
\def\innbfv#1#2{\inn{#1}{#2}_{\bfV}}
\def\innvi#1#2{\inn{#1}{#2}_{V_i}}
\def\innvp#1#2{\inn{#1}{#2}_{\bfV'}}
\def\innp#1#2{\inn{#1}{#2}'}

% choose one of then
\def\simrightarrow{\iso}
\def\surj{\twoheadrightarrow}
%\def\simrightarrow{\xrightarrow{\sim}}

\newcommand\iso{\xrightarrow{
   \,\smash{\raisebox{-0.65ex}{\ensuremath{\scriptstyle\sim}}}\,}}

\newcommand\riso{\xleftarrow{
   \,\smash{\raisebox{-0.65ex}{\ensuremath{\scriptstyle\sim}}}\,}}









\usepackage{xparse}
\def\usecsname#1{\csname #1\endcsname}
\def\useLetter#1{#1}
\def\usedbletter#1{#1#1}

% \def\useCSf#1{\csname f#1\endcsname}

\ExplSyntaxOn

\def\mydefcirc#1#2#3{\expandafter\def\csname
  circ#3{#1}\endcsname{{}^\circ {#2{#1}}}}
\def\mydefvec#1#2#3{\expandafter\def\csname
  vec#3{#1}\endcsname{\vec{#2{#1}}}}
\def\mydefdot#1#2#3{\expandafter\def\csname
  dot#3{#1}\endcsname{\dot{#2{#1}}}}

\def\mydefacute#1#2#3{\expandafter\def\csname a#3{#1}\endcsname{\acute{#2{#1}}}}
\def\mydefbr#1#2#3{\expandafter\def\csname br#3{#1}\endcsname{\breve{#2{#1}}}}
\def\mydefbar#1#2#3{\expandafter\def\csname bar#3{#1}\endcsname{\bar{#2{#1}}}}
\def\mydefhat#1#2#3{\expandafter\def\csname hat#3{#1}\endcsname{\hat{#2{#1}}}}
\def\mydefwh#1#2#3{\expandafter\def\csname wh#3{#1}\endcsname{\widehat{#2{#1}}}}
\def\mydeft#1#2#3{\expandafter\def\csname t#3{#1}\endcsname{\tilde{#2{#1}}}}
\def\mydefu#1#2#3{\expandafter\def\csname u#3{#1}\endcsname{\underline{#2{#1}}}}
\def\mydefr#1#2#3{\expandafter\def\csname r#3{#1}\endcsname{\mathrm{#2{#1}}}}
\def\mydefb#1#2#3{\expandafter\def\csname b#3{#1}\endcsname{\mathbb{#2{#1}}}}
\def\mydefwt#1#2#3{\expandafter\def\csname wt#3{#1}\endcsname{\widetilde{#2{#1}}}}
%\def\mydeff#1#2#3{\expandafter\def\csname f#3{#1}\endcsname{\mathfrak{#2{#1}}}}
\def\mydefbf#1#2#3{\expandafter\def\csname bf#3{#1}\endcsname{\mathbf{#2{#1}}}}
\def\mydefc#1#2#3{\expandafter\def\csname c#3{#1}\endcsname{\mathcal{#2{#1}}}}
\def\mydefsf#1#2#3{\expandafter\def\csname sf#3{#1}\endcsname{\mathsf{#2{#1}}}}
\def\mydefs#1#2#3{\expandafter\def\csname s#3{#1}\endcsname{\mathscr{#2{#1}}}}
\def\mydefcks#1#2#3{\expandafter\def\csname cks#3{#1}\endcsname{{\check{
        \csname s#2{#1}\endcsname}}}}
\def\mydefckc#1#2#3{\expandafter\def\csname ckc#3{#1}\endcsname{{\check{
      \csname c#2{#1}\endcsname}}}}
\def\mydefck#1#2#3{\expandafter\def\csname ck#3{#1}\endcsname{{\check{#2{#1}}}}}

\cs_new:Npn \mydeff #1#2#3 {\cs_new:cpn {f#3{#1}} {\mathfrak{#2{#1}}}}

\cs_new:Npn \doGreek #1
{
  \clist_map_inline:nn {alpha,beta,gamma,Gamma,delta,Delta,epsilon,varepsilon,zeta,eta,theta,vartheta,Theta,iota,kappa,lambda,Lambda,mu,nu,xi,Xi,pi,Pi,rho,sigma,varsigma,Sigma,tau,upsilon,Upsilon,phi,varphi,Phi,chi,psi,Psi,omega,Omega,tG} {#1{##1}{\usecsname}{\useLetter}}
}

\cs_new:Npn \doSymbols #1
{
  \clist_map_inline:nn {otimes,boxtimes} {#1{##1}{\usecsname}{\useLetter}}
}

\cs_new:Npn \doAtZ #1
{
  \clist_map_inline:nn {A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z} {#1{##1}{\useLetter}{\useLetter}}
}

\cs_new:Npn \doatz #1
{
  \clist_map_inline:nn {a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z} {#1{##1}{\useLetter}{\usedbletter}}
}

\cs_new:Npn \doallAtZ
{
\clist_map_inline:nn {mydefsf,mydeft,mydefu,mydefwh,mydefhat,mydefr,mydefwt,mydeff,mydefb,mydefbf,mydefc,mydefs,mydefck,mydefcks,mydefckc,mydefbar,mydefvec,mydefcirc,mydefdot,mydefbr,mydefacute} {\doAtZ{\csname ##1\endcsname}}
}

\cs_new:Npn \doallatz
{
\clist_map_inline:nn {mydefsf,mydeft,mydefu,mydefwh,mydefhat,mydefr,mydefwt,mydeff,mydefb,mydefbf,mydefc,mydefs,mydefck,mydefbar,mydefvec,mydefdot,mydefbr,mydefacute} {\doatz{\csname ##1\endcsname}}
}

\cs_new:Npn \doallGreek
{
\clist_map_inline:nn {mydefck,mydefwt,mydeft,mydefwh,mydefbar,mydefu,mydefvec,mydefcirc,mydefdot,mydefbr,mydefacute} {\doGreek{\csname ##1\endcsname}}
}

\cs_new:Npn \doallSymbols
{
\clist_map_inline:nn {mydefck,mydefwt,mydeft,mydefwh,mydefbar,mydefu,mydefvec,mydefcirc,mydefdot} {\doSymbols{\csname ##1\endcsname}}
}



\cs_new:Npn \doGroups #1
{
  \clist_map_inline:nn {GL,Sp,rO,rU,fgl,fsp,foo,fuu,fkk,fuu,ufkk,uK} {#1{##1}{\usecsname}{\useLetter}}
}

\cs_new:Npn \doallGroups
{
\clist_map_inline:nn {mydeft,mydefu,mydefwh,mydefhat,mydefwt,mydefck,mydefbar} {\doGroups{\csname ##1\endcsname}}
}


\cs_new:Npn \decsyms #1
{
\clist_map_inline:nn {#1} {\expandafter\DeclareMathOperator\csname ##1\endcsname{##1}}
}

\decsyms{Mp,id,SL,Sp,SU,SO,GO,GSO,GU,GSp,PGL,Pic,Lie,Mat,Ker,Hom,Ext,Ind,reg,res,inv,Isom,Det,Tr,Norm,Sym,Span,Stab,Spec,PGSp,PSL,tr,Ad,Br,Ch,Cent,End,Aut,Dvi,Frob,Gal,GL,Gr,DO,ur,vol,ab,Nil,Supp,rank,Sign}

\def\abs#1{\left|{#1}\right|}
\def\norm#1{{\left\|{#1}\right\|}}


% \NewDocumentCommand\inn{m m}{
% \left\langle
% \IfValueTF{#1}{#1}{000}
% ,
% \IfValueTF{#2}{#2}{000}
% \right\rangle
% }
\NewDocumentCommand\cent{o m }{
  \IfValueTF{#1}{
    \mathop{Z}_{#1}{(#2)}}
  {\mathop{Z}{(#2)}}
}


\def\fsl{\mathfrak{sl}}
\def\fsp{\mathfrak{sp}}


%\def\cent#1#2{{\mathrm{Z}_{#1}({#2})}}


\doallAtZ
\doallatz
\doallGreek
\doallGroups
\doallSymbols
\ExplSyntaxOff


% \usepackage{geometry,amsthm,graphics,tabularx,amssymb,shapepar}
% \usepackage{amscd}
% \usepackage{mathrsfs}


\usepackage{diagbox}
% Update the information and uncomment if AMS is not the copyright
% holder.
%\copyrightinfo{2006}{American Mathematical Society}
%\usepackage{nicematrix}
\usepackage{arydshln}
\usepackage[mode=buildnew]{standalone}% requires -shell-escape

\usepackage{tikz,etoolbox}
\usetikzlibrary{matrix,arrows,positioning,backgrounds}
\usetikzlibrary{decorations.pathmorphing,decorations.pathreplacing}
\usetikzlibrary{cd}
% \usetikzlibrary{external}
%   \tikzexternalize
% \usetikzlibrary{cd}

%  \AtBeginEnvironment{tikzcd}{\tikzexternaldisable}
%  \AtEndEnvironment{tikzcd}{\tikzexternalenable}

%  \usetikzlibrary{matrix,arrows,positioning,backgrounds}
%  \usetikzlibrary{decorations.pathmorphing,decorations.pathreplacing}

% % externalization not work properly
% % \usetikzlibrary{external}
% \tikzexternalize[prefix=figures/]
% % % activate the following such that you can check the macro expansion in
% % % *-figure0.md5 manually
% %\tikzset{external/up to date check=diff}
% \usepackage{environ}

% \def\temp{&} \catcode`&=\active \let&=\temp

% \newcommand{\mytikzcdcontext}[2]{
%   \begin{tikzpicture}[baseline=(maintikzcdnode.base)]
%     \node (maintikzcdnode) [inner sep=0, outer sep=0] {\begin{tikzcd}[#2]
%         #1
%     \end{tikzcd}};
%   \end{tikzpicture}}

% \NewEnviron{mytikzcd}[1][]{%
% % In the following, we need \BODY to expanded before \mytikzcdcontext
% % such that the md5 function gets the tikzcd content with \BODY expanded.
% % Howerver, expand it only once, because the \tikz-macros aren't
% % defined at this point yet. The same thing holds for the arguments to
% % the tikzcd-environment.
% \def\myargs{#1}%
% \edef\mydiagram{\noexpand\mytikzcdcontext{\expandonce\BODY}{\expandonce\myargs}}%
% \mydiagram%
% }

\usepackage{upgreek}

\usepackage{listings}
\lstset{
    basicstyle=\ttfamily\tiny,
    keywordstyle=\color{black},
    commentstyle=\color{white}, % white comments
    stringstyle=\ttfamily, % typewriter type for strings
    showstringspaces=false,
    breaklines=true,
    emph={Output},emphstyle=\color{blue},
} 

\newcommand{\BA}{{\mathbb{A}}}
%\newcommand{\BB}{{\mathbb {B}}}
\newcommand{\BC}{{\mathbb {C}}}
\newcommand{\BD}{{\mathbb {D}}}
\newcommand{\BE}{{\mathbb {E}}}
\newcommand{\BF}{{\mathbb {F}}}
\newcommand{\BG}{{\mathbb {G}}}
\newcommand{\BH}{{\mathbb {H}}}
\newcommand{\BI}{{\mathbb {I}}}
\newcommand{\BJ}{{\mathbb {J}}}
\newcommand{\BK}{{\mathbb {U}}}
\newcommand{\BL}{{\mathbb {L}}}
\newcommand{\BM}{{\mathbb {M}}}
\newcommand{\BN}{{\mathbb {N}}}
\newcommand{\BO}{{\mathbb {O}}}
\newcommand{\BP}{{\mathbb {P}}}
\newcommand{\BQ}{{\mathbb {Q}}}
\newcommand{\BR}{{\mathbb {R}}}
\newcommand{\BS}{{\mathbb {S}}}
\newcommand{\BT}{{\mathbb {T}}}
\newcommand{\BU}{{\mathbb {U}}}
\newcommand{\BV}{{\mathbb {V}}}
\newcommand{\BW}{{\mathbb {W}}}
\newcommand{\BX}{{\mathbb {X}}}
\newcommand{\BY}{{\mathbb {Y}}}
\newcommand{\BZ}{{\mathbb {Z}}}
\newcommand{\Bk}{{\mathbf {k}}}

\newcommand{\CA}{{\mathcal {A}}}
\newcommand{\CB}{{\mathcal {B}}}
\newcommand{\CC}{{\mathcal {C}}}

\newcommand{\CE}{{\mathcal {E}}}
\newcommand{\CF}{{\mathcal {F}}}
\newcommand{\CG}{{\mathcal {G}}}
\newcommand{\CH}{{\mathcal {H}}}
\newcommand{\CI}{{\mathcal {I}}}
\newcommand{\CJ}{{\mathcal {J}}}
\newcommand{\CK}{{\mathcal {K}}}
\newcommand{\CL}{{\mathcal {L}}}
\newcommand{\CM}{{\mathcal {M}}}
\newcommand{\CN}{{\mathcal {N}}}
\newcommand{\CO}{{\mathcal {O}}}
\newcommand{\CP}{{\mathcal {P}}}
\newcommand{\CQ}{{\mathcal {Q}}}
\newcommand{\CR}{{\mathcal {R}}}
\newcommand{\CS}{{\mathcal {S}}}
\newcommand{\CT}{{\mathcal {T}}}
\newcommand{\CU}{{\mathcal {U}}}
\newcommand{\CV}{{\mathcal {V}}}
\newcommand{\CW}{{\mathcal {W}}}
\newcommand{\CX}{{\mathcal {X}}}
\newcommand{\CY}{{\mathcal {Y}}}
\newcommand{\CZ}{{\mathcal {Z}}}


\newcommand{\RA}{{\mathrm {A}}}
\newcommand{\RB}{{\mathrm {B}}}
\newcommand{\RC}{{\mathrm {C}}}
\newcommand{\RD}{{\mathrm {D}}}
\newcommand{\RE}{{\mathrm {E}}}
\newcommand{\RF}{{\mathrm {F}}}
\newcommand{\RG}{{\mathrm {G}}}
\newcommand{\RH}{{\mathrm {H}}}
\newcommand{\RI}{{\mathrm {I}}}
\newcommand{\RJ}{{\mathrm {J}}}
\newcommand{\RK}{{\mathrm {K}}}
\newcommand{\RL}{{\mathrm {L}}}
\newcommand{\RM}{{\mathrm {M}}}
\newcommand{\RN}{{\mathrm {N}}}
\newcommand{\RO}{{\mathrm {O}}}
\newcommand{\RP}{{\mathrm {P}}}
\newcommand{\RQ}{{\mathrm {Q}}}
%\newcommand{\RR}{{\mathrm {R}}}
\newcommand{\RS}{{\mathrm {S}}}
\newcommand{\RT}{{\mathrm {T}}}
\newcommand{\RU}{{\mathrm {U}}}
\newcommand{\RV}{{\mathrm {V}}}
\newcommand{\RW}{{\mathrm {W}}}
\newcommand{\RX}{{\mathrm {X}}}
\newcommand{\RY}{{\mathrm {Y}}}
\newcommand{\RZ}{{\mathrm {Z}}}

\DeclareMathOperator{\absNorm}{\mathfrak{N}}
\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\LAnn}{L-Ann}
\DeclareMathOperator{\RAnn}{R-Ann}
\DeclareMathOperator{\ind}{ind}
%\DeclareMathOperator{\Ind}{Ind}



\def\ckbfG{\check{\bfG}}

\newcommand{\cod}{{\mathrm{cod}}}
\newcommand{\cont}{{\mathrm{cont}}}
\newcommand{\cl}{{\mathrm{cl}}}
\newcommand{\cusp}{{\mathrm{cusp}}}

\newcommand{\disc}{{\mathrm{disc}}}



\newcommand{\Gm}{{\mathbb{G}_m}}



\newcommand{\I}{{\mathrm{I}}}

\newcommand{\Jac}{{\mathrm{Jac}}}
\newcommand{\PM}{{\mathrm{PM}}}


\newcommand{\new}{{\mathrm{new}}}
\newcommand{\NS}{{\mathrm{NS}}}
\newcommand{\N}{{\mathrm{N}}}

\newcommand{\ord}{{\mathrm{ord}}}

%\newcommand{\rank}{{\mathrm{rank}}}

\newcommand{\rk}{{\mathrm{k}}}
\newcommand{\rr}{{\mathrm{r}}}
\newcommand{\rh}{{\mathrm{h}}}

\newcommand{\Sel}{{\mathrm{Sel}}}
\newcommand{\Sim}{{\mathrm{Sim}}}

\newcommand{\wt}{\widetilde}
\newcommand{\wh}{\widehat}
\newcommand{\pp}{\frac{\partial\bar\partial}{\pi i}}
\newcommand{\pair}[1]{\langle {#1} \rangle}
\newcommand{\wpair}[1]{\left\{{#1}\right\}}
\newcommand{\intn}[1]{\left( {#1} \right)}
\newcommand{\sfrac}[2]{\left( \frac {#1}{#2}\right)}
\newcommand{\ds}{\displaystyle}
\newcommand{\ov}{\overline}
\newcommand{\incl}{\hookrightarrow}
\newcommand{\lra}{\longrightarrow}
\newcommand{\imp}{\Longrightarrow}
%\newcommand{\lto}{\longmapsto}
\newcommand{\bs}{\backslash}

\newcommand{\cover}[1]{\widetilde{#1}}

\renewcommand{\vsp}{{\vspace{0.2in}}}

\newcommand{\Norma}{\operatorname{N}}
\newcommand{\Ima}{\operatorname{Im}}
\newcommand{\con}{\textit{C}}
\newcommand{\gr}{\operatorname{gr}}
\newcommand{\ad}{\operatorname{ad}}
\newcommand{\der}{\operatorname{der}}
\newcommand{\dif}{\operatorname{d}\!}
\newcommand{\pro}{\operatorname{pro}}
\newcommand{\Ev}{\operatorname{Ev}}
% \renewcommand{\span}{\operatorname{span}} \span is an innernal command.
%\newcommand{\degree}{\operatorname{deg}}
\newcommand{\Invf}{\operatorname{Invf}}
\newcommand{\Inv}{\operatorname{Inv}}
\newcommand{\slt}{\operatorname{SL}_2(\mathbb{R})}
%\newcommand{\temp}{\operatorname{temp}}
%\newcommand{\otop}{\operatorname{top}}
%\renewcommand{\small}{\operatorname{small}}
\newcommand{\HC}{\operatorname{HC}}
\newcommand{\lef}{\operatorname{left}}
\newcommand{\righ}{\operatorname{right}}
\newcommand{\Diff}{\operatorname{DO}}
\newcommand{\diag}{\operatorname{diag}}
\newcommand{\sh}{\varsigma}
\newcommand{\sch}{\operatorname{sch}}
%\newcommand{\oleft}{\operatorname{left}}
%\newcommand{\oright}{\operatorname{right}}
\newcommand{\open}{\operatorname{open}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\triv}{\operatorname{triv}}
\newcommand{\Sh}{\operatorname{Sh}}
\newcommand{\oN}{\operatorname{N}}

\newcommand{\oc}{\operatorname{c}}
\newcommand{\od}{\operatorname{d}}
\newcommand{\os}{\operatorname{s}}
\newcommand{\ol}{\operatorname{l}}
\newcommand{\oL}{\operatorname{L}}
\newcommand{\oJ}{\operatorname{J}}
\newcommand{\oH}{\operatorname{H}}
\newcommand{\oO}{\operatorname{O}}
\newcommand{\oS}{\operatorname{S}}
\newcommand{\oR}{\operatorname{R}}
\newcommand{\oT}{\operatorname{T}}
%\newcommand{\rU}{\operatorname{U}}
\newcommand{\oZ}{\operatorname{Z}}
\newcommand{\oD}{\textit{D}}
\newcommand{\oW}{\textit{W}}
\newcommand{\oE}{\operatorname{E}}
\newcommand{\oP}{\operatorname{P}}
\newcommand{\PD}{\operatorname{PD}}
\newcommand{\oU}{\operatorname{U}}

\newcommand{\gC}{{\mathfrak g}_{\C}}
%\renewcommand{\sl}{\mathfrak s \mathfrak l}
\newcommand{\gl}{\mathfrak g \mathfrak l}


\newcommand{\re}{\mathrm e}

\renewcommand{\rk}{\mathrm k}

\newcommand{\g}{\mathfrak g}
\newcommand{\h}{\mathfrak h}
\newcommand{\p}{\mathfrak p}
\newcommand{\Z}{\mathbb{Z}}
\DeclareDocumentCommand{\C}{}{\mathbb{C}}
\newcommand{\R}{\mathbb R}
\newcommand{\Q}{\mathbb Q}
\renewcommand{\H}{\mathbb{H}}
%\newcommand{\N}{\mathbb{N}}
\newcommand{\K}{\mathbb{K}}
%\renewcommand{\S}{\mathbf S}
\newcommand{\M}{\mathbf{M}}
\newcommand{\A}{\mathbb{A}}
\newcommand{\B}{\mathbf{B}}
%\renewcommand{\G}{\mathbf{G}}
\newcommand{\V}{\mathbf{V}}
\newcommand{\W}{\mathbf{W}}
\newcommand{\F}{\mathbf{F}}
\newcommand{\E}{\mathbf{E}}
%\newcommand{\J}{\mathbf{J}}
\renewcommand{\H}{\mathbf{H}}
\newcommand{\X}{\mathbf{X}}
\newcommand{\Y}{\mathbf{Y}}
%\newcommand{\RR}{\mathcal R}
\newcommand{\FF}{\mathcal F}
%\newcommand{\BB}{\mathcal B}
\newcommand{\HH}{\mathcal H}
%\newcommand{\UU}{\mathcal U}
%\newcommand{\MM}{\mathcal M}
%\newcommand{\CC}{\mathcal C}
%\newcommand{\DD}{\mathcal D}
%\def\eDD{\mathrm{d}^{e}}
%\def\eDD{\bigtriangledown}
\def\eDD{\overline{\nabla}}
\def\eDDo{\overline{\nabla}_1}
%\def\eDD{\mathrm{d}}
\def\DD{\nabla}
\def\DDc{\boldsymbol{\nabla}}
\def\gDD{\nabla^{\mathrm{gen}}}
\def\gDDc{\boldsymbol{\nabla}^{\mathrm{gen}}}
%\newcommand{\OO}{\mathcal O}
%\newcommand{\ZZ}{\mathcal Z}
\newcommand{\ve}{{\vee}}
\newcommand{\aut}{\mathcal A}
\newcommand{\ii}{\mathbf{i}}
\newcommand{\jj}{\mathbf{j}}
\newcommand{\kk}{\mathbf{k}}

\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\bp}{\bigskip}
\newcommand{\be}{\begin {equation}}
\newcommand{\ee}{\end {equation}}

\newcommand{\LRleq}{\stackrel{LR}{\leq}}

\numberwithin{equation}{section}


\def\flushl#1{\ifmmode\makebox[0pt][l]{${#1}$}\else\makebox[0pt][l]{#1}\fi}
\def\flushr#1{\ifmmode\makebox[0pt][r]{${#1}$}\else\makebox[0pt][r]{#1}\fi}
\def\flushmr#1{\makebox[0pt][r]{${#1}$}}


%\theoremstyle{Theorem}
% \newtheorem*{thmM}{Main Theorem}
% \crefformat{thmM}{main theorem}
% \Crefformat{thmM}{Main Theorem}
\newtheorem*{thm*}{Theorem}
\newtheorem{thm}{Theorem}[section]
\newtheorem{thml}[thm]{Theorem}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{obs}[thm]{Observation}
\newtheorem{lemt}[thm]{Lemma}
\newtheorem*{lem*}{Lemma}
\newtheorem{whyp}[thm]{Working Hypothesis}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{prpt}[thm]{Proposition}
\newtheorem{prpl}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
%\newtheorem*{prop*}{Proposition}
\newtheorem{claim}[thm]{Claim}
\newtheorem*{claim*}{Claim}
%\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{dfnl}[thm]{Definition}
\newtheorem*{IndH}{Induction Hypothesis}

\newtheorem*{eg*}{Example}
\newtheorem{eg}[thm]{Example}

\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem*{remarks}{Remarks}


\def\cpc{\sigma}
\def\ccJ{\epsilon\dotepsilon}
\def\ccL{c_L}

\def\wtbfK{\widetilde{\bfK}}
%\def\abfV{\acute{\bfV}}
\def\AbfV{\acute{\bfV}}
%\def\afgg{\acute{\fgg}}
%\def\abfG{\acute{\bfG}}
\def\abfV{\bfV'}
\def\afgg{\fgg'}
\def\abfG{\bfG'}

\def\half{{\tfrac{1}{2}}}
\def\ihalf{{\tfrac{\mathbf i}{2}}}
\def\slt{\fsl_2(\bC)}
\def\sltr{\fsl_2(\bR)}

% \def\Jslt{{J_{\fslt}}}
% \def\Lslt{{L_{\fslt}}}
\def\slee{{
\begin{pmatrix}
 0 & 1\\
 0 & 0
\end{pmatrix}
}}
\def\slff{{
\begin{pmatrix}
 0 & 0\\
 1 & 0
\end{pmatrix}
}}\def\slhh{{
\begin{pmatrix}
 1 & 0\\
 0 & -1
\end{pmatrix}
}}
\def\sleei{{
\begin{pmatrix}
 0 & i\\
 0 & 0
\end{pmatrix}
}}
\def\slxx{{\begin{pmatrix}
-\ihalf & \half\\
\phantom{-}\half & \ihalf
\end{pmatrix}}}
% \def\slxx{{\begin{pmatrix}
% -\sqrt{-1}/2 & 1/2\\
% 1/2 & \sqrt{-1}/2
% \end{pmatrix}}}
\def\slyy{{\begin{pmatrix}
\ihalf & \half\\
\half & -\ihalf
\end{pmatrix}}}
\def\slxxi{{\begin{pmatrix}
+\half & -\ihalf\\
-\ihalf & -\half
\end{pmatrix}}}
\def\slH{{\begin{pmatrix}
   0   & -\mathbf i\\
\mathbf i & 0
\end{pmatrix}}
}

\ExplSyntaxOn
\clist_map_inline:nn {J,L,C,X,Y,H,c,e,f,h,}{
  \expandafter\def\csname #1slt\endcsname{{\mathring{#1}}}}
\ExplSyntaxOff


\def\Mop{\fT}

\def\fggJ{\fgg_J}
\def\fggJp{\fgg'_{J'}}

\def\NilGC{\Nil_{\bfG}(\fgg)}
\def\NilGCp{\Nil_{\bfG'}(\fgg')}
\def\Nilgp{\Nil_{\fgg'_{J'}}}
\def\Nilg{\Nil_{\fgg_{J}}}
%\def\NilP'{\Nil_{\fpp'}}
\def\peNil{\Nil^{\mathrm{pe}}}
\def\dpeNil{\Nil^{\mathrm{dpe}}}
\def\nNil{\Nil^{\mathrm n}}
\def\eNil{\Nil^{\mathrm e}}


\NewDocumentCommand{\NilP}{t'}{
\IfBooleanTF{#1}{\Nil_{\fpp'}}{\Nil_\fpp}
}

\def\KS{\mathsf{KS}}
\def\MM{\bfM}
\def\MMP{M}

\NewDocumentCommand{\KTW}{o g}{
  \IfValueTF{#2}{
    \left.\varsigma_{\IfValueT{#1}{#1}}\right|_{#2}}{
    \varsigma_{\IfValueT{#1}{#1}}}
}
\def\IST{\rho}
\def\tIST{\trho}

\NewDocumentCommand{\CHI}{o g}{
  \IfValueTF{#1}{
    {\chi}_{\left[#1\right]}}{
    \IfValueTF{#2}{
      {\chi}_{\left(#2\right)}}{
      {\chi}}
  }
}
\NewDocumentCommand{\PR}{g}{
  \IfValueTF{#1}{
    \mathop{\pr}_{\left(#1\right)}}{
    \mathop{\pr}}
}
\NewDocumentCommand{\XX}{g}{
  \IfValueTF{#1}{
    {\cX}_{\left(#1\right)}}{
    {\cX}}
}
\NewDocumentCommand{\PP}{g}{
  \IfValueTF{#1}{
    {\fpp}_{\left(#1\right)}}{
    {\fpp}}
}
\NewDocumentCommand{\LL}{g}{
  \IfValueTF{#1}{
    {\bfL}_{\left(#1\right)}}{
    {\bfL}}
}
\NewDocumentCommand{\ZZ}{g}{
  \IfValueTF{#1}{
    {\cZ}_{\left(#1\right)}}{
    {\cZ}}
}

\NewDocumentCommand{\WW}{g}{
  \IfValueTF{#1}{
    {\bfW}_{\left(#1\right)}}{
    {\bfW}}
}




\def\gpi{\wp}
\NewDocumentCommand\KK{g}{
\IfValueTF{#1}{K_{(#1)}}{K}}
% \NewDocumentCommand\OO{g}{
% \IfValueTF{#1}{\cO_{(#1)}}{K}}
\NewDocumentCommand\XXo{d()}{
\IfValueTF{#1}{\cX^\circ_{(#1)}}{\cX^\circ}}
\def\bfWo{\bfW^\circ}
\def\bfWoo{\bfW^{\circ \circ}}
\def\bfWg{\bfW^{\mathrm{gen}}}
\def\Xg{\cX^{\mathrm{gen}}}
\def\Xo{\cX^\circ}
\def\Xoo{\cX^{\circ \circ}}
\def\fppo{\fpp^\circ}
\def\fggo{\fgg^\circ}
\NewDocumentCommand\ZZo{g}{
\IfValueTF{#1}{\cZ^\circ_{(#1)}}{\cZ^\circ}}

% \ExplSyntaxOn
% \NewDocumentCommand{\bcO}{t' E{^_}{{}{}}}{
%   \overline{\cO\sb{\use_ii:nn#2}\IfBooleanTF{#1}{^{'\use_i:nn#2}}{^{\use_i:nn#2}}
%   }
% }
% \ExplSyntaxOff

\NewDocumentCommand{\bcO}{t'}{
  \overline{\cO\IfBooleanT{#1}{'}}}

\NewDocumentCommand{\oliftc}{g}{
\IfValueTF{#1}{\boldsymbol{\vartheta} (#1)}{\boldsymbol{\vartheta}}
}
\NewDocumentCommand{\oliftr}{g}{
\IfValueTF{#1}{\vartheta_\bR(#1)}{\vartheta_\bR}
}
\NewDocumentCommand{\olift}{g}{
\IfValueTF{#1}{\vartheta(#1)}{\vartheta}
}
% \NewDocumentCommand{\dliftv}{g}{
% \IfValueTF{#1}{\ckvartheta(#1)}{\ckvartheta}
% }
\def\dliftv{\vartheta}
\NewDocumentCommand{\tlift}{g}{
\IfValueTF{#1}{\wtvartheta(#1)}{\wtvartheta}
}

\def\slift{\cL}

\def\BB{\bB}


\def\thetaO#1{\vartheta\left(#1\right)}

\def\bbThetav{\check{\mathbbold{\Theta}}}
\def\Thetav{\check{\Theta}}
\def\thetav{\check{\theta}}

\DeclareDocumentCommand{\NN}{g}{
\IfValueTF{#1}{\fN(#1)}{\fN}
}
\DeclareDocumentCommand{\RR}{m m}{
\fR({#1},{#2})
}

%\DeclareMathOperator*{\sign}{Sign}

% \NewDocumentCommand{\lsign}{m}{
% {}^l\mathrm{Sign}(#1)
% }

% \NewDocumentCommand{\bsign}{m}{
% {}^b\mathrm{Sign}(#1)
% }
%
\def\tsign{{}^t\mathrm{Sign}}
\def\lsign{{}^l\mathrm{Sign}}
\def\bsign{{}^b\mathrm{Sign}}
\def\ssign{\mathrm{Sign}}
\NewDocumentCommand{\sign}{m}{
  \mathrm{Sign}(#1)
}

\NewDocumentCommand\lnn{t+ t- g}{
  \IfBooleanTF{#1}{{}^l n^+\IfValueT{#3}{(#3)}}{
    \IfBooleanTF{#2}{{}^l n^-\IfValueT{#3}{(#3)}}{}
  }
}


% Fancy bcO, support feature \bcO'^a_b = \overline{\cO'^a_b}
\makeatletter
\def\bcO{\def\O@@{\cO}\@ifnextchar'\@Op\@Onp}
\def\@Opnext{\@ifnextchar^\@Opsp\@Opnsp}
\def\@Op{\afterassignment\@Opnext\let\scratch=}
\def\@Opnsp{\def\O@@{\cO'}\@Otsb}
\def\@Onp{\@ifnextchar^\@Onpsp\@Otsb}
\def\@Opsp^#1{\def\O@@{\cO'^{#1}}\@Otsb}
\def\@Onpsp^#1{\def\O@@{\cO^{#1}}\@Otsb}
\def\@Otsb{\@ifnextchar_\@Osb{\@Ofinalnsb}}
\def\@Osb_#1{\overline{\O@@_{#1}}}
\def\@Ofinalnsb{\overline{\O@@}}

% Fancy \command: \command`#1 will translate to {}^{#1}\bfV, i.e. superscript on the
% lift conner.

\def\defpcmd#1{
  \def\nn@tmp{#1}
  \def\nn@np@tmp{@np@#1}
  \expandafter\let\csname\nn@np@tmp\expandafter\endcsname \csname\nn@tmp\endcsname
  \expandafter\def\csname @pp@#1\endcsname`##1{{}^{##1}{\csname @np@#1\endcsname}}
  \expandafter\def\csname #1\endcsname{\,\@ifnextchar`{\csname
      @pp@#1\endcsname}{\csname @np@#1\endcsname}}
}

% \def\defppcmd#1{
% \expandafter\NewDocumentCommand{\csname #1\endcsname}{##1 }{}
% }



\defpcmd{bfV}
\def\KK{\bfK}\defpcmd{KK}
\defpcmd{bfG}
\def\A{\!A}\defpcmd{A}
\def\K{\!K}\defpcmd{K}
\def\G{G}\defpcmd{G}
\def\J{\!J}\defpcmd{J}
\def\L{\!L}\defpcmd{L}
\def\eps{\epsilon}\defpcmd{eps}
\def\pp{p}\defpcmd{pp}
\defpcmd{wtK}
\makeatother

\def\fggR{\fgg_\bR}
\def\rmtop{{\mathrm{top}}}
\def\dimo{\dim^\circ}

\NewDocumentCommand\LW{g}{
\IfValueTF{#1}{L_{W_{#1}}}{L_{W}}}
%\def\LW#1{L_{W_{#1}}}
\def\JW#1{J_{W_{#1}}}

\def\floor#1{{\lfloor #1 \rfloor}}

\def\KSP{K}
\def\UU{\rU}
\def\UUC{\rU_\bC}
\def\tUUC{\widetilde{\rU}_\bC}
\def\OmegabfW{\Omega_{\bfW}}


\def\BB{\bB}


\def\thetaO#1{\vartheta\left(#1\right)}

\def\Thetav{\check{\Theta}}
\def\thetav{\check{\theta}}

\def\Thetab{\bar{\Theta}}

\def\cKaod{\cK^{\mathrm{aod}}}

%G_V's or G
%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \def\GVr{G_{\bfV}}
% \def\tGVr{\wtG_{\bfV}}
% \def\GVpr{G_{\bfV'}}
% \def\tGVpr{\wtG_{\bfV'}}
% \def\GVpr{G_{\abfV}}
% \def\tGVar{\wtG_{\abfV}}
% \def\GV{\bfG_{\bfV}}
% \def\GVp{\bfG_{\bfV'}}
% \def\KVr{K_{\bfV}}
% \def\tKVr{\wtK_{\bfV}}
% \def\KV{\bfK_{\bfV}}
% \def\KaV{\bfK_{\acute{V}}}

% \def\KV{\bfK}
% \def\KaV{\acute{\bfK}}
% \def\acO{\acute{\cO}}
% \def\asO{\acute{\sO}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%


\def\mstar{{\star}}

\def\GVr{G}
\def\tGVr{\wtG}
\def\GVpr{G'}
\def\tGVpr{\widetilde{G'}}
\def\GVar{G'}
\def\tGVar{\wtG'}
\def\GV{\bfG}
\def\GVp{\bfG'}
\def\KVr{K_{\bfV}}
\def\tKVr{\wtK_{\bfV}}
\def\KV{\bfK_{\bfV}}
\def\KaV{\bfK_{\acute{V}}}

\def\KV{\bfK}
\def\KaV{\acute{\bfK}}
\def\acO{{\cO'}}
\def\asO{{\sO'}}

\DeclareMathOperator{\sspan}{span}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\sp{{\mathrm{sp}}}

\def\bfLz{\bfL_0}
\def\sOpe{\sO^\perp}
\def\sOpeR{\sO^\perp_\bR}
\def\sOR{\sO_\bR}

\def\ZX{\cZ_{X}}
\def\gdliftv{\vartheta}
\def\gdlift{\vartheta^{\mathrm{gen}}}
\def\bcOp{\overline{\cO'}}
\def\bsO{\overline{\sO}}
\def\bsOp{\overline{\sO'}}
\def\bfVpe{\bfV^\perp}
\def\bfEz{\bfE_0}
\def\bfVn{\bfV^-}
\def\bfEzp{\bfE'_0}

\def\totimes{\widehat{\otimes}}
\def\dotbfV{\dot{\bfV}}

\def\aod{\mathrm{aod}}
\def\unip{\mathrm{unip}}


\def\ssP{{\ddot\cP}}
\def\ssD{\ddot{\bfD}}
\def\ssdd{\ddot{\bfdd}}
\def\phik{\phi_{\fkk}}
\def\phikp{\phi_{\fkk'}}
%\def\bbfK{\breve{\bfK}}
\def\bbfK{\wtbfK}
\def\brrho{\breve{\rho}}

\def\whAX{\widehat{A_X}}
\def\mktvvp{\varsigma_{{\bf V},{\bf V}'}}

\def\Piunip{\Pi^{\mathrm{unip}}}
\def\cf{\emph{cf.} }
\def\Groth{\mathrm{Groth}}
\def\Irr{\mathrm{Irr}}

\def\edrc{\mathrm{DRC}^{\mathrm e}}
\def\drc{\mathrm{DRC}}
\def\drcs{\mathrm{DRC}^{s}}
\def\drcns{\mathrm{DRC}^{ns}}
\def\LS{\mathrm{LS}}
\def\LLS{\mathrm{{}^{\ell} LS}}
\def\LSaod{\mathrm{LS^{aod}}}
\def\Unip{\mathrm{Unip}}
\def\lUnip{\mathrm{{}^{\ell}Unip}}
\def\tbfxx{\tilde{\bfxx}}


\newcommand{\noticed}{noticed }
\newcommand{\ess}{essential }

% Ytableau tweak
\makeatletter
\pgfkeys{/ytableau/options,
  noframe/.default = false,
  noframe/.is choice,
  noframe/true/.code = {%
    \global\let\vrule@YT=\vrule@none@YT
    \global\let\hrule@YT=\hrule@none@YT
  },
  noframe/false/.code = {%
    \global\let\vrule@YT=\vrule@normal@YT
    \global\let\hrule@YT=\hrule@normal@YT
  },
  noframe/on/.style = {noframe/true},
  noframe/off/.style = {noframe/false},
}
\makeatother
%\ytableausetup{noframe=on,smalltableaux}
\ytableausetup{noframe=on,boxsize=1.3em}
\let\ytb=\ytableaushort

\newcommand{\tytb}[1]{{\tiny\ytb{#1}}}

\makeatletter
\newcommand{\dotminus}{\mathbin{\text{\@dotminus}}}

\newcommand{\@dotminus}{%
  \ooalign{\hidewidth\raise1ex\hbox{.}\hidewidth\cr$\m@th-$\cr}%
}
\makeatother


\def\cOp{\cO^{\prime}}
\def\cOpp{\cO^{\prime\prime}}
\def\cLpp{\cL^{\prime\prime}}
\def\cLppp{\cL^{\prime\prime\prime}}
\def\pUpsilon{\Upsilon^+}
\def\nUpsilon{\Upsilon^-}
\def\pcL{\cL^+}
\def\ncL{\cL^-}
\def\pcP{\cP^+}
\def\ncP{\cP^-}
% \def\pcE{\cE^+}
% \def\ncE{\cE^-}
\def\pcC{\cC^+}
\def\ncC{\cC^-}
\def\pcLp{\cL^{\prime+}}
\def\ncLp{\cL^{\prime-}}
\def\pcLpp{\cL^{\prime\prime+}}
\def\ncLpp{\cL^{\prime\prime-}}
\def\pcB{\cB^+}
\def\ncB{\cB^-}
\def\uptaup{\uptau^{\prime}}
\def\uptaupp{\uptau^{\prime\prime}}
\def\uptauppp{\uptau^{\prime\prime\prime}}
\def\bdelta{{\bar{\delta}}}
\def\tcO{\tilde{\cO}}
\def\tcOp{\tcO^{\prime}}
\def\tcOpp{\tcO^{\prime\prime}}
\def\tuptau{\tilde{\uptau}}
\def\tuptaup{\tuptau^{\prime}}
\def\tuptaupp{\tuptau^{\prime\prime}}
\def\tuptauppp{\tuptau^{\prime\prime\prime}}
\def\taup{\tau^{\prime}}
\def\taupp{\tau^{\prime\prime}}
\def\tauppp{\tau^{\prime\prime\prime}}
\def\cpT{\cT^+}
\def\cnT{\cT^-}
\def\cpB{\cB^+}
\def\cnB{\cB^-}

\def\deltas{\delta^s}
\def\deltans{\delta^{ns}}


\def\uum{{\dotminus}}
\def\uup{\divideontimes}

\def\umm{{=}}
\def\upp{{\ast}}
\def\upp{
  {{\setbox0\hbox{$\times$}
      \rlap{\hbox to \wd0{\hss$+$\hss}}\box0
    }}
}

\begin{document}


\title[]{Special unipotent representations of classical groups: orthogonal and
  symplectic group case}

\author [D. Barbasch] {Dan M. Barbasch}
\address{the Department of Mathematics\\
  310 Malott Hall, Cornell University, Ithaca, New York 14853 }
\email{dmb14@cornell.edu}

\author [J.-J. Ma] {Jia-jun Ma}
\address{School of Mathematical Sciences\\
  Shanghai Jiao Tong University\\
  800 Dongchuan Road, Shanghai, 200240, China} \email{hoxide@sjtu.edu.cn}

\author [B. Sun] {Binyong Sun}
% MCM, HCMS, HLM, CEMS, UCAS,
\address{Academy of Mathematics and Systems Science\\
  Chinese Academy of Sciences\\
  Beijing, 100190, China} \email{sun@math.ac.cn}

\author [C.-B. Zhu] {Chen-Bo Zhu}
\address{Department of Mathematics\\
  National University of Singapore\\
  10 Lower Kent Ridge Road, Singapore 119076} \email{matzhucb@nus.edu.sg}




\subjclass[2000]{22E45, 22E46} \keywords{orbit method, unitary dual, unipotent
  representation, classical group, theta lifting, moment map}

% \thanks{Supported by NSFC Grant 11222101}
\maketitle


\tableofcontents


\delete{
\section{Relevent nilpotent orbits}

Let
\[\cO=(C_{2a},C_{2a-1}, \cdots, C_1,C_0,C_{-1}=0)\]
be a special orbit.  The dual orbit
\[ \ckcO = [R_{2a}\geq R_{2a-1}\geq \cdots \geq R_1\geq R_0].\] The $\ckcO$ is
given by add a box on the longest row of $\cO^T$ and then do $B$-collapse.


\begin{defn}
  Suppose $\bfG$ is type $C$.  An special orbit $\cO$ is called purely even if
  $\ckcO$ only has odd rows.
  This is equivalent to the condition on columns of $\cO$ such that (see \Cref{lem:C.even})
  \begin{enumC}
  \item $C_{2i} \equiv C_{2i-1} \pmod{2}$; 
  \item 
   If $C_{2i-1}$ is even,  $C_{2i-1} > C_{2i-2}$; 
  \item
    If $C_{2i}$ is odd, $C_{2i}=C_{2i-1}$. 
  \end{enumC}
  We call a purely even orbit $\cO$ is stablelly trivial when only even columns
  occures. This is equivalent to  
  \[
    C_{2i} \equiv C_{2i-1} \equiv 0 \pmod{2}  \text{ and } C_{2i-1}>
    C_{2i-2} \quad \forall i.
  \]
  {\color{red} In this case all LS in the unipotent representations are
    irreducible. }
  This is also equivalent to
  \[
    R_{2i}>R_{2i-1} \quad \forall i
  \]

  We call a purely even orbit $\cO$ is theta-admissible when each row columns
  appears at most $2$-times.
  {\color{red} All unipotent representations of these orbits are expected to
    constructed by theta correspondence. Moreover, they are parameterized by the
    their local systems. 
  }
  This is also equivalent to each row lenght appears at most $3$-times in
  $\ckcO$. 
\end{defn}

Suppose $\cO$ is purely even. 
The dual orbit 
$\ckcO = [R_{2a}\geq R_{2a-1}\geq \cdots \geq R_1\geq R_0]$
is calculated in the following way: 
\[
  [R_{2i},R_{2i-1}] = \begin{cases}
    [C_0+1, 0] & i=0\\
    [C_{2i}+1, C_{2i-1}-1] & i>0, C_{2i} \text{ is even} \\
    [C_{2i},C_{2i-1}] & i>0, C_{2i} \text{ is odd}
  \end{cases}
\]


\begin{defn}
  Suppose $\bfG$ is type $D$.  An special orbit
  \[
    \cO=(C_{2a-1}\ge\dots \ge C_0\geq C_{-1}=0) \quad C_{2i}\equiv
    C_{2i-1}\pmod{2}, C_{2a-1} \equiv 0 \pmod{2}
  \]
  is called purley even if
  $\ckcO$ only has odd rows.
  This is equivalent to the condition on columns of $\cO$ such that (see \Cref{lem:C.even})
  \begin{enumC}
  \item $C_{2i} \equiv C_{2i-1} \pmod{2}$; 
  \item 
   If $C_{2i-1}$ is even,  $C_{2i-1} > C_{2i-2}$; 
  \item
    If $C_{2i}$ is odd, $C_{2i}=C_{2i-1}$. 
  \end{enumC}
  Note that this is the same condition as the type C case. 
\end{defn}


Suppose $\cO$ is purely even. 
The dual orbit 
$\ckcO = [R_{2a-1}\geq \cdots \geq R_1\geq R_0, R_{-1}=0]$
is calculated in the following way: 
\[
  [R_{2i},R_{2i-1}] = \begin{cases}
    [C_0+1, 0] & i=0\\
    [0, C_{2a-1}-1] & i = a \\
    [C_{2i}+1, C_{2i-1}-1] & a> i>0, C_{2i} \text{ is even} \\
    [C_{2i},C_{2i-1}] & a>i>0, C_{2i} \text{ is odd}
  \end{cases}
\]
}

\section{Introduction and the main result(old)}\label{sec:intro}

A fundamental problem in representation theory is to determine the
unitary dual of a given Lie group $G$, namely the set of equivalent classes of irreducible unitary representations
of $G$. A principal idea, due to Kirillov and Kostant, is that there is a close connection between irreducible unitary representations of $G$ and the orbits of $G$ on the dual of its Lie algebra \cite{Ki62,Ko70}. This is known as orbit method (or the method of coadjoint orbits). Due to its resemblance with the process of attaching a quantum mechanical system to a classical mechanical system, the process of attaching a unitary representation to a coadjoint orbit is also referred to as quantization in the representation theory literature.

As it is well-known, the orbit method has achieved tremendous success in the context of nilpotent and solvable Lie groups \cite{Ki62,AK}. For more general Lie groups, work of Mackey and Duflo \cite{Ma,Du82} suggest that one should focus attention on reductive Lie groups. As expounded by Vogan in his writings (see for example \cite{VoBook,Vo98,Vo00}), the problem finally is to quantize nilpotent coadjoint orbits in reductive Lie groups. The ``corresponding'' unitary representations are called unipotent representations.

Significant developments on the problem of unipotent representations occurred in the 1980's. We mention two. Motivated by Arthur's conjectures on unipotent representations in the context of automorphic forms \cite{ArPro,ArUni}, Adams, Barbasch and Vogan established some important local consequences for the unitary representation theory of the group $G$ of real points of a connected reductive algebraic group defined over $\R$. See \cite{ABV}. The problem of finding (integral) special unipotent representations for complex semisimple groups (as well as their distribution characters) was solved earlier by Barbasch and Vogan \cite{BVUni} and the unitarity of these representations was established by Barbasch for complex classical groups \cite{B.Class}. In a similar vein, Barbasch outlined his proof of the unitarity of special unipotent representations for real classical groups in his 1990 ICM talk \cite{B.Uni}. The second major development is Vogan's theory of associated varieties \cite{Vo89} in which Vogan pursues the method of coadjoint orbits by investigating the relationship between a Harish-Chandra module and its associate variety. Roughly speaking, the Harish-Chandra module of a representation attached to a nilpotent coadjoint orbit should have a simple structure after taking the ``classical limit'', and it should have a specified support dictated by the nilpotent coadjoint orbit via the Kostant-Sekiguchi correspondence.

Simultaneously but in an entirely different direction,  there were significant developments in Howe's theory of (local) theta lifting and it was clear by the end of 1980's that the theory has much relevance for unitary representations of classical groups. The relevant works include the notion of rank by Howe \cite{HoweRank}, the description of discrete spectrum by Adams \cite{Ad83} and the preservation of unitarity in stable range theta lifting by Li \cite{Li89}. Therefore it was natural, and there were many attempts, to link the orbit method with Howe's theory, and in particular to construct unipotent representations in this formalism. See for example \cite{Sa,Pz,HZ,HL,Br,He,Tr,PT,B17}. Particularly worth mentioning were the work of Przebinda \cite{Pz} in which a double fiberation of moment maps made its appearance in the context of theta lifting, and the work of He \cite{He} in which an innovative technique called quantum induction was devised to show the non-vanishing of the lifted representations. More recently the double fiberation of moment maps was successfully used by a number of authors to understand refined (nilpotent) invariants of representations such as associated cycles and generalized Whittaker models \cite{NOTYK, NZ, GZ, LM}, which among other things demonstrate the tight link between the orbit method and Howe's theory.


In the present article we will demonstrate that the orbit method and Howe's theory in fact have perfect synergy when it comes to unipotent representations. (Barbasch, M{\oe}glin, He and Trapa pursued a similar theme. See \cite{B17,Mo17,He,Tr}.) We will restrict our attention to a real classical group $G$ of orthogonal or symplectic type and we will construct all unipotent representations of $\wt{G}$ attached to $\CO$ (in the sense of Barbasch and Vogan) via the method of theta lifting. Here $\wtG$ is either $G$, or the metaplectic cover of $G$ if $G$ is a real symplectic
group, and $\CO$ is a member of our preferred set of complex nilpotent orbits, large enough to include all those which are rigid special. Here we wish to emphasize that there have been extensive investigations of unipotent representations for real reductive groups by Vogan and his collaborators (see e.g. \cite{VoBook,Vo89,ABV}),
%in particular on the related problems of classification of the primitive ideals and Fourier inversion of unipotent orbit integrals \cite{BVPri1, BVPri2},
only for unitary groups complete results are known (\emph{cf}. \cite{BV83, Tr}), in which case all such representations may also be described in terms of cohomological induction.
\vsp


We now proceed to our setup in order to state the main technical result of this article.

Let $\bfG$ be either a complex orthogonal group or a
complex symplectic group. Put $\epsilon=1$ or $-1$, when $\bfG$ is respectively
orthogonal or symplectic. Denote by $\fgg$ the Lie algebra of $\bfG$ and let
$\CO$ be a nilpotent $\bfG$-orbit in $\fgg^*$. Unless otherwise specified, a
superscript ``$\,^*\,$" indicates the dual space.  By identifying $\fgg^*$ with
$\fgg$ via the trace form, $\cO$ is also viewed as a nilpotent $\bfG$-orbit in
$\fgg$. Denote by $\Nil_{\bfG}(\fgg)$ the set of nilpotent $\bfG$-orbits in
$\fgg$.

In the usual way, a nilpotent $\bfG$-orbit $\CO$ in $\fgg$ is parameterized by
its Young diagram. In this article, we will label a Young diagram $\bfdd$ by its
column partition $[c_0,c_1,\cdots, c_k]$, where
\[%\begin{equation}\label{eq:partition}
  c_0\geq c_1\geq \cdots \geq c_k> 0
\]%\end{equation}
represent lengths of the columns of $\bfdd$. If $\bfG$ is a trivial group, then the only nilpotent $\bfG$-orbit is labeled by the empty sequence $\emptyset$, and we set  $k=-1$ in this case.
% By allowing the last entry $c_k$ to be zero, we will assume $k$ to be even if
% $\epsilon =1$, and $k$ to be odd if $\epsilon =-1$. All other $c_i$'s are not
% allowed to be zero. Then $k$ is determined by the Young diagram $\bfdd$.  We
% refer the reader to \Cref{sec:Nil} for more detailed discussions.

% \[ c_k\geq\cdots\geq c_1\geq c_0\geq 0 \] represent lengths of the columns of
% $\bfdd$.


 Fix a parity $\mathbb p\in \Z/2\Z$ throughout the paper.
Let $\cP_{\bfG}$ be the set of partitions/Young diagrams parameterizing the set
$\Nil_{\bfG}(\g)$.  Set $\epsilon_l = \epsilon(-1)^{l}$ for $l\geq 0$ and
consider the following subset of $\cP_{\bfG}$:
% \begin{equation}\label{eq:conditionS}
%\cP^s_{\bfG}:= \Set{\bfdd = [c_0,c_1,\cdots, c_k]\in
%  \cP_{\epsilon}|  \parbox[c]{18em}{
%    \begin{itemize}
%    \item all $c_i$'s have the same parity
%    \item $c_{l} \geq c_{l-1} + 1+ \epsilon_l \\= \begin{cases}
%        c_{l-1} +2 & \text{if } \epsilon_l = 1 \\
%        c_{l-1} & \text{if } \epsilon_l = -1
%      \end{cases}$
%    \end{itemize}}
%    \begin{itemize}
%    \item all $c_i$'s have the same parity,
%    \item
%      $c_{l} \geq c_{l+1} + 2, \text{if } \epsilon_l = 1 \,\,\,(\forall l \leq
%      k-1)$
%    \end{itemize}}
%  }.
%\end{equation}

\begin{equation}\label{eq:conditionS}
\cP^{\mathbb p}_{\bfG}:= \Set{\bfdd = [c_0,c_1,\cdots, c_k]\in
  \cP_{\bfG}|  \parbox[c]{17em}{
%    \begin{itemize}
%    \item all $c_i$'s have the same parity
%    \item $c_{l} \geq c_{l-1} + 1+ \epsilon_l \\= \begin{cases}
%        c_{l-1} +2 & \text{if } \epsilon_l = 1 \\
%        c_{l-1} & \text{if } \epsilon_l = -1
%     \end{cases}$
%   \end{itemize}}
    \begin{itemize}
    %\item
    \item all $c_i$'s have parity $\mathbb p$;
    \item $c_{l} \geq c_{l+1} + 2$, if $0\leq l\leq k-1$ and $\epsilon_l = 1$.
    \end{itemize}} }.
\end{equation}



Let $\Nil^{\mathbb p}_{\bfG}(\g)$ be the subset of $\Nil_{\bfG}(\g)$ corresponding to
partitions in $\cP^{\mathbb p}_{\bfG}$. Write $\bfV$ for the standard module of $\bfG$. Note that if the group $\bfG$ is orthogonal and nontrivial, then there is no partition  in $ \cP_{\bfG}$ satisfying the first condition in \eqref{eq:conditionS} unless $\mathbb p$ equals the parity of $\dim \bfV$.

\begin{remarks}
\begin{enumR}

\item  If $\mathbb p$ is the parity of $\dim\!\bfV$,   then  $\Nil^{\mathbb p}_{\bfG}(\g)$ is precisely
  the set of stably trivial special nilpotent orbits in $\Nil_{\bfG}(\g)$.
 If $\bfG$ is a symplectic group, then
 all nilpotent orbits in
  $\Nil^{1}_{\bfG}(\g)$ are metaplectic-special, as defined in \cite{JLS}. See also \cite{Mo96}.
\item All rigid special nilpotent orbits in $\Nil_{\bfG}(\g)$
  are stably trivial. The reader is referred to \cite[Section~2]{B17} for facts on stably trivial special nilpotent orbits.

\item  Every orbit $\CO\in \Nil^{\mathbb p}_{\bfG}(\g)$ is irreducible as an algebraic variety \cite[IV 2.27]{SS}.
\end{enumR}
\end{remarks}





Let $m$ be the rank of $\bfG$. We identify a Cartan subalgebra of $\g$ with
$\C^m$, using the standard coordinates. Let a superscript group indicate the
space of invariant vectors under the group action.  Then Harish-Chandra
isomorphism yields an identification
\[
  \oU(\fgg)^{\bfG}=\left(\oS(\C^m)\right)^{W_m},
\]
where ``$\oU$'' indicates the universal enveloping algebra, ``$\oS$'' indicates
the symmetric algebra, and $W_m$ denotes the subgroup of $\GL_m(\C)$ generated
by the permutation matrices and the diagonal matrices with diagonal entries
$\pm 1$. We may thus parameterize algebraic characters of $\oU(\g)^{\bfG}$ by
$(\C^m)^*/W_m \cong \C^m/W_m$. Unless $\bfG$ is an even orthogonal group,
$\oU(\g)^{\bfG}$ equals the center $\oZ(\g)$ of $\oU(\g)$.

% Set
% \begin{equation*}
%\begin{aligned}
%  &\rho^{1}_n=\left(\frac{n}{2}-1, \frac{n}{2}-2,\cdots,
%    \frac{n}{2}-\lfloor\frac{n}{2} \rfloor\right), \\
%  &\rho^{-1,1}_{n_1,n_2}=\left(\frac{n_1}{2},\frac{n_1-2}{2}, \cdots,
%    \frac{2-n_2}{2}\right) \ \ (n_1,n_2 \text { have the same parity})
%\end{aligned}
%\end{equation*}

%For $r\in \bN$, define
%\[
%  \rho_r = (\frac{r-1}{2},\cdots, \frac{r-1}{2}- \floor{\frac{r-1}{2}}).
%\]
%We will implicitly omit a possible zero entry in $\rho_r$ sometimes.

For any positive integer $r$, denote
% \begin{equation}
%   \rho_r^\epsilon
%   % = \rho_{r-\epsilon}
%   =\begin{cases}
%     (\frac{r}{2}-1, \cdots, \frac{r}{2} -
%     \floor{\frac{r}{2}})\\
%     = \begin{cases}
%       (\frac{r}{2}-1, \cdots, 1,0)  \in \bZ^{\frac{r}{2}}& \text{if $\epsilon = 1$ and $r$ is even,}\\
%       (\frac{r}{2}-1, \cdots, \frac{3}{2},\frac{1}{2}) \in (\bZ+\half)^{\frac{r-1}{2}}&\text{if $\epsilon = 1$ and $r$ is odd,}
%     \end{cases}\\
%     (\frac{r}{2}, \cdots,
%     \frac{r}{2}-\floor{\frac{r-1}{2}})\\
%     = \begin{cases}
%       (\frac{r}{2}, \cdots, 2,1) \in \bZ^{\frac{r}{2}}& \text{if $\epsilon = -1$ and $r$ is even,}\\
%       (\frac{r}{2}, \cdots, \frac{3}{2},\frac{1}{2}) \in
%       (\bZ+\half)^{\frac{r+1}{2}}& \text{if $\epsilon = -1$ and $r$ is odd.}
%     \end{cases}
%   \end{cases}
% \end{equation}
% By convention, $\rho^\epsilon_0$ denote the unique element of the trivial
% group $ (\bZ/2)^{0}$.
\[%\begin{equation}
  \rho_r^\epsilon
  % = \rho_{r-\epsilon}
  =\begin{cases}
    (\frac{r}{2}-1, \frac{r}{2}-2,  \cdots, \frac{r}{2} -
    \floor{\frac{r}{2}}) \quad \in (\half\bZ)^{\floor{\frac{r}{2}}}, & \text{if $\epsilon =
      1$};\\
    (\frac{r}{2}, \frac{r}{2}-1, \cdots,
    \frac{r}{2}-\floor{\frac{r-1}{2}})\quad  \in (\half\bZ)^{\floor{\frac{r+1}{2}}},& \text{if $\epsilon = -1$}.
  \end{cases}
\]%\end{equation}



\begin{defn}\label{def:infO}
  For a nilpotent orbit $\CO\in \Nil_{\bfG}(\g)$ given by the partition
  $\bfdd = [c_0,c_1,\cdots, c_k]$, define the following element $\lambda_{\CO}$
  of $\C^m$:
  \[
    \lambda_\cO :
    % =\lambda_\bfdd
    = (\rho^{\epsilon_0}_{c_0}, \rho^{\epsilon_1}_{c_1},
    \cdots,\rho^{\epsilon_k}_{c_k} ) \in (\half\bZ)^{m}.
  \]
  By abuse of notation, $\lambda_\cO$ also represents its image in $\bC^m/W_m$,
  as well as the corresponding algebraic character of $\oU(\g)^{\bfG}$.
\end{defn}




\begin{remark}
 If $\mathbb p$ is the parity of $\dim \!\bfV$, then for every $\cO\in \Nil^{\mathbb p}_{\bfG}(\g)$,
 $\lambda_\cO$ equals  the algebraic character of $\oU(\g)^{\bfG}$ determined by
$\half {^{L}h}$ as in \cite[Equation~(1.5)]{BVUni} (\emph{cf}.
  \cite[Proposition 1.12]{Tr} and  \cite[Section~7]{So}).
\end{remark}
\trivial[h]{
  When $c_i$'s are all even, this is in
  \cite[Proposition 1.12]{Tr}. We include a proof for completeness.  In what
  follows, we use the notation and algorithm of \cite[Section~7]{So} for
  computing the Barbasch-Vogan dual.

  Recall some facts in \cite[Section~7]{So}: For any partition $\lambda$, let
  $\lambda^*$ be the dual partition and let$\lambda_X$ be the $X$-collapse, for
  $X = B,C,D$. For each $\lambda$ with correct size (not necessary of type $X$),
  can define a representation $E_\lambda^X$ of the Weyl group of type $X$.
  $E^X_\lambda = E^X_\mu$ if $\lambda$ and $\mu$ has the same $X$-collapse.
  When $\lambda$ is type $X$ then $E^X_{\lambda}$ is the image of the nilpotent
  orbit $\lambda$ under Springer correspondence (which is one-one). The Lusztig-Spaltenstein dual
  is given by $\lambda \mapsto (\lambda^*)_X$ is.
  The Barbasch-Vogan dual is calculated using \cite[Lemma~11]{So}.

  When
  $\lambda$ is a type $C$-partition  (adding a box at bottom of the first column gives
  $\lambda_+$), the map is given by
  \[
    \lambda \mapsto (\lambda^B)^*_B = (\lambda_+)^*_B.
  \]
    Suppose $\bfG$ is a symplectic group and  $\lambda = [c_0,\cdots, c_k]$ and $c_i$'s are all even. Then
  $(\lambda_+)^*$ has row $(c_0+1,c_1, \cdots, c_k)$. Therefore,
  $(\lambda_+)^*_B = (c_0+1,p')$ where $p' = (c_1, \cdots, c_k)_B$.  Note that $c_{2i-1}\geq c_{2i}+2$, for $2i\leq k-1$. Therefore, $p' =
  (c_1-1,c_2+1, \cdots, c_{k-1}-1, c_k+1)$ if $k$ is even and $p' =
  (c_1-1,c_2+1, \cdots, c_{k-1}+1, c_k-1,1)$ if $k$ is odd. In
  particular, ${^{L}\cO}$ gives the infinitesimal character
  $(\rho^{\epsilon_0}_{c_0}, \rho^{\epsilon_{1}}_{c_{1}},\cdots,
  \rho^{\epsilon_k}_{c_k})=\lambda_{\cO}$.



  When $\lambda$ is
  a type $B$-partition,  $\lambda \mapsto E^B_\lambda\otimes \sgn =
  E^B_{\lambda^*_B} = E^B_{\lambda^*} = E^C_{(\lambda^C)^*} =
  E^C_{(\lambda^C)^*_C} \leftrightarrow (\lambda^C)^*_C$, i.e.
  the Barbash-Vogan dual is given by $\lambda \mapsto (\lambda^C)^*_C =
  ((\lambda^-)_C)^*_C $.
  We are interested in the case that $\lambda$ is special, then $\lambda^*$ is
  also special and
  \[ \lambda \mapsto E^B_{\lambda}\otimes \sgn  =
  E^B_{\lambda^*} = E^C_{(\lambda^*)^C} \leftrightarrow \lambda^*_C.
  \]
  Suppose $\bfG$ is an orthogonal group and $c_i$'s are all odd. Then
  $\bfG$ must be an odd orthogonal group,
  $\depth(\bfdd)=k$ must be even and $c_{2i}\geq c_{2i+1}+2$, for $2i\leq k-2$.
  Now $(\lambda^*)_-$  has rows $(c_0,c_1, \cdots, c_{k-1}, c_k-1)$
  and
  $((\lambda^*)_-)_C = (c_0-1,c_1+1, \cdots, c_{2i}-1,c_{2i+1}+1,\cdots,
  c_{k-1}+1,c_k-1)$.  In particular, ${^{L}\cO}$ gives the infinitesimal
  character
  $ (\rho^{\epsilon_0}_{c_0}, \rho^{\epsilon_1}_{c_1},\cdots,
  \rho^{\epsilon_k}_{c_k})=\lambda_{\cO}$.

  When $\lambda$ is a type $D$ partition. Then the Barbasch-Vogan dual is the
  Lusztig-Spaltenstein dual.
  Suppose $\lambda$ has columns $[c_0,\cdots, c_k]\in \cP^\bpp$. Then
  $\lambda^*$ has rows $(c_0, c_1,\cdots, c_k)$. Note that $c_{2i}\geq c_{2i+1}
  +2$ and they are even. The $D$ collapse yields $\lambda^*_D = (c_0-1,c_1+1, \cdots, c_k
  +(-1)^k)$. In particular, ${^{L}\cO}$ gives the infinitesimal
  character
  $ (\rho^{\epsilon_0}_{c_0}, \rho^{\epsilon_1}_{c_1},\cdots,
  \rho^{\epsilon_k}_{c_k})=\lambda_{\cO}$.
}




% \begin{eqnarray*}
%  \lambda_{\CO} &:=&\begin{array}{l} \left(\rho ^{1}_{c_0}, \rho ^{-1,1}_{c_1,c_2},
%  \cdots, \rho ^{-1,1}_{c_{k-1},c_k} \right)\end{array} \\
%   &\textrm{or }& \begin{array}{l}  \left(\rho ^{-1,1}_{c_0,c_1},
%  \cdots, \rho ^{-1,1}_{c_{k-1},c_k}    \right)\end{array},
%\end{eqnarray*}
%when $\epsilon =1$ or $-1$, respectively.

% For each two-sided ideal $I\subset \rU(\fgg)$, by taking the grading of the
% natural filtration of $\rU(\fgg)$, we get an ideal
% \[
%   \gr I\subset \oS(\fgg)=\mathrm{gr} \rU(\fgg).
% \]
% Write $\CV(I)$ for the subvariety of $\fgg^*$ defined by $\mathrm{gr} I$,
% which is called the associated variety of $I$. When $I$ is a primitive ideal,
% write $\lambda_I$ for the algebraic character of $\rU(\fgg)^{G}$ such that
% \[
%   I\cap \rU(\fgg)^{G}=\ker \lambda_I.
% \]

We will work in the category of Casselman-Wallach representations \cite{Ca89, Wa2}. Recall that a  smooth Fr\'echet representation of  moderate growth  of a real reductive group is called a Casselman-Wallach representation if its Harish-Chandra module has  finite length.

Let $G$ be a real form of $\bfG$, namely, $G$ is the fixed point group of an
anti-holomorphic involutive automorphism of $\bfG$. Thus $G$ is a real
orthogonal group, a real symplectic group, a quaternionic orthogonal group, or a
quaternionic symplectic group.  When $G$ is a real symplectic group, write
\[
  \xymatrix@R=0em{ 1\ar[r] &\{1, \varepsilon_G\}\ar[r] &\wtG \ar[r] & G\ar[r] &1
  }
\]
for the metaplectic cover of $G$. It does not split unless $G$ is trivial.
We say that a Casselman-Wallach representation $\pi$ of $\wtG$ is $\mathbb p$-genuine if
$\varepsilon_G$ acts on $\pi$ through the scalar multiplication by
$(-1)^{\mathbb p}$.  % Further when $\bpp$ is the odd parity, we will say that we are in the metaplectic case.
In all other cases, we simply set $\wtG:=G$, and  all Casselman-Wallach representations of $\wtG$ are defined to be $\mathbb p$-genuine. When no confusion is possible, the notion of
``$\mathbb p$-genuine'' will be used in similar settings without further
explanation.



For a Casselman-Wallach representation $\pi$ of $\wtG$, denote $\Ann(\pi)$ its
annihilator ideal in $\rU(\g)$.  Let $\cO \in \Nil^{\mathbb p}_{\bfG}(\g)$.
Following Barbasch and Vogan \cite{BVUni, ABV}, we make the following definition.

\begin{dfnl}\label{defunip1}
  An irreducible Casselman-Wallach representation $\pi$ of $\wtG$ is said to be
  $\cO$-unipotent if
  \begin{itemize}
  \item the associated variety of  $\Ann(\pi)$ is contained in the closure $\overline \CO$ of $\CO$,
  \item the action of $\rU(\fgg)^{\bfG}$ on $\pi$ is given by the character $\lambda_\CO$, and
  \item $\pi$ is $\mathbb p$-genuine.
  \end{itemize}

\end{dfnl}

\begin{remarks}
\begin{enumR}
\item The first two conditions of Definition \ref{defunip1} may also be given in terms of a certain primitive ideal $I_{\cO}$ of $\rU(\fgg)$. We adopt a more direct approach.
  \item We comment on the third condition of Definition \ref{defunip1} by the example of $G=\Sp_2(\bR)=\SL_2(\bR)$. Take $\cO$ the principal nilpotent
  orbit, then up to isomorphisms, there are six irreducible Casselman-Wallach
  representations of $\wtG$ satisfying the first two conditions. Four of these
  representations also satisfy the third condition and are thus $\CO$-unipotent
  in our definition. They are the irreducible components of the two oscillator representations.  The other two descend to the two irreducible principal series representations
  of $G$ with infinitesimal character $\lambda_\CO$. One of them is unitarizable and the other is not. They are not considered as unipotent representations.
  \end{enumR}
  \end{remarks}



Let $\Pi^{\mathrm{unip}}_{\CO}(\wtG)$ denote the set of isomorphism classes of
$\cO$-unipotent irreducible Casselman-Wallach representations of $\wtG$.  Write
$\cK_{\cO}(\wtG)$ for the Grothedieck group of the category of Casselman-Wallach
representations $\pi$ of $\wtG$ such that the associated variety of $\Ann(\pi)$ is contained in $\overline \CO$.  We view $\Pi^\mathrm{unip}_{\CO}(\wtG)$ as a subset of
$\CK_{\CO}(\wtG)$.


Fix a maximal compact subgroup $K$ of $G$. Write $\bfK$ for the Zariski closure
of $K$ in $\bfG$, which is a universal complexification of $K$.  Write $\wtK\rightarrow K$ for the one or two fold covering map  induced by the
 covering map $\wtG\rightarrow G$.  Denote by $\wtbfK$ the universal
complexification of $\wtK$.

Write
\[
  \fgg=\fkk\oplus \fpp,
\]
where $\fkk$ is the Lie algebra of $\bfK$, and $\fpp$ is its orthogonal
complement in $\fgg$ with respect to the trace form. Under the adjoint action
of $\bfK$, the complex variety $\cO\cap \fpp$ is a union of finitely many
orbits, each of dimension $\frac{\dim_\C \CO}{2}$.  For any $\bfK$-orbit
$\sO\subset \cO\cap \p$, let $\CK_{\sO}(\wt{\bfK})$ denote the Grothedieck group
of the category of $\wt{\bfK}$-equivariant algebraic vector bundles on $\sO$.
Put
\[
  \CK_{\CO}(\wtbfK):=\bigoplus_{\sO\textrm{ is a $\bfK$-orbit in $\CO\cap \p$}}
  \mathrm \CK_{\sO}(\wt{\bfK}).
\]

Following Vogan \cite[Section 8]{Vo89}, we make the following definition.

\begin{defn}\label{defaod}
  Let $\sO$ be a $\bfK$-orbit in $\CO\cap \p$. An admissible orbit datum over
  $\sO$ is an irreducible $\wt{\bfK}$-equivariant algebraic vector bundle $\CE$
  on $\sO$ such that
  \begin{itemize}
    \item $\CE_X$ is isomorphic to a multiple of
    $(\bigwedge^{\mathrm{top}} \k_X )^{\frac{1}{2}}$ as a representation of
    $\k_X$;
    \item $\CE$ is $\mathbb p$-genuine.
  \end{itemize}
  Here $X\in \sO$, $\CE_X$ is the fibre of $\cE$ at $X$, $\fkk_X$
  denotes the Lie algebra of the stabilizer of $X$ in $\bfK$, and
  $(\bigwedge^{\mathrm{top}} \k_X)^{\frac{1}{2}}$ is a one-dimensional
  representation of $\k_X$ whose tensor square is the top degree wedge
  product $\bigwedge^{\mathrm{top}} \k_X$.
\end{defn}

Note that in the situation of classical groups we consider here, all admissible
orbit data are line bundles.  Denote by $\cKaod_{\sO}(\wtbfK)$ the
set of isomorphism classes of admissible orbit data over $\sO$, to be viewed as
a subset of $\CK_{\CO}(\wtbfK)$. Put
\[
  \cKaod_{\cO}(\wtbfK):=\bigsqcup_{\sO\textrm{ is a $\bfK$-orbit in
      $\CO\cap \p$}}  \cKaod_{\sO}(\wtbfK)\subset
  \CK_{\CO}(\wtbfK).
\]


According to Vogan \cite[Theorem 2.13]{Vo89}, we have a canonical homomorphism \begin{equation}\label{ch} \Ch_\CO:
\CK_{\CO}(\wtG)\rightarrow \CK_{\CO}(\wtbfK).  \end{equation}

The main result of this article is the following theorem.

\begin{thml}\label{main} Let $\cO \in   \Nil^{\mathbb p}_{\bfG}(\g)$.
  The homomorphism \eqref{ch} restricts to a bijective
  map
  \begin{equation}\label{bij}
    \Ch_\CO: \Pi^\unip_{\CO}(\wtG)\longrightarrow
    \cKaod_{\CO}(\wtbfK).
  \end{equation}
  Moreover, every representation in
  $\Pi^\unip_{\CO}(\wtG)$ is unitarizable.
\end{thml}


\begin{remarks}
\begin{enumR}
\item  When $G$ is a quaternionic orthogonal group or an quaternionic symplectic group,
  the first assertion of Theorem \ref{main} is proved in Theorems 6 and 10
  of \cite{Mc}. See also \cite[Theorem 3.1]{Tr}.
\item The bijectivity in \Cref{bij} implies in particular that the associated variety of a representation in
  $\Pi^\unip_{\cO}(\wtG)$ is the closure of a single nilpotent $\bfK$-orbit in
  $\cO\cap \fpp$. \trivial[h]{Suppose $\Ch_{\cO}(\pi) = \cE \in \cK_{\sO}^\aod(\wtbfK)$
    then $\bsO\subseteq \AV(\pi)$. The equality also could be seen by applying
    \Cref{cor:Cbound} to the explicit
    construction of $\pi$ in \Cref{sec:cons}.}
\end{enumR}
\end{remarks}
% \section{Main theorem}


Key to the proof of Theorem \ref{main} is the existence of unitarizable
unipotent representations with the prescribed nilpotent admissible orbit
data. More precisely we shall first prove the following result (see Theorem
\ref{thmunip}):

\begin{itemize}
\item for every $\CE\in \CK_{\CO}^\aod(\wtbfK)$, there exists a unitarizable
  $\CO$-unipotent representation $\pi$ of $\wt{G}$ such that
  $ \Ch_{\CO}( \pi)= \CE$.
\end{itemize}

Our construction of the $\CO$-unipotent representation $\pi$ for a given
$\CE\in \CK_{\CO}^\aod(\wtbfK)$ will be guided by a geometric process which we
call descent. We describe it briefly.  Write $\bfG =\bfG_{\bfV}$, where $\bfV$
is the standard module of $\bfG$ as before, which is an $\epsilon$-symmetric
bilinear space. From the pair $(\bfV, \CO)$, the decent process yields another
pair $(\bfV', \CO')$, where $\bfV'$ is an $\epsilon'$-symmetric bilinear space,
and $\cO'$ is a nilpotent $\bfG'$-orbit in $\Nil^{\mathbb p}_{\bfG'}(\g')$. Here
$\epsilon \epsilon '=-1$, and $\bfG'=\bfG_{\bfV'}$. The real form $G$ of $\bfG$
is specified by an additional structure on $\bfV$, which we call
$(\epsilon, \dot \epsilon)$-space, where $\dotepsilon =\pm 1$. Assume that
$\sO$ is a $\bfK$-orbit in $\CO\cap \p$. In a similar way, the decent process
yields from the pair $(\bfV, \sO)$ another pair $(\bfV', \sO')$, where $\bfV'$
is an $(\epsilon', \dot \epsilon')$-space ($\dotepsilon \dotepsilon' = -1$),
giving rise to a real form $G'$ of $\bfG'$.
% and $\sO'$ is a nilpotent $\bfK'$-orbit in $\CO'\cap \p'$, .

The geometric process inverse to the descent will be called lifting. Apart from
lifting a nilpotent orbit, one can in fact lift an equivariant algebraic vector
bundle on the nilpotent orbit which has the additional property of sending an
admissible orbit datum over $\sO'$ to an admissible orbit datum over
$\sO$. Moreover, by twisting with characters of the component group of $\bfK$ if
necessary, this lifting map of admissible orbit data is surjective (see \Cref{lem:admchar.surj}). A key
observation here is that the geometric processes outlined are completely
governed by a double fiberation of moment maps mentioned earlier.  (Some of the
basic facts about this double fiberation first appeared in a paper of Kraft and
Procesi on the geometry of conjugate classes in classical groups \cite{KP}.)
This summarises the geometric preparations regarding our nilpotent orbits and
concludes our discussion on the contents of Section \ref{sec:Nil}.


To construct the $\CO$-unipotent representation $\pi$, we will apply theta
lifting for the dual pair $(G',G)$, starting from an ${\cO'}$-unipotent
representation of $\wt{G'}$ with an associated character
$\CE '\in \CK_{\CO'}^\aod(\wtbfK')$. Our model of theta lifting is provided by
matrix coefficient integrals against the oscillator representation in the
so-called convergent range.  The critical task before us is to show that the
lifted representation will not vanish and furthermore the associated character
$\CE$ of the lifted representation is simply the lift of $\CE'$. As a first
step, we show an upper bound of $\CE$ by the lift of $\CE'$ by some largely
geometric considerations. To achieve the equality, we adapt the idea of He
mentioned earlier, namely by applying another theta lifting to an appropriate
group (of the same type as $G'$) and then relating the double theta lift, via a
variant of the well-known doubling method (\emph{cf}. \cite{Ra, MVW}), to a
certain degenerate principal series representation of an appropriately large
classical group (whose structure is explicitly described in
\cite{LZ1,LZ2,Ya}). The end result is that the lifted representation must have
the anticipated associated character, by comparing associated cycles within the
said degenerate principal series representation. To summarize the contents, we
take care of the analytic preparations, namely growth of matrix coefficients,
their integrals against oscillator representations as well as degenerate
principal series in Section \ref{sec:Integrals}, and we combine geometry and
analysis to determine the associated characters of theta lifts in the convergent
range (in a general setting) in Section \ref{sec:AC}.

In Section \ref{sec:unipot}, we complete the construction of unipotent representations by an iterative procedure. For the exhaustion part of the main theorem, we use in a crucial way the result of Barbasch \cite{B.Uni,B10} counting unipotent representations for a real symplectic group and a split real odd orthogonal group. Putting together our construction of unipotent representations with the prescribed nilpotent admissible orbit data, the counting result of Barbasch for the specific cases just mentioned, as well as a general technique of embedding unitary representations (via stable range theta lifting), our main theorem follows for all the cases considered in this article.

Finally the unitarizability of all $\cO$-unipotent representations is a consequence of the exhaustion and the construction by our concrete models. Specifically we achieve this by showing the nonnegativity of a certain matrix coefficient integral, using a general technique of Harris, Li and Sun \cite{HLS}. Note that the unitarizability of the constructed representations also follows from the earlier work of He on theta lifting in the so-called strongly semistable range (\cite[Chapter 5]{He} or \cite{He2}).

\subsection*{Notation}
We adopt the following convention throughout the article. Boldface letters
denote objects defined over $\C$ such as a complex vector space or a complex Lie
group.  If an object with ``$\ '$'' (e.g. $\bfV'$) is defined, all related
notions will be implicitly defined by adding a prime (e.g. $\bfG'$). Epsilons,
e.g. $\epsilon,\dotepsilon,\epsilon'$, always mean a sign taking values in
$\set{\pm 1}$.  A superscript ``$\,^\mathrm t$" indicates the transpose  and
``$\tr$" the trace, of a matrix.  A superscript ``$\,^\vee$" indicates the
contragredient representation in the appropriate
contexts. Unless otherwise specified,  ``$\Ind$'' and ``$\ind$'' indicate the normalized smooth and Schwartz
induction\footnote{For Schwartz induction, see \cite{Cl}.}, respectively.
``$\inn{}{}$" denotes natural parings or Hermitian inner products in the
appropriate contexts. All measures appearing in integrals on real reductive
groups are the Haar measures.
% When an element (or more generally a set) $J$ acts on a set $S$, let $S^J$ denote the subset of invariants under $J$; let $S^{J,\gamma}$ be the
%$\gamma$-eigenspace of $J$, if $S$ is a vector space and the $J$-action is linear.
The largest
integer less than or equal to a real number $a$ is denoted by $\floor{a}$.
Let ``$\id$'' indicate the identity map in various contexts. Let $\bfii$ denote
a fixed $\sqrt{-1}$.

\section{Statement of the main result(new)}
\subsection{Nilpotent Orbits}
Let $\bfG = \Sp,  \rO$, and $\cO\in \Nil(\bfG)$ is a complex nilpotent
orbit.
``Type M'' means that $\wtG$ is a metaplectic group. its dual group $\ckbfG$ is a symplectic
group with the same rank, and its duality means the metaplectic dual.
Let $\drc(\cO)$ be the set of dot-r-c diagrams parameterizing unipotent
representations of the real forms of $\bfG$.

We say an orbit $\ckcO\in \Nil(\ckbfG)$ is purely even (good parity in
Moeglin-Renard's notation) if
\begin{des}
 \item[] all row lengths of $\ckcO$ are even when $\ckbfG$ is a symplectic group.
 \item[]  all row lengths of $\ckcO$ are odd when $\ckbfG$ is an orthogonal group.
\end{des}

%The following set of orbit are the purely even case:

\begin{defn} \label{def:noticed}
  Now we describe the nilpotent orbit $\cO\in \Nil(\bfG)$ who is the
  Barbasch-Vogan dual of a purely even orbit $\ckcO$. If $G$ is
  \begin{des}
    \item [Type C] Then
          $\cO$ is special and it has columns
          \[
            ( C_{2k},C_{2k-1},\cdots, C_{1},C_{0}, C_{-1}=0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ if } C_{2i} \text{ is even for
            } i=0, \cdots, k-1.
          \]
           Note that, by the
          definition of special orbit,
          we have $C_{2i}\equiv C_{2i-1} \pmod{2}$, $C_{2i} = C_{2i-1}$ if
          $C_{2i}$ is odd for $i = 1, \cdots k$.
    \item [Type M] Then
          $\cO$ is metaplecitic special and it has columns
          \[
            ( C_{2k},C_{2k-1},\cdots, C_{1},C_{0}=0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ if } C_{2i} \text{ is odd for } i=0, \cdots, k-1.
          \]
          Note that, by the
          definition of metaplectic special,
          we have $C_{2i}\equiv C_{2i-1} \pmod{2}$, $C_{2i} = C_{2i-1}$ if
          $C_{2i}$ is even
          for $i = 1, \cdots k$.
    \item [Type D] and $\cO$ is special and it has columns
          \[
            ( C_{2k+1},C_{2k},C_{2k-1},\cdots, C_{1},C_{0}, C_{-1}=0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ if } C_{2i} \text{ is
              even for } i=0, \cdots, k.
          \]
          Note that, the
          condition is equivalent to $\DD(\cO)$ is purely even of type C and
          $C_{2k+1}$ is always even.
    \item [Type B] and $\cO$ is special and it has columns
          \[
            ( C_{2k+1},C_{2k},C_{2k-1},\cdots, C_{1},C_{0} =0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ if } C_{2i} \text{ is
              odd for } i=0, \cdots, k.
          \]
          Note that, the condition is equivalent to $\DD(\cO)$ is purely even of type M and
          $C_{2k+1}$ is always odd.
  \end{des}
  Let $\dpeNil(\star)$ the set of duals of purely even
  orbits for type $\star=$ B,C,D,M respectively.

  % Under the above notation, $\cO$ is called \emph{\ess} if
  % $C_{2i}=C_{2i-1}$ for all $i$.
\end{defn}


\subsection{Descent of orbits in the purely even case}
  For $\set{\star,\star'} = \set{C,D}, \set{B,M}$, we define the notion of
  descent of orbits. The descent map is defined in the following way
  (under the above notation):

  \[
    %\begin{tikzpicture}
    %\matrix[matrix of math nodes, column sep=0em, row sep=0em]{
    \begin{tikzcd}
      \eDD \colon & \dpeNil(\star) \ar[rr] & \hspace{3em} &
      \dpeNil(\star') \\
      & \cO \ar[rr, maps to] & & \cO'
    \end{tikzcd}
    % };
    %\end{tikzpicture}
  \]
  such that
  \begin{itemize}
    \item when $\star$ is B or D, $\cO':= \DD(\cO)$;
    \item when $\star$ is C or M,
          \[
          \cO':= \begin{cases}
             & \text{if $C_{2k}$ is even and $\star=B$}\\[-0.8em]
            \DD(\cO) & \\[-0.8em]
             & \text{or $C_{2k}$ is odd and $\star=M$};\\
            ( C_{2k-1}+1, C_{2k-2},C_{2k-3},\cdots, C_{0} )  & \text{otherwise}.
          \end{cases}
          \]
          In the second case,  $C_{2k}=C_{{2k-1}}$ and
          $\cO \mapsto \eDD(\cO)$ is a good generalized descent.
  \end{itemize}


The following set of orbit are essential to us:
\begin{defn} \label{def:noticed}
  A nilpotent orbit $\cO\in \Nil(\bfG)$ is called \emph{\noticed} if $G$ is
  \begin{des}
    \item [Type D] and $\cO$ is special and it has columns
          \[
            ( C_{2k+1},C_{2k},C_{2k-1},\cdots, C_{1},C_{0}, C_{-1}=0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ for } i=0, \cdots, k.
          \]
          % Note that, the
          % condition is equivalent to $\DD(\cO)$ is \noticed of type C, i.e.
          %  $C_{2i}\equiv C_{2i-1} \pmod{2}$ and $C_{2i} = C_{2i-1}$ if $C_{2i}$
          %  is odd for $i = 1, \cdots k$.
    \item [Type B] and $\cO$ is special and it has columns
          \[
            ( C_{2k+1},C_{2k},C_{2k-1},\cdots, C_{1},C_{0} =0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ for } i=0, \cdots, k.
          \]
          % Note that, the
          % condition is equivalent to $\DD(\cO)$ is \noticed of type M, i.e.
          %  $C_{2i}\equiv C_{2i-1} \pmod{2}$ and $C_{2i} = C_{2i-1}$ if $C_{2i}$
          %  is even for $i=1, \cdots, k$.
    \item [Type C] and $\eDD(\cO)$ is noticed of type $D$.

          % $\cO$ is special and it has columns
          % \[
          %   [C_{2k},C_{2k-1},\cdots, C_{1},C_{0}, C_{-1}=0]
          %   \quad \text{such that } C_{2i+1}>C_{2i} \text{ for } i=0, \cdots, k-1.
          % \]
          %  Note that, by the
          % definition of special orbit,
          % we have $C_{2i}\equiv C_{2i-1} \pmod{2}$, $C_{2i} = C_{2i-1}$ if
          % $C_{2i}$ is odd for $i = 1, \cdots k$.
    \item [Type M] and $\eDD(\cO)$ is notice of type $B$.
          % $\cO$ is metaplecitic special and it has columns
          % \[
          %   [C_{2k},C_{2k-1},\cdots, C_{1},C_{0}=0]
          %   \quad \text{such that } C_{2i+1}>C_{2i} \text{ for } i=0, \cdots, k-1.
          % \]
          % Note that, by the
          % definition of metaplectic special,
          % we have $C_{2i}\equiv C_{2i-1} \pmod{2}$, $C_{2i} = C_{2i-1}$ if
          % $C_{2i}$ is even
          % for $i = 1, \cdots k$.
  \end{des}
  Furthermore, We say a noticed orbit $\cO$ of type $D$ or $B$ is
  \emph{+noticed}
  if $C_{2k+1}-C_{2k}\geq 2$.
  % Let $\nNil(\star)$ be the set of noticed %and $\eNil(\star)$ be the sets of \noticed and \ess
  % orbits for type $\star=$ B,C,D,M respectively.
\end{defn}

The following inductive definition of noticed orbit is easy to verify.
\begin{lem}
  An orbit $\cO$ of type D (resp. type B) is noticed if and only if
  \begin{enumI}
    \item $\eDD^{2}(\cO)$ is noticed, when
    $C_{2k}$ is even (resp. odd), or
    \item $\eDD^{2}(\cO)$ is +noticed, when $C_{2k}$ is odd (resp. even). \qedhere
  \end{enumI}
\end{lem}

\subsection{Relavent Weyl group representations and dot-r-c diagrams}
Retain the notation  in \Cref{def:noticed}.
Now we describe all relevent representations of the Weyl group appear in the
counting algorithm.


\trivial[h]{
  We use ``$s$'' and ``$d$'' to denote ``$r'$'' and ``$c'$'' in Dan's notes respectively.
}

\begin{des}
  \item[Type D] We define $c_{i}$ as the following
  \[
    \begin{split}
      c_{2i} & := \floor{\frac{C_{2i}}{2}} \quad \text{and}\quad c_{2i-1} =\floor{\frac{C_{2i-1}+1}{2}}
      \quad \forall i=0,1, \cdots, k,\\
      c_{2k+1} & := \frac{C_{2k+1}}{2}
    \end{split}
  \]
  The (special) Weyl group representation associated to the special orbit $\cO$
  has columns
  \[
    \tau = \tau_L\times\tau_R=(c_{2k+1},c_{2k-1},\dots , c_1)\times (c_{2k},\dots ,c_0).
  \]
  The other representations is obtained from the special one by interchanging
  following pairs when $c_{2i-1}\neq c_{2i}+1$ and $i=1, \cdots, k$ (these are
  pairs coming from even length columns)
  \[
    (c_{2i-1},c_{2i} )\longleftrightarrow (c_{2i}+1,c_{2i-1}-1).
  \]
  \trivial[h]{ Note that we always have $c_{2i-1}-1 \geq c_{2i-2}$ by our
    assumptions of the shape of the orbit. }

  The dot-r-c diagrams of type D: For each representation
  $\tau = \tau_L\times \tau_R$, dots are filled in both sides forming the same
  shape of Young diagram, a column of ``$s$'' is added next to dots on the left
  side diagram, a column of ``$r$'' is added next to dots on the left side
  diagram, add a row of ``$c$''s and finally add a row of ``$d$''s on the left
  side of the diagram; Through this procedure, one must make sure that the shape
  of the diagram is a valid Young diagram after each step. \trivial[h]{At most
    one $r$/$s$ is added in each row of the existing dots diagram and at most
    one $c$/$d$ is added to each column.}

  In summary, $s/r/c/d$ are all added on the left diagram.
  Fixing the representation $\tau$, the left diagram $\uptau_{L}$ determin
  $\uptau_{R}$ completely.

  \item[Type C] Set $C_{2k+1}=0$. The Weyl group representations are obtained by
  the same formula of Type D.

  The dot-r-c diagrams of type C are obtained in almost the same way as that of
  type D, except that $s$ are added on the right side of the diagram.

  \item[Type B] We define $c_{i}$ as the following
  \[
    \begin{split}
      c_{2i} & := \floor{\frac{C_{2i}+1}{2}} \quad \text{and}\quad c_{2i-1} =\floor{\frac{C_{2i-1}}{2}}
      \quad \forall i=1,2, \cdots, k,\\
      c_{2k+1} & := \frac{C_{2k+1}-1}{2}
    \end{split}
  \]
 % \trivial[h]{Note that $C_{2k+1}$ is always odd and $C_{0}=0$}
  Note that $C_{2k+1}$ is always odd and $C_{0}=0$.
  The (special)
  Weyl group representation associated to the special orbit $\cO$ has columns
  \[
    \tau = \tau_L\times\tau_R= (c_{2k},\dots ,c_2) \times (c_{2k+1},c_{2k-1},\dots , c_1).
  \]
  The other representations is obtained from the special one by interchanging
  following pairs when $c_{2i-1}\neq c_{2i}+1$ and $i=1, \cdots, k$ (these are
  pairs coming from odd length columns)
  \[
    (c_{2i}, c_{2i-1})\longleftrightarrow (c_{2i-1}, c_{2i}).
  \]
  \trivial[h]{ Note that we always have $c_{2i-1} \geq c_{2i-2}$ by our
    assumptions of the shape of the orbit. }

  The dot-r-c diagrams of type B: For each representation
  $\tau = \tau_L\times \tau_R$, dots are filled in both sides forming the same
  shape of Young diagram, a column of ``$s$'' is added next to dots on the right
  side of the diagram, a column of ``$r$'' is added next to dots on the right
  side diagram, add a row of ``$d$''s on the right side of the diagram, and
  finally add a row of ``$c$''s on the left side of the diagram. Through this
  procedure, one must make sure that the shape of the diagram is a valid Young
  diagram after each step. \trivial[h]{At most one $r$/$s$ is added in each row
    of the existing dots diagram and at most one $c$/$d$ is added to each
    column.}

  In summary, $s/r/d$ are added on the right and $c$ is added on the left.

  Each dot-r-c diagram of type B is extended into two diagrams by adding an
  extra label ``$a$'' or ``$b$''. This extension helps us to determine the
  signature of special orthogonal groups.


  Fixing the representation $\tau$, the right diagram $\uptau_{R}$ determin
  $\uptau_{L}$ completely.

  \item[Type M] Set $C_{2k+1}=0$. The Weyl group representations are obtained by
  the same formula of Type B.

  The dot-r-c diagrams of type M are obtained in almost the same way as the type
  B except that $s$ are added on the left side of the diagram and we do not add
  labels a/b.
\end{des}

We let $\drc(\cO)$ denote the set of dot-r-c diagrams defined above.
Note that for type B, there is an additional mark $a$/$b$ attached to the
diagram.



In addition, for $\star=B,C,D,M$, let
\[
  \drc(\star) := \bigsqcup_{\cO\in \dpeNil(\star)} \drc(\cO).
\]


% By the counting argument established before, it is suffice to establish \Cref{thm:count} for
% \ess orbits.

\subsection{Main theorem}
Let $\LS(\cO)$ denote the Grothendieck group of $\wtbfK$-equivariant local
systems on $\cO$ for various real forms of $\bfG$.
The following is our main theorem on the counting of unipotent representations.

Let $\ckcO$ be a purely even orbit and $\cO$ be its dual orbit.

\begin{thm} \label{thm:count}
  We can define an injective map using convergence range theta lifting:
  \[
    \begin{tikzcd}[column sep=0em, row sep=0em]
      \uppi:& \drc(\cO) \ar[rr] &\hspace{2em} & \Unip(\cO)\\
      & \uptau \ar[rr,maps to] & & \uppi_{\uptau}\\
    \end{tikzcd}
  \]
\begin{enumS}
  \item
  When $\cO$ is of type C or type M, $\uppi$ is a bijection.
  %we have a bijective map
  % \[
  %   \begin{tikzcd}[column sep=0em, row sep=0em]
  %     \uppi:& \drc(\cO) \ar[rr] &\hspace{2em} & \Unip(\cO)\\
  %     & \uptau \ar[rr,maps to] & & \uppi_{\uptau}\\
  %   \end{tikzcd}
  % \]
%  \item
  \item
  When $\cO$ is of type D or type B, the following map is a bijection
  %Suppose $\cO$ is of type D or type B. we have a bijective map
  \[
    \begin{tikzcd}[column sep=0em, row sep=0em]
       \drc(\cO) \times \bZ/2\bZ \ar[rr] &\hspace{2em} & \Unip(\cO)\\
       (\uptau, \varepsilon) \ar[rr,maps to] & & \uppi_{\uptau}\otimes (\det)^{\varepsilon}\\
    \end{tikzcd}
  \]

\item
  All unipotent representations attached to $\cO$ are unitarizable.
\item
  Suppose $\cO$ is noticed. The associated character map is an injective map:
  \[
    \begin{tikzcd}[column sep=0em, row sep=0em]
      \Ch_{\cO}\colon& \Unip(\cO)  \ar[rr,hook] &\hspace{2em} & \LS(\cO)\\
  %    & \uppi \ar[rr,maps to] & & \cL_{\uppi}\\
    \end{tikzcd}
  \]
%\end{thm}
\item
Suppose $\cO$ is quasi-distinguished. The image of associated character map is
  exactly the set of admissible orbit data. In other words, we have a bijection
  \[
    \begin{tikzcd}[column sep=0em, row sep=0em]
      \Ch_{\cO}\colon& \Unip(\cO)  \ar[rr,hook,two heads] &\hspace{2em} & \LSaod(\cO)\\
  %    & \uppi \ar[rr,maps to] & & \cL_{\uppi}\\
    \end{tikzcd}
    %\Ch_{\cO}\colon \Unip(\cO)\longrightarrow \LS^{aod}(\cO).
  \]
\end{enumS}
\end{thm}

% \begin{thm} \label{cor:count}
%   When $\cO$ is dual purely even,
%   \[
%     \Unip(\cO) = \set{\Thetab_{\chi}\neq 0},
%   \]
%   i.e.  all unipotent representations attached to $\cO$ can be
%   constructed by iterated convergent range theta lifting and therefore unitary.

%   Suppose $\cO$ is noticed. Then the map
%   \[
%     \begin{tikzcd}
%       \Ch\colon \Unip(\cO) \ar[r] & \LS(\cO)
%     \end{tikzcd}
%   \]
%   is injective.
%   %% Moreover, every element in $\Unip(\cO)$ can be obtained by iterated theta lifting.
% \end{thm}

{\color{red} According to Moeglin-Renard's work, Arthur's unipotent Arthur packet
  (defined by endoscopic transfer) is constructed by iterated theta lifting.
  The theorem implies that ABV's unipotent Arthur packet coincide with Arthur's.}


Two unipotent representation $\pi_{1}$ and $\pi_{2}$ are called in the same
LS packet if $\cL_{\pi_{1}} = \cL_{\pi_{2}}$.
For a local system $\cL\in \LS(\cO)$, let
\[
  [\cL] = \set{\pi |\Ch_{\cO}(\pi) = \cL}
\]
denote the set of all unipotent representations attached to $\cL$. We call
$[\cL]$ a  LS packet.

\begin{remark}
  \begin{enumR}
    \item
    % The proof is by establish an explicit injection
    % $\drc(\cO)\longrightarrow \set{\Thetab_{\chi}\neq 0}$ inductively.
    We use convergence range theta lift to construct $\uppi$ inductively with
    respect to the number of columns in $\cO$.
    \item
    When $\cO$ is not noticed, a LS packet may not be a singleton
    and we use the injectivity of theta lifting for a fixed dual pair in an essential way.
    \item
    The size of LS packet $[\cL]$ could be arbitrary large  when the size of $\cO$
    groups.
    For example, $\cO$ is the regular orbit of $\Sp(2n,\bC)$, there is only 5 possible
    local systems when $n\geq 3$. But there are $2n+1$ unipotent
    representations. %See \Cref{sec:C.reg}.
    \item One will see easily from the proof that the associated character
    $\Ch_{\cO}(\pi)$ for every $\pi\in \Unip(\cO)$ is always multiplicity free.
    Even when $\Ch_{\cO}(\pi)$ is not irreducible, the character of the local
    system attached the same row length in different irreducible components are
    always the same.
  \end{enumR}
\end{remark}

\section{Matching doc-r-c diagrams, local systems, and unipotent representations}



\subsection{Descent maps of dot-r-c diagram in the algorithm}

Suppose $\bfG$ is of type B or D, we define a map
\[
  \begin{tikzcd}[column sep=0em, row sep=0em]
    \Sign \colon&   \drc(B)\sqcup \drc(D) \ar[rr]& \hspace{3em} & \bN\times \bN \\
    & \uptau \ar[rr, maps to]& & (p,q)
  \end{tikzcd}
\]
Here $(p,q)$ is the signature of the orthogonal group $\rO(p,q)$ corresponding
to the dot-r-c diagram $\uptau$, which is calculated by the following formula
\[
  \begin{split}
    p &= \# \bullet+ 2 \# r + \# c + \# d + \# A\\
    q &= \# \bullet+ 2 \# s + \# c + \# d + \# B\\
  \end{split}
\]



Suppose $\cO$ is the trivial orbit of $\Sp(2c_{0},\bR)$ ($c_{0}\geq 0$) or
$\Mp(0,\bR)$ ($c_{0}=0$).
Let
\begin{equation}\label{eq:uptau0}
  \uptau_{\cO}=\ytb{\emptyset,\none,\none}\times\ytb{s,\vdots,s}
\end{equation}
such that there are $c_{0}$-entries marked by ``$s$'' in the right diagram.
Then $\drc(\cO) = \set{\uptau_{\cO}}$ is a singleton.
Define
$\uppi_{\uptau_{\cO}} = \bfone$ the trivial representation of $\Sp(2c_{0},\bR)$ or $\Mp(0,\bR) = \bfone$.
That by convention, $\Sp(0,\bR)=\Mp(0,\bR)$ is the trivial group.
Let
\[
  \drc_{0}(C) = \set{\uptau_{\cO}| \cO = (2c_{0}), c_{0}=0,1,2,\cdots}
  \text{ and }
  \drc_{0}(M) = \set{\uptau_{(0)}=\emptyset \times \emptyset}.
\]


The algorithm of matching dot-r-c diagrams is encoded in the descent map
 $\eDD$ of dot-r-c diagrams defined below.
%For $\set{\star,\star'} = \set{C,D}, \set{B,M}$,
For $(\star,\star') = (D,C), (B,M)$,
we define maps
\[
  \begin{tikzcd}[column sep=0em, row sep=0em]
    \eDD \colon & \drc(\star)\sqcup (\drc(\star')-\drc_{0}(\star')) \ar[rr] & \hspace{2em} &
    \left(\drc(\star')\sqcup \drc(\star) \right)\times \bZ/2\bZ\\
    & \uptau \ar[rr, maps to] &  & (\uptau', \upepsilon).
  \end{tikzcd}
\]
Here
\begin{enumI}
  \item $\uptau$ is in $\drc(\cO)$ where $\cO\in \dpeNil(\star)\sqcup \dpeNil(\star')$;
  \item $\uptau'\in \drc(\cO')$ where $\cO': = \eDD(\cO)$;
  \item i$\upepsilon = 0$ when $\cO\mapsto \cO'$ is a generalized descent from type
  C or M to type B or D.
\end{enumI}
To ease the notations, we define
\[
    \eDDo \colon  \drc(\star)\sqcup (\drc(\star')-\drc_{0}(\star')) \longrightarrow
    \left(\drc(\star')\sqcup \drc(\star) \right)
\]
such that $\eDDo(\uptau)$ is the first component of $\eDD(\uptau)$.

\medskip

We define $\cL$ and $\uppi$ inductively with respect to the number of
columns of $\cO$.
\begin{enumS}
  \item % Suppose $\cO=[C_{0}=0]$ and $\star =  C$ or  $M$. Then
  % $\drc(\cO) = \set{\uptau_{\emptyset}}$ is a singleton with $\uptau_{\emptyset}=(\emptyset,\emptyset)$.
  Our reduction terminates when $\cO$ is the trivial orbit of $\Sp(2c_{0},\bR)$ or
  $\Mp(0,\bR)$.
  In this case,
  $\drc(\cO) = \set{\uptau_{\cO}}$ which is attached to the trivial
  representation.
  We remark that the theta lift of the trivial representation
  $\uppi_{\uptau_{\cO}}=\bfone$ of $\Sp(0,\bR)$ or $\Mp(0,\bR)$ to $\rO(p,q)$ for
  any signature $p,q$ is the trivial representation $\bfone_{p,q}^{+,+}$ of
  $\rO(p,q)$.\footnote{When $c_{0}=0$, this is an assignment by convention.}
  \item Suppose $\cO\in \Nil(\star)\sqcup \Nil(\star')$ is a nontrivial orbit.
  Let $\uptau \in \drc(\cO)$ and
  \[
    (\uptau', \upepsilon) = \eDD(\tau)\in \drc(\cO')\times \bZ/2\bZ \text{ where }\cO' = \eDD(\cO).
  \]
  \begin{enumS}
    \item Suppose $\uptau\in \drc(C)$ or $\drc(M)$. Now $\wtG = \Sp(2n,\bR)$ or
    $\Mp(2n,\bR)$ with $n=\abs{\uptau}$. By induction, $\uptau'$ is attached to
    a unipotent representation $\uppi_{\uptau'}$ of $\wtG' = \rO(p,q)$ where
    $(p,q)=\Sign(\uptau')$. We define
    \[
      \uppi_{\uptau} := \Thetab_{\wtG',\wtG}(\uppi_{\uptau'}\otimes (\det)^{\upepsilon}).
    \]
    Here $\det$ is the determinant character of $\rO(p,q)$.
    \item Suppose $\uptau\in \drc(D)$ or $\drc(B)$. Now $\wtG = \rO(p,q)$ with
    $(p,q) = \Sign(\uptau)$. By induction, $\uptau'$ is attached to a
    unipotent representation of $\wtG'$ where $\wtG' = \Sp(2n,\bR)$ or
    $\Mp(2n,\bR)$ and $n=\abs{\uptau'}$. We define
    \[
      \uppi_{\uptau} := \Thetab_{\wtG',\wtG}(\uppi_{\uptau'})\otimes (\bfone_{p,q}^{+,-})^{\upepsilon}.
    \]
  \end{enumS}
\end{enumS}

We let
\[
  \begin{split}
    \sL_{\uptau} & := \Ch_{\cO}(\uppi_{\uptau}), \text{ and } \\
    % \lUnip(\cO) &= \set{\uppi_{\uptau}|\uptau \in \drc(\cO)} \\
    \LLS(\cO) & := \set{\cL_{\uptau}|\uptau \in \drc(\cO)}
  \end{split}
\]
to be the set of local systems obtained from our algorithm.

We summarize our definitions in the following diagram with $\star=\cO/C/D/B/M$.
% \[
%   \begin{tikzcd}[column sep=0em, row sep=0em]
%  &   \edrc(\star) \ar[rrrr,"\uppi"] \ar[dddd, "\cL"']  & & & & \Unip(\star) \ar[dddd, "\Ch"] \\
%  &   &  \uptau \ar[rr,maps to] \ar[dd,maps to]& \hspace{4em} & \pi_{\uptau}  \ar[lldd,maps to]&  \\[2em]
% \edrc(\star') \times \bZ/2\bZ \ar[ruu,leftarrow,"\eDD"] \ar[ddd,"\cL\times \id"']&   & & &   & \\[2em]
%  &   &\cL_{\uptau} & &   & \\
%  &  \LLS(\star)\ar[rrrr,hook]\ar[ld,"\eDD"] & & & & \LS(\star) \\[3.5em]
%  \LLS(\star')\times \bZ/2\bZ \ar[rrrr,hook]&   & & &\LS(\star')\ar[ru,dashed,"\vartheta"']  & \\
% \end{tikzcd}
% \]
% \[
%   \begin{tikzcd}[column sep=0em, row sep=0em]
%     \drc(\star) \ar[rrrr,"\uppi"] \ar[dddd, "\cL"']  & & & & \Unip(\star) \ar[dddd, "\Ch"] \\
%     &  \uptau \ar[rr,maps to] \ar[dd,maps to]& \hspace{4em} & \pi_{\uptau}  \ar[lldd,maps to]&  \\[2em]
%     &   & & &   & \\[2em]
%     &\cL_{\uptau} & &   & \\
%    \LLS(\star)\ar[rrrr,hook] & & & & \LS(\star) \\
% \end{tikzcd}
% \]
% Here
% \begin{enumC}
%   \item $\uptau$ is in $\drc(\cO)$ where $\cO$ is essential;
%   \item $\uppi_{\uptau}$ is a unipotent representation of $\wtG$ attached to $\cO$;
%   \item $\wtG$ is $\Mp(2n,\bR)$ or $\Sp(2n,\bR)$ if $\star = $ $C$ or $M$;
%   \item $\wtG$ is $\rO(p,q)$ if $\star=$  $B$ or $C$ and $(p,q)=\Sign(\uptau)$;
%   \item
%   % \item For each local system $\cL\in \LLS(\star)$, the descent map $\cL$
%   % \item the left commutative diagram says the descent map $\eDD$ is compatible
%   % with the local system, i.e. it sends
% \end{enumC}

% Let
% \[ \color{red}
% \]
%

\[
  \begin{tikzcd}[column sep=0em, row sep=0em]
    \drc(\star) \ar[rrrr,"\uppi"] \ar[dddd, "\cL"']  & & & & \Unip(\star) \ar[dddd, "\Ch"] \\
    &  \uptau \ar[rr,maps to] \ar[dd,maps to]& \hspace{4em} & \pi_{\uptau}  \ar[dd,maps to]&  \\[2em]
    &   & & &   & \\[2em]
    &\cL_{\uptau} \ar[rr,<->]& &  \sL_{\uptau} & \\
   \KM(\star)\ar[rrrr,hook,two heads] & & & & \LS(\star) \\
\end{tikzcd}
\]

Here $\KM(\star)$ is a combinatiorially defined monoid parameterizing the local
systems on the relevent nilpotent orbits, see.

\section{The definition of $\eDD$ }
\def\taur{\uptau_{R}}
\def\taul{\uptau_{L}}
\def\taulf{\uptau_{L,0}}
\def\tauls{\uptau_{L,1}}
\def\taurf{\uptau_{R,0}}
\def\taurs{\uptau_{R,1}}

\def\tauplf{\uptau'_{L,0}}
\def\taupls{\uptau'_{L,1}}
\def\tauprf{\uptau'_{R,0}}
\def\tauprs{\uptau'_{R,1}}
\def\tail{\mathrm{tail}}




From now on, we assume
\[
  \uptau = (\taulf,\tauls,\cdots)\times(\taurf,\taurs,\cdots).
\]

% The definition of sign $\upepsilon$
% \begin{enumS}
%   \item Suppose $\uptau$ is type D or B, $\upepsilon=0$ if and only if
%   $\# d (\uptau)> \#d(\uptau')$. This means:
%   \begin{enumS}
%     \item When $\uptau$ is type D,  $\tail(\taulf) = d$.
%     \item When $\uptau$ is type B,   $\tail(\taurf) = d$ or
%     $(\tail(\taulf),\tail(\taurf),\tail(\taurs)) = (c,r,d)$.
%   \end{enumS}
%   \item Suppose $\uptau$ is type C or M, $\upepsilon=0$ if and only if
%   $\abs{\taulf}\geq \abs{\taurf}$.
% \end{enumS}

For any $\uptau$ let $\uptau^{\bullet}$ be the subdiagram consisting of
$\bullet$ and $s$ entries only.


\subsection{dot-s switching algorithm}
\def\bipartl{\mathrm{bi\cP_L}}
\def\bipartr{\mathrm{bi\cP_R}}
\def\dsdiagl{\mathrm{DS_L}}
\def\dsdiagr{\mathrm{DS_R}}
\def\DDl{\eDD_\mathrm{L}}
\def\DDr{\eDD_\mathrm{R}}

We say a bipartition
$\tau = \tau_{L}\times \tau_{R}$
is interlaced with lager left part if  $\tau$ has columns
$(\tau_{L,0}\geq \tau_{L,1}, \cdots, )\times (\tau_{R,0},\tau_{R,1}, \cdots,)$
such that
\[
\tau_{L,0}\geq \tau_{R,0}\geq \tau_{L,1}\geq \tau_{R,1}\geq \tau_{L,2} \geq \cdots.
\]
$\bipartl$ denote the set of all interlaced bipartitions with larger left parts.
Similarly, define $\bipartr$ be the set of bipartitoins with larger right parts:
\[
  \bipartr = \set{\tau=(\tau_{L,0}\geq \tau_{L,1}, \cdots, )\times (\tau_{R,0},\tau_{R,1}, \cdots,)|
\tau_{L,0}\geq \tau_{R,0}\geq \tau_{L,1}\geq \tau_{R,1}\geq \tau_{L,2} \geq \cdots}
\]

Let $\dsdiagl$ (resp. $\dsdiagr$) be the set of of filled diagrams with only
``$s$'' entries on the left (resp. right) diagram and the rest are all ``$\bullet$''.

Note that for each $\uptau\in \dsdiagl$, its shape $\tau$ is in $\bipartl$.
On the other hand, for each $\tau\in \bipartl$, we can fill ``$\bullet$'' in
all entries on the right diagram and corresponding entries on the left, and than fill ``$s$''
in the rest entries on the left. This procedure yields a valid dot-s diagram.
In summary, $\bipartl$ and $\dsdiagl$ are naturally bijective to each other.

Let $\DDl\colon \bipartl\rightarrow \bipartr $ (resp.
$\DDr\colon \bipartr\rightarrow \bipartl$) be the operation
of deleting the longest column on the left (resp. on the right).
Then the operation gives a well defined maps between $\dsdiagl$ and $\dsdiagr$ making
the following diagrams commute (the vertical maps are the natural identification
discussed above):
\[
\begin{tikzcd}
  \bipartl \ar[r,"\DDl"] \ar[d,equal]& \bipartr \ar[d,equal] &
  \bipartr \ar[r,"\DDr"] \ar[d,equal]& \bipartl \ar[d,equal] \\
  \dsdiagl\ar[r,dashed,"\DDl"] & \dsdiagr & \dsdiagr\ar[r,dashed,"\DDr"] & \dsdiagl\\
\end{tikzcd}
\]
By abuse of notation, we also call the dashed arrow above $\DDl$ and $\DDr$.


\subsection{Definition of $\eDD$ of Type D and C} \label{sec:alg.CD}

\subsubsection{Bijection between ``special'' and ``non-special'' diagrams for type C}
We define a bijection between ``special'' diagram $\uptau^{s}$ and
``non-special'' diagrams $\uptau$.

\begin{defn}\label{def:sp-nsp.C.sp}
  Let $\cO = (C_{2k},C_{2k-1}, \cdots, C_{1},C_{0}, C_{-1}=0)\in \dpeNil(C)$
  with $k\geq 0$.
  Let
  \[
  \tau = (\tau_{2k-1}, \cdots, \tau_{1},\tau_{-1}=0) \times (\tau_{2k}, \cdots, \tau_{0}).
  \]
  be a Weyl group representation attached to $\cO\in \dpeNil(C)$.
  We say $\tau$ has
  \begin{itemize}
    \item \idxemph{special shape} if $\tau_{2k-1}\leq \tau_{2k}+1$;
    \item \idxemph{non-special shape} if $\tau_{2k-1}> \tau_{2k}+1$.
  \end{itemize}
  Clearly, this gives a partition of the set of Weyl group representations
  attached to $\cO$.

  Suppose $k\geq 1$, $C_{2k}=2c_{2k}$ and $C_{2k-1}=2c_{2k-1}$.
  The special shape representation $\tau^{s}$
  \[
    \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}=(c_{2k-1},\tau_{2k-3},\cdots, \tau_{1} )
    \times (c_{2k},\tau_{2k-2},\cdots, \tau_{0})
  \]
  is paired with the non-special shape representation
  \[
    \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} = (c_{2k}+1,\tau_{2k-3},\cdots, \tau_{1} )
    \times (c_{2k-1}-1,\tau_{2k-2},\cdots, \tau_{0})
  \]
  In the paring $\tau^{s}\leftrightarrow \tau^{ns}$, $\tau_{j}$  is unchanged for $j\leq 2k-2$.
  We call $\tau^{s}$ the \emph{special shape} and $\tau^{ns}$ the
  corresponding \emph{non-special shape}
\end{defn}



\begin{defn}\label{def:sp-nsp.C}
  Suppose $C_{2k}$ is even.
We retain the notation in \Cref{def:sp-nsp.C.sp} where the shapes $\tau^{s}$ and $\tau^{ns}$
correspond with each other.
We define a bijection between $\drc(\tau^{s})$ and $\drc(\tau^{ns})$:
\[
  \begin{tikzcd}[row sep=0em]
    \drc(\tau^{s}) \ar[rr,<->]&\hspace{2em} & \drc(\tau^{ns})\\
    \uptau^{s} \ar[rr,<->]& & \uptau^{ns}
  \end{tikzcd}
\]

Without loss of generality, we can assume
that $\uptau^{s}\in \drc(\tau^{s})$ and $\uptau^{ns}\in \drc(\tau^{ns})$ have the following shapes:
\begin{equation}\label{eq:sp-nsp.C}
  \uptau^{s}:\tytb{\cdots\cdots\cdots,{x_{0}}{\ast}{\cdots},{x_{1}}{x_{2}}{\cdots},\ ,\ ,\ ,\ }
  \times\tytb{\cdots\cdots\cdots,{v_{0}}{\cdots},{x_{3}},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ } \longleftrightarrow \hspace{2em}
  \uptau^{ns}:\tytb{\cdots\cdots\cdots,{y_{0}}{\ast}{\cdots},{*(srcol)r}{y_{2}}\cdots,
    {*(srcol)\vdots},{*(srcol)r},{y_{1}},{y_{3}} }
  \times\tytb{\cdots\cdots\cdots,{w_{0}}{\cdots},\ ,\ ,\ ,\ ,\ }
\end{equation}
(Here the grey parts have length $(C_{2k}-C_{2k-1})/2$ (could be zero length), the row contains
$x_{0}$ and $y_{0}$ may be empty, and $*$/$\cdots$ are
arbitrary entries. We remark that the value of $v_{0}$ and $w_{0}$ are
completely determined by $x_{0}$ and $y_{0}$. In particular, $v_{0}$ and $w_{0}$
are non-empty if and only if
$x_{0}/y_{0}\neq \emptyset$, i.e. $C_{2k-1}\geq 4$.)

% We marks the entries of $\uptau^{s}$ and $\uptau^{ns}$ as in
% \eqref{eq:sp-nsp.C}.
The correspondence between $(x_{0},x_{1}, x_{2}, x_3)$, with
$(y_{0},y_{1},y_{2},y_{3})$ is given by \Cref{tab:nonsp.C}.
The rest part of the diagrams are unchanged.

We define
\[
  \drcs(\cO) := \bigsqcup_{\tau^{s}} \drc(\tau^{s}) \quad \text{ and }\quad
  \drcns(\cO) := \bigsqcup_{\tau^{ns}} \drc(\tau^{ns})
\]
where $\tau^{s}$ (resp. $\tau^{ns}$) runs over all specail (resp. non-special) shape representations attached to $\cO$.
Clearly $\drc(\cO) = \drcs(\cO)\sqcup \drcns(\cO)$.
\end{defn}
It is easy to check the bijectivity in the above definition, which we leave it
to the reader.



\subsubsection{Special and non-special shapes of type D}
Now we define the notion of special and non-special shape of type D.
\begin{defn}\label{def:sp-nsp.D.sp}
  Let
  \[
  \tau = (\tau_{2k+1},\tau_{2k-1}, \cdots, \tau_{1})\times (\tau_{2k}, \cdots, \tau_{0})
  \]
  be a Weyl group representation attached to $\cO\in \dpeNil(D)$.
  We say $\tau$ has
  \begin{itemize}
    \item \idxemph{special shape} if $\tau_{2k-1}\leq \tau_{2k}+1$;
    \item \idxemph{non-special shape} if $\tau_{2k-1}> \tau_{2k}+1$.
  \end{itemize}

  Suppose
  $\cO=(C_{2k+1}=2c_{2k+1},C_{2k}=2c_{2k},C_{2k-1}=2c_{2k-1},\cdots,C_{0}\geq 0)$
  with $k\geq 1$.\footnote{Note that $C_{2k}$ and $C_{2k-1}$ are non-zero
    even integers.}
  A representation $\tau^{s}$ attached to $\cO$ has the shape
  \[
    \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}=(c_{2k+1},c_{2k-1},\tau_{2k-3},\cdots, \tau_{1} )
    \times (c_{2k},\tau_{2k-2},\cdots, \tau_{0})
  \]
  is paired with
  \[
    \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} = (c_{2k+1},c_{2k}+1,\tau_{2k-3},\cdots, \tau_{1} )
    \times (c_{2k-1}-1,\tau_{2k-2},\cdots, \tau_{0}).
  \]
  In the paring $\tau^{s}\leftrightarrow \tau^{ns}$, $\tau_{j}$  is unchanged for $j\leq 2k-2$.
  % We call $\tau^{s}$ the \emph{special shape} and $\tau^{ns}$ the
  % corresponding \emph{non-special shape}
\end{defn}

\begin{table}[hpb]
\[\tiny
\begin{array}{c|c|c:c|c}
  & \uptaup & \uptau^{s} & \uptau^{ns} \\
  \hline
           & \ytb{{x'_{0}}{\ast},{x'_{1}}{x'_{2}},\none,\none,\none,\none}
             \times \ytb{\ast,\none,\none,\none,\none,\none}
           &\ytb{{x_{0}}{\ast},{x_{1}}{x_{2}},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}{\ast},{x_{3}},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{y_{0}}{\ast},{*(srcol)r}{y_{2}},{*(srcol)\vdots},{*(srcol)r},{y_{1}},{y_{3}} }
    \times\ytb{{\ast}\ast,\ ,\ ,\ ,\ ,\ }\\
  \hline
  \ytb{{x'_{1}}{=}{s},{\text{then}},{z_{0}}{=}{\emptyset/}{s},{x_{0}}{=}{\emptyset/}{\bullet},{x_{1}}{=}{\bullet},
  {x_{2}}{=}{x'_{2}}}
  &
            \ytb{{x'_{0}}{\ast},{s}{x_{2}},\none,\none,\none,\none}
             \times \ytb{\ast,\none,\none,\none,\none,\none}
                &
                \ytb{{x_{0}}{\ast},{\bullet}{x_{2}},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}\ast,{\bullet},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{x_{0}}{\ast},{*(srcol)r}{x_{2}},{*(srcol)\vdots},{*(srcol)r},{c},{d} }
                          \times\ytb{{\ast}{\ast},\ ,\ ,\ ,\ ,\ }
          &x_{2}\neq r
  \\
  \cline{3-5} & &
                  \ytb{{x_{0}}{\ast},{\bullet}{r},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}\ast,{\bullet},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{x_{0}}{\ast},{*(srcol)r}{c},{*(srcol)\vdots},{*(srcol)r},{r},{d} }
    \times\ytb{{\ast}\ast,\ ,\ ,\ ,\ ,\ } & x_{2}=r \\
  \hline
\ytb{{x'_{1}}{\neq}{s},{\text{then}},{x_{1}}{=}{x'_{1}},{x_{2}}{=}{x'_{2}}}
  &
            \ytb{{x'_{0}}{\ast},{x'_{1}}{x_{2}},\none,\none,\none,\none}
             \times \ytb{\ast,\none,\none,\none,\none,\none}
   &
    \ytb{{x_{0}}{\ast},{x_{1}}{x_{2}},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}\ast,{s},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{x_{0}}{\ast},{*(srcol)r}{x_{2}},{*(srcol)\vdots},{*(srcol)r},{r},{x_{1}} }
       \times\ytb{{\ast}\ast,\ ,\ ,\ ,\ ,\ } &
     \ytb{{x'_{0}}{\neq}{c},{\text{then}},{x'_{0}}{=}{\emptyset/}{s/}{r},{x_{0}}{=}{\emptyset/}{\bullet/}{r}}
  \\
  %\hline
  \cline{3-5}
   & &
    \ytb{{c}{\ast},{d}{x_{2}},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}\ast,{s},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{r}{\ast},{*(srcol)r}{x_{2}},{*(srcol)\vdots},{*(srcol)r},{c},{d} }
  \times\ytb{{\ast}\ast,\ ,\ ,\ ,\ ,\ }&
  \ytb{{x'_{0}}{=}{c}\none\none,{\text{then}},{x_{0}}{=}{x'_{0}}{=}{c},{x_{1}}{=}{x'_{1}}{=}{d},{x_{2}}{=}{x'_{2}}{=}{\emptyset/d}}
  \\
  \hline
  \hline
\end{array}
\]
\caption{``special-non-special'' switch}
\label{tab:nonsp.C}
\end{table}


\subsubsection{Convention}
The induction starts with type C: For the trivial orbit $\cO$ of
$\wtG = \Sp(2c_{0},\bR)$, $\drc(\cO) = \set{\uptau_{\cO}}$ and
$\uppi_{\uptau_{\cO}}=\bfone$ is the trivial representation, see \eqref{eq:uptau0}.

\subsubsection{The defintion of $\upepsilon$.} \label{sec:upepsilon}
\begin{enumerate}[label=(\arabic*).,series=alg1]
  \item When $\uptau\in \drc(D)$, $\upepsilon$ is determined by the ``basal
  disk'' of $\uptau$ (see \eqref{eq:x.uptau} for the definition of $x_{\uptau}$):%escent from type D to type C,
  \[
    \upepsilon_{\uptau}:=
    \begin{cases}
      0, & \text{if $x_{\uptau}=d$;} \\
      1, & \text{otherwise.}
    \end{cases}
  \]
  \item When $\uptau\in \drc(C)$, the  $\upepsilon$  is determined by
  the lengths of $\taulf$ and $\taurf$:
  \[
    \upepsilon_{\uptau} :=
    \begin{cases}
      0, & \text{if $\uptau$ has special shape, i.e. } \abs{\taulf}-\abs{\taurf} \leq  1;\\
      1, & \text{if $\uptau$ has non-special shape, i.e. }\abs{\taulf} - \abs{\taurf}> 1.
    \end{cases}
  \]
\end{enumerate}
%To indicate the relation with $\uptau$, we will also w

\medskip

%{\bf Definition of the descent of diagram $\uptaup$.}

\subsubsection{Initial cases}
%For type D, %when $\cO$ must have odd number of column.
Let $\cO$ be a nilpotent orbit of type D with at most 2 columns.
\begin{enumerate}[resume*=alg1]
  \item Suppose $\cO = (2c_{1},2c_{0})$.
        Then
        $\cOp:=\eDD(\cO)$ is the trivial orbit of $\Sp(2c_{0},\bR)$. $\drc(\cO)$
        consists of diagrams of shape
        $\tau_{L}\times \tau_{R} =(c_{1},)\times (c_{0},)$.
        The set $\drc(\cOp)$ is a singleton $\set{\uptau_{\cOp}}$, and every element
        $\uptau \in \drc(\cO)$ maps to $\uptau_{\cOp}$ (see \eqref{eq:uptau0}):
        \[\tiny
          \drc(\cO)\ni \uptau: \hspace{1em} \ytb{\bullet,\vdots,\bullet,{x_{1}},\vdots,{x_{n}}}
          \times \ytb{\bullet,\vdots,\bullet,\none,\none,\none}
          \mapsto \uptau_{\cOp}:
          \ytb{\emptyset,\none,\none,\none,\none,\none}
          \times \ytb{s,\vdots,s,\none,\none,\none}
        \]
        We define
        \[
          \bfpp_{\uptau}:=\bfxx_{\uptau} := \tytb{{x_{1}},\vdots,{x_{n}}} \text{ and }x_{\uptau}:=x_{n}
        \]
        We call $\bfpp_{\uptau}=\bfxx_{\uptau}$ the ``peduncle'' part of $\uptau$ and
        $x_{\uptau}$ the
        ``basal disk'' of $\uptau$.
        Note that $\bfxx_{\uptau}$ consists of entries marked by $s/r/c/d$.
\end{enumerate}


\subsubsection{The descent from C to D}
The descent of a special shape diagram is simple, the descent of a non-special shape
reduces to the corresponding special one:
\begin{enumerate}[resume*=alg1]
  \item Suppose $\abs{\taulf} - \abs{\taurf} < 2$, i.e. $\uptau$ has special
        shape. Keep $r,c,d$ unchanged, delete $\taurf$ and fill the remaining
        part with ``$\bullet$'' and ``$s$'' by $\DDr(\uptau^{\bullet})$ using
        the dot-s switching algorithm.
  \item Suppose $\abs{\taulf} - \abs{\taurf} \geq 2$. We define
        \[\uptaup=\eDDo(\uptau):=\eDDo(\uptau^{s})\] where $\uptau^{s}$ is the
        special diagram corresponding to $\uptau$ defined in
        \Cref{def:sp-nsp.C}.
\end{enumerate}

\begin{lem}\label{lem:ds.CD}
  Suppose $\cO = (C_{2k},C_{2k-1}, \cdots, C_{0})$ with $k\geq 1$ and $C_{2k}$ even.
  Let $\cOp := \eDD(\cO)=(C_{2k-1},\cdots, C_{0})$.
  Then
  \[
    \begin{split}
      \drcs(\cO) &\xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \drc(\cOp) \\
      \drcns(\cO)&
      \xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \drc(\cOp)
    \end{split}
  \]
  are a bijections.
\end{lem}
\begin{proof}
  The claim for $\drcs(\cO)$ is clear by the definition of descent.
  The claim for $\drcns(\cO)$ reduces to that of $\drcs(\cO)$ using \Cref{def:sp-nsp.C}.
\end{proof}

\begin{lem}\label{lem:gd.CD}
  Suppose $\cO = (C_{2k},C_{2k-1}, \cdots, C_{0})$ with $k\geq 1$ and $C_{2k}$ odd.
  Let $\cOp := \eDD(\cO)=(C_{2k-1}+1,\cdots, C_{0})$.
  Then the following map is a bijection
  \[
      \drc(\cO) \xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \set{\uptaup\in \drc(\cOp)| x_{\uptau}\neq s}. %\subsetneq \drc(\cOp).
  \]
\end{lem}
\begin{proof}
  This is clear by the descent algorithm.
\end{proof}
\subsubsection{Descent from $D$ to $C$} Now we consider the general case of the
descent from type $D$ to type $C$. So we assume $\cO$ has at least 3 columns.
First note that the shape of $\uptau' = \eDD(\uptau)$ is the shape of $\uptau$ deleting the
longest column on the left.

% We assume $\uptau$ and $\uptau'$ has the following shape where $(y_{1},y_{2})$
% could be empty and $w_{0}$ is non-empty if $\uptau_{R}\neq \emptyset$.
The definition splits in cases below. In all these cases we define
\begin{equation}\label{eq:x.uptau}
\bfxx_{\uptau} := x_{1}\cdots x_{n} \text{ and } x_{\uptau} := x_{n}
\end{equation}
which is marked by $s/r/c/d$.
For the part marked by $*/\cdots$ , $\eDD$ keeps $r,c,d$ and maps the rest part consisting of $\bullet$ and $s$ by dot-s switching algorithm.
\begin{enumerate}[resume*=alg1]
  \item When $C_{2k}=C_{2k-1}$ is odd, we could assume $\uptau$ and $\uptaup$ hase
        the following forms with $n = (C_{2k+1}-C_{2k}+1)/2$.
      \[
        \uptau: \hspace{1em} \tytb{\cdots\cdots\cdots,{\ast}{\ast}{\cdots},{x_{1}}{y_{1}}\cdots,{\vdots},{x_{n}}}
        \times \tytb{\cdots\cdots\cdots,{w_{0}}{\ast}{\cdots},\none,\none,\none}
        \mapsto
        \uptaup:  \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none{z_{1}}\cdots,\none,\none}
        \times \tytb{\cdots\cdots\cdots,{w_{0}}{\ast}{\cdots},\none,\none,\none}
      \]
        Suppose $y_{1} = c$ and $(x_{1}, \cdots, x_{n}) = (r, \cdots, r)$ or
        $(r, \cdots, r,d)$, then let $z_{1}= r$; otherwise, set $z_{1}:= y_{1}$.
        We define
        \[
        \bfpp_{\uptau}:=\tytb{{x_{1}}{y_{1}},\vdots,{x_{n}}}.
        \]
  \item When $C_{2k}$ is even and $\uptau$ has special shape, the descent is given by the following diagram
      \[\tiny
        \uptau: \hspace{1em}
        \ytb{
        \cdots\cdots\cdots,
        {\ast}{\ast}{\cdots},
        {*(srcol)\bullet},
        {*(srcol)\vdots},{*(srcol)\bullet},{x_1},\vdots,{x_n}}
        \times \ytb{\cdots\cdots\cdots,{\ast}{\ast}{\cdots},{*(srcol)\bullet},{*(srcol)\vdots},{*(srcol)\bullet},\none,\none,\none}
        \mapsto
       \uptaup: \ytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none}
        \times \ytb{\cdots\cdots\cdots,{\ast}{\ast}{\cdots},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\none,\none,\none}
      \]
  \item When $C_{2k}$ is even and $\uptau$ has non-special shape, then
        \[
        \uptau:\tytb{{\cdots}\cdots\cdots\cdots,{\ast}{\ast}{\cdots}{\cdots},{*(srcol)s}{*(srcol)r}{\cdots}\cdots,
        {*(srcol)\vdots}{*(srcol)\vdots},{*(srcol)s}{*(srcol)r},{x_{0}}{y_{1}},{x_{1}}{y_{2}},{\vdots},{x_{n}}}
        \times\tytb{{\cdots}\cdots\cdots,{\ast}{\cdots}\cdots,\ ,\ ,\ ,\ ,\ ,\ ,\ }
        \mapsto \uptau':
        \tytb{\cdots\cdots\cdots,{\ast}{\ast}{\cdots},{*(srcol)r}{\ast}\cdots,{*(srcol)\vdots},{*(srcol)r},{z_{1}},{z_{2}},\ ,\ }
        \times\tytb{{\cdots}\cdots\cdots,{\ast}{\cdots}\cdots,\ ,\ ,\ ,\ ,\ ,\ ,\ }
        \]
      where $y_{1},y_{2}$ are non empty.
      In most of the case, we just delete the longest column on the left and set
      $(z_{1},z_{2})=(y_{1},y_{2})$. The exceptional cases are listed below:
      \begin{itemize}
        \item When
 $x_{0}=r$, we have $(y_{1},y_{2})=(c,d)$. We let
      \[
          \tytb{{x_{0}}{y_{1}}\none{r}{c},{x_{1}}{y_{2}}{=}{x_{1}}{d},\vdots\none\none\vdots,{x_{n}}\none\none{x_{n}}}
          \mapsto \tytb{{z_{1}}\none{r},{z_{2}}{:=}r,\none,\none}
        \]

        \item When $x_{0}=c$, we have $n=1$ and $(x_{0},x_{1})=(y_{1},y_{2})=(c,d)$. We let
        \[
          \tytb{{x_{0}}{y_{1}},{x_{1}}{y_{2}}} = \tytb{cc,dd}
          \mapsto \tytb{{z_{1}},{z_{2}}}:=\tytb{r,c}.
      \]
      \item
      We remark that $x_{0}$ never equals to $d$.
  \end{itemize}
\end{enumerate}

\subsubsection{A key property in the descent case}
We retain the notation in \Cref{def:sp-nsp.D.sp}, where
\[
\cO=(C_{2k+1}=2c_{2k+1},C_{2k}=2c_{2k},C_{2k-1}=2c_{2k-1},\cdots, C_{0}) \text{
  such that } k\geq 1.
\]
Let $\cOp=\eDD(\cO)$ and $\cOpp=\eDD(\cOp)$.
The following lemma is the key property satisfied by our definition
\begin{lem}\label{lem:sp-nsp.D}
  Let $\tau^{s}$ and $\tau^{ns}$ are two representations attached to $\cO$ as in
  \Cref{def:sp-nsp.D.sp}.
  Then
  \begin{enumS}
    \item \label{lem:sp-nsp.D.1} For every $\uptau\in \drc(\tau^{s})\sqcup \drc(\tau^{ns})$, the shape
    of $\eDD^{2}(\uptau)$ is
    \[
      \taupp = (c_{2k-1},\tau_{2k-3},\tau_{1})\times (\tau_{2k-2},\cdots, \tau_{0})
    \]
    \item \label{lem:sp-nsp.D.2} Let $\cO_{1}= (2(c_{2k+1}-c_{2k}),)\in \Nil(D)$ be the trivial orbit
    of $\rO(2(c_{2k-1}-c_{2k}),\bC)$.
    We define $\delta\colon \drc(\cO)\rightarrow \drc(\cOpp)\times \drc(\cO_{1})$ by $\delta(\uptau) = (\eDD^{2}(\uptau),\bfxx_{\uptau})$.
    The following maps are bijections
    \[
      \begin{tikzcd}[row sep=0em]
        \drc(\tau^{s})\ar[r,"\delta"] & \drc(\taupp)\times \drc(\cO_{1}) &\ar[l,"\delta"'] \drc(\tau^{ns})\\
        \uptau^{s}\ar[r,maps to] & (\eDD^{2}(\uptau^{s}), \bfxx_{\uptau^{s}})&\\
        & (\eDD^{2}(\uptau^{ns}), \bfxx_{\uptau^{ns}})& \uptau^{ns}\ar[l,maps to]\\
      \end{tikzcd}
    \]
    In particular, we obtain an one-one correspondence
    $\uptau^{s}\leftrightarrow \uptau^{ns}$ such that $\delta(\uptau^{s})=\delta(\uptau^{ns})$.
    \item\label{lem:sp-nsp.D.3}
    Suppose $\uptau^{s}$ and $\uptau^{ns}$ correspond as the above such that
    $\delta(\uptau^{s})=\delta(\uptau^{ns})=(\uptaupp,\bfxx)$. Then
    \begin{equation} \label{eq:sp-nsp-sig}
      \ssign(\uptau^{s})=\ssign(\uptau^{ns})=(C_{2k},C_{2k})+\ssign(\uptaupp)+\ssign(\bfxx).
    \end{equation}
  \end{enumS}
\end{lem}
\begin{proof}
  Suppose $\uptau^{s}$ has special shape.
  the the behavior of $\uptau^{s}$ under the descent map $\eDD$ is illostrated
  as the following:
  \[\tiny
    \uptau^{s}: \hspace{1em}
    \ytb{
      {*(srcol)\cdots}\cdots\cdots,
      {*(srcol)\ast}{\ast}{\cdots},
      {*(srcol)\bullet},
      {*(srcol)\vdots},{*(srcol)\bullet},{x_1},\vdots,{x_n}}
    \times
    \ytb{{*(srcol)\cdots}\cdots\cdots,
      {*(srcol)\ast}{\ast}{\cdots},{*(srcol)\bullet},{*(srcol)\vdots},{*(srcol)\bullet},\none,\none,\none}
    \mapsto
    \uptau'^{s}
     \ytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none}
    \times \ytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)\ast}{\ast}{\cdots},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\none,\none,\none}
    \mapsto
    \uptaupp:
    \ytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none}
    \times \ytb{\none\cdots\cdots,{\none}{\ast}{\cdots},\none,\none,\none,\none,\none,\none}
  \]
  Note that $\uptau^{s}$ is obtained from $\taupp$ by attaching the grey part
  consisting totally $2c_{2k}$ dots and $\bfxx$. Now the claims for $\uptau^{s}$ is
  clear.


  Now consider the descent of a non-special diagram $\uptau^{ns}$:
  \[\tiny
    \uptau^{ns}:\ytb{{*(srcol)\cdots}\cdots\cdots\cdots,{*(srcol)\ast}{y_{0}}{\ast}{\cdots},{*(srcol)s}{*(srcol)r}{y_{2}}\cdots,
      {*(srcol)\vdots}{*(srcol)\vdots},{*(srcol)s}{*(srcol)r},{x_{0}}{y_{1}},{x_{1}}{y_{3}},{\vdots},{x_{n}} }
    \times\ytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)u_{0}}{\cdots},\ ,\ ,\ ,\ ,\ ,\ ,\ }
    \mapsto
    \uptau'^{ns}:\ytb{\cdots\cdots\cdots,{y'_{0}}{\ast}{\cdots},{*(srcol)r}{y'_{2}}\cdots,
      {*(srcol)\vdots},{*(srcol)r},{y'_{1}},{y'_{3}},\ ,\ }
    \times\ytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)w_{0}}{\cdots},\ ,\ ,\ ,\ ,\ ,\ ,\ }
    \mapsto
    \uptaupp:\hspace{1em}
            \ytb{{\cdots}{\cdots}{\cdots},{x'_{0}}{\ast}{\cdots},{x'_{1}}{x'_{2}}\cdots,\none,\none,\none,\none,\none,\none}
            \times
            \ytb{{\cdots}{\cdots},{\cdots}\none,\none,\none,\none,\none,\none,\none,\none}
            % \ytb{\emptyset,\none,\none,\none,\none,\none}
  \]
  The bijection follows from the observation that 1. $\uptau^{ns}$ is obtained by
  attaching the grey part $x_{0},\cdots,x_{n}$ and $y_{0},y_{1},y_{2},y_{3}$
  to the $\ast/\cdots$ part of $\uptaupp$;
  2. the value of $(y_{0},y_{1},y_{2},y_{3})$ is completely determined by
  $(x'_{0},x'_{1},x'_{2})$ and $\bfxx=x_{1}\cdots x_{n}$.

  We leave it to the reader for checking case by case that the grey part of $\uptau^{ns}$ has signature
  $(C_{2k}-2,C_{2k}-2)$ and
  \[\ssign(x_{0}y_{0}y_{1}y_{2}y_{3})-\ssign(x'_{0}x'_{1}x'_{2})=(2,2).
  \]
 Therefore \eqref{eq:sp-nsp-sig} follows.

 \trivial[]{
   First assume that $C_{2k}=2$. Note that we can not/(or now?) assume $k=1$, consider the
   orbit $\cOpp=(2,1,1,1,1)$.
   \begin{enumPF}
     \item
     $x'_{1}=s$, now $y'_{0} = \emptyset/\bullet$ when $x'_{0}=\emptyset/s$
     \begin{enumPF}
       \item Suppose $x'_{2}\neq r$. Then $(y'_{2},y'_{1},y'_{3}) = (x'_{2},r,d)$,
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,x'_{0}, x'_{2},c,d)$.
       Therefore, the sign difference is $\ssign(s,c,d)-\ssign(s)=(2,2)$.
       \item Suppose $x'_{2} = r$. Then $(y'_{2},y'_{1},y'_{3}) = (c,r,d)$.
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,x'_{0},c,r,d)$.
       Therefore, the sign difference is $\ssign(s,c,r,d)-\ssign(s,r)=(2,2)$.
     \end{enumPF}
     \item $x'_{1}\neq s$.
     \begin{enumPF}
       \item Suppose $x'_{0}\neq c$.
       Then $x'_{0}=\emptyset/s/r$, $x'_{1}=r/c/d$, $(y'_{0}, y'_{2},y'_{1},y'_{3}) = (\emptyset/\bullet/r,x'_{2},r,x'_{1})$.
       \begin{enumPF}
         \item $x'_{1}=r$. Then
         $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (r,x'_{0},x'_{2},c,d)$.
         Therefore, the sign difference is $\ssign(r,c,d)-\ssign(r)=(2,2)$.
         \item $x'_{1}=c$. Then  $x_{1}=d$.
         $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (c,x'_{0},x'_{2},c,d)$.
         Therefore, the sign difference is $\ssign(c,c,d)-\ssign(c)=(2,2)$.
         \item $x'_{1}=d$. Then
         $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,x'_{0},y'_{2},y'_{1},y'_{3})=(s,x'_{0},x'_{2},r,d)$.
         Therefore, the sign difference is $\ssign(s,r,d)-\ssign(d)=(2,2)$.
       \end{enumPF}
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,r,x'_{2},c,d)$.
       Therefore, the sign difference is $\ssign(s,r,x'_{2},c,d)-\ssign(c,d,x'_{2})=(2,2)$.
       \item Suppose $x'_{0} = c$.
       Then $x'_{1}=d$, $(y'_{0}, y'_{2},y'_{1},y'_{3}) = (r,x'_{2},c,d)$.
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,r,x'_{2},c,d)$.
       Therefore, the sign difference is $\ssign(s,r,x'_{2},c,d)-\ssign(c,d,x'_{2})=(2,2)$.
     \end{enumPF}
   \end{enumPF}
   }
 \end{proof}

\subsubsection{A key proposition in the generalized descent case}\label{sec:gd2.CD}

We now assume that $k\geq 1$ and $C_{2k}$ is odd, i.e. $\cOp\leadsto \cOpp$ is a
generalized descent.

Without loss of generality, we can assume the dot-r-c diagrams have the
following shapes with $n = (C_{2k+1}-C_{2k}+1)/2$:
\begin{equation}\label{eq:gd2.drc}
  \uptau:\tytb{
    {*(srcol)\cdots}\cdots\cdots\cdots,
    {*(srcol)\ast}{\ast}{\ast}{\ast},
    {x_{1}}{x_{0}}{\cdots}\cdots,
    \vdots,
    {x_{n}}
  }
  \times
\tytb{{*(srcol)\cdots}\cdots\cdots,
    {*(srcol)\ast}{\ast}{\cdots},
    \none,\none,\none}
  \xmapsto{\hspace{1em}\eDDo\hspace{1em}}
  \uptaup:\tytb{
    \cdots\cdots\cdots,
    {\ast}{\ast}{\ast},
    {x_{\uptaupp}}{\cdots}\cdots,
    \none,
    \none
  }
  \times
\tytb{{*(srcol)\cdots}\cdots\cdots,
    {*(srcol)\ast}{\ast}{\cdots},
    \none,\none,\none}
  \xmapsto{\hspace{1em}\eDDo\hspace{1em}}
  \uptaupp:\tytb{
    \cdots\cdots\cdots,
    {\ast}{\ast}{\ast},
    {x_{\uptaupp}}{\cdots}\cdots,
    \none,
    \none
  }
  \times
\tytb{\cdots\cdots,
    {\ast}{\cdots},
    \none,\none,\none}
\end{equation}

The diagram $\uptau$ is obtained from the diagram of $\uptau$ by adding
$\bullet$ at the
grey parts, changing $x_{\uptaupp}$ to $x_{0}$ and attaching $x_{1}\cdots x_{n}$.


We define
\[
  \bfpp_{\uptau}:=\tytb{{x_{1}}{x_{0}},\vdots,{x_{n}}}
\]
and call $\bfpp_{\uptau}$ the peduncle part of $\uptau$. Let
$\cO_{1} = (C_{2k+1}-C_{2k}+1,)\in \dpeNil(D)$. We define
$\bfuu_{\uptau}\in \drc(\cO_{1})$ by the following formula:
\begin{equation}\label{eq:def.u}
  \bfuu_{\uptau}:=u_{1} \cdots u_{n} =
  \begin{cases}
    r\cdots r c, & \text{when } \bfpp_{\uptau} = \tytb{rc,\vdots,r}\\
    r\cdots c d, & \text{when } \bfpp_{\uptau} = \tytb{rc,\vdots,d}\\
    x_{1}\cdots, x_{n} & \text{otherwise}.
  \end{cases}
\end{equation}


Let $\tcO = (C_{2k+1}-C_{2k}+1,1,1,)\in \dpeNil(D)$ and
$\tcOpp = \eDD^{2}(\tcO) = (2)\in \dpeNil(D)$. Then
$\bfpp_{\uptau}\in \drc(\tcO)$ and $x_{\uptau}\in\dpeNil(D)$.
There is some restriction on the possibilities  of $\bfuu_{\uptau}$.

\begin{lem}\label{lem:u}
  Let
  \[
    \uptau = \tytb{{x_{1}}{x_{0}},\vdots, {x_{n}}}\in \drc(\tcO)
    \quad \text{and}\quad \uptaupp:=\eDDo^{2}(\uptau).
  \]
  Then we have the following properties which is easy to verify.
  \begin{enumS}
    \item  If $\uptaupp = r$, then $s \in \bfuu_{\uptau}$ or
    $c \in \bfuu_{\uptau}$. In particular, $\ssign(\bfuu_{\uptau})\succ (0,1)$.
    If $\ssign(\bfuu_{\uptau})\nsucc (0,2)$, we have
    \[
      \uptau = \tytb{rc, \vdots,r} \quad \text{and}\quad  \bfuu_{\uptau} = \tytb{r,\vdots,c}.
    \]
    \item  If $\uptaupp = c$, then $s \in \bfuu_{\uptau}$ or
    $c \in \bfuu_{\uptau}$. In particular, $\ssign(\bfuu_{\uptau})\succeq (0,1)$.
    \item If $\uptaupp = d$, there is no restriction on $\bfuu_{\uptau}$.
    \item  We have $x_{n}=d$ if and only $d\in \bfuu_{\uptau}$.
    \item If $x_{n}=d$ and $\uptaupp =r/c$,  we have $n\geq 2$ and
    $\ssign(\bfuu_{\uptau})\succeq (0,2)$.
    \item If $\bfuu_{\uptau} = r\cdots r$, we have $\uptaupp=d$.
  \end{enumS}

\end{lem}


\begin{lem}\label{lem:gd.inj}
  The map $\delta\colon  \drc(\cO)\rightarrow \drc(\cOpp) \times \drc(\cO_{1})$
  given by $\uptau\mapsto (\eDDo^{2}(\uptau),\bfuu_{\uptau})$ is injective.
  Moreover,
  \[
  \ssign(\uptau) =\ssign(\uptaupp) + (C_{2k}-1, C_{2k}-1)+\ssign(\bfuu_{\uptau}).
  \]
  The map $\tdelta\colon \drc(\cO)\rightarrow \drc(\cOpp) \times \bN^{2}\times \bZ/2\bZ$
  given by $\uptau\mapsto (\eDDo^{2}(\uptau), \ssign(\uptau),\upepsilon_{\uptau})$ is injective.
\end{lem}
\begin{proof}
  By our algorithm,
  \[
    (x_{\uptaupp},\bfuu_{\uptau}) = (x_{\eDDo^{2}(\bfpp_{\uptau})}, \bfuu_{\bfpp_{\uptau}}).
  \]
  The the injectivity of $\delta$ and the siginature formula follows directly
  from the definition of $\bfuu_{\uptau}$.
  Now the injectivity of $\tdelta$ follows from the injectivity of
  $\bfuu_{\uptau}\mapsto (\ssign(\bfuu_{\uptau}), \upepsilon)$ by
  \Cref{c:init.CD}.
  % Let $\uptaupp:=\eDDo^{2}(\uptau)$ and
  % Then $\uptau\mapsto (\uptaupp,\bfuu_{\uptau})$ is injective and
  % \[
  % %\ssign(\uptau) =\ssign(\uptaupp) + 2(n_1,n_{1})+\ssign(\bfuu_{\uptau}) \text{ where }2n_{1}+1 = C_{2k}.
  % \ssign(\uptau) =\ssign(\uptaupp) + (C_{2k}-1,C_{2k}-1)+\ssign(\bfuu_{\uptau}) \text{ where }2n_{1}+1 = C_{2k}.
  % \]
  % Now the lemma follows from
  % $\bfuu_{\uptau}\mapsto (\ssign(\bfuu_{\uptau}), \upepsilon)$ is injective by \Cref{c:init.CD}.
\end{proof}


\section{Classical groups and their nilpotent orbits} \label{sec:Nil}

% \subsection{Classical groups}
% \subsubsection{complex orthogonal and symplectic groups}
\subsection{Complex orthogonal and symplectic groups}
Let $\epsilon\in \set{\pm 1}$. Let $\bfV$ be a finite dimensional complex vector space equipped with an
$\epsilon$-symmetric non-degenerate bilinear form
$\inn{\cdot}{\cdot}_{\bfV}$, to be called an $\epsilon$-symmetric bilinear
space. Denote its isometry group by
\[
 \bfG := \bfG_{\bfV} := \Set{g\in \End_\bC(\bfV)|\inn{g\cdot v_1}{g\cdot
      v_2}_{\bfV} = \inn{v_1}{v_2}_{\bfV},\quad\textrm{for all }v_1,v_2\in \bfV}.
\]
The Lie algebra of $\bfG$ is given by
\[
 \fgg:= \fgg_{\bfV}:=\set{X\in \End_\bC(\bfV)\mid \inn{X\cdot v_1}{v_2}_{\bfV}
    +\inn{v_1}{X\cdot v_2}_{\bfV}=0,\quad\textrm{for all }v_1,v_2 \in \bfV}.
\]

Note that  $\bfG_{\bfV}$ is a trivial group if and only if $\bfV=\{0\}$.
% We shall (loosely) call $G$ a complex classical group. We also say $G$ has
% type $\epsilon$.
% \subsubsection{unitary groups}TBA

\subsection{Real form, Cartan involution, and
  $(\epsilon, \dot \epsilon)$-space}\label{sec:rG}
We recall some facts about real structures and Cartan involutions on the complex
classical group $\bfG$. See \cite[Section~1.2-1.3]{Ohta}.
Let $\dot \epsilon\in \set{\pm 1}$.\footnote{In \cite{Ohta}, $\dotepsilon$ is
  denoted by $\omega$.}


%\subsubsection{Real form}
% The real from of $\bfG$ is given by a conjugate linear automorphism of $V$.

%Let $\dotepsilon=\pm 1$.


\begin{defn}\label{def:J}
  An $\dotepsilon$-real form of $\bfV$ is a conjugate linear automorphism
  $J$ of $\bfV$ such that
    \[
    J^2=\epsilon \dotepsilon\quad \text{ and }\quad \inn{Jv_1}{Jv_2}_{\bfV}=
  \overline{\inn{v_1}{v_2}_{\bfV}},\quad\textrm{for all }v_1,v_2\in \bfV.
  \]
\end{defn}

%  By conjugation action, $J$ induces an anti-holomorphic involution on $\bfG$.

For $J$ as in \Cref{def:J}, write   $\bfG^J$ for the centralizer of $J$ in $\bfG$ (we will use similar notation  without further explanation). It is a real
form of $\bfG$ as in \Cref{tab:realforms}.

%  We call $J$ a (strong) real form of $\bfG$.

\begin{table}[h]
  \centering
  \begin{tabular}{c|c|c}
    \diagbox{ $\hspace{1em}\epsilon$}{$\dotepsilon$} & $1$ & $-1$\\
    \hline
    $1$ &  real orthogonal group &  quaternionic orthogonal group \\
    \hline%inserts double horizontal lines
    $-1$ & quaternionic  symplectic group  &  real symplectic group \\
    \hline
  \end{tabular}
  \vspace*{.5em}
  \caption{The real classical group $\mathbf{G}^J$}\label{tab:realforms}
\end{table}



\begin{remarks}
  \begin{enumR}
  \item The real form $\bfG^J$ may also be described as the isometry group of a
    $\dotepsilon$-Hermitian space over a division algebra $D$, where $D$ is
    $\bR$ if $\ccJ = 1$ and the quaternion algebra $\bH$ if $\ccJ = -1$.
    %See \Cref{sec:FS} for a case by case construction of $J$.
  \item
    % Note that the (possibly non-connected) group $\bfG$ is isomorphic to
    % $\Aut(\bfG)$ in the cases we consider.  Hence
    Every real form of $\bfG$ is of the form $\bfG^J$ for some $J$.
    % by an element of $\bfG$.
  \item The conjugate linear map $J$ is an equivalent formulation of Adams-Barbasch-Vogan's
    notion of strong real forms \cite[Definition~2.13]{ABV}.  \trivial[h]{ Fix
      a (maximally split) real form $V$ of $\bfV$, i.e. $\inn{}{}_{\bfV}|_{V}$
      is a non-degenerate split form taking values in $\bR$. Let $\cpc$ be the
      complex conjugation on $\bfV$, $\bfG$ and $\GL(\bfV)$. Let
      $\Gamma = \Gal(\bC/\bR) = \gen{\cpc}$.  By abuse of notation also denote
      $\cpc$ corresponding the complex conjugation on $\bfG$ and $\GL(\bfV)$.
      The extended group is defined to be
      $\bfG^\Gamma := \bfG\rtimes \gen{\cpc}$.  Let $J$ be as in
      \Cref{def:J}. Then $J = z \circ \cpc$ where $z\in \GL(\bfV)$.  We have
      $z \in \bfG$, since
      \[
        \innbfv{z v_1 }{z v_2} = \innbfv{J\cpc(v_1)}{J\cpc(v_2)} =
        \overline{\innbfv{\cpc(v_1)}{\cpc(v_2)}} = \innbfv{v_1}{v_2}.
      \]
      Moreover
      $J^2 = z \cpc z \cpc = z \cpc(z)\in \set{\pm 1} \subset \cent{\bfG}$.
      Therefore, $J\leftrightarrow z$ gives the correspondence between real
      forms of $\bfV$ and strong real forms of $\bfG$.

      Note that $\cent{\bfG} = \set{\pm 1}$ except $\bfG = \rO(2,\bC)$.  }
  \end{enumR}
\end{remarks}




\begin{defn}\label{def:L}
  An $\dotepsilon$-Cartan form of $\bfV$ is a  linear automorphism
  $L$ of $\bfV$ such that
  \[
    L^2= \dotepsilon\quad \text{ and }\quad \inn{L v_1}{L v_2}_{\bfV}=
    \inn{v_1}{v_2}_{\bfV},\quad\textrm{for all }v_1,v_2\in \bfV.
  \]
\end{defn}

Given an $\dotepsilon$-Cartan form $L$ of $\bfV$, conjugation by $L$ yields an
involution of the algebraic group $\bfG$. Thus we have a symmetric subgroup
$\bfG^L$ of $\bfG$.




%\subsubsection{Cartan involution}
%We recall a standard result on (global) Cartan involution.
We omit the proof of the following lemma (\cf \cite[Section~1.3]{Ohta}).
\begin{lem}\label{lem:cartan}
  For every $\dotepsilon$-real form $J$ of $\bfV$, up to conjugation by
  $\bfG^J$, there exists a unique $\dotepsilon$-Cartan form $L$ of $\bfV$ such
  that % $\ccL = \dotepsilon:= \epsilon \ccJ$, $a=b=1$.
  \begin{enumC}
%  \item \label{it:cartan.1} $\inn{Lu}{Lv}_{\bfV} = \inn{u}{v}_{\bfV} $ and $L^2 = \dotepsilon$;
   % and $\epsilon\ccL\ccJ = 1$;
  \item \label{it:cartan.2} $LJ = JL$;
  \item \label{it:cartan.3} the Hermitian form $(u,v)\mapsto \innbfv{Lu}{Jv}$ on
    $\bfV$ is positive definite.
  \end{enumC} Similarly, for every  $\dotepsilon$-Cartan form $L$ of $\bfV$, up to conjugation by $\bfG^L$, there exists a
  unique $\dotepsilon$-real form $J$ of $\bfV$ such
  that the above two conditions hold.
\end{lem}
% \begin{proof}
% This is elementary, \emph{cf}.  \Cref{sec:FS}.
% \end{proof}

For $L$ as in \Cref{lem:cartan}, conjugation by $L$ induces a Cartan involution on $\bfG^J$.


\trivial[h]{
The $G$-orbit of $L\in \GL(\bfV)$ satisfying \Cref{it:cartan.1}, \Cref{it:cartan.2} and
that $G^L$ is a maximal compact subgroup of $G$ is unique up to $\set{\pm 1}$.
\Cref{it:cartan.3}
}


%\subsubsection{$(\epsilon, \dotepsilon)$-space}


\begin{defn}\label{defn:eespace}
  An $\epsilon$-symmetric bilinear space $\bfV$ with a pair $(J,L)$
  as in \Cref{lem:cartan} is called an
  \emph{$(\epsilon, \dotepsilon)$-space}.
 % if it is equipped with
 %  The conjugation by $L$ induces a Cartan involution on $G$, and $K:= G^L$
 %  is then a maximal compact subgroup of $G$.
 % We simply call the element $L$ a \emph{Cartan
 %  involution} of $(\bfV,J)$.
\end{defn}




In view of \Cref{lem:cartan} and when no confusion is possible, we also name the pairs $(\bfV, L)$ and  $(\bfV, J)$ as $(\epsilon, \dot \epsilon)$-spaces.
% Thus an $(\epsilon, \dot \epsilon)$-space $\bfV$ comes with the datum $(\bfV,J,L)$.
We define the notion of a non-degenerate $(\epsilon, \dot \epsilon)$-subspace and isomorphisms of
$(\epsilon, \dot \epsilon)$-spaces in an obvious way.
% The real classical group $G=\bfG^{J}$ associated the $(\epsilon, \dot \epsilon)$-space $\bfV$ may then be described as in \Cref{tab:realG}.


% \begin{table}[h]
% \centering
% \begin{tabular}{c|c|c}
% \diagbox{ $\hspace{1em}\epsilon$}{$\dot \epsilon$} & $1$ & $-1$\\
% \hline
%  $1$ &  real orthogonal group &  quaternionic orthogonal group \\
%  \hline%inserts double horizontal lines
% $-1$ & quaternionic symplectic group  & real symplectic group \\
% \hline
% \end{tabular}
% \caption{The real classical group $G$}\label{tab:realG}
% \end{table}


%\subsubsection{Signatures}



\begin{defn}\label{def:Vsign}
  The signature of an $(\epsilon, \dot \epsilon)$-space $(\bfV,J,L)$  is defined
  by the following recipe: $$\sign{\bfV} := \sign{\bfV, L}:=(n^+,n^-),$$
   where $n^+$ and $n^-$ are
  respectively the dimensions of $+1$ and $-1$ eigenspaces of $L$ if
  $\dotepsilon=1$, and the dimensions of $+\mathbf i$ and $-\mathbf i$ eigenspaces of $L$ if
  $\dotepsilon=-1$.  For every
  $L$-stable subquotient $\bfE$ of $\bfV$, the signature $\sign{\bfE}$ is
  defined analogously.
 \end{defn}


For a fixed pair $(\epsilon, \dot \epsilon)$, the isomorphism class of an $(\epsilon, \dot \epsilon)$-space $(\bfV,J,L)$ is
determined by $\sign{\bfV}$. In view of \Cref{lem:cartan}, we define the signatures of the pairs $(\bfV,L)$ and $(\bfV,J)$  as that of $(\bfV,J,L)$.
% (see \Cref{sec:FS})
The value of $\sign{\bfV}$ is listed in \Cref{tab:sign} for the real classical group $\bfG^J$.
\begin{table}[h!]
\centering
\begin{tabular}{c|c}
  \hline
  $\bfG^J$ & $\sign{\bfV}$ \\
  \hline
  $\rO(p,q)$ & $(p,q)$\\
  $\Sp(2n,\bR)$ & $(n,n)$\\
%  $\rU(p,q)$ & $(p,q)$ \\
  $\rO^*(2n)$ & $(n,n)$\\
  $\Sp(p,q)$ & $(2p,2q)$\\
  \hline
\end{tabular}
\vspace*{.5em}
\caption{Signature of $(\epsilon, \dot \epsilon)$-spaces}\label{tab:sign}
\end{table}


%\begin{remark}\label{rmk:Vsign}
%The datum $(\epsilon, \dotepsilon, n^+,n^{-})\in  \set{\pm1}\times \set{\pm 1}\times \Z_{\geq 0}^2$
%uniquely determine $(\bfV; J,L)$, up to isometric isomorphism.
%\end{remark}

%\subsection{Nilpotent orbits and its decent}



\subsection{Metaplectic cover}\label{sec:MC}
Let $(J,L)$ be as in \Cref{lem:cartan}.  Put $G := \bfG^J$ and $\bfK :=
\bfG^L$. Then $K:=G\cap \bfK$ is a maximal compact subgroup of both $G$ and
$\bfK$.  As a slight modification of $G$, we define
 \[
   \wtG:=
   \begin{cases}
     \textrm{the metaplectic double cover of $G$},\quad
     &\textrm{if $G$ is a real symplectic group};\\
     G,\quad &\textrm{otherwise}.
   \end{cases}
 \]
 Here ``$G$ is a real symplectic group" means that $(\epsilon, \dot \epsilon)=(-1,-1)$, and similar terminologies will be used later on.
 In the case of a real symplectic group, we use $\varepsilon_G$
 to denote the nontrivial element in the kernel of the covering homomorphism
 $\wtG \rightarrow G$.  In general, we use ``$\,\widetilde{\phantom{a}}\,$"
 over a subgroup of $G$ to indicate its inverse image under the covering map
 $\wtG\rightarrow G$.
 % For example, $\wtbfK$ is the degree  $2$ covering of the
 % complex group $\bfK$.
 For example, $\wtK$ is the a maximal compact subgroup of
 $\wtG$ with a covering map $\wtK\rightarrow K$ of degree $1$ or
 $2$. Similar notation will be used for other covering groups similar to $\wtG$.

 When there is a need to indicate the dependence of various objects introduced on the
 $(\epsilon,\dotepsilon)$-space $\bfV$, we will add the subscript $\bfV$ in various
 notations (e.g. $\wtG_{\bfV}$ and $\wtK_{\bfV})$.



\subsection{Young diagrams and complex nilpotent orbits}
% Let $(\bfV, \inn{}{}_{\bfV})$ be an $\epsilon$-symmetric space of dimension
% $n$, as before.

Let $\Nil_{\bfG}(\fgg)$ be the set of nilpotent $\bfG$-orbits in $\fgg$.
For $n\in \bN:=\{ 0, 1,2, \cdots\}$, let $\cP_\epsilon(n)$ be the set of Young diagrams of size $n$ such that
\begin{enumI}
\item rows of even length appear in even times if $\epsilon=1$;
\item rows of odd length appear in even times if $\epsilon=-1$.
\end{enumI}



In this paper, a Young diagram $\bfdd$ will be labeled by a sequence
$[c_0,c_1,\cdots, c_k]$ of integers enumerating its columns, where $k\geq
-1$. By convention, $[c_0,c_1,\cdots,c_k]$ denotes the empty sequence $\emptyset$ which
labels the empty Young diagram when $k=-1$. It is easy to see that
$\cP_{\epsilon}(n)$ consists of sequences of the form $[c_0,c_1,\cdots, c_k]$
such that
\[%\begin{equation}
\label{eq:P_eps}
\begin{cases}
  c_0\geq c_1\geq \cdots \geq c_k>0,\\
  \sum_{l=0}^k  c_l=n \text{, and} \\
  \sum_{l=i}^k  c_l \text{ is even, when $i\equiv \frac{1+\epsilon}{2} \pmod{2}$ and
  $0\leq i\leq k$},\\
\end{cases}
\]%\end{equation}
and $\cP_{\epsilon}(0) := \set{\emptyset}$ by convention.

\begin{defn}\label{def:NilC}For a nilpotent element $X$ in $\fgg$, set
\begin{equation}\label{eq:E.depth}
\depth(X):=\left\{
                 \begin{array}{ll}
                 \max\set{l\in \bN| X^l \neq 0}, \qquad &\textrm{if $\bfV\neq \{0\}$}; \\ % \text{($\depth$ by convention)}.\\
                 -1, &\textrm{if $\bfV=\{0\}$}.
                 \end{array}
                 \right.
\end{equation}
Given $\cO\in \NilGC$, pick any $X\in \cO$.
Set $\depth(\cO) := \depth(X)$ and define the Young diagram
\[
\bfdd_\cO:=[c_0,c_1,\cdots, c_k],
  \qquad (k:=\depth(\cO)\geq -1)
\]
where %$c_l = \dim (\bfee^{l}\bfV/\bfee^{l+1}\bfV)$, for
$$c_l := \dim (\Ker(X^{l+1})/\Ker(X^{l})), \quad \textrm{for all  }\,
0\leq l\leq k.
$$
\end{defn}
% Define $\abs{\bfdd} = n$ be the size of

We have the one-one correspondence: (\cite[Chapter 5]{CM})
\begin{equation}\label{eq:dd}
\xymatrix@R=0em{
\Nil_{\bfG}(\fgg) \ar[r]& \cP_{\epsilon}(\dim \bfV),\\
 \cO \ar@{|->}[r]& \bfdd_\cO.
}
\end{equation}



Let
\[
\Nil_{\epsilon} := \left.\left( \bigsqcup_{\bfV} \Nil_{\sfG_{\bfV}}(\fgg_{\bfV})\right)\right/\sim
\]
where $\bfV$ runs over all $\epsilon$-symmetric bilinear spaces, and $\sim$ denotes the
equivalence relation induced by isomorphisms of $\epsilon$-symmetric bilinear
spaces.
Let
\[
\cP_{\epsilon} := \bigsqcup_{n\geq 0} \cP_{\epsilon}(n).
\]
% Then the diagram map
% \[
% \xymatrix@R=0em{
% \bfD \colon \Nil_{\bfG}(\fgg) \ar[r]& \cP_{\epsilon}(n)\\
% \cO\ar@{|->}[r]& \bfdd_\cO
% }
% \]
The correspondence \cref{eq:dd}
induces a bijection
\[
\bfD\colon \Nil_{\epsilon}\longrightarrow \cP_{\epsilon}.
\]

%Note that the diagram of the zero orbit $\set{0}$ consists of one column and has depth $0$.

% Let
% \[\cP^+_{\epsilon}(n):= \set{\bfdd \in \cP_{\epsilon}(n)| \depth(\bfdd)\geq
%   1}, \ \text{ and }   \cP^+_{\epsilon} := \bigsqcup_{n} \cP^+_{\epsilon}(n).
% \]
% Define $\Nil^+_{\rU(\bfV)}(\fuu(\bfV))$ and $\Nil^+_{\epsilon}$ similarly.

%Similarly, define
%\[\Nil^+_{\rU(\bfV)}(\fuu(\bfV)):=\set{\cO\in \Nil_{\rU(\bfV)}(\fuu(\bfV))|
%  \depth(\cO)\geq 1} \text{ and }
%\Nil^+_{\epsilon} := \left.\left( \bigsqcup_{\bfV}
%  \Nil^+_{\rU(\bfV)}(\fuu(\bfV))\right)\right/\sim
%\]

\begin{defn}\label{defdo}
Define the descent of a Young diagram by
\[
\xymatrix@R=0em@C=5em{
  \flushmr{\DDc\colon} \cP_{\epsilon} \ar[r] & \cP_{-\epsilon}\\
[c_0,c_1,\cdots ,c_k] \ar@{|->}[r]&  [c_1,\cdots, c_k],
}
\]
namely by removing the left most column of the diagram.
By convention,  $\DDc(\emptyset) := \emptyset$.
\end{defn}

% \begin{defn}\label{def:dec.1}
% Suppose $\cO\in \Nil_{\bfG_{\bfV}}(\fgg_{\bfV})$ and fix an $\bfee\in \cO$.
% Define $\bfV' := \bfee \bfV\subset \bfV$ and equip $\bfV'$ with
% a bilinear form $\inn{}{}_{\bfV'}$ by requiring
% \begin{equation}\label{eq:dform}
%   \inn{\bfee v_1}{v'_2}_{\bfV'}:= \inn{v_1}{v'_2}_{\bfV},\qquad v_1\in \bfV,
%   v'_2\in \bfV'=\bfee \bfV.
% \end{equation}
% Then $(\bfV', \inn{}{}_{\bfV'})$ is well-defined, non-degenerate, and
% $(-\epsilon)$-symmetric bilinear space. The map $\bfee|_{\bfV'}$
% is a nilpotent element of $\bfG_{\bfV'}$ and let $\cO'$ denote its $\bfG_{\bfV'}$-obrit.
% We define the descent of a nilpotent orbit by
% \[
%   \xymatrix@R=0em@C=4em{
%     \flushmr{\DD \colon} \Nil_{\epsilon} \ar[r]& \Nil_{\epsilon}\\
%     \cO\ar@{|->}[r] & \cO'.
% }
% \]
% \end{defn}

% Obviously, we have the commutative diagram:
% \[
% \xymatrix{
% \Nil_{\epsilon} \ar[r]^{\DD} \ar[d]_{\bfD} & \Nil_{-\epsilon}\ar[d]^{\bfD}\\
% \cP_{\epsilon} \ar[r]_{\DD} & \cP_{-\epsilon} \makebox[0em][l]{\;.}
% }
% \]

%Clearly the descent sequence determines a nilpotent orbit.

Fix $\mathbb p\in \Z/2\Z$ as in the Introduction. As highlighted in the Introduction, we will  consider the following set of partitions/Young diagrams/nilpotent orbits.

\begin{defn}\label{def:c} Denote $\epsilon_l := \epsilon (-1)^{l}$, for $l\geq 0$. Let
\[
\cP^{\mathbb p}_{\epsilon}:= \Set{\bfdd = [c_0,\cdots, c_k]\in
  \cP_{\epsilon}|  \parbox[c]{18em}{
%    \begin{itemize}
%    \item all $c_i$'s have the same parity
%    \item $c_{l} \geq c_{l-1} + 1+ \epsilon_l \\= \begin{cases}
%        c_{l-1} +2 & \text{if } \epsilon_l = 1 \\
%        c_{l-1} & \text{if } \epsilon_l = -1
%     \end{cases}$
%    \end{itemize}}
    \begin{itemize}
    \item all $c_i$'s have parity $\mathbb p$;
    \item $c_{l} \geq c_{l+1} + 2$, if $0\leq l\leq k-1$ and $\epsilon_l = 1$.
        \end{itemize}}
}.
\]
By convention, $\emptyset \in \cP^{\mathbb p}_{\epsilon}$.
Denote by $\Nil^{\mathbb p}_{\bfG}(\g)$ the subset of $\Nil_{\bfG}(\g)$ corresponding to
partitions in $\cP^{\mathbb p}_{\bfG}:=\cP^{\mathbb p}_{\epsilon}\cap  \cP_{\epsilon}(\dim \bfV)$.
\end{defn}
%\[
%\cP^{\mathbb p}_{\bfG}:= \Set{\bfdd = [c_0,\cdots, c_k]\in
%  \cP_{\epsilon}^{\mathbb p} \mid  c_0+c_1+\cdots+c_k=\dim \bfV}.
%\]


%For a $\bfdd = [c_k,\cdots, c_0]\in \cP_{\epsilon}$, we will consider its descent sequence $\DD(\bfdd)$, $\DD^2(\bfdd)$, ....
%Clearly $\DD^{k-l}(\bfdd) \in \cP_{\epsilon_{l}}$ and has depth $l$.


\subsection{Signed Young diagrams and rational nilpotent orbits}\label{subsec:SYD}
Recall that $(\bfV, J,L)$ is an
$(\epsilon, \dot \epsilon)$-space. %We have $K = G^L$ and
Under conjugation by $L$, the complex Lie algebra $\fgg$ decomposes into
$\pm 1$-eigenspaces:
\begin{equation}\label{eq:k+p}
\fgg  = \fkk\oplus \fpp=\fkk_{\bf V} \oplus \fpp_{\bf V}.
\end{equation}
% Note that $\fgg^J$ equals the Lie algebra of $G:=\bfG^J$.
% It is well-known that
% the set $\Nil_{G}(\fgg^J)$ of nilpotent $G$-orbits in $\fgg^J$ and
% the set $\Nil_{\bfK}(\fpp)$ of nilpotent $\bfK$-orbits in $\fpp$
% correspond to
% each other via Kostant-Sekiguchi correspondence.
%Both sets are parameterized by signed Young diagrams.
Let  $\Nil_{\bfK}(\fpp)$ be the set of nilpotent $\bfK$-orbits in
$\fpp$.

\subsubsection{Parametrization}
 In this section, we explain the parameterization
of $\Nil_{\bfK}(\fpp)$.

%We use a tuple of signatures to label a signed Young diagrams:
\begin{defn}\label{def:dec.rP} Let $\Z_{\geq 0}^2$ be the set of pairs of
  non-negative integers, whose elements are called \emph{signatures}.
  For a signature $n = (n^+,n^-)$, its \emph{dual signature} is defined to be
  $\cknn:=(n^-, n^+)$.
  Define a partial order on $\bZ_{\geq 0}^2$ by
\[
  (n^+_1,n^-_1)\succeq (n^+_2,n^-_2)\quad \text{if and only if}\quad n^+_1\geq
  n^+_2 \text{ and } n^-_1\geq n^-_2.
\]
\end{defn}

Recall that a signed Young diagram is a Young diagram in which every box is labeled with a $+$ or $-$ sign in such a way that signs alternate across rows.
For a signed Young diagram which contains $n^+_i$ number of ``$+$'' signs and $n^-_i$ number of ``$-$'' signs in the $i$-th column, we will label it by the sequence
of signatures $[d_0,d_1,\cdots, d_k]$, where $k\geq -1$ and
$d_i = (n^+_i, n^-_i)$. By convention $[d_0,d_1,\cdots, d_k]$ labels the empty
diagram when $k=-1$.

The set of all signed Young diagrams will then correspond to the set
%For a signature $(n^+,n^-)\in \Z_{\geq 0}^2$, we will use $n$ to denote its sum $n^++n^-$.
%Meanwhile, we say $n_1\geq n_2$ when $n^+_1+n^-_1 \geq n^+_2+n^-_2$.
\[
  \ssP:=\bigsqcup_{k\geq -1} \set{[d_0,\cdots, d_k]\in ( \Z_{\geq
      0}^2\setminus\{(0,0)\})^{k+1}\mid d_l\succeq \ckdd_{l+1}
    \textrm{ for all }\, 0\leq l\leq k-1}.
\]

Similar to \Cref{defdo}, we define the descent map
\begin{equation}\label{dedd}
  \DD \colon \ssP \longrightarrow \ssP,
  \quad [d_0, d_{1}, \cdots, d_k]\mapsto [d_{1},\cdots, d_k].
\end{equation}


%For any nilpotent $K$-orbits  $\cO\in \NilP$.

% Let   is parameterized by signed
% Young diagram.  For an signed Young diagram $\bfdd$, let $[c_k,\cdots, c_0]$ be the list of
% the lengths of columns in the underlying diagram.
% Each $c_k$ is viewed as a sign, i.e. an element in $\bN^2$.
% Let
% \[ \lsign{\bfdd} := (\lnn+{\bfdd},\lnn-{\bfdd}):=  c_k := (c_k^+, c_k^-)
% \]
% be the sign of the most left column
% of $\cO$.


% \subsubsection{Parametrization of real nilpotent orbits and nilpotent $\bfK$-orbits in $\fpp$.}


%\subsubsection{Nilpotent $\bfK$-orbits in $\fpp$.}



% \begin{defn}\label{def:dec.rNG}
% Let $\sOr\in \Nil_{G}(\fgg^J)$, $e\in \sOr$ and $\bfV' := e\bfV\subset \bfV$ with the form
% $\inn{}{}_{\bfV'}$ defined by \eqref{eq:dform}.
% Set $J' :=  J|_{\bfV'}$ so that $J'$ is a $(-\dot \epsilon)$-real form of $\bfV'$. Set $k=\depth(\cO)$. We define the signatures $c_0,c_{1},...,c_k$ inductively: $c_0 = \sign{\bfV} - \sign{\bfV'}$, and likewise $c_{1}$ by considering the nilpotent element $e':= e|_{\bfV'}$, and so on. The parametrization map $\ssD \colon \Nil_{G}(\fggR) \longrightarrow \ssP$ is then given by
% $\cO\mapsto [c_0, c_1,\cdots, c_k]$.
% \end{defn}

\begin{defn}\label{def:dec.sNG}
  Given $\sO\in \Nil_{\bfK}(\fpp)$, pick any $X\in \sO$.
  Set $\depth(\sO) := \depth(X)$ (see \cref{eq:E.depth}) and define the signed Young
  diagram
  \[
    \ssdd_\sO:= [d_0,\cdots, d_k], \qquad (k:=\depth(\sO)\geq -1)
    \]
    where
    \[
   d_l:= \sign{\Ker(X^{l+1})/\Ker(X^{l})}, \quad \textrm{for all }\, 0\leq l\leq k.
    \]
\end{defn}

We parameterize $\Nil_{\bfK}(\fpp)$ via the injective map (\emph{cf}. \cite{DKP2})
\[
\ssD \colon
\Nil_{\bfK}(\fpp) \longrightarrow  \ssP,\quad \sO\mapsto \ssdd_\sO.
\]

\subsubsection{Stabilizers}\label{sec:KX}
Let $\slt$ be the complex Lie algebra consisting of $2\times 2$ complex matrices
of trace zero. Write

%Let $\Jslt$ be the complex conjugation on $\slt$,
$$
\Lslt := \begin{pmatrix}\phantom{-}0 & 1 \\-1 & 0 \end{pmatrix}\quad \textrm{and}\quad
\Xslt := \begin{pmatrix}1/2 & \phantom{-} \mathbf i/2 \\ \mathbf i/2 & -1/2 \end{pmatrix}.
$$
Let $\sO\in \Nil_{\bfK}(\fpp)$ with $\ssD(\sO) =[d_0,\cdots, d_k]$ and pick any
element $X\in \sO$.  By \cite{Se} (also see \cite[Section~6]{Vo89}), there is a
Lie algebra homomorphism (unique up to $\bfK$-conjugation)
\[
\phik\colon \slt \rightarrow \fgg
\]
 such that
 \begin{itemize}
 \item
 $\phik$ intertwines the conjugation of $\Lslt$ on $\slt$ and the conjugation of $L$ on $\fgg$; and
 \item
$\phik(\Xslt)=X$;

 \end{itemize}
We call $\phik$ an $L$-compatible $\slt$-triple attached to $X$.




%Characteristic cycles and wave front cycles of representations of reductive Lie groups
\medskip

For each $l\geq 0$, let
  $\phi_l\colon \SL_2(\bC)\rightarrow \GL_{l+1}(\bC)$ denote an irreducible
  representation of $\SL_2(\bC)$ realized on $\bC^{l+1}$. Fix an $\SL_2(\bC)$-invariant $(-1)^l$-symmetric non-degenerate  bilinear form $\inn{}{}_{l}$ on $\bC^{l+1}$.
As an $\slt$-module via $\phik$, we have
\begin{equation}\label{eq:Vl.1}
\bfV = \bigoplus_{l=0}^{k} \bfV`l \otimes_\bC \bC^{l+1},  \qquad (k:=\depth(\sO)\geq -1)
\end{equation}
where $\bC^{l+1}$ is viewed as an $\slt$-module via the differential of $\phi_l$, and
\[
\bfV`l := \Hom_{\slt}( \bC^{l+1},\bfV)
\]
is the multiplicity space.


    Let
  $$
  L_l := (-1)^{\floor{\frac{l}{2}}}\, \phi_l(\Lslt).
  $$
   Then
  $(\bC^{l+1}, L_l)$ is a $((-1)^l,(-1)^l)$-space and the $L_l$-stable subspace
  %$\Ker(\rdd\phi_l(\Xslt))$
  $$
   (\bC^{l+1})^{\Xslt}:=   \{v\in \bC^{l+1}\mid \Xslt \cdot v=0\}
   $$
  has signature $(1,0)$.

 % Let $$
  %E := \begin{pmatrix}0 & 1\\ 0 &0\end{pmatrix}, \quad F :=\begin{pmatrix}0&
   % 0\\1& 0\end{pmatrix}\quad \textrm{and}\quad H:= \begin{pmatrix}1& 0 \\ 0&-1 \end{pmatrix}
    %$$ be
 % the standard $\fsl_2$-triple in $\fsl_2(\bC)$.
  %Realize the representation $\sp_l$ on $\bC^{l+1}$ with standard basis
  %$\set{e_0,\cdots, e_{l}}$ such that
  %\[
 % E\cdot e_0 = 0,\quad E\cdot e_k = e_{k-1}, \quad \textrm{
  %for all }\, k=1, 2, \cdots, l,
  %\]
    %and
     %\[
     %H\cdot e_k = (l-2k)e_k,\quad \textrm{ for all }\, k=0,1, \cdots,  l.
     %\]
     % Fix an $\slt$-invariant
  %$(-1)^l$-symmetric bilinear form $\inn{}{}_{\sp_l}$ on $\bC^{l+1}$ such that
  %\[
  %\inn{e_0}{e_l}_{\sp_l} =a:=(-1)^{\floor{\frac{l}{2}}}.
  %\]



  Define the $(-1)^l\epsilon$-symmetric bilinear form $\inn{}{}_{\bfV`l}$ on ${\bfV`l}$ by requiring that
  \[
  \inn{}{}_{\bfV} = \bigoplus_l
  \inn{}{}_{\bfV`l}\otimes \inn{}{}_{l}.
  \]
  Define
  \[
  \L`l(T):= L\circ T \circ L_l^{-1},\quad\textrm{
for all }\, T\in \bfV`l=\Hom_{\slt}(\bC^{l+1},\bfV).
\]
 It is routine
to check that $(\bfV`l, \L`l)$ is a $((-1)^l \epsilon,(-1)^l\dot
\epsilon)$-space and it has signature  $d_{l} - \ckdd_{l+1}$ if $l$ is even and
has signature $\ckdd_l - d_{l+1}$ if $l$ is odd.


\medskip
Let $\bfK_X:=\Stab_{\bfK}(X)$ be the stabilizer of $X$ in $\bfK$, and $\bfR_X$ the stabilizer of $\phik$ in $\bfK$.
%its subgroup consisting of those elements in $\bfK_X$ stabilizing the decomposition \cref{eq:Vl.1}.
Then $\bfK_X = \bfR_X\ltimes \bfU_X$,
  where $\bfU_X$
  denotes the unipotent radical of $\bfK_X$.

Set $\KK`l := (\bfG_{\bfV`l})^{\L`l}$. Using the decomposition \cref{eq:Vl.1}, we get the following lemma from the discussion above.

\begin{lem}\label{lem:KX1}
 There is a canonical isomorphism
 \[
   \bfR_X \cong \prod_{l=0}^k \KK`l .
 \]
 % \qed
\end{lem}
% \begin{proof}
% The lemma then follows.
% \end{proof}

%{\trivial[]{
%Let $C$ be the Cayley transform.
%Realize the representation $\sp_l$ on $\bC^l$ as above.  $\Xslt = CEC^{-1}$.
%So $\Ker(\sp_l(\Xslt)) = C\Ker(\sp_l(E)) = \sspan{C e_0}\cong \sspan{e_0}$. The signature is
%determined by the $C^{-1}\phi_l(\Lslt)C = \phi_l(\exp(\pi/2*\diag(i,-i))) =
%\exp(\pi/2*\diag(li, l-2i, \cdots, -l i))$.  Let $a$ be the above, it is clear that
%$a \phi_l(\Lslt)$ has the property that the first entry is either $1$ or $i$,
%i.e. $\sign{\Ker(\sp_l(\Xslt))} = (1,0)$.
%On each $\sp_l$, we fix a $(-1)^l$-symmetric $\slt$-invariant non-degenerate
%bilinear form $\inn{}{}_{\sp_l}$.
%Equip $\sp_l$ a $((-1)^{l-1},(-1)^{l-1})$-space structure $(J_l,L_l)$ such that
%$\sign{\Ker(\sp_l(\Xslt))} = (1,0)$.

%Then
%the space $\bfV`l$ has a $\eps`l$-symmetric form $\inn{}{}_{\bfV`l}$ so that
%\[
%\inn{v_1\otimes a_1 }{v_2\otimes a_2}_{\bfV} = \inn{v_1}{v_2}_{\bfV`l}\otimes \inn{a_1}{a_2}_{\sp_l}
%\]

%Moreover, the real form $J$ and Cartan involution $L$ induce in a natural way a real
%form $\J`l(T):=J\circ T \circ \Jslt^{-1}$ and Cartan involution $\L`l(T):= L
%\circ T \circ L_l^{-1}$ on the multiplicity space $\Hom_{\slt}(\sp_l,\bfV)$.

%Note that $\J`l^2 = c_J $ since $\Jslt^2 = 1$. The signature of $\bfV`l$ is
%given by (setting $c_{k+1} = (0,0)$)


%\[
%\sign{\bfV`l, \J`l}:= c_{l} - \ckcc_{l+1} \in \Z_{\geq 0}^2.
%\]

%Note that the datum $(\eps`l, c_J,\sign{\bfV`l, \J`l})$ uniquely determines
%the real form $\J`l$ of $\bfV`l$.  Let $\bfG`l:= \rU(\bfV`l)$ and
%$^{l}\bfK :=\bfG`l^{\L`l}$. Then the isomorphism type of $\G`l:=\bfG`l^{\J`l}$
%and $^{l}\bfK$ may be read off explicitly using \Cref{tab:realforms,tab:sign}.
%}



Let $A:= G/G^{\circ}$ be the component group of $G$, where $G^\circ$ denotes the identity connected component of $G$. It is isomorphic to the
component group of $\bfK$ and is trivial unless $G$ is a real orthogonal group.

Suppose we are in the case when $G= \rO(p,q)$ ($p,q\geq 0$) is a real orthogonal group.  Then $\bfK =\rO(p,\bC)\times \rO(q,\bC)$ is a product of two complex orthogonal groups.
For every pair $\eta:=(\eta^+, \eta^-)\in \Z/2\Z \times \Z/2\Z$,  let $\sgn^\eta$ denote the character $\det^{\eta^+}\boxtimes
\det^{\eta^-}$ of $\rO(p,\bC)\times \rO(q,\bC)$,  where ${\det}$ denotes the sign character of an orthogonal group. It obviously induces characters on $\rO(p)\times \rO(q)$, $\rO(p,q)$ and $A$, which are still denoted by $\sgn^\eta$.  Then
\[
  \Z/2\Z \times \Z/2\rightarrow \widehat A,\quad \eta\mapsto \sgn^\eta
\]
is a surjective homomorphism. Here and henceforth,  ``$\widehat{\phantom A}$" indicates the  group of characters of a finite abelian group.



% Let $\sgn^\eta$ be a character of $G$ trivial on $G^\circ$, where $\eta \in \mu_2 \times \mu_2$.
% Suppose $

We record the following lemma.

\begin{lem}\label{lem:char.res}
  Suppose $G = \rO(p,q)$ ($p,q\geq 0)$.  Write $
  \sign{\bfV`l}=(\pp`l^+,\pp`l^-) $ for $0\leq l\leq k$.  Then there is an obvious isomorphism
\begin{equation}\label{isoo}
\KK`l \cong
\begin{cases}
\rO(\pp`l^+,\bC)\times \rO(\pp`l^-,\bC), & \text{if $l$ is even};\\
\GL(\pp`l^+,\bC), & \text{if $l$ is odd}.
\end{cases}
\end{equation}
% \begin{enumT}
% \item,
%   $\G`l\cong \rO(\pp`l^+,\pp`l^-)$ and $^{l}\bfK \cong;
% \item if $l$ is odd, $\G`l\cong \Sp(\pp`l,\bR)$ and $^{l}\bfK \cong \GL(\pp`l^+,\bC)$ where $\pp`l =
%   2\pp`l^+ = 2\pp`l^-$ is the dimension of $\bfV`l$.
% \end{enumT}
Moreover for $\eta:=(\eta^+, \eta^-)\in  \Z/2\Z \times \Z/2\Z$, the character $\sgn^\eta$ of $\bfK$ has trivial restriction to  $\bfU_X$, and with respect to the isomorphism \eqref{isoo},
\[
\sgn^\eta |_{\KK`l} =
\begin{cases}
{\det}^{\eta^+}\boxtimes {\det}^{\eta^-}, & \text{if $l$ is even};\\
1, & \text{if $l$ is odd}.
\end{cases}
\]

% Let $\hatA=\mu_2 \times \mu_2
% \twoheadrightarrow \widehat{\A`l}$ be the natural quotient which is
% \begin{enumT}
% \item the identity map if
% $\pp`l^+>0$ and $\pp`l^->0$,
% \item the projection to the first component if
% $\pp`l^+>0$ and $\pp`l^-=0$,
% \item the projection to the second component if
% $\pp`l^+=0$ and $\pp`l^->0$, and
% \item the projection to the trivial group if $\pp`l^+=0$ and $\pp`l^-=0$
% \end{enumT}
% Let $\bareta$ denote the image of $\eta$ under the above quotient. Then $\sgn^\eta|_{^{l}\bfK} = \sgn^{\bareta}$.
\end{lem}

\begin{proof}
The first assertion follows by using
\Cref{tab:sign}. Since $\bfU_X$ is unipotent, it has no nontrivial algebraic character. Thus  $\sgn^\eta$ of $\bfK$ has trivial restriction to  $\bfU_X$. The last assertion of the lemma is routine to check, which we omit.
\end{proof}

\subsection{Dual pairs, descent and lift of nilpotent orbits}\label{sec:descent}

\begin{defn}[Dual pair]\label{def:DP}
\begin{enumT}
\item A \emph{complex dual pair} is a pair consisting of an $\epsilon $-symmetric
  bilinear space and an $\epsilon '$-symmetric bilinear space, where
  $\epsilon ,\epsilon '\in \set{\pm1}$ with $\epsilon \epsilon '=-1$.
\item  A \emph{rational dual pair} is a pair consisting of an $(\epsilon,\dotepsilon)$-space
  and an $(\epsilon',\dotepsilon')$-space, where
  $\epsilon, \epsilon', \dotepsilon, \dotepsilon' \in \set{\pm1}$ with
  $\epsilon\epsilon'= \dotepsilon\dotepsilon'=-1$.
\end{enumT}
\end{defn}


%\begin{defn}\label{def:W}
  Let $(\bfV,\bfV')$ be a complex dual pair.
  % \begin{enumT}
  % \item
  Define a $(-1)$-symmetric bilinear space
  \[
    \bfW := \Hom_\bC(\bfV,\bfV'),
    \]
     with the form
     \[
    \innw{T_1}{T_2} := \tr(T_1^\mstar T_2), \qquad\textrm{for all }T_1,T_2\in \bfW.
  \]
  Here
  $\xymatrix{ \mstar\colon \Hom_{\bC}(\bfV,\bfV') \ar[r]^<>(.5){\cong} &
    \Hom_{\bC}(\bfV',\bfV) }$ is the adjoint map induced by the non-degenerate
  forms on $\bfV$ and $\bfV'$:
  \[
    \inn{Tv}{v'}_{\bfV'} = \inn{v}{T^\mstar v'}_{\bfV},  \qquad\textrm{for all }v\in
    \bfV,v'\in \bfV', T\in \Hom_{\bC}(\bfV,\bfV').
  \]
  The pair of groups $(\bfG,\bfG'):=(\bfG_{\bfV},\bfG_{\bfV'})$ is a
  \emph{complex reductive dual pair} in $\Sp(\bfW)$ in the sense of Howe \cite{Howe79}.



  Further suppose that $(\bfV, J,L)$ and $(\bfV', J',L')$ form a rational dual pair.
  Then the complex symplectic space $\bfW = \Hom_\bC(\bfV,\bfV')$ is naturally
   a $(-1,-1)$-space by defining
  \[
  \J_{\bfW}(T):= J'\circ T\circ J^{-1}\quad \textrm{and}\quad
  L_{\bfW}(T):= \dotepsilon \; L' \circ T \circ L^{-1}, \qquad  \textrm{for all } T\in \bfW.
  \]
The pair of groups $(\GVr,\GVar) = (\bfG_{\bfV}^{J},\bfG_{\bfV'}^{J'})$ is then
a (real) reductive dual pair in $\Sp(W)$, where $W:=\bfW^{J_{\bfW}}$.


  \trivial[h]{ If one switch the role of $\bfV$ and $\bfV'$ the form on
    $\inn{}{}_{\bfW}$ will switch the sign, i.e $\tr(T^\mstar T) = -
    \tr((T^\mstar)^\mstar (T^\mstar))$.  Also note that $(J' T J^{-1})^\mstar = J T^\mstar J'^{-1}$ and
    $(L'TL^{-1})^\mstar = L T^\mstar L'^{-1}$. Hence, once we verified $(J'
    \bullet J^{-1}, L' \bullet L^{-1})$ satisfies \Cref{lem:cartan} for
    $\dotepsilon =1$. Then $(J'
    \bullet J^{-1}, - L' \bullet L^{-1})$ satisfies \Cref{lem:cartan} when
    $\dotepsilon = -1$.

    Retain the constructions in the
    appendix, we check the claim case by case.

    Consider the real orthogonal-symplectic case. Take the
    decomposition $\bfV = \bfV_1 \oplus \bfV_{-1}$ and suppose
    $\sign{\bfV} = (n^+,n^-)$. Then
    $\bfW \cong \bfV'^{\oplus n^+}\oplus \bfV'^{\oplus n^-}_{-}$ as formed space
    (to see this fix orthonormal basis $\set{e_j}$ of $\bfV_{1}$ then
    $\tr(T^\mstar T) = \sum \inn{Te_j}{Te_j}$ ), the $J_\bfW$ action is just
    complex conjugation. the $L_\bfW$ action is
    $L_{\bfV'}^{\oplus n^+} \oplus -L_{\bfV'}^{n^-}$. Hence $\inn{J_\bfW
      \;\bullet }{L_\bfW \;\bullet }_\bfW$ is positive definite.

    Now consider the quaternion group case.
    Again assume $\dotepsilon  = 1$, WLOG, assume $\bfV = \bfV_1 = \bD$.
    Now $\bfW = \bfV'\oplus \bfV'$ by $T\mapsto (T(1), T(\bfjj)) = (v'_1,v'_2)$.
    $J_\bfW (v'_1,v'_2) = (-J' v'_2, J' v'_1)$ and $L_\bfW(v'_1,v'_2) = (-L'
    v'_2, L' v'_1)$. Since $(J',L')$ satisfies \Cref{lem:cartan},
    $(J_\bfW,L_\bfW)$ also satisfies \Cref{lem:cartan}.
}

  \medskip

  For the rest of this section, we work in the setting of rational dual pairs and introduce a notion of descent and lift of
  nilpotent orbits in this context.

\subsubsection{Moment maps}
\label{sec:dpmm}
We define the following \emph{moment maps} $\MM$ and $\MM'$ with respect to a complex dual pair
$(\bfV,\bfV')$:
  \[
    \xymatrix@R=0em@C=4em{
      \fgg &\ar[l]_<>(.5){\MM} \bfW \ar[r]^<>(.5){\MM'} & \fgg',\\
      T^\mstar T & \ar@{|->}[l] T \ar@{|->}[r] & T T^\mstar.
    }
  \]
%\end{itemize}

When we have a rational dual pair, we decompose
\[%\begin{equation}\label{eq:XY}
\bfW = \cX\oplus \cY
\]%\end{equation}
where $\cX$ and $\cY$ are $+\bfii$ and $-\bfii$ eigenspaces of $L_{\bfW}$,
respectively. Restriction on $\cX$ induces a pair of maps (see \eqref{eq:k+p}
for the definition of $\fpp$ and $\fpp'$):
  \[
    \xymatrix@R=0em@C=6em{
      \fpp &\ar[l]_<>(.5){\MMP:=\MM|_{\cX}} \cX \ar[r]^<>(.5){\MMP':=\MM'|_{\cX}} & \fpp',
  %    T^\mstar T & \ar@{|->}[l] T \ar@{|->}[r] & T T^\mstar.
    }
  \]
  which are also called \emph{moment maps} (with respect to the rational dual
  pair). By classical invariant theory (see \cite{Weyl} or
  \cite[Lemma~2.1]{NOZ}), the image $M(\cX)$ is Zariski closed in $\fpp$, and
  the moment map $M$ induces an isomorphism
\begin{equation}\label{clinv}
\bfK'\backslash\!\backslash  \cX\cong M(\cX)
\end{equation}
of affine algebraic varieties, where $\bfK'\backslash\!\backslash \cX$ denotes
the affine quotient.\footnote{See \cite[Section~4.4]{PV} for the definition of
  affine quotient.} Thus \cite[Corollary 4.7]{PV} implies that $M$ maps every
$\bfK'$-stable Zariski closed subset of $\cX$ onto a Zariski closed subset of
$\fpp$. Similar statement holds for $M'$. We will use these basic facts freely.

% \begin{itemize}[resume]
% \item Let
%   \[
%     W := \bfW^{J_{\bfW}}
%   \]
%   Then $(G,\G')$ is a (real) reductive dual pair in $\Sp(W)$ in the sense of Howe.
%  \item Let \[
% \bfW = \cX\oplus \cY \quad \text{where } \cX := \bfW^{L_\bfW,i} \text{ and }\cY :=
% \bfW^{L_{\bfW},-i}
% \] be the eigenspace decomposition of $L_\bfW$. This gives a polarization of $\bfW$.
%\item We have
% \[M(W)\subseteq \fggR, \text{ and } M'(W)\subseteq \fgg'_{\bR},\]
% and
%\end{itemize}
%\end{enumT}
%\end{defn}

\subsubsection{Lifts and descents of nilpotent orbits}\label{sec:LD}

% The following definition is justified by the results in \cites{DKP2,Ohta4}.
% \begin{defn}


% \begin{defn}\label{def:LD.2}
% \begin{enumT}
% \item
% We retain the notation in \Cref{}
% Let $(\bfV,\bfV')$ be a complex dual pair. Assume that $\dim(\V)\geq \dim (\bfV')$.
Let
\begin{equation*}
\bfWo := \set{T \in \bfW | T \text{ is a surjective map from $\bfV$ onto $\bfV'$}}.
\end{equation*}
Clearly $\bfWo\neq \emptyset$ only if $\dim \bfV\geq \dim \bfV'$.


Suppose $\bfee\in \cO \in \Nil_{\bfG}(\fgg)$ and
$\bfee'\in \cO' \in \Nil_{\bfG'}(\fgg')$.  We call $\bfee'$ (resp. $\cO'$) a
descent of $\bfee$ (resp. $\cO$), if there exits  $T\in \bfWo$ such that
$$
\MM(T) = \bfee\quad\textrm{and}\quad \MM'(T) = \bfee'.
$$
Put $$\Xo := \bfW^\circ \cap \cX,$$
 and write $\bfK:=\bfK_{\bfV}$ and $\bfK':=\bfK_{\bfV'}$. Suppose $X\in \sO \in \Nil_{\bfK}(\fpp)$ and
$X'\in \sO' \in \Nil_{\bfK'}(\fpp')$.  We call $X'$ (resp. $\sO'$) a
descent of $X$ (resp. $\sO$), if there exits
$T\in \Xo$ such that
$$
\MMP(T) = X\quad\textrm{and}\quad \MMP'(T) = X'.
$$
In all cases, we will say that $T$ realizes the descent, and $\cO$ (resp. $\sO$) is the lift of $\cO'$ (resp. $\sO'$).
In the notation of \Cref{defdo}, we then have
\[
\DDc(\bfdd_{\cO}) = \bfdd_{\cO'}\quad\textrm{ and }\quad \DD(\ssdd_{\sO}) = \ssdd_{\sO'}.
\]
Hence the notion of descent (for nilpotent orbits) defined here agrees with  that of \Cref{defdo} and \eqref{dedd} (for Young diagrams).
We will thus write
\[
\cO' = \DDc(\cO)=\DDc_{\bfV, \bfV'}(\cO)\quad \textrm{and}\quad  \sO' = \DD(\sO)=\DD_{\bfV, \bfV'}(\sO).
\]
We record a key property on descent and lift:
\begin{equation}\label{eq:def.LsO22}
\MM(\MM'^{-1}(\bcOp)) = \bcO \quad \text{and} \quad
\MMP(\MMP'^{-1}(\bsOp)) = \bsO,
\end{equation}
where ``$\;\overline{\phantom{m}}\;$'' means taking Zariski closure. This is checked by
using explicit formulas in \cite{KP,DKPC} (for complex dual pairs) and
\cite[Lemma~14]{Ohta} (for rational dual pairs).


In fact by \cite[Theorem 1.1]{DKPC}, the notion of lift can be extended to an arbitrary complex dual pair and  an arbitrary complex nilpotent orbit: for any $\cO'\in \Nil_{\bfG'}(\fgg')$, $\MM(\MM'^{-1}(\bcO'))$ equals to the closure of a
 unique nilpotent orbit $\cO \in \Nil_{\bfG}(\fgg)$. We call $\cO$ the \emph{theta lift} of $\cO'$, written as
 \begin{equation}
 \label{def:LC}
  \cO=\oliftc_{\bfV',\bfV}(\cO').
 \end{equation}
%We will also say $\sO'$ is in the domain of theta lift of nilpotent orbits with respect to the rational dual pair $(\bfV',\bfV)$ and similarly write
%\begin{equation}\label{eq:def.LsO}
  %\sO = \olift_{\bfV',\bfV}(\sO').
%\end{equation}

%\begin{remark}
%The maps $\vartheta_{\bfV',\bfV}$ and $\vartheta_{\bfV,\bfV'}$ are not the mutually inverse maps. In fact, for most of
%$\cO'\in \Nil_{\bfG'}(\fgg')$, $\vartheta_{\bfV',\bfV}(\vartheta_{\bfV,\bfV'}(\cO'))\neq \cO'$.
%\end{remark}

\subsubsection{Generalized descent of nilpotent orbits}
\label{def:GD}
Let
\[
\bfWg := \set{T \in \bfW| \text{the image of $T$ is a
      non-degenerate subspace of $\bfV'$}}
\]
and
\[
  \Xg:= \bfWg\cap \cX.
\]
Suppose $X\in \sO \in \Nil_{\bfK}(\fpp)$ and
$X'\in \sO' \in \Nil_{\bfK'}(\fpp')$.  We call $X'$ (resp. $\sO'$) a
generalized descent of $X$ (resp. $\sO$), if there exits
$T\in \Xg$ such that
$$
\MMP(T) = X\quad\textrm{and}\quad \MMP'(T) = X'.
$$
As before, we say that $T$ realizes the generalized descent.

 It is easy to see that for each  nilpotent orbit $\sO\in \Nil_{\bfK}(\fpp)$,
 the following three assertions are equivalent (\emph{cf.} \cite[Table~4]{DKP2}).
 \begin{itemize}
 \item
   The orbit $\sO$ has a generalized descent.
   \item
  The orbit  $\sO$ is contained in the image of the moment map $M$.
  \item
  Write $\ssdd_\sO = [d_0, d_1, \cdots, d_k]\in \ssP$, then
  $$\sign{\bfV'}  \succeq \sum_{i=1}^{k} d_i.$$
  \end{itemize}
  When this is the case,   $\sO$ has a unique generalized
descent $\sO'\in \Nil_{\bfK'}(\fpp')$, and
  \begin{equation}\label{eq:GD}
\ssdd_{\sO'} = [d_{1}+s, d_{2}, \cdots, d_k], \quad \textrm{where } \, s:= \sign{\bfV'} - \sum_{i=1}^{k} d_i.
\end{equation}
We write $\sO' = \gDD_{\bfV,\bfV'}(\sO).$ On the other hand, different nilpotent
orbits may map to a same nilpotent orbit under $\gDD_{\bfV,\bfV'}$.
\trivial[h]{
Using  \cite[Table~4]{DKP2} or the observation that $M^{-1}(X)\cap \Xg$ is the
unique closed
$\bfK'$-orbit in $M^{-1}(X)$ for an element $X\in \sO$, we see that
$\sO'$ is the minimal
$\bfK$-orbit in $M'(M^{-1}(\sO))$ and \cref{eq:GD.min} holds.
}
\trivial[h]{
To show the equation \Cref{eq:GD}, it suffices to consider the descent case,
i.e. when $s = (0,0)$.

Fix a $T\in \cX^\circ \subset \Hom(\bfV,\bfV')$ realizing the descent.
Fix a $L$ invariant decomposition $\bfV = \Ker(X) \oplus \bfY$. $T|_\bfY$ is an
isomorphism.
It suffices to check that $\sign{\bfY} = \sign{\bfV'}$.
This is clear since $\dotepsilon L' T L^{-1}  = \bfii\, T$.  (If $v\in
\bfY^{L, \pm 1}$, then $L' T v = \pm L' T  L^{-1} v = \pm \bfii\, Tv$,
i.e. $v\in \bfV'^{L', \pm \bfii}$. Similarly, If $v\in
\bfY^{L, \pm \bfii}$, then $L' T v = \mp\bfii L' T  L^{-1} v = \mp\bfii \bfii\,
Tv = \pm Tv$,
i.e. $v\in \bfV'^{L', \pm 1}$.
}

Analogously, suppose $\bfee\in \cO\in \Nil_{\bfG}(\fgg)$ and
$\bfee'\in \cO' \in \Nil_{\bfG'}(\fgg')$.  We call $\bfee'$ (resp. $\cO'$) a generalized descent of $\bfee$ (resp.
$\cO$), if there exits an element  $T\in \bfWg$ such that
\[
\MM(T) = \bfee \quad\textrm{and}\quad \MM'(T) = \bfee'.
\]
When this is the case, $\cO'$ is determined by $\cO$ and we write $\cO' = \gDDc_{\bfV,\bfV'}(\cO)$.



  \begin{lem}\label{gendec}
  Assume that $\sO\in \Nil_{\bfK}(\fpp)$ has a generalized descent $\sO'\in \Nil_{\bfK'}(\fpp')$. Let $X\in \sO$ and $T\in \Xg$ such that $M(T)=X$. Then $\bfK'\cdot T$ is the unique closed $\bfK'$-orbit in $M^{-1}(X)$. Moreover,     \begin{equation}\label{eq:GD.min}
\sO' =
M'(M^{-1}(\sO))\cap \CO'=M'(M^{-1}(\sO))\cap \overline{\CO'},
\end{equation}
where $\CO':=\bfG'\cdot \sO'$, which is the generalized descent of $\CO:=\bfG\cdot \sO$.
  \end{lem}
  \begin{proof}
 It is elementary to check that $\bfK'\cdot T$ is Zariski closed in $\cX$.  Then the first assertion follows by using the isomorphism \eqref{clinv}. Note that $\sO'$ is the only $\bfK'$-orbit in
 $\overline{\CO'}\cap \fpp'$ whose Zariski closure contains $\sO'$.
  Thus the first assertion implies the second one.
    \end{proof}





\medskip

In this article, we will need to consider the following special types of nilpotent orbits.

\begin{defn}\label{def:GD.good}
  A nilpotent oribit $\cO \in \Nil_{\bfG}(\fgg)$ with $\rdd_\cO = [c_0, c_{1} \cdots, c_k]
  \in \cP_\epsilon$
  is said to be good for generalized descent if $k\geq 1$ and $c_0 = c_{1}$.  A nilpotent
  orbit $\sO \in \Nil_{\bfK}(\fpp)$ is said to be  \emph{good} for generalized descent if
  the  nilpotent orbit  $\bfG \cdot \sO\in \Nil_{\bfG}(\fgg)$ is  good for generalized descent.
\end{defn}

The following lemma exhibits a certain maximality property of nilpotent orbits which are good for generalized descent.
\begin{lem}\label{lem:GDS.set}
 If $\cO\in \Nil_{\bfG}(\fgg) $ is good for generalized descent, and
  $\cO' = \gDDc_{\bfV,\bfV'}(\cO)$, then
  $\MM(\MM'^{-1}(\bcOp)) = \bcO$. Consequently, if $\sO\in \Nil_{\bfK}(\fpp)$ is good for generalized descent and
  $\sO' = \gDD_{\bfV,\bfV'}(\sO)$, then $\sO$ is an open $\bfK$-orbit in
  $\MMP(\MMP'^{-1}(\bsOp))$.
\end{lem}

%\begin{remark}
%Good geometric properties of good orbits (\Cref{lem:GDS.sh}) will play a crucial role in \Cref{prop:GDS.AC}.
%\end{remark}

\begin{proof}
This is easy to check using the explicit description of
$\MM(\MM'^{-1}(\bcO'))$ in \cite[Theorem~5.2 and 5.6]{DKPC}. % \cite[]{DKP2}).
\end{proof}


%\subsubsection{Extending to $\slt$-modules}
% We now extend the notion of descent to $\slt$ homomorphisms, \Cref{sec:KX}.

% \begin{defn}
%   \begin{enumT}
%   \item \label{it:dec.slt1} Let $(\bfV, \bfV')$ be a rational dual pair.  Let
%     $\gamma =\set{\bfee,\bfhh,\bfff}$ be an $\slt$-triple in $\fgg$ and let
%     $\gamma '=\set{\bfee',\bfhh',\bfff'} $ be an $\slt$-triple in $\fgg'$.
%     % let $\phi\colon \slt\rightarrow \fgg$ be the corresponding Lie algebra
%     % morphism.
%     % let $\phi'\colon \slt\rightarrow \fgg'$ be the corresponding Lie algebra
%     % morphism.
%     We say the $\gamma '$ is a descent of $\gamma $ if
%     \begin{enumC}
%     \item $\bfee'$ is a descent of $\bfee$, and
%     \item there exists
%       \[
%         T\in \bfW_{1} := \set{T\in \bfW| (\bfhh,\bfhh')\cdot T = T}.
%       \]
%       realizing the descent.
%     \end{enumC}
%   \item \label{it:dec.slt2} Let $(\bfV, \bfV')$ be a rational dual pair.
%     \begin{itemize}
%     \item Let $\phi \colon \slt\rightarrow \fgg$ be a $J$-compatible morphism,
%       and $\phi ' \colon \slt\rightarrow \fgg'$ be a $J'$-compatible morphism.
%       We say $\phi '$ is a descent of $\phi $ if
%       \begin{enumC}
%       \item \label{it:dec.slt3} $\phi'(\eslt)$ is a descent of $\phi(\eslt)$,
%         and
%       \item there exists an element $T \in W_1=:W\cap \bfW_1$ realizing the
%         descent.
%       \end{enumC}
%     \item Let $\phi \colon \slt\rightarrow \fgg$ be a $L$-compatible morphism,
%       and $\phi ' \colon \slt\rightarrow \fgg'$ be a $L'$-compatible morphism.
%       We say $\phi '$ is a descent of $\phi $ if
%       \begin{enumC}
%       \item \label{it:dec.slt4} $\phi'(\Xslt)$ is a descent of $\phi(\Xslt)$,
%         and
%       \item there exists an element $T \in \cX_1=:\cX \cap \bfW_1$ realizing the
%         descent.
%       \end{enumC}
%     \end{itemize}
%   \item In all cases, we will say that $T$ realizes the descent, and we write
%     $\phi' = \DD(\phi)$.
%   \end{enumT}
% \end{defn}

% \begin{remark}
% %\begin{enumR}
% %Note that the pair $\set{\bfee,\bfhh}$ already determine an $\slt$-triple. On the other
% %hand, an arbitrary pair $(\bfee,\bfhh)$ where $\bfee$ is nilpotent, $\bfhh$ is semisimple and
% %  $[\bfhh,\bfee]=2\bfee$ may not come from an $\slt$-triple in general.
% Suppose $\bfee'$ is a descent of $\bfee$ realized by $T\in \bfWo$. Given an $\slt$-triple $\set{\bfee,\bfhh,\bfff}$, we define $\bfhh'\in \fgg'$ by
%   $\bfhh'(T(v)) := T(\bfhh(v)) + T(v)$ for all $v\in \bfV$, so that $(\bfhh,\bfhh')\cdot T = T$. One checks that pair
%   $(\bfee',\bfhh')$  extends to an $\slt$-triple $\set{\bfee',\bfhh',\bfff'}$ and thus descent of a nilpotent orbit can always be extended to descent of the corresponding $\slt$-triple\footnote{There is no clean formula for $\bfff'$ but its existence is clear by examining the decomposition in \Cref{eq:Vl.1}. See discussions in \cite{DKP2}.}.
%   Similar statements hold for rational descents.
% \end{remark}

% The arguments in \cite[Section~8]{DKP2} (for stable range case) extends naturely to the descent of nilpotent
% orbit case. Hence we have the compatibility of descent and Kostant-Sekiguchi correspondence:
% \begin{lem}
%   Suppose $\sOr'\in \Nil_{G'}(\fgg'_{\R})$, $\sOr\in \Nil_{G}(\fgg_{\R})$, $\KS{\sOr'}=:\sO'\in \Nil_{\bfK'}(\fpp')$ and
%   $\KS{\sOr}=:\sO\in \Nil_{\bfK}(\fpp)$.
%   Then $\DD {\sOr}  = \sOr'$ if and only if $\DD {\sO} = \sO'$, i.e.
%   \[
%     \DD{\KS{\sOr}} = \KS{\DD{\sOr}}.
%   \]
%   \qed
% \end{lem}


\trivial[h]{An alternative proof: Let $\phi \colon \slt\rightarrow \fgg$ be a $(J,L)$-compatible morphism realizing the Kostant-Sekiguchi correspondence of $\cO$ with $\KS{\cO}$.
Let $\phi'$ be a $J$-compatible descent of $\phi$, realized by an element $T\in W_1$. By conjugating with an element of $G'$ if necessary, one may assume that $\phi'$ is $(J',L')$-compatible.
From the $\slt$-morphisms, we define the Cayley elements
\[
C := \phi(\cslt)\in \bfG, \text{ and } C' := \phi'(\cslt)\in \bfG'.
\]
Let $T' = C'TC^{-1}$. Since $(C'TC^{-1})^\mstar = C T^\mstar C'^{-1}$ we see
that it realize the descent from $\phi(\Xslt)$ to $\phi'(\Xslt)$.
Now it suffices to verify that $T'\in \cX$.
Using the block decomposition \cref{eq:Vl.1}, the problem reduces to case where
$\phi(\eslt)$ is in the principle
nilpotent orbit in $\rO(n+1,n)$ or $\Sp(2n)$. This could be down by a explicit calculation, see formulas in \cite[Section~6]{DKP2}.
}

\subsubsection{Map between isotropy groups}\label{sec:alpha}
%\subsubsection{Correspondence between nilpotent orbits}


% We now review some the geometry of moment maps.

% \begin{defn}
% For any closed set $S'\subset \fpp'$, define
% \[
% \olift{S'} := M(M'^{-1}(S')).
% \]

% Suppose $\cO'$ is a nilpotent $K$-orbit in $\fpp'$, define
% \[
% \olift{\cO'} := \set{\cO | \cO \text{ is open in } \olift{\bcO'}}.
% \]

% Define $\oliftc$ and $\oliftr$ for the complex and real moment maps similarly.
% \end{defn}
% \begin{remark}
% By \cite{DKPC}, $\oliftc(\cO'_\bC)$ is always a singleton for any complex
% nilpotent orbit $\cO'_\bC$.
% On the other hand, by \cite{DKP2}, $\olift(\bcO')$ has several open orbits in
% general.
% \end{remark}




% By \Cref{lem:LM.E}, it is important to understand the set
% $\olift{\bcO'}$.







% \begin{defn}
% Define the partial order on $\bN^2$ by: $(n^+_1,_1)\succeq (\nn+_2,\nn-_2)$ iff
% $\nn+_1\geq \nn+_2$ and $\nn-_1\geq \nn-_2$.
% For $\epsilon$-Hermitian space $V$, define $\sign{V} := (\nn+{V},\nn-{V})$ as
% the following table

% \centerline{
% \begin{tabular}{c|c}
%   \hline
%   $G_\bR$ & $\sign{V}$ \\
%   \hline
%   $\rO(p,q)$ & $(p,q)$\\
%   $\Sp(2n,\bR)$ & $(n,n)$\\
%   $\rU(p,q)$ & $(p,q)$ \\
%   $\rO^*(2n)$ & $(n,n)$\\
%   $\Sp(p,q)$ & $(2p,2q)$\\
%   \hline
% \end{tabular}
% }
% The set $\NilP$ of nilpotent $K$-orbits in $\fpp$ is parameterized by signed Young
% diagram.
% For $\cO' \in \NilP$, let $[c_k,\cdots, c_0]$ be the list of length columns of the
% underlying diagram.
% Let \[
% \lsign{\cO} := (\lnn+{\cO},\lnn-{\cO})
% \]
% be the sign of the most left column
% of $\cO$.
% \end{defn}





% In our paper, we make could describe the lift of orbits explicitly.
% \begin{lem}[]
%   Suppose $\sign{V}\succ \sign{V'}$.
%   Then
%   \[
%     \RR{\fpp'}{\Xo} = \set{\cO'\in \NilP'|d(V,V') \succeq \lsign{\cO'}},
%   \]
%   where $d(V,V'):= \sign{V}-\sign{V'}$.
%   Let $\cO'\in \RR{\fpp'}{\Xo}$, then $\olift{\cO'}$ is the signed Young diagram
%   obtained by attaching $d(V,V')$ on the left of $\cO'$.

%   In particular, $\oliftc{\cO'_\bC} = (\olift{\cO'})_\bC$ corresponding to the
%   Young diagram obtained by attaching a column of $\dim V - \dim V'$ boxes on
%   the left of $\cO'_\bC$.
% \end{lem}
% \begin{proof}
%   The lemma follows immediately by \cite[Theorem~5.2 and 5.6]{DKPC} and
%   \cite[Table~4]{DKP2} (see also \cite{Ohta4} for the unitary group case.).
% \end{proof}

%For $T\in \cX$, $X\in \fpp$ and $X' \in \fpp'$, we denote corresponding isotropy subgroups by
%\[
%  \bfS_T :=
%  \Stab_{\bfK\times \bfK'}(T), \quad  \bfK_X:= \Stab_{\bfK}(X)\quad \text{and}\quad \bfK'_{X'}
%  := \Stab_{\bfK'}(X') \quad \text{respectively}.
%\]

Suppose $\sO\in \Nil_{\bfK}(\fpp)$ admits a descent $\sO'\in
  \Nil_{\bfK'}(\fpp')$. % is the descent of $\sO\in \Nil_{\bfK}(\fpp)$.
  According to
  \cite[Proposition 11.1]{KP} and \cite[Lemmas~13 and 14]{Ohta},
  $\MMP^{-1}(\sO)$
  is a single
  $\bfK\times \bfK'$-orbit contained in $\Xo$ and $\MMP'(\MMP^{-1}(\sO)) =
  \sO'$. Moreover $\bfK'$ acts on $\MMP^{-1}(\sO)$ freely.

  Fix $T\in \MMP^{-1}(\sO)$ which realizes the descent from $X := \MMP(T)\in \sO$
  to $X' := \MMP'(T)\in \sO'$. Denote the respective isotropy subgroups by
  \[
    \bfS_T :=
    \Stab_{\bfK\times \bfK'}(T), \quad  \bfK_X:= \Stab_{\bfK}(X)\quad \text{and}\quad \bfK'_{X'}
    := \Stab_{\bfK'}(X').
  \]
  Then there is a unique homomorphism
  \begin{equation}
    \label{eq:alpha}
    \alpha\colon \bfK_X \mapsto \bfK'_{X'}
  \end{equation}
  such that $\bfS_T$ is the graph of $\alpha$:
  \[
    \bfS_T = \set{(k,\alpha(k))\in \bfK_X\times \bfK'_{X'}|k\in \bfK_X}.
  \]
  % \begin{proof} \cref{it:lemM.0} amounts to the first fundamental theorem of classical invariant theory \cite{Weyl}. \Cref{it:lemM.1} and \cref{it:lemM.2} are in. \cref{it:lemM.3} is an immediate consequence of \cref{it:lemM.2}.
% \end{proof}
% \begin{lem}[{\cite{Weyl}, \cite[Proposition 11.1]{KP}, \cite[Lemmas 13 and 14]{Ohta}}]\label{lem:O1}\label{lem:DS.set}
% Suppose $(\bfV,\bfV')$ is a rational dual pair such that $\dim(\bfV)\geq \dim (\bfV')$.
% The followings hold true.
% \begin{enumT}
% \item \label{it:lemM.0} $\MMP'\colon \cX \rightarrow \fpp'$ is the affine quotient of
%   $\cX$ by the $\bfK$ action. The image of $\MMP$ is reduced and $\MMP\colon \cX \rightarrow
%   M(\cX)$ is the affine quotient of $\cX$ by the $\bfK'$ action.
% \item \label{it:lemM.1} $\MMP' \colon \Xo \rightarrow \fpp'$ is smooth and $\MMP \colon
%   \Xo \rightarrow \MMP(\Xo)$ is a locally trivial fibration with typical fiber
%   $\bfK'$.
% \end{enumT}
% Suppose further $\sO'\in
%   \Nil_{\bfK'}(\fpp')$ is the descent of $\sO\in \Nil_{\bfK}(\fpp)$. The following hold true.
% \begin{enumT}[resume]
% \item \label{it:lemM.2} % $\bfY:=\MMP^{-1}(\sO)$
%   $\MMP^{-1}(\sO)$
%   is a single
%   $\bfK\times \bfK'$-orbit  contained in $\Xo$ and $\MMP'(\MMP^{-1}(\sO)) = \sO'$. Moreover, as the scheme theoretical
%   pre-image of $\sO$, $\MMP^{-1}(\sO)$  is reduced and smooth.
% \item \label{it:lemM.3} Fix $T\in \MMP^{-1}(\sO)$ and let $X := \MMP(T)\in \sO$
%   and $X' := \MMP'(T)\in \sO'$.  Then there is a (unique) homomorphism
% \begin{equation}
% \label{eq:alpha}
% \alpha\colon \bfK_X \mapsto \bfK'_{X'}
% \end{equation}
% such that $\bfS_T$ is the graph of $\alpha$:
% \[
% \bfS_T = \set{(k,\alpha(k))\in \bfK_X\times \bfK'_{X'}|k\in \bfK_X}.
% \]
% \qedhere
% \end{enumT}
% \end{lem}
% \begin{proof} \cref{it:lemM.0} amounts to the first fundamental theorem of classical invariant theory \cite{Weyl}. \Cref{it:lemM.1} and \cref{it:lemM.2} are in \cite[Proposition 11.1]{KP} and \cite[Lemmas 13 and 14]{Ohta}. \cref{it:lemM.3} is an immediate consequence of \cref{it:lemM.2}.
% \end{proof}
The homomorphism $\alpha$ is uniquely determined by the requirement that
\[
\alpha(k)(Tv) = T(kv)\quad \textrm{ for all }v\in \bfV, \, k\in \bfK_X.
\]


\medskip

We recall the notation in \Cref{sec:KX} where $\phik$ is an $L$-compatible
$\slt$-triple attached to $X$. Let $\Hslt := \slH$. Then there is a unique
$L'$-compatible $\slt$-triple $\phikp$ attached to $X'$ such that (see \cite[Section~5.2]{GZ})
$$\phikp(\Hslt)
\circ T - T \circ \phik(\Hslt) = T.$$
As an $\slt$-module via $\phikp$,
\[
\bfV' = \bigoplus_{l\geq 0}^{k-1} \bfV`l' \otimes \bC^{l+1}.
\]
We adopt notations in \Cref{sec:KX} to $X' \in
\sO'$, via $\phikp$. In particular, we have $\bfK_X = \bfR_X \ltimes \bfU_X$ and $\bfK'_{X'} =\bfR_{X'}
\ltimes \bfU_{X'}$. Here $\bfU_X$ and $\bfU'_{X'}$ are the unipotent radicals, and $\bfR_X =
\prod_{l=0}^k {\KK`l}$ and $\bfR_{X'} = \prod_{l=0}^{k-1}{\KK`l'}$ are Levi factors
 of $\bfK_X$ and $\bfK'_{X'}$, respectively.
%which are compatible with the $\slt$-module structures on $\bfV$ and $\bfV'$ respectively.


 For each irreducible $\slt$-module $\bC^{l+1}$ fix a nonzero vector
 $v_l\in (\bC^{l+1})^{\Xslt}$.
 % \Ker(\rdd\phi_l(\Xslt))$
      For each $l\geq 0$, the map
 $\nu \mapsto \nu(v_l)$ identifies $\bfV`l = \Hom_{\slt}(\bC^{l+1},\bfV)$
 (resp. $\bfV`l'$) with a subspace $\bfV`l_0$ of $\bfV$ (resp. $\bfV`l'_0$ of
 $\bfV'$). For $1\leq l\leq k$,  $T^\mstar$ induces a vector space isomorphism\footnote{In fact, it
 is a similitude between the two formed spaces and satisfis $L\circ \tau_{l}=\bfii \,\tau_l\circ L'$.}
\[
\xymatrix@C=5em{
\tau_l\colon \bfV`{l-1}' = \bfV`{l-1}'_0 \ar[r]^<>(.5){v \mapsto T^\mstar(v)}
& \bfV`{l}_0 = \bfV`{l}.
}
\]
This results in an isomorphism (which is independent of the choices of $v_l$ and $v_{l-1}$)
\begin{equation}\label{eq:alpha_l}
    \alpha_l :  \KK`{l}   \xrightarrow{\ \ \cong \ \ }  {\KK`{l-1}'} ,\qquad h_l\mapsto (\tau_l)^{-1} \circ h_l \circ\tau_l.
\end{equation}


\medskip

%The following lemma gives a more precise description of the map $\alpha$.

\begin{lem}\label{lem:alpha.e} The homomorphism $\alpha$ maps $\bfR_X$ into $\bfR_{X'}$ and maps $\bfU_X$ into $\bfU_{X'}$. Moreover, the map
  $\alpha|_{\bfR_X}$ is given by
\[
\xymatrix@R=0em{
\flushmr{\alpha|_{\bfR_X}\colon}\prod_{l=0}^{k} {\KK`l} \ar[r]& \prod_{l=0}^{k-1} {\KK`l'},\\
(h_0, h_1, \cdots h_k) \ar@{|->}[r]& (\alpha_1(h_1),\cdots,
\alpha_k(h_k)), \quad \quad h_l\in \KK`l,
}
\]
where $\alpha _l$ ($1\leq l\leq k$) is given in \eqref{eq:alpha_l}.
\end{lem}
\begin{proof}
  Note that $\alpha$ is a surjection since $M^{-1}(X)$ is a $\bfK'$-orbit (see
  \Cref{lem:DS.sh}~\cref{it:DS.G3} or \cite[Lemma~13]{Ohta}).  So $\alpha(\bfU_X)$ is a unipotent normal
  subgroup in $\bfK'_{X'}$ which must be contained in $\bfU_{X'}$. Note that
  (see \cite[Lemma~3.4.4]{CM})
  \[ \bfR_X = \Stab_{\bfK}(\phi_\fkk(\Xslt)) \cap
    \Stab_{\bfK}(\phi_{\fkk}(\Hslt)).
\] By the defintion of $\alpha$ and
$\phi_{\fkk'}$,  we see
\[
\alpha(\bfR_X) \subset \Stab_{\bfK'}(\phi_{\fkk'}(\Xslt)) \cap
\Stab_{\bfK'}(\phi_{\fkk'}(\Hslt)) = \bfR_{X'}.
\]
The rest follows from the discussions before the lemma.
\end{proof}

Let $A$, $A_X$ and $A'_{X'}$ be the component groups of $G$, $\bfK_X$ and $\bfK'_{X'}$
respectively. We will identify $A$ with the component group of $\bfK$ and let
$\chi|_{A_X}$ denote the pullback of $\chi \in \whA$ via the natural map $A_X
\rightarrow A$.
The homomorphism $\alpha\colon \bfK_X \mapsto \bfK'_{X'}$ induces a homomorphism $\alpha\colon A_X \mapsto A'_{X'}$, which further yields a homomorphism
\[
\widehat{A'_{X'}}\rightarrow \widehat{A_{X}}, \quad \rho'\mapsto \rho'\circ\alpha.
\]

\begin{lem}\label{lem:char.surj}
The following map is surjective:
%\begin{equation}
\[
\xymatrix@R=0em{
\widehat{A} \times \widehat{A'_{X'}} \ar@{->>}[r]&  \widehat{A_X},\\
(\chi,\rho') \ar@{|->}[r] & \chi|_{A_X} \cdot (\rho'\circ\alpha).}
%\end{equation}
\]
\end{lem}

\begin{proof} This follows easily from \Cref{lem:alpha.e} and \Cref{lem:char.res}.
\end{proof}

\subsection{Lifting of equivariant vector bundles and admissible orbit
  data}\label{sec:LVB}
Recall from the Introduction the complexification $\wtbfK$ of $\widetilde K$, which is  $\bfK$ except when $G$ is a  real symplectic group.
For a nilpotent $\bfK$-orbit $\sO\in \Nil_{\bfK}(\fpp)$, % is also viewed as an
% $\wtbfK$-orbit.
let $\cK_{\sO}^{\mathbb p}(\wtbfK)$ denote the Grothendieck group of $\mathbb p$-genuine $\wtbfK$-equivariant coherent sheaves on
$\sO$. This is a free abelian group with a free basis consisting of isomorphism classes of  irreducible $\mathbb p$-genuine $\wtbfK$-equivariant algebraic vector
bundles on $\sO$.  Taking the isotropy representation at a point $X\in \sO$ yields an identification
\begin{equation}\label{idenkr}
  \cK_{\sO}^{\mathbb p}(\wtbfK)=\cR^{\mathbb p}(\wtbfK_{X}),
\end{equation}
where the right hand side denotes
  the Grothendieck group  of the category of $\mathbb p$-genuine
  algebraic representations of the stabilizer group $\wtbfK_X$.


  For $\cO\in \Nil_{\bfG}(\fgg)$, let $\cK^{\mathbb p}_{\cO}(\wt{\bfK})$ denote the
  Grothendieck group
  % (with integral coefficients) of the category
  of $\mathbb p$-genuine $\wt{\bfK}$-equivariant coherent sheaves on $\cO\cap \fpp$. Since
  $\cO\cap \fpp$ is the finite union of its $\bfK$-orbits, we have
  \begin{equation}\label{eq:dec.KO}
    \cK_{\cO}^{\mathbb p}(\wt{\bfK})=\bigoplus_{\sO\textrm{ is a $\bfK$-orbit in $\cO\cap \fpp$}} \cK^{\mathbb p}_{\sO}(\wt{\bfK}).
  \end{equation}

  There is a natural partial order $\succeq$ on $\cK_{\cO}^{\mathbb p}(\wt{\bfK})$ and
  $\cK^{\mathbb p}_{\sO}(\wt{\bfK})$: we say $c_1\succeq c_2$ (or $c_2\preceq c_1$) if $c_1-c_2$ is represented by a
  % non-trivial
  $\mathbb p$-genuine $\wtbfK$-equivariant coherent sheaf. The same notation obviously applies  to other Grothendieck groups.



  % \subsubsection{Lift of algebraic vector bundles I: the descent
  % case}\label{sec:lift.AC}
  \subsubsection{An algebraic character}%\label{sec:lift.AC}
  Attached to a rational dual pair $(\bfV,\bfV')$, there is a distinguished character
  $\mktvvp$ of
  $\wtbfK\times\wtbfK'$ arising from the oscillator
  representation, which we shall describe.

  When $G$ is a real symplectic group, let $\cX_{\bfV}$ denote the $\mathbf i$-eigenspace of
  $L$. Then $\wtbfK$ is identified with \[
    \set{(g,c)\in \GL(\cX_{\bfV})\times
      \bC^\times|\det(g) = c^2}.\]
  It has a %genuine
  character
  $ (g,c)\mapsto c$, which is denoted by $\det_{\cX_{\bfV}}^{\half}$. % $\varsigma_{\bfV}$


  When $G$ is a quaternionic orthogonal group, still let
  $\cX_V$ denote the $\mathbf i$-eigenspace of $L$. Then $\wtbfK = \GL(\cX_{\bfV})$. Let $\det_{\cX_{\bfV}}$ denote its determinant character.

  Write $\sign{\bfV'} = (n'^+,n'^-)$. Then the character $\mktvvp|_{\wtbfK}$ is
  given by the following formula: %\footnote{If we denote $\varsigma_\cX$
  % (resp. trivial character) by $\det_{\cX}^{-\half}$ (resp. $\det_{\cX}^0$),
  % then
  % $\mktvvp|_{\wtbfK}$ always equals $\det_{\cX}^{-\frac{n^+-n^-}{2}}$.}
  \[%\begin{equation} \label{ktwvv1}
    \mktvvp|_{\wtbfK}:=\begin{cases}
      \left(\det_{\cX_{\bfV}}^{\half}\right)^{n'^+-n'^-} ,
      %\varsigma_{\bfV}^{n'^+-n'^-} ,
      & \text{if  $G$ is a real symplectic group};\\
      \det_{\cX_{\bfV}}^{\frac{n'^+-n'^-}{2}},&  \text{if  $G$ is a quaternionic orthogonal group}; \medskip \\
      \textrm{the trivial character, } & \text{otherwise}.\\
    \end{cases}
  \]%\end{equation}
  % The role of $\bfV$ and $\bfV'$ is symmetric, and
  The character $\mktvvp|_{\wtbfK'}$ is given by a similar formula
  with $n'^+-n'^-$ replaced by $n^--n^+$, where $(n^+, n^-)=\sign{\bfV}$.

  \trivial[h]{
    The key property of $\mktvvp$ is that $(\mktvvp)^{-2}$ restricted on the
    conncected component of $\wtK\times \wtK'$ is the determinant
    of the $\wtbfK\times \wtbfK'$ action on $\cX$.

    We calculate $\det|_\cX$. When $\dotepsilon = 1$, $\cX  = \Hom(\bfV_1,
    \bfV'^{L',+\bfii}) \oplus \Hom(\bfV_{-1},\bfV'^{L', -\bfii})$ and
    $\det|_{\cX}(g_1,g_{-1}) = (\det g_1)^{-n'^+}(\det g_2)^{-n'^-}$. (Here by
    right we should take $\mktvvp|_\bfK$ be the character of half
    determinant when $G = \rO(p,q)$.
    However, we always fix the splitting $\rO(p,q)\rightarrow
    \widetilde{\rO(p,q)}$ so that the $\rO(p)\times \rO(q)$-action
    on the minimal $K$-type of the Weil
    representation is trivial.

    When $\dotepsilon = -1$, $\cX = \Hom(\bfV_{+\bfii}, \bfV'_0)\oplus
    \Hom(\bfV_{-\bfii}, \bfV'_{-1})$. Now $\det|_{\cX}(g) = \det(g)^{-n'^+ +
      n'^-}$.

    Similarly, when $\dotepsilon' = -1$, $\det|_{\cX}(g') = \det(g)^{n^+ -
      n'^-}$.
    These yields the claim.
  }

  \subsubsection{Lift of algebraic vector bundles}\label{sec:lift.AC}

  In the rest of this section, we assume that $\mathbb p$ is the parity of $\dim \bfV$ if $\epsilon=1$, and  the parity of $\dim \bfV'$ if $\epsilon'=1$.  Then $\mktvvp|_{\wtbfK}$ and
  $\mktvvp|_{\wtbfK'}$ are $\mathbb p$-genuine.

  Suppose $T\in \Xo$ realizes the descent from  $X = \MMP(T)\in \sO\in \Nil_{\bfK}(\fpp)$
  to
  $X' = \MMP'(T)\in \sO'\in \Nil_{\bfK'}(\fpp')$. Let  $\alpha\colon
  {\bfK}_X\rightarrow {\bfK'}_{X'}$ be the homomorphism as in \cref{eq:alpha}.

  Let $\rho'$ be a $\mathbb p$-genuine algebraic representation  of $\wtbfK'_{X'}$. Then  the representation $\mktvvp|_{\wt{\bfK'}_{X'}}\otimes \rho'$ of $\wtbfK'_{X'}$ descends  to a representation of $\bfK'_{X'}$.  Define
  \begin{equation}\label{defn:tlift.rho}
    \dliftv_{T}(\rho'):= \mktvvp|_{\wt{\bfK}_{X}} \otimes (\mktvvp|_{\wt{\bfK'}_{X'}}\otimes \rho')\circ \alpha,
  \end{equation}
  which  is a $\mathbb p$-genuine algebraic representation of $\wt{\bfK}_{X}$.

  Clearly $\dliftv_T$ induces a homomorphism from
  $\cR^{\mathbb p}(\wtbfK'_{X'})$ to $\cR^{\mathbb p}(\wtbfK_X)$.
  In view of \eqref{idenkr}, we thus have a homomorphism
  \begin{equation}\label{defn:DS.ch}
    \xymatrix{
      \dliftv_{\sO',\sO}\colon \cK^{\mathbb p}_{\sO'}(\wt{\bfK}') \ar[r]&
      \cK^{\mathbb p}_{\sO}(\wt{\bfK}).
    }
  \end{equation}
  This is independent of the choice of $T$.



  Suppose $\cO\in\Nil_{\bfG}(\fgg)$ and $\cO'=\DD(\CO)\in \Nil_{\bfG'}(\fgg')$. Using decomposition \cref{eq:dec.KO}, we define a homomorphism
  \begin{equation}\label{eq:DS.chc}
    \xymatrix{
      \dliftv_{\cO',\cO} := \displaystyle\sum_{\substack{\sO\subset \cO\cap \fpp\\ \sO' =
          \DD(\sO) \subset \fpp'}}\dliftv_{\sO',\sO}\colon \cK^{\mathbb p}_{\cO'}(\wt{\bfK}') \ar[r]&
      \cK^{\mathbb p}_{\cO}(\wt{\bfK})
    }
  \end{equation}
  where the summation
  is over all pairs  $(\sO, \sO')$ such that $\sO'\subset \fpp'$ is the descent of
  $\sO\subset \cO\cap \fpp$.

  % \begin{remark}
  %   The explicit form of $\KTW|_{\wtK'_{X'}}$ is not important for us. We
  %   refer the interested reader to \Cref{sec:KTW} for the explicit formula.
  % \end{remark}

  % Using \Cref{defn:tlift.rho}, we have the following estimate of associated
  % character by


  % Likewise let $\CK_{\KV}(\sO)$ denote the Grothendieck group of the category
  % of $\KV$-equivariant algebraic vector bundles on $\sO$.  Then
  % \begin{equation}\label{decomk}
  %   \CK_{\widetilde \KV}(\sO)=\left\{ \begin{array}{ll}
  %       \CK_{ \KV}(\sO)\oplus \CK_{\widetilde \KV}^{\mathrm{gen}}(\sO), & \textrm{if } (\epsilon, \dot \epsilon)=(-1,-1);\medskip\\
  %       \CK_{ \KV}(\sO),&  \textrm{otherwise, } \\
  %     \end{array}
  %   \right.
  % \end{equation}
  % where $\CK^{\mathrm{gen}}_{\widetilde \KV}(\sO)$ denotes the Grothendieck
  % group of the category of genuine $\widetilde \KV$-equivariant algebraic
  % vector bundles on $\sO$.  Here and as usual, ``genuine" means that the
  % non-trivial element in the kernel of the covering map
  % $\widetilde \KV\rightarrow \KV$ acts through the scalar multiplication by
  % $-1$.


  % \subsubsection{Lift of algebraic vector bundles II: the generalized descent
  % case}
  \medskip
  Now suppose $\sO'=\gDD_{\bfV,\bfV'}(\sO) \in \Nil_{\bfK'}(\fpp')$ is the
  generalized decent of $\sO\in \Nil_{\bfK}(\fpp)$. From the discussion in
  \Cref{def:GD}, there is an $(\epsilon',\dotepsilon')$-space decomposition
  $\bfV' = \bfV'_1\oplus \bfV'_2$ and an element
  \[
  T\in
  \CX_1^\circ:=\{w\in\Hom(\bfV,\bfV'_1)\mid w\textrm{ is surjective}\}\cap \CX\subseteq \CX^{\mathrm{gen}}
  \]
   such that
  $\sO'_1:= \bfK'_1 \cdot X' \in \Nil_{\bfK'_1}(\fpp'_1)$ is the descent of
  $\sO$. Here $X' := M'(T)\in \sO'$,
  $\bfK'_i:= \bfG_{\bfV'_i}^{L'}$ is a
  subgroup of $\bfK'$ for $i=1,2$, and $\fpp'_1 := \fpp_{\bfV'_1}$.


  Let $X := M(T)\in \sO$ and
  \begin{equation}\label{eq:def.alpha1}
    \alpha_1\colon \bfK_X \rightarrow \bfK'_{1,X'}
  \end{equation}
  be
  the (surjective) homomorphism defined in
  \cref{eq:alpha} with respect to the descent from $\sO$ to $\sO'_1$.
  Then the stabilizer $\bfS_T := \Stab_{\bfK\times
    \bfK'}(T)$ of $T$ is given by
  \begin{equation}\label{labst}
    \bfS_T = \Set{(k,\alpha_1(k)k'_2)\in \bfK\times \bfK' |k\in \bfK \text{ and } k'_2\in \bfK'_2}.
  \end{equation}
  For a $\mathbb p$-genuine algebraic representation $\rho'$ of $\wtbfK'_{X'}$, define a
  representation
  \begin{equation}\label{defn:glift.rho}
    \gdlift_{T}(\rho'):= \mktvvp|_{\wt{\bfK}_{X}} \otimes \left((\mktvvp|_{\wt{\bfK}'_{X'}}\otimes
      \rho')^{\bfK'_2}\right)\circ \alpha_1.
  \end{equation}
  Clearly, \cref{defn:glift.rho} is a generalization of \cref{defn:tlift.rho}, as ${\bfK'_2}$ is the trivial group in the latter case.
  As in the descent case, $\gdlift_{T}$ induces a homomorphism
  \[
    \dliftv_{\sO',\sO}\colon \cK^{\mathbb p}_{\wt{\bfK}'}(\sO')
    \rightarrow \cK^{\mathbb p}_{\wt{\bfK}}(\sO).
  \]
  Furthermore, \cref{eq:DS.chc} is extended to the generalized descent case: for every pair $(\cO,\cO')\in \Nil_{\bfG}(\fgg)\times  \Nil_{\bfG'}(\fgg')$ with $\cO' =\gDD_{\bfV,\bfV'}(\cO)$, we define a homomorhism
  \[
    \dliftv_{\cO',\cO} := \sum_{\substack{\sO \subset \cO\cap \fpp,\\
        \sO' = \gDD_{\bfV,\bfV'}(\sO)\subset \fpp'}}\dliftv_{\sO',\sO}\colon \cK^{\mathbb p}_{\wt{\bfK}'}(\cO')
    \rightarrow \cK^{\mathbb p}_{\wt{\bfK}}(\cO).
  \]




  \subsubsection{Lift of admissible orbit data}\label{sec:aod}
  % \subsubsection{Admissible orbit data}

    % The symbol ``$\widetilde{\phantom A}$" will be used in similar situations
  % without further explanation.

  Now let $\sO$ be a $\bfK$-orbit in $\CO\cap \p$, where
  $\cO\in \Nil_{\bfG}^{\mathbb p}(\fgg)$. Let $X\in \sO$.   The component group  $A_X:=\bfK_X/\bfK_X^\circ$  is an
  elementary abelian $2$-group by \Cref{sec:KX}.  Let $\fkk_X$ be the Lie algebra of $\bfK_X$. Denote by $\bbfK_X\rightarrow \bfK_X$ the covering map induced by the covering $\bbfK\rightarrow \bfK$.



  We make the following definition.

\begin{defn}[{\cite[Definition~7.13]{Vo89}}]\label{def:admD}
  Let $\gamma_X$ denote the one-dimensional $\bfK_X$-module
  $\bigwedge^{\rmtop} \fkk_X$ and let $\rdd\gamma_X$ be its
  differential. \footnote{$\rdd\gamma_X$ is the same as $\rdd\gamma_\fkk$ in
    \cite[Theorem~7.11]{Vo89} since $\fkk$ is reductive.}  An irreducible
  representation $\rho$ of $\bbfK_X$ is called \emph{admissible} if
  \begin{enumT}
  \item its differential $\rdd\rho$ is isomorphic to a multiple of
    $\half \rdd\gamma_X$, equivalently,
    \[
      \rho(\exp(x)) = \gamma_X(\exp(x/2))\cdot \id, \quad\textrm{for all }x\in
      \fkk_X\text{, and}
    \]
  \item it is $\bpp$-genuine.
  \end{enumT}

  Let $\Phi_X$ denote the set of all isomorphism classes of admissible
  irreducible representations of $\bbfK_X$.
  % Note that $\Phi_X$ may be empty.
  % \begin{defn}[{\cite[Definition~7.13]{Vo89}}]
  %   If $\Phi_X\neq \emptyset$, we say that the orbit $\sO:=\bfK\cdot X$ is
  %   \emph{admissible}.
\end{defn}

\Cref{def:admD} is obviously consistent with \Cref{defaod}, since a
representation $\rho\in \Phi_X$ determines an admissible orbit datum
$\cE\in \cKaod_\sO(\wtbfK)$, where $\cE$ is a $\bbfK$-equivariant algebraic
vector bundle on $\sO$ whose isotropy representation $\cE_X$ at $X$ is
isomorphic to $\rho$.  We therefore have an identification
\begin{equation}\label{idenip}
  \cKaod_\sO(\wtbfK)=\Phi_X.
\end{equation}
\trivial[h]{
  % \begin{obs}
  Suppose $\sO$ is an admissible orbit and $X\in \sO$.
  When $\bfG$ is an orthogonal group or symplectic group then
  \begin{enumT}
  \item $\Phi_X$ is a set of one-dimensional representations of $\wtK_X$ and
  \item
  \end{enumT}
  When $\bfG$ is a general linear group. Then $\Phi_X$ is a singleton, since $K_X$
  is always connected.
  % \end{obs}

  % \begin{obs}\label{obs:admchar}
  Suppose $\rho_0 \in \Phi_X$ is a character. Then $\Phi_X = \set{\chi \otimes \rho_0|\chi\in
    \whAX}$. Furthermore, if $A_X$
  is abelian, then $\Phi_X$ consists of
  characters and the tensor product action of the character
  group $\whAX$ on $\Phi_X$ is free and transitive, i.e. $\Phi_X$ is an $\whAX$
  torsor.
  % \end{obs}
  % \begin{proof}
  This follows by Mackey theory. Suppose $\rho\in \Phi_X$, then
  $\Hom_{\nu \bbfK_X^\circ}(\rho, \rho_0)\neq 0$.
  Therefore, $\rho$ is a sub-representation of
  \[
    \Ind_{\nu \bbfK_X^\circ}^{\bbfK_X}(\rho_0|_{\nu \bbfK_X^\circ}) = \Ind_{\nu \bbfK_X^\circ}^{\bbfK_X}
    \bfone \otimes \rho_0 = \Ind_{\bfK_X^\circ}^{\bfK_X} \bfone \otimes \rho_0.
  \]
  Hence $\rho \cong \chi \otimes \rho_0$ for some
  character  $\chi\in \widehat{A_X}$.
  The rest is clear.
  % \end{proof}
}
From the structure of $\bfK_X$ in \Cref{lem:KX1} and \Cref{lem:char.res}, it is
easy to see  that $\Phi_X$ consists of one-dimensional representations.
\medskip

\begin{lem}\label{lem:Kaod}
  The tensor product yields a simply transitive action of the character group
  $\widehat{A_X}$ on the set $\Phi_X$.
\end{lem}
\begin{proof}
  It is clear that we only need to show that $\Phi_X$ is nonempty. Consider a
  rational dual pair $(\bfV,\bfV')$ such that
  $\sO' = \DD(\sO) \in \Nil_{\bfK'}(\fpp')$ is the descent of
  $\sO\in \Nil_{\bfK}(\fpp)$. Suppose that $T\in \Xo$ realizes the descent from
  $X$ to $X'\in \sO'$. The proof of \cite[Proposition~6.1]{LM} shows that if
  $\rho'\in \Phi_{X'}$ is admissible, then $\dliftv_T(\rho')$ is
  admissible.
  Therefore, we may do reductions and eventually reduce the problem
  to the case when $\bfV$ is the zero space.  It is clear that $\Phi_X$ is a
  singleton in this case.
  \trivial[h]{
    Note that, the role of $V$ and $V'$ are switched in that proof.
    The short exact sequence for the proof of \cite[(23)]{LM} still
    holds since the moment map $M$ is smooth at
    $T$ (see the property of principle straum in \cite[page 217]{PV} or
    \Cref{sec:Sdes}).
  }
\end{proof}

\begin{remark}
By \Cref{lem:Kaod}, the set $\cKaod_\sO(\wtbfK)$ of admissible orbit data over
$\sO$ has $2^r$ elements, where $r$ is the number of orthogonal groups appearing in the decomposition
of $\bfR_X$ in \Cref{lem:KX1}.
\end{remark}

As in the proof of Lemma \ref{lem:Kaod},
the homomorphism \eqref{defn:DS.ch} restricts to a map
\begin{equation}\label{eq:l.adm}
  \dliftv_{\sO',\sO}\colon \cKaod_{\sO'}(\wtbfK') \rightarrow \cKaod_{\sO}(\wtbfK).
\end{equation}

\medskip

\begin{lem}\label{lem:admchar.surj}
  Let $A$ be the component group of $G$ which is identified with the component
  group of $\bfK$.  Then the following map is
  surjective:\footnote{%The component group $A$ of $G$ is
    % identified with the component group of $\bfK$.
    Under the identification \eqref{idenip}, the tensor product of a character
    $\chi\in \whA$ on $\cKaod_{\sO}(\wtbfK)$ is identified with the tensor
    product of $\chi|_{A_X}$ with the isotropy representation.}
  \[
    \xymatrix@C=4em@R=0em{
      \whA \times \cKaod_{\sO'}(\wtbfK')\ar[r] & \cKaod_{\sO}(\wtbfK),\\
      (\chi,\cE') \ar@{|->}[r] & \chi \otimes \dliftv_{\sO',\sO}(\cE').  }
  \]
  In particular, $\cKaod_{\sO}(\wtbfK)$ is a singleton if $G$ is a quaternionic
  group.
\end{lem}
\begin{proof}
  This follows from \Cref{lem:char.surj} and \Cref{lem:Kaod}.
\end{proof}




\trivial[h]{
  \begin{proof}
    \begin{enumPF}
    \item follows from the fact that \begin{enumIL}
      \item $\gamma_X$ is always trivial since $R_X$ is semisimple and
      \item $\bfK_X$ is connected.
      \end{enumIL}
    \item Recall that $\bfK_X = R_X \ltimes U_X$, where
      $R_X=\prod_{l} {^{l}{\bfK}}$. Note that $\gamma_X|_{U_X}$ is trivial and
      \[
        \gamma_X |_{R_X} = \bigboxtimes_{l} {\det}_{^{l}{\bfK}}^{n_l}
      \]
      where $\det_{^{l}{\bfK}}$ is the restriction of the determinant character
      of $\GL(\bfV`l)$ on $^{l}{\bfK}$, and $n_l$ is a certain non-negative
      integer.

      % Let $R_{-}=\prod_{l \text{ odd}} {^{l}{\bfK}}$ and
      % $R_+ = \prod_{l \text{ even}}{^{l}{\bfK}}$.
      Suppose $G$ is a symplectic group, then $^{l}{\bfK}$ is a product of
      orthogonal groups for $l$ odd, and a general linear group for $l$ even.
      The preimage $\breve{^{l}{\bfK}}$ of $^{l}{\bfK}$ is thus a genuine double
      covering for $l$ even (see \Cref{eq:def.brK}).

      If the parity $\bpp$ is even, then $\Phi_X$ is non-empty if and only if
      $n_l$ is even for all $l$ even. In that case, one may choose
      \begin{equation}\label{eq:rho0.sp}
        \rho_0 =
        \bigboxtimes_{l\text{ odd}} \bfone \boxtimes \bigboxtimes_{l\text{
            even}}{\det}_{^{l}{\bfK}}^{n_l/2}
      \end{equation}
      and apply %\cref{obs:admchar}.

      If the parity $\bpp$ is odd, then $\Phi_X$ is non-empty if and only if
      $n_l$ is odd for all $l$ even. One can choose $\rho_0$ as in
      \eqref{eq:rho0.sp} by replacing $\det_{^{l}{\bfK}}^{n_l/2}$ with the
      genuine character
      $\det_{\breve{^{l}{\bfK}}}^{n_l/2}\colon (g,c) \mapsto c^{n_l}$ of
      $\breve{^{l}{\bfK}}$.

      When $G$ is an orthogonal group, the argument is similar. We leave it to
      the reader.
    \end{enumPF}
  \end{proof}
}



% Note that
% $\dliftv(\rho'\otimes \chi) = \dliftv(\rho')\otimes \chi\circ \alpha$ for any
% character $\chi$ of $K'_{X'}$.


% \subsection{Two other upper bounds}


\section{Combinatoral Convention on the local system}
An irreducible local system is represented by a {\emph{marked Young
    diagram}\index{Young Diagram}}. A general local system is understand as the
union of irreducible ones. By our computation later, it would be clear that the
local systems appeared in our cases are always \emph{multiplicity one}.


\subsection{Commutative free monoid}
Given a  set $\sfA$, the commutative free monoid $\sfC(\bA)$ on $\bfA$ consists all finite multisets with
elements drawn from $\sfA$.
It is equipped with the binary operation, say $\bullet$ such that
\[
  \set{a_{1},\cdots, a_{k_{1}}}\bullet \set{b_{1},\cdots, b_{k_{2}}} :=
  \set{a_{1},\cdots, a_{k_{1}},b_{1},\cdots, b_{k_{2}}}.
\]
In the following, we always identify $\sfA$ with the subset of $\sfC(\sfA)$
consists of singletons.

Suppose $\sfM$ is a commutative monoid, a map $f\colon \sfA\rightarrow \sfM$ is
uniquelly extends to a morphism $\sfC(\sfA)\rightarrow \sfM$ which is still
called $f$ by abuse of notations.

In particular a map $f\colon \sfA\rightarrow \sfB$ between sets uniquely extends to an morphism
$f\colon \sfC(\sfA)\rightarrow \sfC(\sfB)$ by
\[
  f(\set{a_{1},\cdots, a_{k}}) = \set{f(a_{1}), \cdots, f(a_{k})}.
\]

\subsection{Marked Young diagram}
We now explain the combinatiorial objects parameterizing local systems.
Basically ,we use $+/-$ (resp. $\upp/\umm$) to denote the associated character on the
corresponding factor of the isotropic group.
Let $\star=B,C,D,M$.


\begin{itemize}
  \item {\bf Young diagram } Let $\YD$ be the commutative free monoid
        $\sfC(\bN^{+})$ on the set of positive integers $\bZ_{\geq 1}$. An
        element $\cO = \set{R_{1}, \cdots, R_{k}}$ is identified with the Young
        diagram whose set of row lengths is $\cO$. Therefore, we identify $\YD$
        with the set of Young diagrams. Let
        \[
        \abs{ \ \ }\colon \YD \longrightarrow \bN
        \]
        be the map sending $\set{R_{1},\cdots R_{k}}$ to $\sum_{i=1}^{k} R_{i}$.

        Let $\YD(\star)$ to denote the Young diagrams corresponding to
        partitions of type $\star$. The set $\YD(\star)$ parameterizes the set
        of nilpotent orbits of type $\star$. Note that $\YD(C)=\YD(M)$.



  \item {\bf Signed Young diagram } Let $\sfS$ be the set of non-empty finite
        length strings of alternating signs of the form $+-+\cdots$ or
        $-+-\cdots$. Let $\SYD :=\sfC(\sfS)$ be the monoid on $\sfS$.

        The monoid $\SYD$ is identified with the set of all signed Young
        diagrams: $\sO=\set{\bfrr_{1}, \cdots, \bfrr_{k}}\in \SYD$ is identified
        with the signed Young diagram whose rows are filled by $\bfrr_{j}$. The
        map $ \sfS\rightarrow \bZ_{\geq 1}$ sending a string to its length
        extends to the morphism
        \[
        \begin{tikzcd}[row sep=0em]
          \cY\colon \SYD \ar[r] & \YD\\
          \set{\bfrr_{1},\cdots, \bfrr_{k}} \ar[r,maps to] & \set{\abs{\bfrr_{1}},\cdots, \abs{\bfrr_{k}}}
        \end{tikzcd}
        \]
        where $\abs{\bfrr_{j}}$ denote the length of the string $\bfrr_{j}$. By
        abused of notation, we also denote $\abs{\ \ }\circ \cY$ by
        $\abs{\ \ }$.

        We define $\SYD(\star)$ to be a subset of the preimage of $\YD(\star)$
        under the above map: When $\star=C,M$ (resp. $\star=D,B$),
        \[
        \SYD(\star) = \Set{ \sO\in \SYD| \begin{minipage}{15em}
            $\cY(\sO)\in \YD(\star)$\\
            For each positive odd number (resp. even number) $r$, the strings $+-\cdots$ and
            $-+\cdots$ of the length $r$ appears in $\sO$ with the same
            multiplicity (could be 0).
          \end{minipage}
        }
        \]

        The set $\SYD(\star)$ parameterizes the real nilpotent orbits of type
        $\star$ and $\bfK$-orbits in $\fpp$.

        We define two signature maps $\sfS\rightarrow \bN\times \bN$ as the
        following. For $\bfrr\in \sfS$, define
        \[
        \begin{split}
          \ssign(\bfrr)& := (\#+(\bfrr), \#-(\bfrr)) \quad \text{and}\\
          \lsign(\bfrr)& := \begin{cases}
            (1,0) & \text{if } \bfrr = +\cdots\\
            (0,1) & \text{if } \bfrr = -\cdots\\
          \end{cases}.
        \end{split}
        \]
        The above defined signature maps naturally extends to signature maps
        $\ssign\colon \SYD\rightarrow \bN\times \bN$ and
        $\ssign\colon \SYD\rightarrow \bN\times \bN$.



  \item {\bf Marked Young diagram} Let $\sfM$ be the set of finite length
        strings of alternating marks of the form $+-+\cdots$,$-+-\cdots$,
        $\upp\umm\upp\cdots$, or $\umm\upp\umm\cdots$.

        Let $\MYD:=\sfC(\sfM)$ which is identified with the set of Young
        diagrams marked with alternating marks $+/-$, $\upp/\umm$. Define
        $\sF\colon \sfM \rightarrow \sfS$ by the formula
        \[
        \sF(\bfrr) := \begin{cases}
          +-+\cdots & \text{ if } \bfrr = +-+\cdots \text{ or } \upp\umm\upp\cdots\\
          -+-\cdots & \text{ if } \bfrr = -+-\cdots \text{ or } \umm\upp\umm\cdots\\
        \end{cases} \quad \forall \bfrr\in \sfM
        \]
        such that $\sF(\bfrr)$ and $\bfrr$ have the same length. $\sF$ extends
        to the map $\sF: \MYD \rightarrow \SYD$.

        By abused of notation, we also denote $\abs{\ \ }\circ \cY$ by
        $\abs{\ \ }$.

        For $\cL\in\MYD$, we define
        \[
        \ssign(\cL) = \ssign(\sF(\cL)) \quad \text{and} \quad \lsign(\cL) = \lsign(\sF(\cL)).
        \]
        We define $\MYD(\star)$ to be a subset of the preimage of the above map:
        \[
        \MYD(\star) =\Set{\cL\in \MYD(\star)|\begin{minipage}{18em}
            $\sF(\cL)\in \SYD(\star)$;\\
            $\bfrr_{1}=\bfrr_{2}$ if $\bfrr_1, \bfrr_2\in \cL$ and
            $\sF(\bfrr_{1})=\sF(\bfrr_{2})$;\\
            $\bfrr = +-+\cdots $ or $-+-\cdots $ if the length of $\bfrr$ is odd
            (resp. even ) when $\star \in \set{C,M}$ (resp.
            $\star\in \set{B,D}$).
          \end{minipage}
        }
        \]
        We will use $\MYD(\star)$ to parameterize irreducible local systems
        attached to the nilpotent orbits of type $\star$.
\end{itemize}
For monoid  $\YD$, $\SYD$ or $\MYD$, the identity element is the empty set
$\emptyset$, and the monoid binary operator is denoted by
``$\cdot$''.
The  $\emptyset$ is  always in
$\MYD(\star)$ by convention.
According to the definition of $\MYD(\star)$.  it could happen that $\cL_{1}\cdot \cL_{2}\notin \MYD(\star)$ for
$\cL_{1},\cL_{2}\in \MYD(\star)$.

% We will represent an element $\cL$ in $\SYD$ or $\MYD$ by the Young diagram whose
% rows are filled with the strings in $\cL$.
%
%Let $\bZ/2\bZ\times \sfM\rightarrow \sfM$ by

We define an involution
\begin{equation}\label{eq:def.bar}
 \overline{\phantom{+}}\colon \sfM\rightarrow \sfM
\end{equation}
on $\sfM$  by
switching the symbols $+$ with $\upp$  and $-$ with $\umm$.
For example $\overline{+-+}= \upp\umm\upp$ and $\overline{ \umm\upp } = -+$.
% \[
%   \meltese(\bfrr) =\begin{cases}
%     +-\cdots & \text{if } \bfrr= \upp\umm\cdots
%     -+\cdots & \text{if } \bfrr= \upp\umm\cdots
%     \upp-\cdots & \text{if } \bfrr= \upp\umm\cdots
%   \end{cases}
% \]

We define the map
\begin{equation}\label{eq:def.dagger}
  \dagger\colon \sfM\rightarrow \sfM
\end{equation}
by extending the length of
the strings to the left by one.
For example $\dagger(+-+) = -+-+$ and $\dagger(\umm\upp)=\upp\umm\upp$.

For  $\cL,\cC\in \MYD$, the expression $\cL\succ\cC$ means that there is $\cB\in \MYD$
such that the
factorization $\cL = \cB\cdot \cC$ holds.

In the following, we will represent an element $\cL\in \MYD$ by the Young diagram whose rows are
filled with the strings in $\cL$. The terminology ``$l$-row'' means a row of length $l$.
If we do not care whether the mark is $\upp$ or $+$ (resp.  $\umm$ or $=$), we will use $\uup$ (resp. $\uum$)
to mark the corresponding position.

\begin{eg}
  The following two diagrams $\ddagger_{p,q}$ and $\dagger_{p,q}$ are in
  $\MYD(B)\cup \MYD(D)$.
  \[
    \ddagger_{p,q} := \tytb{+,\vdots,+,=,\vdots,=}
  \]
  represents the local system on the trivial orbit of $\rO(p,q)$ which has the
  trivial character on $\rO(p)$ and $\det$ on $\rO(q)$. Similarly,
  \[
    \dagger_{p,q}:= \tytb{+,\vdots,+,-,\vdots,-}
  \]
  represents the trivial local system on the trivial orbit.
\end{eg}



\subsubsection{Local systems}
We define  $\KM$ to be the free commutative monoid generated by $\MYD$.
The binary operation in $\KM$ is denoted by ``$+$''.

The operation ``$\cdot$'' naturally extends to $\KM$:
\[
  (\sum_{i}  m_{i}\cL_{i})\cdot (\sum_{j} m_{j}\cL'_{j}) := \sum_{i,j} m_{i}m_{j}(\cL_{i}\cdot \cL'_{j}).
\]
where $\cL_{i},\cL'_{j}\in \MYD$, $m_{i},m_{j}\in \bZ_{\geq 0}$.

Now $(\KM, +, \cdot)$ is in fact a commutative semiring. We let $0$ be the
additive identity element in $\KM$ and $\emptyset$ is the multiplicative
identify. Note that $\cL\cdot 0=0$ for any
 $\cL\in \KM$ by definition.

For $\cL,\cD\in \KM$, $\cL\succ \cD$ means that there exists $\cB\in \KM$ such that
$\cL=\cB\cdot \cD$.
In addition, we write $\cL\supset \cD$ if there is $\cL_{1},\cL_{2}\in \KM$ such
that $\cL_{1}\succ \cD$ and $\cL_{1}+\cL_{2}=\cL$.

Let $\KM(\star)$ be the sub-monoid of $\KM$ generated by $\MYD(\star)$.
Note that $\KM(\star)$ is not a sub semi-ring of $\KM$.

For $\cL = \sum_{i=1}^{k}\cL_{i}\in \KM$ with $\cL_{i}\in \MYD$, we let
\[
  \ssign(\cL)= \Set{\ssign(\cL_{i})|i=1,\cdots,k}\text{ and }
  \lsign(\cL)= \Set{\lsign(\cL_{i})|i=1,\cdots,k}
\]

\subsection{Operations on $\KM(\star)$}
\def\npp{\#_{+}}
\def\nmm{\#_{-}}
% We use $\npp(\cS)$ to denote the number of $+$ and $\upp$ in the object $\cS$.
% For example $\npp(\tytb{\upp\umm\upp,+})=3$.

% The involution $\overline{\phantom{+}}$ defined in \eqref{eq:def.bar} extends to
% an in

The operation $\dagger$ defined in \eqref{eq:def.dagger} extends to an operation
\[
  \dagger \colon \KM\longrightarrow \KM
\]
on $\KM$ which adding a column on the left of the original marked Young diagram.


\subsubsection{Character twists on $\KM(D)$ and $\KM(B)$}
\label{sec:tchar.DB}
Recall that  $\bZ/2\bZ\times \bZ/2\bZ$ paramterizes
the characters of a indefinite orthogonal group $\rO(p,q)$:
\[
  \chi=(\chi^{+},\chi^{-})\longleftrightarrow (\bfone^{-,+})^{\chi^{+}}\otimes (\bfone^{+,-})^{\chi^{-}}.
\]

We define the action of $\bZ/2\bZ \times \bZ/2\bZ$ action on $\sfM$ by:
\[
  \bfrr \otimes \chi := \begin{cases}
    \overline{\bfrr} & \text{if } p+q \equiv 1 \text{ and }\chi^{+}p + \chi^{-} q\equiv 1 \pmod{2}\\
    \bfrr & \text{otherwise}%\text{if } \chi^{+}p + \chi^{-}q\equiv 0 \pmod{2} \\
  \end{cases}
\]
where $\bfrr\in \sfM, \chi=(\chi^{+},\chi^{-}) \in \bZ/2\bZ\times \bZ/2\bZ$ and
$(p,q)=\ssign(\bfrr)$.

The $\bZ/2\bZ\times \bZ/2\bZ$ action extends to actions on $\KM(D)$ and $\KM(B)$.
% Now $\bZ/2\bZ\times \bZ/2\bZ$ has an action on $\KM(D)$ and $\KM(B)$ defined as
% the following:

% Let $\chi\in \bZ/2\bZ\times \bZ/2\bZ$ and $\set{}$


% We use $\cB\cdot\cC$ to denote attach the local system $\cC$ below $\cB$ and the
% operation is distributive. And use $\cup$ or $+$ to denote the union of local systems
% systems.

\subsubsection{Twists on $\KM(C)$ and $\KM(M)$}
We define an involution $\maltese_{C} \colon \sfM\rightarrow \sfM$ on $\sfM$ by
\[
  \maltese(\bfrr):= \begin{cases}
    \overline{\bfrr} & \text{if } \abs{\bfrr} \equiv 2 \pmod{4}\\
    \bfrr & \text{otherwise}.
  \end{cases}
\]
The involution $\maltese$ extends to an involution on $\KM$.%$(C)$.
We will only apply $\maltese$ on $\cL\in \KM(C)$ or $\KM(M)$.

% Now fix a signature $(p,q)\in \bN\times \bN$ such that $p+q$ is even.
% For $\cL\in \KM(C)$, we define
% \[
%   \maltese_{(p,q)}(\cL) := \maltese^{\frac{p-q}{2}}(\cL)= \begin{cases}
%     \cL & \text{if } p-q \equiv 0 \pmod{4}\\
%     \maltese(\cL) & \text{if } p-q \equiv 2 \pmod{4}\\
%   \end{cases}
% \]
% For $\cL\in \KM(M)$, let
% \[
%   \maltese_{(p,q)}:=\maltese^{\frac{p-q-1}/2} =
%   \begin{case}
%     \cL & \text{if } p-q\equiv 1 \pmod{4}\\
%     \maltese{\cL} & \text{if } p-q\equiv 3 \pmod{4}
%   \end{case}
% \]

% \[
%   \maltese^{(p,q)}:=\maltese^{\frac{p-q+1}/2} =
%   \begin{case}
%     \cL & \text{if } p-q\equiv 3 \pmod{4}\\
%     \maltese{\cL} & \text{if } p-q\equiv 1 \pmod{4}
%   \end{case}
% \]
% We define the action of $\bZ/2\bZ \times \bZ/2\bZ$ action on $\sfM$ by:
% \[
%   \bfrr \otimes \chi := \begin{cases}
%     \overline{\bfrr} & \text{if } p+q \equiv 1 \text{ and }\chi^{+}p + \chi^{-} q\equiv 1 \pmod{2}\\
%     \bfrr & \text{otherwise}%\text{if } \chi^{+}p + \chi^{-}q\equiv 0 \pmod{2} \\
%   \end{cases}
% \]
% where $\bfrr\in \sfM, \chi=(\chi^{+},\chi^{-}) \in \bZ/2\bZ\times \bZ/2\bZ$ and
% $(p,q)=\ssign(\bfrr)$.

% The $\bZ/2\bZ\times \bZ/2\bZ$ action extends to actions on $\KM(D)$ and $\KM(B)$.

\subsubsection{Truncations}% on $\KM(D)$ and $\KM(B)$}.

\def\Tpp{\sfT^+}
\def\Tmm{\sfT^-}
\def\Tpm{\sfT^{\pm}}

We define the Truncation maps %$\Tpp$ and $\Tmm$
\[
  \Tpp \colon \KM\longrightarrow \KM
\]
such that for $\cL\in \MYD$
\[
\Tpp(\cL) = \begin{cases}
  \cL_{1} & \text{if there is $\cL_{1}\in \MYD$ such that $\cL_{1}\cdot + = \cL $}\\
  0 & \text{otherwise}
\end{cases}
\]
We define $\Tmm\colon \KM \longrightarrow \KM$ similarly such that
$\cL=\Tmm(\cL)\cdot - $ if $\cL\succ -$ and $\Tmm(\cL)=0$
otherwise for $\cL\in \MYD$.

To symplify the notation, we write $\sL^{\pm} := \Tpm(\sL)$ for $\cL\in \KM$.

\subsection{Theta lifts of local systems}


\subsubsection{Lift from type C to D}

For each signature $(p,q)\in \bN\times \bN$ such that $p+q$ is even, we define a map
\[
  \vartheta_{CD,(p,q)} \colon \KM(C)\rightarrow \KM(D)
\]
as the following:
Let $\cL\in \MYD(C)$. Let $(p_{1},q_{1})=\lsign(\cL)$ and
\[
(p_{0}, q_{0})  = (p,q) -\ssign(\cL)-(q_{1},p_{1}).
\]
We define
\[
  \vartheta_{CD,(p,q)}(\cL) =
  \begin{cases}
    (\dagger \maltese^{\frac{p-q}{2}}(\cL))\cdot \dagger_{p_{0}, q_{0}} &
    \text{if } p_{0}\geq 0 \text{ and } q_{0} \geq 0 \\
    0 & \text{otherwise}
  \end{cases}
\]


\subsubsection{Lift from type D to type C}

For each non-zero integer $n\in \bN$, we define a map
\[
  \vartheta_{DC,n} \colon \KM(D)\rightarrow \KM(C)
\]
as the following:
Let $\cL\in \MYD(D)$. Let $(p_{1},q_{1})=\lsign(\cL)$ and
$(p,q) = \ssign(\cL)$.
Let
\[
  n_{0} = n - (p+q)/2 - (p_{1}+q_{1})/2
\]
We define
\[
  \vartheta_{DC,n}(\cL) =
  \begin{cases}
    \maltese^{\frac{p-q}{2}}((\dagger \cL)\cdot \dagger_{n_{0}, n_{0}}) &
    \text{if } n_{0}\in \bZ_{\geq 0}\\
    \maltese^{\frac{p-q}{2}}(\dagger \cL^{+}  + \dagger \cL^{-})& \text{if } n_{0}=-1\\
    0&\text{otherwise}
  \end{cases}
\]
We remark that
$\maltese^{\frac{p-q}{2}}((\dagger \cL)\cdot \dagger_{n_{0}, n_{0}})= (\maltese^{\frac{p-q}{2}}(\dagger\cL))\cdot \dagger_{n_{0},n_{0}}$.

\trivial{
  We take a splitting $\rO(p,q)\times \Sp(n,\bR)$ in to the big metaplectic
  group $\Mp$ such that $\rO(p,\bC)\times\rO(q,\bC)$ acts on the Fock model linearly.
  The maximal compact $K_{\Sp(n,\bR)}= \rU(2n)$ acts on the Fock model by the
  character $\zeta=\det^{(p-q)/2}$.
  For the component of the rational nilpotent orbit $\Sp(2n,\bR)$,
  the factor of the component group is $\Sp$ if the corresponding row has odd
  length.
  Otherwise the component group is $\rO(p_{2k})\times\rO(q_{2k})$ where
  $(p_{2k},q_{2k})$ is the signature corresponding to the $2k$-rows.
  $\zeta|_{\rO(p_{2k})}= \det^{(p-q)k/2}_{\rO(p_{2k})}$ which is nontrivial if
  and only if $p-q\equiv 2\pmod{4}$ and $2k\equiv 2\pmod{4}$.
  This gives the formula above.
}


{
  \color{red}
  In the proof later, we don't care above the marks for rows with length longer
  than 1 in the most of the case. So we will omit $\maltese$ sometimes.
  When there is no confusion, we will simply write $\vartheta$ for
  $\vartheta_{CD,(p,q)}$ and $\vartheta_{CD,(p,q)}$.
}


\subsubsection{Lift from type M to B}

For each signature $(p,q)\in \bN\times \bN$ such that $p+q$ is odd, we define a map
\[
  \vartheta_{MB,(p,q)} \colon \KM(M)\rightarrow \KM(B)
\]
as the following:
Let $\cL\in \MYD(M)$. Let $(p_{1},q_{1})=\lsign(\cL)$ and
\[
(p_{0}, q_{0})  = (p,q) -\ssign(\cL)-(q_{1},p_{1}).
\]
We define
\[
  \vartheta_{MB,(p,q)}(\cL) =
  \begin{cases}
    (\dagger \maltese^{\frac{p-q+1}{2}}(\cL))\cdot \dagger_{p_{0}, q_{0}} &
    \text{if } p_{0}\geq 0 \text{ and } q_{0} \geq 0\\
    0 & \text{otherwise}
  \end{cases}
\]


\subsubsection{Lift from type B to type M}

For each non-zero integer $n\in \bN$, we define a map
\[
  \vartheta_{BM,n} \colon \KM(B)\rightarrow \KM(M)
\]
as the following:
Let $\cL\in \MYD(D)$. Let $(p_{1},q_{1})=\lsign(\cL)$ and
$(p,q) = \ssign(\cL)$.
Let
\[
  n_{0} = n - (p+q)/2 - (p_{1}+q_{1})/2
\]
We define
\[
  \vartheta_{BM,n}(\cL) =
  \begin{cases}
    \maltese^{\frac{p-q-1}{2}}((\dagger \cL)\cdot \dagger_{n_{0}, n_{0}}) &
    \text{if } n_{0}\in \bZ_{\geq 0}\\
    \maltese^{\frac{p-q-1}{2}}(\dagger \cL^{+}  + \dagger \cL^{-})& \text{if } n_{0}=-1\\
    0&\text{otherwise}
  \end{cases}
\]
We remark that
$\maltese^{\frac{p-q-1}{2}}((\dagger \cL)\cdot \dagger_{n_{0}, n_{0}})= (\maltese^{\frac{p-q-1}{2}}(\dagger\cL))\cdot \dagger_{n_{0},n_{0}}$.

\trivial{
  For odd orthogonal-metaplectic group case, we still take the splitting such
  that $\rO(p,q)$ acts linearly.

  The maximal compact $\wtK_{\Sp(n,\bR)}= \widetilde{\rU(2n)}$ acts on the Fock model by the
  character $\zeta=\det^{(p-q)/2}$.

  Then
  $\det^{(p-q)/2}|_{\rO(p_{2k})\times \rO(q_{2k})}=\det^{\frac{(p-q)k}{2}}_{\rO(p_{2k})}\boxtimes
  \det^{\frac{(p-q)k}{2}}_{\rO(q_{2k})}. $
  Note that $p-q$ is an odd number.
  When $k$ is even the character on $\widetilde{\rO(p_{2k})}/\widetilde{\rO(q_{2k})}$ are
  $\bfone$ or $\det$. When $k$ is odd the character would be $\det^{\half}$ or
  $\det^{\half+1}$.

  We assume the default character on $2k$-rows is $\det^{\frac{k}{2}}$, and
  we use $+/-$ to mark the row. Otherwise, we use $\upp/\umm$ to mark the rows.
}

\subsection{Examples and remarks}

\subsubsection{Example}
\begin{eg}
  Let
  $\cT :=\dagger\dagger (\dagger_{2,1}) + \dagger\dagger(\dagger_{{1,2}})$ and $\cP= \ddagger_{1,3}$.
  Then
  \[
    \cT\cdot \cP = \tytb{\uup\uum\uup,\uup\uum\uup,\uum\uup\uum,+,=,=,=}
    \cup
    \tytb{\uup\uum\uup,\uum\uup\uum,\uum\uup\uum,+,=,=,=}.
  \]
\end{eg}


% For each local system $\cL$ of type B/D, define $\pcL$ (resp. $\ncL$) be the
% part of $\cL$ obtained by deleting a ``$+$''-symbol (resp. ``$-$''=symbol) among 1-rows.
% $\pcL:=0$ (resp. $\ncL:=0$) if there is no ``$+$''-symbol (resp.
% ``$-$''-symbol).

% For an local system $\cL$, $\cL\succeq\cC$ means there is a
% factorization of $\cL = \cB\cdot \cC$;
% $\cL\supset \cC$ means there is an irreducible component $\cL_{1}$ of $\cL$ such
% that $\cL_{1}\succeq \cC$.


% \subsubsection{}

%\subsection{Definition of $\eDD$}
\subsubsection{Signs of the local systems obtained by iterated lifting}


Suppose $\cL\in \KM$ is obtained by iterated theta lifting and character
twisting in \Cref{sec:tchar.DB}.
Then the set $\lsign(\cL)$ has restricted possibilities.
First, $\ssign(\cL)$ is always a singleton.

When $\cO$ is of type B/D, $\lsign(\cL)$ is a singleton $\set{(p_{1},q_{1})}$
where
\[
  (p_{1},q_{1})= \ssign(\cL) - (n_{0},n_{0}) \quad \text{and} \quad 2n_{0} = \abs{\eDD(\cO)}.
\]

When $\cO$ is of type C/M,
$\lsign( \cL ) =\set{ (p_{1},q_{1})}$ is a singleton in the most of the case.
The $\lsign(\cL)$
may have two elements if $\cL$ is obtained by good generalized lifting, and it has the form
$\lsign( \cL ) = \set{(p_{1}+1,q_{1}),(p_{1},q_{1}+1)}$.

% Another important invariant is $\bsign( \cL )$ which indicates the signature of
% the local system of length one rows in $\cL$.


\section{Proof of main theorem in the type C/D case}
We do induction on the number of columns of the nilpotent orbits.
\subsection{Notation}
In this section, $\cO$ is always an nilpotent orbit of type D in $\dpeNil(D)$.
We always let
\[
  \begin{split}
    \cO &= (C_{2k+1}, C_{2k}, C_{2k-1}, \cdots,C_{1},C_{0}),\\
    \cOp &=\eDD(\cO)=(C_{2k}, C_{2k-1},\cdots,C_{1},C_{0} ).
    \end{split}
\]
When  $k\geq 1$, we let
\[
    \cOpp  = \eDD^{2}(\cO) =
    \begin{cases}
      (C_{2k-1},\cdots,C_{1},C_{0} ) & \text{when  $C_{2k}$ is even},\\
      (C_{2k-1}+1,\cdots,C_{1},C_{0} ) & \text{when  $C_{2k}$ is odd}.\\
    \end{cases}
\]

For a $\uptau\in \drc(\cO)$, we let
\[
(\uptaup,\upepsilon)=\eDD(\uptau) \quad\text{ and }\quad
   (\uptaupp,\upepsilon')=\eDD(\uptaup) \text{ (when $k\geq 1$)}.
 \]

 \subsubsection{Main proposition}
The aim of this section is to prove the following main proposition holds for
$\cO\in \dpeNil(D)$.
% with only one column.

%Inductively, we will assume the following claims holds for $\cOpp$.

\begin{prop}\label{prop:CD}
   We have:
  \begin{enumS}
    \item \label{p:drcls.0} $\cL_{\uptau}$ is non-zero. In particular,
    $\uppi_{\uptau}\neq 0$.
    \item %\label{p:drcls.4}
    Suppose $\uptaup_{1}\neq \uptaup_{2}\in\drc(\cOp)$, then $\uppi_{\uptaup_{1}}\neq \uppi_{\uptaup_{2}}$.
    \item \label{p:drcls.4}
    Suppose $\uptau_{1}\neq \uptau_{2}\in\drc(\cO)$, then $\uppi_{\uptau_{1}}\neq \uppi_{\uptau_{2}}$.
    \item \label{p:drcls.1}
    The local system $\cL_{\uptau}$ is disjoint with their determinant twist:
    \begin{equation}\label{eq:LS.dis}
      \set{\cL_{\uptau} | \uptau \in \drc(\cO)} \cap \set{\cL_{\uptau}\otimes \det| \uptau\in \drc(\cO)} = \emptyset.
    \end{equation}
    % \item \label{p:drcls.4}
    % Suppose $\uptau_{1}\neq \uptau_{2}$, then $\uppi_{\uptau_{1}}\neq \uppi_{\uptau_{2}}$.
    % \item \label{p:drcls.2}
    % Compatible with LS lifting: Suppose $\uptaup_{1}\in [\cL_{\uptaup}]$ and
    % $\uptaup_{1}\neq \uptaup$, then
    % there is (a unique) $\uptau_{1}\in \cL_{\uptau}$ such that
    % $\eDD(\uptau_{1}) = (\uptaup_{1},\upepsilon)$ and $\uptau_{1}\neq \uptau$.

    % \item  \label{p:drcls.3}
    % Suppose $\upepsilon=0$.
    % $\cL_{\uptau}\neq \cL_{\uptau}\otimes \bfonepn$.
    %Therefore $\lUnip(\cO)=\Unip(\cO)$.
    %\
    \delete{
    \item {\color{red} abandon:}  $x_{\uptau}$ determine the factorization of local system described in
    \Cref{tab:ls.factor}:
    \[
      \cL_{\uptau} = \sum_{i=-k}^{k} \cB_{\uptau,i}\cdot \cD_{\uptau,i}.
    \]
    %Here $i$ running over a finite index set.
    The key properties of the factorization are
    \begin{equation}\label{eq:bd.prop}
      \begin{split}
        (\cB_{\uptau,i}\cdot\cD_{\uptau,i})^{+} &=
        \begin{cases}
          \cB_{\uptau,i}\cdot (\cD_{\uptau,i})^{+} & \text{for } i \geq 0\\
          0 & \text{for }i < 0\\
        \end{cases}
        ,\\
        (\cB_{\uptau,i}\cdot\cD_{\uptau,i})^{-} &=
        \begin{cases}
          0 &\text{for } i > 0\\
          \cB_{\uptau,i}\cdot (\cD_{\uptau,i})^{-} &\text{for } i \leq 0\\
        \end{cases}\\
        \text{and } \quad \lsign(\cD_{\uptau,i}) & = \ssign(\bfxx_{\uptau}).
      \end{split}
    \end{equation}

    % \begin{equation}\label{eq:ls.factor}
  %   \begin{array}{c|c|c|c}
  %     x_{\uptau} & \cL_{\uptau} & \cD_{\uptau} &\\
  %     \hline
  %     s & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cD_{\uptau,i} & \cD_{\uptau,1}=\tytb{=,=},
  %                                                                        \cD_{\uptau,2}= \tytb{\uum\cdots,=}
  %     &\begin{minipage}{10em}exactly one of $\cB_{\uptau,1}$ and $\cB_{\uptau,2}$ is non-zero \end{minipage} \\
  %     \hline
  %     r & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cD_{\uptau,i} & \cD_{\uptau,1}=\tytb{+,+},
  %                                                                        \cD_{\uptau,2} = \tytb{\uup\cdots,+}
  %     & \begin{minipage}{10em}exactly one of $\cB_{\uptau,1}$ and $\cB_{\uptau,2}$ is non-zero \end{minipage} \\
  %     \hline
  %     %\ytb{sd\cdots,\vdots,s,c} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cD_{\uptau,i} &  \cD_{\uptau,1} = \ytb{\uum\cdots,+},
  %     %                                                                                      \cD_{\uptau,2}=\ytb{\uup\cdots,=}
  %     %                                         &  \#s \geq 0\\
  %     %\hdashline
  %     %\ytb{\star\cdots,\vdots, c} & \cB_{\uptau,1}\cD_{\uptau,1} &  \cD_{\uptau,1} = \ytb{\uum\cdots,+} & \\
  %     %& & & \cB_{\uptau,2}\neq \emptyset \text{only if
  %     %      } \bfxx_{\uptau} = (s\cdots sc)^{t}\\
  %    c
  %                    & \displaystyle\sum_{i=1}^{2} \cB_{\uptau,i}\cdot\cD_{\uptau,i}
  %                                   &  \cD_{\uptau,1} = \tytb{\uum\cdots,+},
  %                                     \cD_{\uptau,2}= \tytb{\uup\cdots,=}
  %                                                  & \cB_{\uptau,1}\neq \emptyset.
  %     \\
  %     %& & & \cB_{\uptau,2}\neq \emptyset \text{only if
  %     %      } \bfxx_{\uptau} = (s\cdots sc)^{t}\\
  %    \hline
  %    d & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cD_{\uptau,i} &  \cD_{\uptau,1} = \tytb{\uum\cdots,+},
  %                                                                                            \cD_{\uptau,2}=\tytb{\uup\cdots,-}
  %                                              &\cB_{\uptau,1}\text{ and }\cB_{\uptau,2}\neq \emptyset\\
  %   \end{array}
  % \end{equation}
  \begin{table}[pb]
    \[
      \begin{array}{c|c|c|c}
        x_{\uptau} & \cL_{\uptau} & \cD_{\uptau} &\\
        \hline
        s & \displaystyle\sum_{i=0}^{k}\cB_{\uptau,-i}\cdot\cD_{\uptau,-i}
                                  & %\cD_{\uptau,1}=\tytb{=,=},
                                    \cD_{\uptau,i}=\begin{cases}
                                      0 & \text{when } i>0\\
                                    \tytb{\uum\cdots\uum,=}  & \text{when
                                    } i\leq 0
                                  \end{cases}
          & \exists i\geq 0 \text{ s.t. } \cB_{\uptau,-i}\neq 0 \\
        \hline
        r & \displaystyle\sum_{i=0}^{k}\cB_{\uptau,i}\cdot\cD_{\uptau,i}
                                  & \cD_{\uptau,i}=
                                    \begin{cases}
                                      \tytb{\uup\cdots\uup,+} & \text{when } i\geq 0\\
                                      0&  \text{when } i<0
                                    \end{cases}
                                  & \exists i\geq 0 \text{ s.t. } \cB_{\uptau,i}\neq 0 \\
        \hline
        c
                   & \displaystyle\sum_{i=-k}^{k} \cB_{\uptau,i}\cdot\cD_{\uptau,i}
                                  &  \cD_{\uptau,i} =\begin{cases} \tytb{\uum\cdots\uum,+} & \text{when
                                    } i\geq 0,\\
                                    \tytb{\uup\cdots\uup,=} & \text{when }i <0
                                  \end{cases}
                                  &  \exists i\geq 0 \text{ s.t. } \cB_{\uptau,i}\neq 0.
        \\
        \hline
        d
                   & \displaystyle\sum_{i=-k}^{k} \cB_{\uptau,i}\cdot\cD_{\uptau,i}
                                  &  \cD_{\uptau,i} =\begin{cases} \tytb{\uum\cdots\uum,+} & \text{when
                                    } i\geq 0,\\
                                    \tytb{\uup\cdots\uup,-} & \text{when }i <0
                                  \end{cases}
                                  &  \exists i,j\geq 0 \text{ s.t. }
                                    \begin{cases}
                                      \cB_{\uptau,i}\neq 0,\\% &\\ %\text{and} \\
                                      \cB_{\uptau,-j}\neq 0.% &.  \\
                                    \end{cases}

      \end{array}
    \]
  In the above table $\uup\cdots\uup$ or $\uum\cdots\uum$ has length $2i+1$
  where we do not specify the associated character of the local system on these rows when $i\neq 0$.

  (The associated character depends on $\uptau$ and can be
  specified inductively.)

  The local system of $\cD_{\uptau,0}$ is specified in the following
  table:
  \begin{equation}\label{eq:ls.srcd}
   \begin{array}{c|c|c|c|c}
      x_{\uptau} &  s & r & c &d \\
      \hline
      \cD_{\uptau,0} & \tiny \tytb{=,=} &\tiny \tytb{+,+} & \tiny \tytb{+,=} &\tiny \tytb{+,-}
    \end{array}
  \end{equation}
    \caption{Factorization of the local system}
    \label{tab:ls.factor}
    \label{eq:ls.factor}
  \end{table}
  }
  \item
  %In particular, we have:
  We have
  \begin{enumT}
    \item $x_{\uptau} = s$, then $\pcL_{\uptau} = \ncL_{\uptau} = 0$.
    \item $x_{\uptau} = r/c$, then $\pcL_{\uptau} \neq 0$ and $\ncL_{\uptau}=0$.
    \item $x_{\uptau} = d$, then $\pcL_{\uptau}\neq 0$ and $\ncL_{\uptau}\neq 0$.
  \end{enumT}
  % \item
  % When $x_{\uptau}=c$, $\cD_{\uptau,2}\neq \emptyset$ only if
  % $\bftt_{\uptau} = \ytb{sd\cdots, \vdots,s,c}$.
  \item If $\cOp \leadsto \cOpp$ is a usual descent, we have a simpler
  factorization:
  \begin{equation}\label{eq:d.factor}
    %\cL_{\uptau} = \cB_{\uptau,0}\cdot \cD_{\uptau,0}
    \cL_{\uptau} = \cT_{\uptau}\cdot \cP_{\bfxx_{\uptau}}.
  \end{equation}
  % where $\cD_{\uptau,0}$ is given by \eqref{eq:ls.srcd}.

  % In particular, $\cD_{\uptau,0}=\tytb{=,=}$ (resp.
  % $\cD_{\uptau,0}=\tytb{+,+}$) if and only if all 1-rows
  % of $\cL_{\uptau}$ have ``$=$'' marks (resp. ``+'' marks), i.e. $x_{\uptau}=s$
  % (resp. $x_{\uptau}=r$).
  \item When $\cOp$ is noticed, the map
  $\cL\colon \drc( \cOp )\longrightarrow \LLS(\cOp)$ is a bijection.
  \item When $\cO$ is noticed, the map
  $\cL\colon \drc(\cO)\longrightarrow \LLS(\cO)$ is a bijection.
    \item When $\cO$ is +noticed, the maps
    % $\pUpsilon_{1}:=\pr_{1}\circ \Upsilon$
    \[
      \begin{tikzcd}[row sep=0em]
        \pUpsilon_{\cO} \colon \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0} \ar[r] & \set{\pcL_{\uptau}}\\
       \cL_{\uptau} \ar[r,maps to] & \pcL_{\uptau}& \text{and}\\
        \nUpsilon_{\cO} \colon \set{\cL_{\uptau}|\ncL_{\uptau}\neq 0} \ar[r] & \set{\ncL_{\uptau}}&\\
       \cL_{\uptau} \ar[r,maps to] & \ncL_{\uptau}
      \end{tikzcd}
    \]
    are injective.
    % \item If $C_{2k+1}-C_{2k}\geq 2$ and $\bfxx_{\uptau}$ ends with $d$, $\cL_{\uptau}$ has an irreducible
    % component $\succeq \dagger_{(1,1)}$. In particular, if $\cO$ is +noticed and
    % $\bfxx_{\uptau}$ ends with $d$, we have
    % $\cL_{\uptau}\supset \dagger_{(1,1)}$.
    \item When $\cO$ is noticed, the map
    \begin{equation}\label{eq:up}
      \begin{tikzcd}[row sep=0em]
        \Upsilon_{\cO} \colon \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0} \ar[r] & \set{(\pcL_{\uptau},\ncL_{\uptau})|\pcL_{\uptau}\neq 0} \\
        \cL_{\uptau} \ar[r,maps to] & (\pcL_{\uptau},\ncL_{\uptau})
      \end{tikzcd}
    \end{equation}
    is injective.\footnote{In fact, we only need to know whether $\ncL_{\uptau}$ is
      non-zero or not.}
  \end{enumS}
\end{prop}

Note that, $\drc(\cO)$ counts the unipotent representations of special
orthogonal groups a priori. But \Cref{prop:CD}~\eqref{p:drcls.1}, implies that the representation
$\uppi_{\uptau}$ and $\uppi_{\uptau}\otimes \det$ are two different
representations of the orthogonal groups. Therefore $\drc(\cO)\times \bZ/2\bZ$
counts the set of unipotent representations of orthogonal groups.

% The factorization \eqref{eq:ls.srcd} also holds in more general cases, we
% indicate when it holds in the proof of \Cref{prop:CD}.

The main theorem would be a consequence of \Cref{prop:CD}.

\subsubsection{How to think about the factorization of local systems}
When % $C_{2k}$ is even, i.e.
$\cOp\leadsto \cOpp$ is the usual descent,
the local system $\cL_{\uptau}$ could be compared to a water hydra, see in
\Cref{fig:wh}.
\begin{figure}[pb]
\includestandalone[width=.5\textwidth]{hydra}
 % \includegraphics[scale=0.5]{abc.pdf}
  \caption{Freshwater hydra}
  \label{fig:wh}
\end{figure}

The tentacles part $\cT_{\uptau} = \dagger \cL_{\uptaup}$
could be reducible. The peduncle part $\cP_{\uptau} := \cL_{\bfxx_{\uptau}}$ and
$\cL_{\uptau} = \cT_{\uptau}\cdot \cP_{\uptau}$.

% On the other hand, $\cL_{\uptau}$ also could be factorized into the body part
% and the basal
% disk part:
% \[
%   \cL_{\uptau} = \cB_{\uptau,0}\cdot \cD_{\uptau,0}.
% \]
% Here $\cD_{\uptau,0}$ is given in \eqref{eq:ls.srcd}.
% % ) which will be used in the
% % generalized descent case.

\medskip

When $\cOp\leadsto \cOpp$ is a generalized descent, the situation is more
complicated as the local system $\cL_{\uptau}$ may consists of two hydras, see \eqref{eq:gd.ls}.

% To ease the notation, we will set $\cB_{\uptau} :=\cB_{\uptau,0}$  and
% $\cD_{\uptau} :=\cD_{\uptau,0}$
% in the following proof.
% %On the other hand, $x_{\uptau}$ could been detected from the following list of 1-rows:
% \[
% \begin{array}{c|c|c|c|c}
%   x_{\uptau} &  s & r & c &d \\
%   \hline
%   \cD_{\uptau} & \tiny \ytb{=,=} &\tiny \ytb{+,+} & \tiny \ytb{+,=} &\tiny \ytb{+,-}
% \end{array}
% \]

% Here $x_{\uptau}=s$ (resp. $x_{n}=r$) is equivalent to that only $=$ (resp. $+$)
% occurs in 1-rows of $\cL_{\uptau}$.


% Therefore
% \[
% \cL_{\uptau} = \vartheta(\cL_{\uptaup})\otimes (\bfone^{+,-})^{\upepsilon}\mapsto (\cL_{\uptaup}, \upepsilon)
% \]
% is a bijection on $\LLS(\cO,\rO(p,q))$
% In particular, \Cref{prop:CD.1} \ref{p:drcls.1}% ,  \ref{p:drcls.2}
% and \ref{p:drcls.3} can be read
% off from the character twist action on the local systems in the above
% table.

% \Cref{prop:CD.1}~\ref{p:drcls.4} follows from the fact that $\lUnip(\cO')=\Unip(\cO')$.
% Note that in this case $\uptaupp$ is the subdiagram of $\uptau$ and $*$'s above
% $x_{1}$ must be $\bullet$.

% \subsubsection{descent of nonspecial dot-r-c diagram} \label{sec:dd.nonsep}
% In the most of the case the $\uptaup$ is obtained by deleting the most left
% column of $\uptau$ and then apply the dot-s switch algorithm.

% Now we list the exceptional case:
% \[
% \begin{array}{c|c|c}
%   \ytb{{x_{0}}{y_{1}},{x_{1}}{y_{2}},\vdots,{x_{n}}}= & \ytb{rc,{x_{1}}d,\vdots,{x_{n}}} & \ytb{cc,dd,\ ,\ }\\
%   \hline
%   \ytb{{x_{\uptaupp}},{z_{2}}}= & \ytb{r,r} & \ytb{r,c}\\
% \end{array}
% \]

% \subsubsection{specail-nonspecial twist} \label{sec:nsp.twist}
% Let $\uptau$ and $\uptaup$ be two diagram in $\drc(\cO)$ with the following
% shape. We assume $\cOp\leadsto \cOpp$ is a usual descent.
% Fix the leg $\bfxx = x_{1}\cdots x_{n}$.
% \begin{claim}
%   There is an bijection between diagrams
% \[
%   \uptau_{1} = \ytb{\bullet{w_{0}}\cdots,\bullet{w_{1}}{w_{2}}\cdots,{x_{1}},{x_{2}},\vdots,{x_{n}}}\times
%   \ytb{\bullet\cdots,\bullet,\ ,\ ,\ ,\ }
%   \longleftrightarrow
%   \uptau_{2} = \ytb{\bullet{y_{0}}\cdots\cdots,{x_{0}}{y_{1}}{y_{2}}\cdots,{x_{1}}{y_{3}},{x_{2}},\vdots,{x_{n}}}\times
%   \ytb{\bullet\cdots,\ ,\ ,\ ,\ ,\ }
% \]
% such that
% $\uptaup_{2} = \eDD(\uptau_{2})$ is the non-special twist of $\uptaup_{1} = \eDD(\uptau_{1})$ (see \eqref{eq:nonsp.twist}).
% Moreover, $\ssign(\uptau_{1}) = \ssign(\uptau_{2})$.
% \end{claim}
% \begin{proof}
%   This is by \eqref{eq:nonsp.twist} and \eqref{eq:d.nonsp.e}.
%   {\color{red}Detail is needed to be written.}
% \end{proof}

%\subsection{Proof of \Cref{thm:count} for type C/D}

\subsection{The initial case:}\label{sec:pfDC.init}
When $k=0$, $\cO = (C_{1}=2c_{1},C_{0}=2c_{0})$ has  at most
two columns.
Now $\uppi_{\uptaup}$ is the trivial representation of $\Sp(2c_{0},\bR)$.
The lift $\uppi_{\uptaup} \mapsto \Thetab(\uppi_{\uptaup})$ is in fact a stable
range theta lift.%, and therefore $\uppi_{\uptau}\neq 0$.
For $\uptau\in \drc(\cO)$, let $(p_{1},q_{1}) = \ssign(\bfxx_{\uptau})$ and
$x_{\uptau}$ be the foot of $\uptau$. It is easy to see that  (using associated
character formula)
\[
  \cL_{\uppi_{\uptau}} = \cT_{\uptau}\cdot \cP_{\uptau},
  \text{ where }\cT_{\uptau}:=\dagger \dagger_{c_{0},c_{0}},
  \text{ and } \cP_{\uptau}:=\begin{cases}
    \ddagger_{p_{1},q_{1}}&  x_{\uptau} \neq d,\\
    \dagger_{p_{1},q_{1}}& x_{\uptau} = d.\\
  \end{cases}
\]
Note that $\cL_{\uppi_{\uptau}}$ is irreducible.

Let $\cO_{1} = (2(c_{1}-c_{0}))\in \dpeNil(D)$. Using the above formula,
one can check that the following maps are bijections
\[
  \begin{tikzcd}[row sep=0em]
    \drc(\cO_{1}) &\ar[l] \drc(\cO) \ar[r] & \LLS(\cO)\\
    \bfxx_{\uptau} & \ar[l,maps to] \uptau \ar[r,mapsto] & \cL_{\uptau}.
  \end{tikzcd}
\]
To see that $\drc(\cO)\ni\uptau\mapsto \cL_{\uptau}$ is an injection, one check the
following lemma holds:
\begin{lem}\label{c:init.CD}
  The map $\drc(\cO_{1})\longrightarrow \bN^{2}\times \bZ/2\bZ$ given by
  $\uptau\mapsto (\ssign(\uptau),\upepsilon_{\uptau})$ is injective (see
  \Cref{sec:upepsilon} for the definition of $\upepsilon_{\uptau}$). Moreover,
  $\upepsilon_{\uptau}=0$ only if $\ssign(\uptau)\geq (0,1)$. \qedhere
\end{lem}


Moreover, $\cL_{\uptau}\otimes \det \notin \LLS(\cO)$ for any $\uptau\in \drc(\cO)$.
In fact, if $\ssign(\bfxx_{\uptau})\succeq (1,0)$, $\cL_{\uptau}$
on the 1-rows with $+$-signs is trivial and $\cL_{\uptau}\otimes \det$ has
non-trivial restriction. When $\ssign(\bfxx_{\uptau})\nsucceq (1,0)$,
$\bfxx_{\uptau}=s\cdots s$, all 1-rows of $\cL_{\uptau}$ are marked by ``$=$'' and
all 1-rows of $\cL_{\uptau}\otimes \det$ are  marked by ``$-$''.

\delete{
Obviously we have a factoriation of the peduncle:
\begin{equation}\label{eq:ped.factor1}
  \cP_{\uptau} = \cL_{\bfxx_{\uptau}} = \cB_{\bfxx_{\uptau}}\cdot \cD_{\bfxx_{\uptau}}
  \text{ with }
  \cB_{\bfxx_{\uptau}}:=\begin{cases}
    \ddagger_{\ssign(x_{1}\cdots x_{n-1})} & \text{when }x_{\uptau} \neq d\\
    \dagger_{\ssign(x_{1}\cdots x_{n-1})} & \text{when }x_{\uptau} = d\\
  \end{cases}
\end{equation}
and $\cD_{\bfxx_{\uptau}}$ given in \eqref{eq:ls.srcd}.
Now
\begin{equation}\label{eq:bd.factor2}
  \cL_{\uptau} = \cB_{\uptau}\cdot \cD_{\uptau} \text{ with
  } \cB_{\uptau}:=\cT_{\uptau} \cdot \cB_{\bfxx_{\uptau}} \text{ and }
  \cD_{\uptau} := \cD_{\bfxx_{\uptau}}.
\end{equation}
and so the factorization \eqref{eq:d.factor} holds.
% For the above discussion, one can immediately deduce the factorization of local
% system of $\cL_{\uptau}$ in \eqref{eq:ls.factor}.



Therefore, our main theorem, \Cref{thm:count}, holds for $\cO$.
}
Therefore our main \Cref{thm:count} and main proposition \Cref{prop:CD} holds for $\cO$.

\subsection{The descent case}\label{sec:pf.ds.CD}
Now we assume $k\geq 1$ and $C_{2k}$ is even. In this case $\cOp\leadsto \cOpp$
is a usual descent.

\subsubsection{Unipotent representations attached to $\cOp$}
Therefore, $\LS(\cOpp)\longrightarrow \LS(\cOp)$ given by
$\cL\mapsto \vartheta(\cL)$ is an injection between abelian groups.


For $\cLpp\in \LLS(\cOpp)\sqcup \LLS(\cOpp)\otimes \det$, let $(p_{1},q_{1}) = \lsign(\cL)$ and
$(p_2,q_2)=(C_{2k}-q_{1},C_{2k}-p_{1})$. Then
\[
  \vartheta(\cLpp) = \dagger\cLpp \cdot \dagger_{p_{2},q_{2}}.
\]

By \eqref{eq:LS.dis}, we have a injection
\begin{equation}\label{eq:LS.CD.inj}
  \begin{tikzcd}[row sep=0em]
    \LLS(\cOpp)\times \bZ/2\bZ \ar[r] &\LLS(\cOp)\\
    (\cLpp,\upepsilon') \ar[r,maps to] & \vartheta(\cLpp\otimes \det^{\upepsilon'}).
  \end{tikzcd}
\end{equation}
In particular, we have $\cL_{\uptaup}\neq 0$ and $\uppi_{\uptaup}\neq 0$ for every
$\uptaup\in \drc(\cOp)$.



\subsubsection{Unipotent representations attached to $\cO$}
Now suppose $\uptaup_{1}\neq \uptaup_{2}\in \drc(\cOp)$ and
$\cL_{\uptaup_{1}}=\cL_{\uptaup_{2}}$. By \eqref{eq:LS.CD.inj},
$\upepsilon'_{1}=\upepsilon'_{2}$ and $\cL_{\uptaupp_{1}}=\cL_{\uptaupp_{2}}$.
In particular,  $\uptaupp_{1}$ and $\uptaupp_{2}$  have the same signature. %, say $(p'',q'')$.% are dot-r-c diagrams for the
% same real orthogonal group.
By \Cref{lem:ds.CD} and the induction hypothesis, $\uptaupp_{1}\neq \uptaupp_{2}$ and so
$\uppi_{\uptaupp_{1}}\otimes {\det}^{\upepsilon'_{1}} \neq \uppi_{\uptaupp_{2}}\otimes {\det}^{\upepsilon'_{2}}$.
Now the injectivity of theta lifting yields
\[
  \uppi_{\uptaup_{2}} = \Thetab(\uppi_{\uptaupp_{1}}\otimes {\det}^{\upepsilon'_{1}})
  \neq \Thetab(\uppi_{\uptaupp_{2}}\otimes {\det}^{\upepsilon'_{2}}) = \uppi_{\uptaup_{2}}
\]
Suppose $\cOp$ is noticed. Then $\cOpp = \eDD(\cOp)$ is noticed by definition
and
$(\uptaupp,\upepsilon')\mapsto \Ch(\uppi_{\uptaupp}\otimes{\det}^{\upepsilon'})$
is an injection into $\LS(\cOpp)$.
Now \eqref{eq:LS.CD.inj} implies $\uptaup\mapsto\cL_{\uptaup}$ is also an injection.

Suppose $\cOp$ is quasi-distingushed. Then $\cOpp = \eDD(\cOp)$ is
quasi-distingushed by definition
and
$(\uptaupp,\upepsilon')\mapsto \Ch(\uppi_{\uptaupp}\otimes{\det}^{\upepsilon'})$
is  a bijection with $\LSaod(\cOpp)$.
Since the component group of each K-nilpotent orbit in $\cOp$ is naturally
isomorphic to the component group of its descent. So we deduce that $\uptaup \mapsto \cL_{\uptaup}$
is a bijection onto $\LSaod(\cOp)$.

This proves the main proposition for $\cOp$.


Now let $\uptau\in \drc(\cO)$. % and $(p_{0},q_{0}):=\ssign(\bfxx_{\uptau})$.
By \eqref{eq:sp-nsp-sig}, we have
\begin{equation}\label{eq:LS.D.ds}
  \cL_{\uptau} =  \cT_{\uptau}\cdot \cP_{\uptau}\neq 0, \text{ where
  }\cT_{\uptau} := \dagger\cL_{\uptaup}, \text{ and } \cP_{\uptau}:=\cL_{\bfxx_{\uptau}}.
\end{equation}
In particular, $\uppi_{\uptau}\neq 0$ and we could determine $\bfxx_{\uptau}$ from
the marks on the 1-rows of $\cL_{\uptau}$.

% The factorization of $\cL_{\uptau}$ in the fashion of \Cref{eq:ls.factor} is also given by
% \eqref{eq:ped.factor1} and \eqref{eq:bd.factor2}.
% When $\upepsilon=0$, $(p_{0},q_{0})\succeq \ssign(d)=(1,1)$ and so
% $\cL_{\uptau}\neq \cL_{\uptau}\otimes \bfone_{\ssign(\uptau)}^{+,-}$.

Now suppose $\uptau_{1} \neq \uptau_{2}$ and
$\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$. By \eqref{eq:LS.D.ds}, the result in
\Cref{sec:pfDC.init} and
\Cref{lem:sp-nsp.D}~\eqref{lem:sp-nsp.D.2},
we have
$\bfxx_{\uptau_{1}}=\bfxx_{\uptau_{2}}$,  $\upepsilon_1=\upepsilon_{2}$ and
$\uptaupp_{1}\neq \uptaupp_{2}$.
By \eqref{eq:LS.D.ds}, we have
$\cL_{\uptaup_{1}}=\cL_{\uptaup_{2}}$.
Applying the main proposition of $\cOp$, we have
$\upepsilon'_{1}=\upepsilon'_{2}$ and $\uptaup_{1}\neq \uptaup_{2}$.
Now by the injectivity of theta lifing, we conclude that
\[
  \uppi_{\uptau_{2}} = \Thetab(\uppi_{\uptaup_{1}})\otimes (\bfone^{+,-})^{\upepsilon_{1}}
  \neq \Thetab(\uppi_{\uptaup_{2}})\otimes (\bfone^{+,-})^{\upepsilon_{2}} = \uppi_{\uptaup_{2}}
\]

\subsubsection{}

Note that $\cL_{\uptau}$ is obtained from $\cL_{\uptaup}$ by attaching the peduncle
determined by $\bfxx_{\uptau}$. The claims about noticed and
quasi-distinguished orbit are easy to verify. We leave them to the reader.


%\subsection{}

% For a dot-r-c diagram $\uptau\in \drc(D)$, we have the following three cases:
% (The top rows are either empty or $w_{0}\neq \emptyset$.)


% {\bf Case I: } $x_{1}\neq \emptyset$. In this case $\cOpp\leadsto \cOp$ is usual
% lift and $\upepsilon'=0$.
% \[
% \begin{tikzpicture}
%   \matrix[matrix of math nodes, row sep={1.5em,between origins},column sep={1.5em,between origins}]{
%   \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%   *      & *      & *      & *      & \times                   & w_{0}  & *      & *      & *      & \\
%   x_{1}  &        &        &            &                          &        &        &        &        & \\
%   \vdots &        &        &        &                          &        &        &        &        & \\
%   x_{n}   &        &        &        &                          &        &        &        &        & \\
%   };
% \end{tikzpicture}
% \]
% We define $\bfxx_{\uptau}=\bftt_{\uptau} = \ytb{{x_{1}},\vdots,{x_{n}}}$.


% {\bf Case II:} $y_{2}\neq \emptyset$. In this case $\cOpp\leadsto \cOp$ is usual
% lift and $\upepsilon'=1$.
% \[
% \begin{tikzpicture}
%   \matrix[matrix of math nodes, row sep={1.5em,between origins},column sep={1.5em,between origins}]{
%   \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%   *      & *      & *      & *      & \times                   & w_{0}  & *      & *      & *      & \\
%   x_{0}  & y_{1}  &  *     &  \cdots    &                          &        &        &        &        & \\
%   x_{1}  & y_{2}  &        &        &                          &        &        &        &        & \\
%   \vdots &        &        &        &                          &        &        &        &        & \\
%   x_{n}  &    &        &        &                          &        &        &        &        & \\
%   };
% \end{tikzpicture}
% \]
% We define $\bfxx_{\uptau}=\bftt_{\uptau} = \ytb{{x_{1}},\vdots,{x_{n}}}$.


% {\bf Case III:} $y_{1}\neq \emptyset$. In this case $\cOpp\leadsto \cOp$ is a
% generalized lift and $\upepsilon'=0$.
% \[
% \begin{tikzpicture}
%   \matrix[matrix of math nodes, row sep={1.5em,between origins},column sep={1.5em,between origins}]{
%   \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%   *      & *      & *      & *      & \times                   & w_{0}  & *      & *      & *      & \\
%   x_{1}  & y_{1}  &  *     &  \cdots    &                          &        &        &        &        & \\
%   \vdots &        &        &        &                          &        &        &        &        & \\
%   x_{n}  &    &        &        &                          &        &        &        &        & \\
%   };
% \end{tikzpicture}
% \]
% We define $\bfxx_{\uptau}:= \ytb{{x_{1}},\vdots,{x_{n}}}$ and $\bftt_{\uptau}:= \ytb{{x_{1}}{y_{1}},\vdots,{x_{n}}}$.

% We call $\bftt_{\uptau}$ the ``leg'' of $\uptau$ and $x_{\uptau}:=x_{n}$ the ``foot'' of $\uptau$.

% In case I/II, the sign of length-1 row in $\cL_{\uptau}$ is
% \[
% \bsign{\uptau} = \Sign{\bfxx_{\uptau}}
% \]
% We factorize $\cL_{\uptau} = \cB_{\uptau}\cdot \cC_{\uptau}$. Here
% $\lsign{\cT_{\uptau}}$ is a constant on each irreducible components.
% $\lsign{\cB_{\uptau}}=\bsign{\uptau}$.


% In case III, the sign of lenght-1 row with a plus length row  is determined by
% \[
% \bsign{\uptau} = \Sign{\bfxx_{\uptau}}
% \]

% $\cL_{\uptau} = \cpT_{\uptau}\cdot \cpB_{\uptau} + \cnT_{\uptau}\cdot \cnB_{\uptau}$.
% We allow $\cnB=\emptyset$, and $\cpB$ is assumed to have
% more length-1 row marked by $+$ than that of $\cnB$.
% We still have sign of $\cpT$ and $\cnT$ are the same. More importantly,
% $\lsign{\cpB} = \Sign{\bfxx_{\uptau}}$, and $\lsign{\cnB}=\Sign{\bfxx_{\uptau}}$
% if $\cnB\neq \emptyset$.
% We call $x_{n}$ the tail of $\uptau$.

% The key property is that the lifting of local system is controlled by the leg $\bftt_{\uptau}$.

% Moreover, we claim that all $\uptau$ in a LS-packet $[\cL]$ has the same
% tail $x_{n}$.

%We will establish this by induction.


% \subsection{Descent case}
% We assume now $\cOp\leadsto \cOpp$ is a usual descent.

% When $\upepsilon' = 0$, the dot-r-c diagrams have the following shape:
% \[
%   \begin{tikzcd}[row sep={1.5em,between origins},column sep={1.5em,between origins}]
%              & \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%     \uptau:  & *      & *      & *      & *      & \times                   &   *     & *      & *      & *      & \\
%              & x_{1}  &        &        &            &                          &        &        &        &        & \\
%              & \vdots &        &        &        &                          &        &        &        &        & \\
%              & x_{n}  &        &        &        & \  \ar[d,maps to,"\eDD"] &        &        &        &        & \\[1em]
%              &        &        &        &        & \                        &        &        &        &        & \\
%              &        & \cdots & \cdots & \cdots & \                        & \cdots & \cdots & \cdots & \cdots & \\
%     \uptau': &        & *      & *      & *      & \times                   & *      & *      & *      & *      & \\
%              &        &        &        &        & \ \ar[d,maps to,"\eDD"]   &        &        &        &        & \\[1em]
%              &        & \cdots & \cdots & \cdots & \                        &        & \cdots & \cdots & \cdots & \\
%     \uptaupp:
%              &        & *      & *      & *      & \times                   &        & *      & *      & *      & \\
%              &        &        &        &        &                          &        &        &        &        & \\
%   \end{tikzcd}
% \]


% When $\upepsilon'=1$, the dot-r-c diagrams have the following shape:
% \[
%   \begin{tikzcd}[row sep={1.5em,between origins},column sep={1.5em,between origins}]
%              & \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots \\
%     \uptau:  & *      & *      & *      & *      & \times                   & *      & *      & *      & *      \\
%              & x_{0}  & y_{1}  &        &        &                          &        &        &        &        \\
%              & x_{1}   & y_{2}  &        &        &                          &        &        &        &        \\
%              & \vdots  &        &        &        &                          &        &        &        &        \\
%              & x_{n}  &        &        &        & \  \ar[d,maps to,"\eDD"] &        &        &        &        \\[1em]
%              &        &        &        &        & \                        &        &        &        &        \\
%              &        & \cdots & \cdots & \cdots & \                        & \cdots & \cdots & \cdots & \cdots \\
%     \uptau': &        & *      & *      & *      & \times                   & *      & *      & *      & *      \\
%              &        & x_{\uptaupp}  &        &        & \                        &        &        &        &        \\
%              &        & z_{2}  &        &        & \ \ar[d,maps to,"\eDD"]  &        &        &        &        \\[1em]
%     \uptaupp:
%              &        & \cdots & \cdots & \cdots & \                        &        & \cdots & \cdots & \cdots & \\
%              &        & *      & *      & *      & \times                   &        & *      & *      & *      \\
%              &        & w_{1}  &        &        &                          &        &        &        &        \\
%   \end{tikzcd}
% \]
% The actual definition of $\uptau\mapsto \uptaup$ is in \Cref{sec:alg.CD}. %\Cref{sec:dd.nonsep}.

% Consider the following map of local system
% \[
%   \begin{tikzcd}[row sep=0em]
%     \LLS(\cOpp) \times \bZ/2\bZ \ar[r]& \LS(\cO')\\
%     (\cLpp, \upepsilon') \ar[r,maps to] & \vartheta(\cLpp\otimes {\det}^{\upepsilon'}).
%   \end{tikzcd}
% \]
% Its image is always non-zero and it is an injection by
% \Cref{prop:CD.1}~\ref{p:drcls.1} for $\cOpp$.

% Therefore the theta lift $ \uppi_{\uptaup}:= \Thetab(\uppi_{\uptaupp}\otimes {\det}^{\upepsilon'})$ is always
% non-vanishing and $\uppi_{\uptaup}$ are distinct with each other.
% %Hence $\lUnip(\cO') = \Unip(\cO')$.
% Hence $\Unip(\cO') = \set{\uppi_{\uptaup}}$.

% We now prove that we have a factorization of local system:
% \[
%   \cL_{\uptau} = \cB_{\uptau}\cdot \cC_{\uptau},
% \]
% here $\cC_{\uptau}$ is determined by $\bfxx_{\uptau} = x_{1}\cdots x_{n}$.

% Since $C_{2k}=C_{2k-1}$ is even,  $\cOpp\leadsto \cOp$ is a usual lifting and
% $\det\otimes \cL_{\uptaupp}\notin \LLS(\cOpp)$,
% \[
% \cL_{\uptaup} = \vartheta(\cL_{\uptaupp}\otimes (\det)^{\upepsilon'}) \mapsto (\cL_{\uptaupp}, \upepsilon')
% \]
% is a well defined map and restricted on $\LLS(\cO, \rO(p,q))$ is a bijection.



% Using our algorithm, we compute
% $\Sign(\uptau)-\Sign(\uptaupp) = (2a+p_{1},2a+q_{1})$. Here $a$ is the number of
% entries in $\taulf$ above $x_{1}$ and
% $(p_{1},q_{1})=\Sign((x_{1}, \cdots, x_{n})^{T})$ (see \Cref{sec:nsp.twist} for
% the non-special representation case).

% Therefore, the components in the local system $\cL_{\uptau}$ is given by:
% Attach two columns on the left of the irreducible LS of $\cL_{\uptaupp}$,
% and $2n$ 1-rows with siginature $(p_{1},q_{1})$.

% The tail $x_{n}$ determine the twisting character $(\bfonepn)^{\upepsilon}$.
% When $x_{n} = r$ (resp. $x_{n}=s$), $q_{1}=0$ (resp. $p_{1}=0$).

%\subsection{The general case}
% We will prove two aspects: 1. the liftings $\uppi_{\uptau}\neq 0$; 2. they are
% non-isomorphic.

% Here $\cB$ stands for ``body'', $\cD$ stands for ``foot'.
% Later $\cC$ stands for ``leg'' (crus in Latin)

% We always assume $\uptau$ is a type D dot-r-c diagram.
% Inductively we establish the following properties.

% \begin{claim}
% \begin{enumT}
%   \item  $x_{\uptau}$ determine the factorization of local system:
%   \begin{equation}\label{eq:ls.factor}
%     \begin{array}{c|c|c|c}
%       \bftt_{\uptau} & \cL_{\uptau} & \cF_{\uptau} &\\
%       \hline
%       \ytb{s\cdots,\vdots,s} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cF_{\uptau,i} & \cF_{\uptau,1}=\ytb{=,=},
%                                                                                          \cF_{\uptau,2}= \ytb{\uum\cdots,=} &\\
%       \hline
%       \ytb{\star\cdots,\vdots,r} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cF_{\uptau,i} & \cF_{\uptau,1}=\ytb{+,+}, \cF_{\uptau,2} = \ytb{\uup\cdots,+}\\
%       \hline
%       %\ytb{sd\cdots,\vdots,s,c} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cF_{\uptau,i} &  \cF_{\uptau,1} = \ytb{\uum\cdots,+},
%       %                                                                                      \cF_{\uptau,2}=\ytb{\uup\cdots,=}
%       %                                         &  \#s \geq 0\\
%       %\hdashline
%       %\ytb{\star\cdots,\vdots, c} & \cB_{\uptau,1}\cF_{\uptau,1} &  \cF_{\uptau,1} = \ytb{\uum\cdots,+} & \\
%       %& & & \cB_{\uptau,2}\neq \emptyset \text{only if
%       %      } \bfxx_{\uptau} = (s\cdots sc)^{t}\\
%       \ytb{\star\cdots,\vdots, c}
%                      & \displaystyle\sum_{i=1}^{2} \cB_{\uptau,i}\cdot\cF_{\uptau,i}
%                                     &  \cF_{\uptau,1} = \ytb{\uum\cdots,+},
%                                       \cF_{\uptau,2}= \ytb{\uup\cdots,=}
%                                                    & \cB_{\uptau,1}\neq \emptyset.
%       \\
%       %& & & \cB_{\uptau,2}\neq \emptyset \text{only if
%       %      } \bfxx_{\uptau} = (s\cdots sc)^{t}\\
%      \hline
%       \ytb{\star\cdots,\vdots,d} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cF_{\uptau,i} &  \cF_{\uptau,1} = \ytb{\uum\cdots,+},
%                                                                                              \cF_{\uptau,2}=\ytb{\uup\cdots,-}
%                                                &\cB_{\uptau,1}\text{ and }\cB_{\uptau,2}\neq \emptyset\\
%     \end{array}
%   \end{equation}
%   When $x_{\uptau}=c$, $\cF_{\uptau,2}\neq \emptyset$ only if
%   $\bftt_{\uptau} = \ytb{sd\cdots, \vdots,s,c}$.
%   \item If $\cOp \leadsto \cOpp$ is a usual descent, we have a simpler
%   factorization:
%   $\cL_{\uptau} = \cB_{\uptau} \cF_{\uptau}$.
%   \begin{equation}\label{eq:ls.srcd}
%     \begin{array}{c|c} x_{\uptau} & \cF_{\uptau} \\
%       \hline
%       s &  \ytb{=,=}\\
%       \hline
%       r & \ytb{+,+}\\
%       \hline
%       c & \ytb{+,=}\\
%       \hline
%       d & \ytb{+,-}\\
%       \hline
%     \end{array}
%   \end{equation}
%   \item
%   From the above table, we have:
%   \begin{enumT}
%     \item $x_{\uptau} = s$, then $\pcL = \ncL = 0$.
%     \item $x_{\uptau} = r/c$, then $\pcL \neq 0$ and $\ncL=0$.
%     \item $x_{\uptau} = d$, then $\pcL$ and $\ncL$ are both non-zero.
%   \end{enumT}
%   \item
%     The set of lifted local system are and disjoint with their determinant twist:
%     \[
%       \set{\cL_{\uptau} | \uptau \in \drc(\cO)} \cap \set{\cL_{\uptau}\otimes \det| \uptau\in \drc(\cO)} = \emptyset.
%     \]
% %  \item
% % \ref{p:drcls.1} follows from the above properties.
% %   \[
% %   \begin{array}{c|c|c|c|c}
% %     x_{\uptau} & s & r &c &d\\
% %     \hline
% %     \pcL_{\uptau} & \emptyset &  \sum_{i=1}^{2} \cB_{\uptau_{i}} \cT_{\uptau_{i}} & \\
% %     \ncL_{\uptau} & \emptyset & \emptyset & \emptyset &
% %   \end{array}
% % \]
%   % \item We have
%   % $\set{\cL_{\uptau}|\pcL_{\uptau}\neq 0} \rightarrow \set{\pcL_{\uptau}}$ given
%   % by $\cL_{\uptau}\mapsto \pcL_{\uptau}$ is injective if $n\geq 2$ or
%   % $\cOp\leadsto \cOpp$ is a usual descent..

%     \item If $\cO$ is noticed,
%     \[
%       \begin{tikzcd}[row sep=0em]
%         \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0} \ar[r] & \set{\pcL_{\uptau}}\times \set{T,F} &\\
%         & (\pcL_{\uptau},F)
%         \arrow[dd, start anchor=north west, end anchor=south west, no head, xshift=-1em, decorate, decoration={brace,mirror}]
%         & \ncL_{\uptau} = \emptyset
%         \\[-1em]
%         \cL_{\uptau} \ar[r,mapsto, end anchor={[xshift=-2em]west}] & \phantom{(\pcL_{\uptau},F)} & \\[-1em]
%         &(\pcL_{\uptau},T) &  \ncL_{\uptau} \neq \emptyset
%       \end{tikzcd}
%     \]
%     is injection.
%     \item If $\cO$ is +noticed, the composition of the above map with $\pr_{1}$
%     is injective.
%     \item If $C_{2k+1}-C_{2k}\geq 2$ and $\bfxx_{\uptau}$ ends with $d$, $\cL_{\uptau}$ has an irreducible
%     component $\succ \dagger_{(1,1)}$. In particular, if $\cO$ is +noticed and
%     $\bfxx_{\uptau}$ ends with $d$, we have
%     $\cL_{\uptau}\supset \dagger_{(1,1)}$.
% \end{enumT}

% \end{claim}




% \subsubsection{Usual descent case}
% When $\cOp \rightarrow \cOpp$ is a usual descent, the non-vanishing is clear and
% the above properties are easily follows.
% Moreover, the signature of $1$-rows in $\cL_{\uptau}$ is given by
% $\ssign(\bfxx_{\uptau})$. Note that, (1). the lift of $\LS(\cOpp)\longrightarrow\LS(\cOp)$ is
% an injection, we could read the twisting character $\upepsilon_{\uptaup}$ from
% $\cL_{\uptaup}$.

% On the other hand, the twisting character $\upepsilon_{\uptau}$ could be read
% from the restriction on 1-rows of $\cL_{\uptau}$.  In fact, in the most of the
% case $\upepsilon_{\uptau}=1$. $\upepsilon_{\uptau}=0$ if and only if $x_{\uptau}=d$
% where $\cL_{\uptau}$ must contain an irreducible component  whose 1-rows contain a
%  $-$ sign.

% \subsubsection{Proof of Generalized descent case}



% Non-vanishing of the lifting:

% The dot-r-c diagrams have the following shape:
% \[
%   \begin{tikzcd}[row sep={1.5em,between origins},column sep={1.5em,between origins}]
%              & \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%     \uptau:  & *      & *      & *      & *      & \times                   &   *     & *      & *      & *      & \\
%              & x_{0}  & y_{1}   & w_{1}   & \cdots &                          &        &        &        &        & \\
%              & \vdots &        &        &        &                          &        &        &        &        & \\
%              & x_{n}  &        &        &        & \  \ar[d,maps to,"\eDD"] &        &        &        &        & \\[1em]
%              &        &        &        &        & \                        &        &        &        &        & \\
%              &        & \cdots & \cdots & \cdots & \                        & \cdots & \cdots & \cdots & \cdots & \\
%     \uptau': &        & *      & *      & *      & \times                   & *      & *      & *      & *      & \\
%              &        & x_{\uptaupp}  & w_{1}   &  \cdots   & \ \ar[d,maps to,"\eDD"]   &        &        &        &        & \\[1em]
%              &        & \cdots & \cdots & \cdots & \                        &        & \cdots & \cdots & \cdots & \\
%     \uptaupp:
%              &        & *      & *      & *      & \times                   &        & *      & *      & *      & \\
%              &        & x_{\uptaupp}   & w_{1}  &        &                          &        &        &        &        & \\
%   \end{tikzcd}
% \]


\subsection{The general descent case}\label{sec:pf.gd.CD}
%We now starts with induction:
We  assume $k\geq 1$ and all the properties are satisfied by $\uptaupp\in \drc(\cOpp)$.
We retain the notation in \Cref{sec:gd2.CD}.

\subsubsection{Local systems}
We now describe the local systems $\cL_{\uptaup}$ and $\cL_{\uptau}$ more
precisely using our formula of the associated character and the induction
hypothesis. Note that these local systems are always non-zero which implies that
$\uppi_{\uptaup}$ and $\uppi_{\uptau}$ are unipotent representations attached to
$\cOp$ and $\cO$ respectively.

First note that in $\uptaup$ and $\uptaupp$, $x_{\uptaupp}\neq s$ by the definition of
dot-r-c diagram.
\footnote{
  Suppose $\uptaupp\in \drc(\cOpp)$ has the shape in \eqref{eq:gd2.drc} and
  $x_{\uptaupp}=s$. By the induction hypothesis,   $\pcL_{\uptaupp}=\ncL_{\uptaupp}=0$ and so
  the theta lift of $\uppi_{\uptaupp}$ vanishes.
}
% in generalized descent.
By the induction hypothesis, $\cL_{\uptaupp}^{+}\neq 0$.
% , and so
% \[
%   \cL_{\uptaup} = \vartheta(\cL_{\uptaupp}) = \dagger \cL_{\uptaupp}^{+}\cup
%   \dagger \cL_{\uptaupp}^{-} \neq 0.
% \]

% Now for each $\uptaup\in \drc(\cOp)$, $\uptaupp$


Let $(p''_{1},q''_{1}) := \lsign(\cL_{\uptaupp})$.
Then
\begin{equation}\label{eq:lsign.1}
\lsign(\pcL_{\uptaupp}) = (p_{0}-1,q_{0}), \text{ and }
\lsign(\ncL_{\uptaupp})=(p_{0},q_{0}-1) \text{ if } \ncL_{\uptaupp}\neq \emptyset.
\end{equation}
\begin{equation}\label{eq:LS.taup}
  \cL_{\uptaup} = \vartheta(\cL_{\uptaupp}) = \maltese^{\frac{\abs{\ssign(\uptaupp)}}{2}}
  (\dagger \pcL_{\uptaupp} + \dagger \ncL_{\uptaupp}) \neq 0
\end{equation}
where
$\lsign(\dagger\pcL_{\uptaupp}) = (q''_{1}, p''_{1}-1)$ and
$\lsign(\dagger\ncL_{\uptaupp})=(q''_{1}-1,p''_{1})$ (if
$\dagger\ncL_{\uptaupp}\neq 0$).

Let $(p_{1},q_{1}) := \lsign(\cL_{\uptau})$ and
$(e,f):=(p_{1}-p''_{1}+1, q_{1}-q''_{1}+1)$. Using \Cref{lem:gd.inj}
% \eqref{eq:bd.prop} and
% \eqref{eq:def.u},
one can show that
\[
  (e,f)=\ssign(\bfuu_{\uptau}).
\]
\trivial[]{ It suffice to consider the most left three columns of the peduncle
  part: this part has signature
  $\lsign(\cP_{\uptau}) +(1,1) = \ssign(\bfuu_{\uptau}x_{\uptaupp})= \ssign(\bfuu_{\uptau})+\lsign(\cD_{\uptaupp})$.
  Therfore,
  \[\ssign(\bfuu_{\uptau}) = \lsign(\cP_{\uptau})-\lsign(\cD_{\uptaupp})
  + (1,1) = \lsign(\cL_{\uptau})-\lsign(\cL_{\uptaupp})+(1,1).
  \]
}

Now
\begin{equation}\label{eq:gd.ls}
  \cL_{\uptau} =
  \begin{cases}
    (\bfone^{+,-}\otimes \dagger\maltese^t \dagger \pcL_{\uptaupp}) \cdot \pcP_{\uptau}
    + (\bfone^{+,-}\otimes \dagger\maltese^{t} \dagger \ncL_{\uptaupp})  \cdot \ncP_{\uptau}
    & \text{if } x_{\uptau} \neq d\\
    (\dagger\maltese^t \dagger \pcL_{\uptaupp}) \cdot \pcP_{\uptau}
    + (\dagger\maltese^{t} \dagger \ncL_{\uptaupp})  \cdot \ncP_{\uptau}
    & \text{if } x_{\uptau} =d\\
  \end{cases}
\end{equation}
where
\[
  \begin{split}
    t & = \frac{\abs{\ssign(\uptau)-\ssign(\uptaupp)}}{2} = \frac{\abs{\ssign(\bfuu_{\uptau})}}{2}\\
    \pcP_{\uptau}& = \begin{cases} \ddagger_{e,f-1} & \text{when
      } f\geq 1 \text{ and } x_{\uptau}\neq d \\
      \dagger_{e,f-1} & \text{when
      } f\geq 1 \text{ and } x_{\uptau}= d \\
      0 & \text{otherwise}
    \end{cases}\\
    \ncP_{\uptau}& = \begin{cases} \ddagger_{e-1,f} & \text{when
      } e\geq 1 \text{ and } x_{\uptau}\neq d \\
      \dagger_{e-1,f} & \text{when
      } e\geq 1 \text{ and } x_{\uptau}= d \\
      0 & \text{otherwise}
    \end{cases}.\\
  \end{split}
\]
%
% $\pcP$ and $\ncP$ are 1-rows of sign $(p_{1}-p''_{1}+1,q_{1}-q''_{1})$ and
% $(p-p'',q-q''+1)$ respectively.

\medskip

\delete{
By induction hypothesis, we have
a factorization of $\cL_{\uptaupp}$ as in \eqref{eq:ls.factor}
\[
  \cL_{\uptaupp} = \sum_{i=-(k-1)}^{k-1}\cB_{\uptaupp,i}\cdot \cD_{\uptaupp,i}.
\]
%where $\abs{i}\leq k-1$ in the above formula.
Then we have the following factorization of $\cL_{\uptau}$:
\[
\cL_{\uptau}=\sum_{i\neq 0} \cT_{\uptau,i}\cdot \cP_{\uptau,i}, \text{ with
} \cT_{\uptau,i}:=
\begin{cases}
\dagger\dagger \cB_{\uptaupp,i-1} & i\geq 1 \\
\dagger\dagger \cB_{\uptaupp,i+1} & i\leq -1.
\end{cases}
\]
Now we describle $\cP_{\uptau,i}$ according to $x_{\uptaupp}$ case by case. In the
following discussion,
\[
  \uup\cdots\uup\quad \text{ and }\quad  \uum\cdots\uum
\]
always denote a row has length
$2i+1$ with unspecified associated character.
%We have the following cases
%\subsubsection{}
%First note that $x_{\uptaupp}\neq s$ in generalized descent.

 \subsubsection{Case $x_{\uptaupp}=r$}\label{sec:z.r}
 We will see that the factorization \eqref{eq:d.factor} always holds
 when $x_{\uptaupp}=r$ and $n\geq 2$.
 % according to the about list.
  %\item $x_{\uptaupp}=r$. %In this case, all length $3$ rows ends with $+$ sign!
  % So
  % $\bsign{\bfxx_{\uptaupp}} \succ (2,0)$, $\pcL_{\uptaupp}\neq 0$ has tail with
  % sign $+$, and $\ncL_{\uptaupp}=0$.
  We have three sub-cases:
  \begin{enumT}
  \item $\bfpp_{\uptau} = \tytb{rc\cdots,\vdots,r}$. Then
  $\cL_{\uptau}=\sum_{i=1}^{k} (\dagger\dagger \cB_{\uptaupp,i-1})\cdot \cP_{\uptau,i}$, where
  \begin{equation}\label{eq:rr.c}
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,+,\vdots,+} \quad \forall i\geq 1.
  \end{equation}

 When $n\geq 2$, we have $\cP_{\uptau,i}\succeq \tytb{+,+}$ and the
 factorization \eqref{eq:d.factor} holds.

 When $n=1$, we set
 \begin{equation} \label{eq:gd.rr}
   \cB_{\uptau,0} = 0,
   \cB_{\uptau,i} = \cT_{\uptau,i} \text{ and
   } \cD_{\uptau,i} = \cP_{\uptau,i} \text{ for } i\geq 1.
 \end{equation}
 Now $\cL_{\uptau} = \sum_{i=1}^{k} \cB_{\uptau,i}\cdot \cD_{\uptau,i}$.
%where $i$ is the index such that $\cB_{\uptaupp,i}\neq 0$.

 \item $\bfpp_{\uptau} = \tytb{rc\cdots,\vdots,r,d}$.
 In this case, $n\geq 2$.
  \begin{equation}\label{eq:rd.c}
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,-,+,\vdots,+} \succ \tytb{-,+} \quad  \forall i\geq 1
  % \cP_{\uptau,1}  = \tytb{\uup\uum\uup,-,+,\vdots,+}\quad
  % \cP_{\uptau,2}  = \tytb{\uup\uum\uup\cdots,-,+,\vdots,+}
  \end{equation}
In particular, \eqref{eq:d.factor} holds.
% $\cP_{\uptau,i}\succeq \ddagger_{(2,1)}\succ \dagger_{(1,1)}$ and the
% factorization
% $\cL_{\uptau} = \cB_{\uptau,1}\cdot \cD_{\uptau,1}$ such that $\cD_{\uptau,1}=\tytb{+,-}$.
 \item $\bfpp_{\uptau} = \tytb{sr\cdots,\vdots,s,{x_{j}},\vdots,{x_{n}}}$.
% $y_{1}=x_{\uptaupp}=r$ and $\bfxx_{\uptau} = s\cdots sx_{j}\cdots x_{n}$ with
 In this case $\#s(\bfxx_{\uptau})\geq 1$.

 When $n\geq 2$, the factorization \eqref{eq:d.factor} holds.
 More precisely, we have four cases according to the mark of $x_{n}$.
 \begin{enumT}
   \item $x_{n}=s$, i.e. $\bfxx_{\uptau} = s\cdots s$. Then
   \[
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,=,\vdots,=} \quad \forall i \geq 1
   \]
   When $n= 1$,
   $\cL_{\uptau} = \sum_{i=-1}^{-k} \cB_{\uptau,i}\cdot \cD_{\uptau,i}$
   with $\cB_{\uptau,i} = \cT_{\uptau,i}$ and $\cD_{\uptau,i} = \cP_{\uptau,i}$.
   % and the
   % factorization is also given by the formula \eqref{eq:gd.rr}.
   \item $x_{n}=r$. Then $n\geq 2$ and
   \[
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,+,\vdots,+,=,\vdots,=} \succeq \tytb{+,+,=}\succ \tytb{+,+,\none}
  \quad \forall i\geq 1
  \]
   \item $x_{n}=c$. Then $n\geq 2$ and
   \[
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,+,\vdots,+,=,\vdots,=} \succeq \tytb{+,=,=}\succ \tytb{+,=,\none}
  \quad \forall i\geq 1
  %\cP_{\uptau,2}  = \tytb{\uup\uum\uup\cdots,+,\vdots,+,=,\vdots,=} \succeq \tytb{+,=,=}\succ \tytb{+,=,\none}
   \]
   \item $x_{n}=d$. Then $n\geq 2$ and
   \[
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,+,\vdots,+,-,\vdots,-}  \succeq \tytb{+,-,-}\succ \tytb{+,-,\none}
  \quad \forall i\geq 1
  %\cP_{\uptau,2}  = \tytb{\uup\uum\uup\cdots,+,\vdots,+,-,\vdots,-} \succeq \tytb{+,-,-}\succ \tytb{+,-,\none}
   \]
 \end{enumT}
 % Suppose $\Sign(\bfxx_{\uptau})=(p_{1},q_{1})$ with $p_{1}+q_{1}=2n$
  % \begin{equation}%\cL_{\uptau} = \dagger\dagger \pcL_{\uptaupp} \cdot \ytableaushort{+,\vdots,+,{-/=},\cdots,{-/=}}
  %   \cB_{\uptau}  =
  %   \tytb{+-+,+,\vdots,+,-,\vdots,-}  \text{ when } x_{n} = d \text{ or  } \tytb{+-+,+,\vdots,+,=,\vdots,=}
  %   \text{ when } x_{n} = r/c
  % \end{equation}
  % \[
  %   \cB_{\uptau} = \tytb{+-+,=,\vdots,=} \text{ when } x_{n}=s.
  % \]
  % Note that, we have at least one $-$ sign in 1-rows.
  % At least two $-$ signs if $x_{n}=c/d$.

  %  We have  $\cB_{\uptau}\succeq \ddagger_{(0,2)}$  when $x_{n}=s$;
  %  $\cB_{\uptau}\succeq \ddagger_{(2,1)}$  when $x_{n}=r$;
  % $\cB_{\uptau}\succeq \ddagger_{(2,1)}$ when $x_{n}=c$;
  % $\cB_{\uptau}\succeq \dagger_{(2,1)}$ when $x_{n}=d$.
  \end{enumT}


  \subsubsection{Case $x_{\uptaupp}=c$}\label{sec:z.c}
  % In this case, the length $3$-rows will contain at least one $-$ sign.
  %$\pcL_{\uptaupp}\neq 0$ has tail sign $=$, and $\ncL_{\uptaupp}=0$.
  %We assume $\Sign(\bfxx_{\uptau})=(p_{1},q_{1})$.
  We always have $\cP_{\uptau,2}=\emptyset$.
  \begin{enumT}
    \item  $x_{n} =  s$. In this case $x_{\uptau}=s\cdots s$.
    \begin{equation}\label{eq:ss.c}
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,=,\vdots,=} \quad \forall i\geq 1.
    \end{equation}
    When $n\geq 2$, the  factorization \eqref{eq:d.factor} holds.

    When $n=1$, we have
    \begin{equation}\label{eq:gd.ss}
      \cL_{\uptau} = \sum_{i=-1}^{-k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}
      \text{ where } \cB_{\uptau,i}=\cT_{\uptau,-i}
      \text{ and }\cD_{\uptau,i}=\cP_{\uptau,-i}.
  \end{equation}
  \item $x_{n} = r$.
    In this case, $\bfxx_{\uptau}= s\cdots sr\cdots r$ where
    $\#s(\bfxx_{\uptau})>1$ and $n\geq 2$.
   \[
     \cP_{\uptau,i}  = \tytb{\uum\cdots\uum,=,\vdots,=,+,\vdots,+,} \succeq \tytb{=,+,+}\succ\tytb{\none,+,+}
     \quad \forall i\geq 1.
   \]
   In particular, \eqref{eq:d.factor} holds.
   \item $x_{n} = c$.
   % In this case, $\bfxx_{\uptau}= s\cdots s r\cdots r$ where number of
   \begin{enumT}
     \item
     When $\#s(\bfxx_{\uptau})>1$ and so $n\geq 2$.
     \[
       \cP_{\uptau,i}  = \tytb{\uum\cdots\uum,+,\vdots,+,=,\vdots,=} \succ \tytb{+,=}
     \quad \forall i\geq 1.
     \]
     % The
     % Otherwise, $\cP_{\uptau,1}\succ \ddagger_{1,1}$.
     The factorization \eqref{eq:d.factor} holds.
     \item
     When $\bfxx_{\uptau}=r\cdots rc$ with $n_{r}:=\#r(\bfxx_{\uptau}) \geq 0$.
     \[
       \cP_{\uptau,i}  = \tytb{\uum\cdots\uum,+,\vdots,+} %\quad \forall i\geq 1. \succ \tytb{+}.
       \quad \forall i\geq 1.
     \]
     We have $\cL_{\uptau} = \sum_{i=1}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}$  where $\cD_{\uptau,i} = \tytb{\uum\cdots\uum,+}$ and
     $\cB_{\uptau,i} = \cT_{\uptau,i}\cdot \ddagger_{2n_{r},0}$.
   \end{enumT}
   \item $x_{n} = d$. In this case, $n\geq 2$ and
   $\#s(\bfxx_{\uptau})+\#c(\bfxx_{\uptau})\geq 1$. Therefore,
    \begin{equation}\label{eq:ss.c}
      \cP_{\uptau,i} = \tytb{\uum\uup\uum\cdots,-,\vdots,-,+,\vdots,+}\succ \tytb{-,+}, \quad \forall i\geq 1
    \end{equation}
    and the factorization \eqref{eq:d.factor} holds.
  \end{enumT}

  \subsubsection{Case $x_{\uptaupp}=d$}\label{sec:z.d}
  In this case, $\bfxx_{\uptau}$ could be anything.
%  Then
  %$\pcL_{\uptaupp} = \cT_{\uptaupp} \cdot \pcB_{\uptaupp}$ and $\ncL_{\uptaupp}=\cT_{\uptaupp} \cdot \ncB_{\uptaupp}$.
 % We assume $\bsign{\pcL_{\uptaupp}}=(p-1,q)$ and $\bsign{\ncL_{\uptaupp}}=(p,q-1)$.
  % \[
  %   \cL_{\uptau} = \dagger \dagger \cT_{\uptaupp}\cdot \cB_{\uptau}.
  % \]
  \begin{enumT}
    \item $\bfxx_{\uptau}=s\cdots s$. We have
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,=,\vdots,=} \quad \forall i\geq 1.
    \]
    When $n\geq 2$, the factorization \eqref{eq:d.factor} holds.
% Clearly $\pcL_{\uptau}=\emptyset$.
    When $n=1$, the factorizaton is given by \eqref{eq:gd.ss}.
    \item $\bfxx_{\uptau}=r\cdots r$.
    \[
      \cP_{\uptau,i} = \tytb{\uup\cdots\uup,+,\vdots,+} \quad \forall i\leq -1.
    \]
    When $n\geq 2$, the factorization \eqref{eq:d.factor} holds.

    When $n=1$,
    \[
    \cL_{\uptau} = \sum_{i=1}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i} \text{
      where } \cB_{\uptau,i} = \cT_{\uptau,-i} \text{ and } \cD_{\uptau,i} = \cP_{\uptau,-i}.
    \]
    \item $\bfxx_{\uptau} = s\cdots sr\cdots r$ with $n_{s}:=\#s(\bfxx_{\uptau})\geq 1$
    and $n_{r}:=\#r(\bfxx_{\uptau})\geq 1$
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,=,+,+,+,\vdots,+,=,\vdots,=}
      \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,+,=,=,+,\vdots,+,=,\vdots,=}
      \quad \forall i\geq 1
    \]
    %Clearly $\cP_{\uptau,i}\succ \ddagger_{(1,1)}$ and $n\geq 2$.
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}.
    \]
    Here
      \begin{align*}
        \cB_{\uptau,0} &= \sum_{i=1}^{k} \cT_{\uptau,i}\cdot \tytb{\uum\cdots\uum,=} \cdot\ddagger_{2n_{r}-2,2n_{s}-2}, &
        \cD_{\uptau,0} &= \tytb{+,+},\\
        \cB_{\uptau,i} &= \cT_{\uptau,-i}\cdot \ddagger_{2n_{r}-2,2n_{s}},  &
        \cD_{\uptau,i} &= \tytb{\uup\cdots\uup,+}, \quad \forall i\geq 1\\
      \end{align*}
    \item $\bfxx_{\uptau} = s\cdots sc$ where $n_{s}:=\#s(\bfxx_{\uptau})\geq 0$.
    \begin{equation}\label{eq:ped.ssc}
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,=,\vdots,=} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,=,=,\vdots,=} \quad \forall i\geq 1
    \end{equation}
    We have
    \[
      \cL_{\uptau} = \sum_{i=1}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}+ \sum_{i=1}^{k}\cB_{\uptau,-i}\cdot \cD_{\uptau,-i}.
    \]
    For $i\geq 1$,
      \begin{align*}
        \cB_{\uptau,i} &= \cT_{\uptau,i}\cdot \ddagger_{0,2n_{s}}, &
        \cD_{\uptau,i} &= \tytb{\uum\cdots\uum,+},\\
        \cB_{\uptau,-i} &= \cT_{\uptau,-i}\cdot \ddagger_{0,2n_{s}},  &
        \cD_{\uptau,-i} &= \tytb{\uup\cdots\uup,=}. %, \quad \forall i\geq 1\\
      \end{align*}
    \item $\bfxx_{\uptau} = r\cdots rc$ where $n_{r} = \#r(\bfxx_{\uptau})\geq 1$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,=,+,\vdots,+}
      \quad \forall i\geq 1
    \]
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}.
    \]
    where
      \begin{align*}
        \cB_{\uptau,0} &= \sum_{i=1}^{k}\cT_{\uptau,-i}\cdot \tytb{\uup\cdots\uup,+} \cdot \ddagger_{2n_{r}-2,0}, &
        \cD_{\uptau,0} &= \tytb{=,+},\\
        \cB_{\uptau,i} &= \cT_{\uptau,i}\cdot \ddagger_{2n_{r},0},  &
        \cD_{\uptau,i} &= \tytb{\uum\cdots\uum,+}  \quad \forall i\geq 1.\\
      \end{align*}
    \item $\bfxx_{\uptau} = s\cdots sr\cdots rc$ where
    $n_{s} := \#s(\bfxx_{\uptau})\geq 1, n_{r}:=\#r(\bfxx_{\uptau})\geq 1$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+,=,\vdots,=}\succ \tytb{+,=},
      \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,=,+,\vdots,+,=,\vdots,=}\succ \tytb{+,=} \quad \forall i\geq 1
    \]
    %Note that $\cP_{\uptau,i}\succ \ddagger_{(1,1)}$.
    Now the factorization \eqref{eq:d.factor} holds.
    \item $\bfxx_{\uptau} = s\cdots sd$ where $\#s(\bfxx_{\uptau})\geq 1$.
    \begin{equation}\label{eq:ped.ssd}
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,-,\vdots,-} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-,-,\vdots,-}
      \quad \forall i\geq 1
    \end{equation}
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,-i}\cdot \cD_{\uptau,-i}.
    \]
    where
      \begin{align*}
        \cB_{\uptau,0} &= \sum_{i=1}^{k}\cT_{\uptau,i}\cdot \tytb{\uum\cdots\uum,-} \cdot \dagger_{0,2n_{s}-2}, &
        \cD_{\uptau,0} &= \tytb{+,-},\\
        \cB_{\uptau,-i} &= \cT_{\uptau,-i}\cdot \ddagger_{0,2n_{s}},  &
        \cD_{\uptau,-i} &= \tytb{\uup\cdots\uup,-}  \quad \forall i\geq  1.\\
      \end{align*}
    \item $\bfxx_{\uptau} = r\cdots rd$ where $n_{r}=\#r(\bfxx_{\uptau})\geq 1$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-,+,\vdots,+}
      \quad \forall i\geq 1
    \]
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}.
    \]
    where
      \begin{align*}
        \cB_{\uptau,0} &= \sum_{i=1}^{k}\cT_{\uptau,-i}\cdot \tytb{\uup\cdots\uup,+} \cdot \dagger_{2n_{r}-2,0}, &
        \cD_{\uptau,0} &= \tytb{-,+},\\
        \cB_{\uptau,i} &= \cT_{\uptau,i}\cdot \dagger_{2n_{r},0},  &
        \cD_{\uptau,i} &= \tytb{\uum\cdots\uum,+}  \quad \forall i\geq  1.\\
      \end{align*}
    \item $\bfxx_{\uptau} = s\cdots sr\cdots rd$ where
    $\#s(\bfxx_{\uptau})\geq 1, \#r(\bfxx_{\uptau})\geq 1$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+,-,\vdots,-} \succ\tytb{+,-},
      \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-,+,\vdots,+,-,\vdots,-} \succ\tytb{+,-}
      \quad \forall i\geq 1.
    \]
    Now the factorization \eqref{eq:d.factor} holds.
    \item $\bfxx_{\uptau} = s\cdots sr\cdots rcd$ where
    $\#s(\bfxx_{\uptau})\geq 0, \#r(\bfxx_{\uptau})\geq 0$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+,-,\vdots,-}\succ\tytb{+,-},
      \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-,+,\vdots,+,-,\vdots,-}\succ\tytb{+,-}
      \quad \forall i\geq 1.
    \]
    Now the factorization \eqref{eq:d.factor} holds.
    \item $\bfxx_{\uptau}=d$. In this case, $\bfpp_{\uptau} = dd\cdots$
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-}
      \quad \forall i \geq 1
    \]
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}+\sum_{i=0}^{k}\cB_{\uptau,-i}\cdot \cD_{\uptau,-i}.
    \]
    where
    \[
        \cB_{\uptau,i} = \cT_{\uptau,i}, \quad
        \cD_{\uptau,i} = \cP_{\utau,i}  \quad \forall i = -k, \cdots, -1,1,\cdots, k.\\
    \]
  \end{enumT}
}

%\subsubsection{Summary of the factorization}
% We have the non-vanishing of the lifted local system $\cL_{\uptau}$ and the
% factorization described in
% \Cref{eq:ls.factor} holds.
\begin{lem}
  The local system $\cL_{\uptau}\neq 0$.
\end{lem}
\begin{proof}
  Since $x_{\uptaupp}\neq s$, $\pcL_{\uptaupp}\neq 0$. When
  $\ssign(\bfuu_{\uptau})\succeq (0,1)$, the first term in \eqref{eq:gd.ls} dose
  not vanish. Now suppose $\ssign(\bfuu_{\uptau})\nsucc(0,1)$. We have
  $x_{\uptaupp}=d$ by \Cref{lem:u} and $\ssign(\bfuu_{\uptau})\succ(1,0)$.
  Therefore, $\ncL_{\uptaupp}\neq 0$ by the induction hypothesis and the second
  term in \eqref{eq:gd.ls} dose not vanish. Hence $\cL_{\uptau}\neq 0$ in all
  cases.
\end{proof}

\subsubsection{Unipotent representations attached to $\cOp$}
In this section, we let $\uptaup\in \drc(\cOp)$ and
$\uptaupp  = \eDDo(\uptaup)\in \drc(\cOpp)$. First note that
$x_{\uptaupp}\neq s$ and so $\pcL_{\uptaupp}$ always non-zero.

Recall \eqref{eq:LS.taup}.
We claim that we can recover $\pcL_{\uptaupp}$ and
$\ncL_{\uptaupp}$ from $\cL_{\uptaup}$:
\begin{lem}\label{c:gd.C1}
  The map $\Omega_{\cOp}\colon \cL_{\uptaup}\mapsto (\pcL_{\uptaupp},\ncL_{\uptaupp})$ is a well
  defined map.
\end{lem}
\begin{proof}
  When $\lsign(\cL_{\uptaup})$ has two elements, $x_{\uptaupp}=d$ and
  $\lsign(\cL_{\uptaup}) = \set{(q''_{1},p''_{1}-1),(q''_{1}-1,p''_{1})}$. In
  \eqref{eq:LS.taup}, $\dagger\pcL_{\uptaupp}$ (resp. $\dagger\ncL_{\uptaupp}$)
  consists of components whose first column has siginature $(q''_{1},p''_{1}-1)$
  (resp. $(q''_{1}-1,p''_{1})$). When $\lsign(\cL_{\uptaup})$ has only one
  elements, $x_{\uptau}=r/c$,
  $\lsign(\cL_{\uptaup}) = \set{(q''_{1},p''_{1}-1)}$,
  $\cL_{\uptaup} = \dagger\pcL_{\uptaupp}$ and $\ncL_{\uptaupp}=0$
  % \trivial[h]{
  %   Note that, $\lsign( \dagger\pcL_{\uptaupp} ) = (q_{0},p_{0}-1)$ and
  %   $\lsign( \dagger\ncL_{\uptaupp} ) = (q_{0}-1,p_{0})$ (if it is none-zero) by
  %   \eqref{eq:lsign.1}. }

  In any case, we get
  % recover $\lsign(\cL_{\uptaupp})=(p_{0},q_{0})$ and
  \begin{equation}\label{eq:uptaupp.sign}
    \ssign(\uptaupp) = (n_{0},n_{0})+(p''_{1},q''_{1})\quad \text{where }
    2n_{0} = \abs{\DD(\cOpp)}.
  \end{equation}
% $+\half \abs{\DD(\cOpp)} \cdot(1,1)$.
  Using the signature $\ssign(\uptaupp)$, we could recover the twisting
  characters in the theta lifting of local system. Therefore
  $\pcL_{\uptaupp}$ and $\ncL_{\uptaupp}$ can be recovered from  $\cL_{\uptaup}$.
\end{proof}


\begin{lem}\label{c:gd.C3}
  Suppose $\uptaup_{1}\neq \uptaup_{2}\in \drc(\cOp)$. Then
  $\uppi_{\uptaup_{1}}\neq \uppi_{\uptaup_{2}}$.
\end{lem}
\begin{proof}
  It suffice to consider the case when $\cL_{\uptaup_{1}} = \cL_{\uptaup_{2}}$.
 By \eqref{eq:uptaupp.sign} in the proof of \Cref{c:gd.C1},
 $\ssign(\uptaupp_{1}) = \ssign(\uptaupp_{2})$.
 On the other hand, $\upepsilon_{1}=\upepsilon_{2}=0$ and
 $\uptaupp_{1}\neq \uptaupp_{2}$ by \Cref{lem:gd.CD}. So
 \[
   \uppi_{\uptaup_{1}} = \Thetab(\uppi_{\uptaupp_{1}})\neq\Thetab(\uppi_{\uptaupp_{2}}) = \uppi_{\uptaup_{2}}
 \]
  by the injectivity of theta lift.
\end{proof}


%\medskip

% When $\bfpp_{\uptau} = \tytb{sd\cdots,\vdots,s,{c/d}}$,
% $\pcL_{\uptau} = (\dagger\dagger \cB_{\uptaupp,1} \cP_{\uptau,1})^{+}$
% and this is the only case that $\pcL_{\uptau}\neq \emptyset$ has less irreducible
% components than that of $\cL_{\uptau}$.

% {
%   \color{red}
%   The above computation also tells the shape of legs of $\cL_{\uptau}$ according
%   to $\bfpp_{\uptau}$.
% }

% , $\cOpp$ is noticed when
% $C_{2k}$ is even or $\cOpp$ is +notice when $\cO_{2k}$ is odd.

\subsubsection{Unipotent representations attached to $\cO$}

\begin{lem}\label{c:gd.D1}
  Suppose $\uptau_{1}\neq \uptau_{2}\in \drc(\cO)$. Then $\uppi_{\uptau_{1}}\neq \uppi_{\uptau_{2}}$.
\end{lem}
\begin{proof}
 It suffice to consider the case that $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$.
 Clearly, $\ssign(\uptau_{1})=\ssign(\uptau_{2})$. On the other hand,
 the twisting $\upepsilon_{\uptau_{1}}=\upepsilon_{\uptau_{2}}$ since it is
 determined by the  local system:
 $\upepsilon_{\uptau_{i}}=0$ if and only if $\cL_{\uptau_{i}}\supset \tytb{-}$.
 %(see \eqref{eq:gd.ls}).

 We conclude that $\uptaupp_{1}\neq \uptaupp_{2}$ and $\uptaup_{1}\neq \uptaup_{2}$
 by \Cref{lem:gd.inj} and \Cref{lem:gd.CD}.
 By \Cref{c:gd.C3} and the injectivity of theta lift,
 \[
   \uppi_{\uptau_{1}} = \Thetab(\pi_{\uptaup_{1}})\otimes (\bfone^{+,-})^{\upepsilon_{\uptau_{1}}}
  \neq \Thetab(\pi_{\uptaup_{2}})\otimes (\bfone^{+,-})^{\upepsilon_{\uptau_{2}}} = \uppi_{\uptau_{2}}
 \]
\end{proof}


\subsubsection{Noticed orbits}

% \begin{claim}
% Suppose $\uptau_{1}\neq \uptau_{2}$ and
% $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$. Then, $\uptaup_{1}\neq \uptaup_{2}$ and
% $\upepsilon_{1}=\upepsilon_{2}$.
% \end{claim}
% \begin{proof}
% First note taht $\upepsilon_{i}$ is completely determined by the shape of local
% system $\cL_{\uptau_{i}}$.
% Observe that
% $\abs{\ssign(\uptau)} - \abs{\ssign(\uptaupp)} = \abs{\ssign(\bfxx_{\uptau}y_{1})} - \abs{\ssign(z_{1})}$.
% This implies that the signature of $\uptau$ is completely determined by
% $\bfxx_{\uptau}y_{1}$ and $\uptaupp$.
% Also observe that $\uptaupp$ is determined by $\uptaup$.

% By our algorithm we see that, for every fixing $\uptaup, \upepsilon$,
% the map
% \[
% \set{\uptau | \eDD(\uptau)= (\uptaup,\upepsilon)} \rightarrow \bZ
% \]
% defined by $\uptau\mapsto \abs{\ssign(\bfxx_{\uptau}y_{1})} - \abs{\ssign(z_{1})}$ is
% injective.

% Now $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$ implies
% $\ssign(\uptau_{1})=\ssign(\uptau_{2})$.

% Suppose $\uptaup:=\uptaup_{1}=\uptaup_{2}$ and $\upepsilon=\upepsilon_{1}=\upepsilon_{2}$, $\uptau_{1}$ and $\uptau_{2}$ are two
% elements in the above set with the same image in $\bZ$. This yields an
% contradiction.
% \end{proof}


% Now fix signature $(p,q)$. We will show that
% \[
%   \set{\cL_{\uptau}| \lsign(\cL_{\uptau}) = (p,q)}\longrightarrow \set{\cL_{\uptaup}}
% \]
% is injective when $\cO$ is noticed.


In this section, we prove the claims about noticed and +noticed orbits.

% \begin{claim}\label{c:gd.C2}
%   Suppose $\cOpp$ is +noticed. Then
%   \begin{enumT}
%     \item \label{c:gd.C2.1}The map
% $\set{\cL_{\uptaupp}| x_{\uptaupp}\neq s}\rightarrow \set{\cL_{\uptaup}}$ given by
% $\cL_{\uptaupp}\mapsto \cL_{\uptaup}=\vartheta(\cL_{\uptaupp})$ is a bijection.
% \item
% The map $\drc(\cOp)\rightarrow \LLS(\cOp)$ given by $\uptaup\mapsto \cL_{\uptaup}$ is a bijection.
% \end{enumT}
% \end{claim}
% \begin{proof} %Recall \eqref{eq:LS.taup}.
%   Let $\uptaup\in \drc(\cOp)$.
%   By \Cref{c:gd.C1}, we have a well defined map
%   $\cL_{\uptaup}\mapsto \pcL_{\uptaupp}$ with $\pcL_{\uptaupp}\neq 0$.
%   Since $\cOpp$ is +noticed, $\pcL_{\uptaupp}$ uniquely determines the local
%   system $\cL_{\uptaupp}$ by inductive hypothesis. Therefore,
%   $\cL_{\uptaup}\mapsto \pcL_{\uptaupp}\mapsto \cL_{\uptaupp}$ gives the inverse
%   map in the claim.

%   Now suppose $\uptaup_{1}\neq \uptaup_{2}\in \drc(\cOp)$. By \Cref{lem:gd.CD},
%   $\uptaupp_{1}\neq \uptaupp_{2}$. Hence
%   $\cL_{\uptaupp_{1}}\neq\cL_{\uptaupp_{2}}$ by the induction hypothesis.
%   Therefore, $\cL_{\uptaup_{1}}\neq \cL_{\uptaup_{2}}$ by part \eqref{c:gd.C2.1}
%   of the claim.
% % Case $x_{\uptaupp}=d$:
% %   When $\lsign(\cL_{\uptaupp}) = \set{(q_{0},p_{0}-1),(q_{0}-1,p_{0})}$ has two
% %   elements,
% %   we let $\pcL_{\uptaup}$ (resp. $\ncL_{\uptaup}$) be the parts whose
% %   $\lsign = (q_{0},p_{0}-1)$ (resp. $=(q_{0}-1,p_{0})$).
% %   If $\bsign(\cL_{\uptaup})= \set{(0,0)}$,
% %   $\cL_{\uptaupp} = \DD(\pcL_{\uptaup})\cdot + \cup \DD(\ncL_{\uptaup})\cdot - $.
% %   Otherwise, if every component of $\cL_{\uptaupp}$ $\succ \dagger_{(1,0)}$,
% %   we have $\cL_{\uptaupp} = \DD(\pcL_{\uptaup})\cdot +$; if
% %   $\cL_{\uptaupp} \succ \dagger_{(0,1)}$,
% %   $\cL_{\uptaupp} = \DD(\ncL_{\uptaup})\cdot -$.

% % Case $x_{\uptapp}=r/c$:
% % Since $\cOpp$ is +noticed, we have
% % $\cL_{\uptaup} = \dagger\pcL_{\uptaupp}\mapsto \pcL_{\uptaupp}\mapsto \cL_{\uptaupp}$
% % is well defined, and bijective with $\set{\cL_{\uptaupp}|\pcL_{\uptaupp}\neq \emptyset}$.
% % $\cL_{\uptaupp}\mapsto \pcL_{\uptaupp}$ is injective. Hence
% % $\cL_{\uptaup}\mapsto \cL_{\uptaupp}$ is injective.
% \end{proof}

% \begin{prop}\label{c:gd.pnoticed}
%     Suppose $\cO$ is +noticed.
%     The map $\Upsilon \colon \set{\uptau\in\drc{\cO}|x_{\uptau}}
%     \longrightarrow \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0}\longrightarrow \set{\pcL_{\uptau}\neq 0}$
%     is injective.
%   %   \item
%   %   Suppose $\cO$ is noticed the map $\Upsilon$ defined in \eqref{eq:up} is injective.
%   % \end{enumC}
% \end{prop}

\begin{lem}\label{c:gd.C2}
  Suppose $\cOp$ is noticed. Then
  \begin{enumT}
    \item \label{c:gd.C2.1}The map
$\set{\cL_{\uptaupp}| x_{\uptaupp}\neq s}\longrightarrow \set{\cL_{\uptaup}}=\LLS(\cOp)$ given by
$\cL_{\uptaupp}\mapsto \cL_{\uptaup}=\vartheta(\cL_{\uptaupp})$ is a bijection.
\item
The map $\drc(\cOp)\rightarrow \LLS(\cOp)$ given by $\uptaup\mapsto \cL_{\uptaup}$ is a bijection.
\end{enumT}
\end{lem}
\begin{proof} %Recall \eqref{eq:LS.taup}.
  \begin{enumPF}
    \item
  Note that $\cOpp$ is noticed by definition. Hence $\Upsilon_{\cOpp}$ is invertible.
  % Let $\uptaup\in \drc(\cOp)$.
  % By  and the induction hypothesis , we have a well defined map
  % $\cL_{\uptaup}\mapsto \pcL_{\uptaupp}$ with $\pcL_{\uptaupp}\neq 0$.
  % Since $\cOpp$ is +noticed, $\pcL_{\uptaupp}$ uniquely determines the local
  % system $\cL_{\uptaupp}$ by inductive hypothesis. Therefore,
  %
  Recall \Cref{c:gd.C1}, we see that
  \[
    (\Upsilon_{\cOpp})^{-1}\circ \Omega_{\cOp}\colon
    \cL_{\uptaup}\mapsto (\pcL_{\uptaupp},\ncL_{\uptaupp})\mapsto \cL_{\uptaupp}
  \]
  gives the inverse of the map in the claim.
  \item
  Suppose $\uptaup_{1}\neq \uptaup_{2}\in \drc(\cOp)$. By \Cref{lem:gd.CD},
  $\uptaupp_{1}\neq \uptaupp_{2}$. Hence
  $\cL_{\uptaupp_{1}}\neq\cL_{\uptaupp_{2}}$ by the induction hypothesis.
  Therefore, $\cL_{\uptaup_{1}}\neq \cL_{\uptaup_{2}}$ by \ref{c:gd.C2.1}
  of the claim.
\end{enumPF}
\end{proof}

\begin{lem}\label{c:noticed.bij}
 Suppose $\cO$ is noticed, $\cL \colon \drc(\cO)\mapsto \LLS(\cO)$ given by
 $\uptau\mapsto \cL_{\uptau}$ is bijective.
% Moreover, $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$ implies $\cL_{\uptaup_{1}}=\cL_{\uptaup_{2}}$.
\end{lem}
\begin{proof}
We prove the claim by contradiction. We assume $\uptau_{1}\neq \uptau_{2}$ such
that $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$.


Recall \eqref{eq:gd.ls}: there is an pair of non-negative integers
$(e_{i},f_{i})=\ssign(\bfuu_{\uptau_{i}})$ such that
\[
  \cL_{\uptau_{i}} = \dagger\dagger \pcL_{\uptaupp_{i}}\cdot \pcP_{\uptau_{i}}
  + \dagger\dagger \ncL_{\uptaupp} \cdot \ncP_{\uptau_{i}}.
\]

\begin{enumPF}
  \item
Suppose that $\cL_{\uptau_{i}}$ contains a 1-row marked by $-$ or $=$. Then we
have
%\begin{enumI}
%  \item
$\upepsilon_{\uptau_{1}}=\upepsilon_{\uptau_{2}}$, which can be read from the mark $-/=$.
Moreover, the term
$\dagger\dagger\pcL_{\uptaupp_{i}}\cdot \pcP_{\uptau_{i}}\neq 0$ and we can
recover it from $\cL_{\uptau_{i}}$. So $\pcL_{\uptaupp_{1}} = \pcL_{\uptaupp_{2}}$.
Since $\cOpp$ is +noticed, $\uptaupp_{1}=\uptaupp_{2}$ by
\eqref{c:gd.pnoticed} and the induction hypothesis.
Note that $\ssign(\uptau_{1})=\ssign(\uptau_{2})$, we get
$\uptau_{1}=\uptau_{2}$ by \Cref{lem:gd.inj} which is contradict to our assumption.

% as the parts.. must contains the term
 % where $\pcP_{i}$ and $\ncP_{i}$ are columns of sign $(p_{i},q_{i}-1)$ and
 % $(p_{i}-1,q_{i})$ respectively.
 % Here we adapt the convention that $\pcP_{i} = \emptyset$ (resp. $\ncP_{i}$) if
 % $q_{i}-1<0$ (resp. $p_{i}-1<0$).

% Therefore, we have $\cL_{\uptaup_{i}}= \DD(\cL_{\uptau_{i}}) $ if $\cL_{\uptau}$ contains a 1-row
% of $+$ sign and a 1-row of $-$ sign.
\item
Now we assume that $\cL_{\uptau_{i}}$ does not contains a 1-row marked by $-/=$.
By \eqref{eq:gd.ls}, we conclude that $x_{\uptaupp}\neq d$ and
$\bfuu_{\uptau} = r\cdots r$ or $ r\cdots rc$. Therefore $\bfpp_{\uptau_{i}}$
must be one of the following form by \Cref{lem:u}:
% The exceptioinal cases are:
% \begin{enumT}
%   \item $(p_{i},q_{i}) = (2a,0)$ and so $\pcP_{i}=\emptyset$.
%   In this case, $\set{\bfpp_{\uptau_{i}}}$ must consists of the following three elements
  \[
    \bfpp_{1} =\tytb{rc,\vdots,r,r}, \quad \bfpp_{2}=\tytb{rc,\vdots,r,c}, \quad\text{and}
    \quad\bfpp_{3}= \tytb{rd,\vdots,r,r}\\
  \]
  We consider case by case according to the set $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}}$:
  \begin{enumPF}
    \item Suppose
    $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}}=\set{\bfpp_{1}}$ or $ \set{\bfpp_{2}}$.
    In these cases, $\upepsilon_{\uptau_{1}}=\upepsilon_{\uptau_{2}}$ and
    $\uptaupp_{1}\neq \uptaupp_{2}$ by \Cref{lem:gd.inj}.
    On the other hand, $\pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}$ by \eqref{eq:gd.ls}.
    Since $\cOpp$ is +noticed, we get $\uptaupp_{1}=\uptaupp_{2}$ a contradiction.
    \item Suppose
    $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}}=\set{\bfpp_{3}}$.
    We still have $\upepsilon_{\uptau_{1}}=\upepsilon_{\uptau_{2}}$ and
    $\uptaupp_{1}\neq \uptaupp_{2}$ by \Cref{lem:gd.inj}.
    On the other hand, $\ncL_{\uptaupp_{1}}=\ncL_{\uptaupp_{2}}$ by \eqref{eq:gd.ls}.
    This again contradict to the injectivity of $\cL_{\uptaupp}\mapsto \ncL_{\uptaupp}$.
    %Since $\cOpp$ is +noticed, we get $\uptaupp_{1}=\uptaupp_{2}$ a contradiction.
    \item  Suppose
    $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}} = \set{\bfpp_{1},\bfpp_{2}}$.
    By the argument above, we have $\pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}$
    Now $\uptaupp_{1}\neq \uptaupp_{2}$ since $\set{x_{\uptaupp_{1}},x_{\uptaupp_{2}}}=\set{r,c}$.
    This contradict to that $\cOpp$ is +noticed again.
    \item\label{it:c:noticed.bij.4} Suppose $\bfpp_{\uptau_{1}} = \bfpp_{1} \text{ or } \bfpp_{2}, \bfpp_{\uptau_{2}}=\bfpp_{3}$.
    Then
   \[
    \cL_{\uptau_{1}} = \dagger\maltese^{\frac{\abs{\bfuu_{\uptau_{1}}}}{2}}\dagger\pcL_{\uptaupp_{1}}\cdot \pcP_{\uptaupp_{1}}
    \quad \text{and} \quad
    \cL_{\uptau_{2}} = \dagger\maltese^{\frac{\abs{\bfuu_{\uptau_{2}}}}{2}}\dagger\ncL_{\uptaupp_{2}}\cdot \ncP_{\uptaupp_{2}}.
    \]
    This implies
    $\abs{\ssign(\uptaupp_{1})} \equiv \abs{\ssign(\uptaupp_{2})}+2 \pmod{4}$
    and
    $\maltese \dagger \pcL_{\uptaupp_{1}}= \dagger\ncL_{\uptaupp_{2}}$.


    \begin{claim}\label{c:d+}
      We have $\ncL_{\uptaupp_{2}}\supset \tytb{+}$.
    \end{claim}
    \begin{proof}
      If $\cOpp$ is obtained by the usual descent, we have
      $\cL_{\uptau}\succeq \tytb{-,+}$ and we are done.

      Now assume $\cOpp$ is obtained by generalized descent and $\cOpp$ is
      +noticed, i.e. $\bfuu_{\uptaupp}$ has at least length $2$.
      Suppose $\ssign( \bfuu_{\uptaupp} )\succ (1,2)$. Applying \eqref{eq:gd.ls} to $\uptaupp$,
      we see that the first term is non-vanishing and
      $\cL_{\uptaupp}\supseteq \dagger_{(1,1)}$.

      Otherwise, $\ssign( \bfuu_{\uptaupp} ) = (2n_{0}-1,1)\succeq (3,1)$ where $n_{0}$ is the
      length of $\bfuu_{\uptaupp}$. By \eqref{eq:gd.ls}, the second term is
      non-vanishing and $\cL_{\uptaupp}\succ \dagger_{(2n_{0}-1,1)}\succ +$.
    \end{proof}
    % Note that $\cOpp$ is a +noticed orbit. Then
    % By the list in \Cref{sec:z.r,sec:z.c,sec:z.d}, we see that
    % $\cL_{\uptaupp_{2}}\supset \tytb{-,+}$ and
    % $\ncL_{\uptaupp_{2}}\supset \tytb{+}$.

    The claim leads to a contradiction: Thanks to the character twist in the theta
    lifting formula of the local system, we see that the the associated
    character restricted on the 2-row $\tytb{-+}$ of $\maltese \dagger \pcL_{\uptaupp_{1}}$ and
    $\dagger \ncL_{\uptaupp_{2}}$ must be are different, a contradiction.

    % Note that  $\cL_{\uptau_{2}}\succ \dagger_{(1,1)}$ implies that
    % $\ncL_{\uptau_{2}}\succ \dagger_{(1,0)}$. So $\dagger\ncL_{\uptau_{2}}$ has
    % a 2-row of sign $\tytb{-+}$.
    % On the other hand, $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$ implies
    % $\dagger \pcL_{\uptau_{1}}=\pcL_{\uptaup_{1}} = \ncL_{\uptaup_{2}}= \dagger\ncL_{\uptau_{2}}$. So
    % $\abs{\ssign(\uptaupp_{1})} \equiv \abs{\ssign(\uptaupp_{2})}+2 \pmod{4}$.
    % , i.e.
    % \[\cL_{\uptau_{1}}=\dagger \pcL_{\uptaupp_{1}} \cdot \dagger_{(2a-1,0)}
    %   \neq \ddagger\ncL_{\uptaup_{2}}\cdot \ddagger_{(2a-1,0)} = \cL_{\uptau_{2}}.
    % \]
    % \item $\bfpp_{\uptau_{1}} = \bfpp_{2},\bfpp_{\uptau_{2}}=\bfpp_{3}$.
    % On argue by the same way as the case \eqref{} and yield a contRadiction.
  \end{enumPF}
%   \item $(p_{i},q_{i}) = (0,2a)$ and so $\ncP_{i}=\emptyset$.
%   In this case, $\set{\bfpp_{\uptau_{i}}}$ must consists of two the following three elements
%   \[
%     \bfpp_{1} =\tytb{sc,\vdots,s}, \quad \bfpp_{2}=\tytb{sr,\vdots,s}, \quad\text{and}
%     \quad\bfpp_{3}= \tytb{sd,\vdots,s}\\
%   \]
%   This case is also easy.
%   $ \uptau_{1}\neq \uptau_{2} $ implies $\uptaupp_{1}\neq \uptaupp_{2}$.
%   But $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$ implies
%   $\cL_{\uptaupp_{1}} = \DD^{2}(\cL_{\uptau_{1}})\cdot + \neq \DD^{2}(\cL_{\uptau_{2}})\cdot + = \cL_{\uptaupp_{2}}$.
%   This contradict to the bijection between local systems with dot-r-c diagrams
%   for the +noticed orbit $\cOpp$.
%   %$\uptaupp_{1} = \DD^{2}(\uptau_{1})\neq \DD^{2}(\uptau_{2})  = \uptaupp_{2}$
% \end{enumT}
% \end{enumI}
\end{enumPF}
  We finished the proof of the lemma.
\end{proof}

\subsubsection{The maps $\pUpsilon_{\cO}$, $\nUpsilon_{\cO}$ and $\Upsilon_{\cO}$}

\begin{lem}\label{c:gd.pnoticed}\label{c:gd.pnoticed.p}
    Suppose $\cO$ is +noticed.
    The map
    $\pUpsilon_{\cO} \colon \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0}\rightarrow \set{\pcL_{\uptau}\neq 0}$
    is injective.
\end{lem}
\begin{proof}
    %First assume $\cO$ is +noticed.
    We have two cases:
    \begin{enumPF}
      \item $\cL_{\uptau}$ contain an irreducible component $\succ \tytb{+,+}$.
      This is equivalent to $\pcL_{\uptau}$ has an irreducible component
      $\succ\tytb{+}$. Now all irreducible components of
      $\cL_{\uptau} \succ \tytb{+}$ and $\cL_{\uptau}\mapsto \pcL_{\uptau}$ will
      not kill any irreducible components. Hence we could recover $\cL_{\uptau}$
      from $\pcL_{\uptau}$.%, and the map $\Upsilon_{1}$.
      \item Suppose that $\cL_{\uptau_{1}}\neq \cL_{\uptau_{2}}$ do not contain
      a component $\succ \tytb{+,+}$.

      By \Cref{c:noticed.bij}
      $\uptau_{1}\neq \uptau_{2}$.\footnote{$\cL_{\uptau_{1}}\neq \cL_{\uptau_{2}}$
        clearly implies $\uptau_{1}\neq \uptau_{2}$.} We now show that
      $\pcL_{\uptau_{1}}=\pcL_{\uptau_{2}}\neq 0$ leads to a contradiction.
      Clearly, $\ssign(\uptau_{1})=\ssign(\uptau_{2})$.
      By \eqref{eq:gd.ls} and checking the properties in \Cref{lem:u}, we have
      \[
        \bfpp_{\uptau_{i}} = \tytb{s{x_{\uptaupp}},\vdots,s,{x_{\uptau_{i}}}} \quad \text{
          where }x_{\uptaupp_{i}}=c/d, x_{\uptau_{i}}=c/d.
      \]
      % By looking at \eqref{eq:ped.ssc} and \eqref{eq:ped.ssd},
      On the other hand, when $\bfpp_{\uptau_{i}}$ have the above form, the
      first term of \eqref{eq:gd.ls} is non-vanishing. So we conclude that
      $\pcL_{\uptau_{1}}=\pcL_{\uptau_{2}}$ implies
      \begin{equation}\label{eq:pnoticed.1}
        \pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}.
      \end{equation}

      Moreover, we see that every components of $\cL_{\uptau_{i}}$ has a 1-row
      of mark ``$-/=$'' and we can determine $\upepsilon_{\uptau_{i}}$ by the
      mark $-/=$ of the 1-row appeared in $\pcL_{\uptau_{i}}$. In particular, we
      have $\upepsilon_{1}=\upepsilon_{2}$. Now \Cref{lem:gd.inj} implies
      $\uptaupp_{1}\neq \uptaupp_{2}$. This is contradict to
      \eqref{eq:pnoticed.1} and our induction hypothesis since $\cOpp$ is also
      +noticed.

      % On the other hand, $\cOpp$ is also +noticed. But \eqref{eq:ped.ssc} and
      % \eqref{eq:ped.ssd} also imply that
      % $\pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}$ which is a contradiction to
      % our
      % induction hypothesis.
      % % By our descent algorithm $\eDD$, we have
      % % $\uptaupp_{1}\neq \uptaupp_{2}$.
      % % Note that the collision implies
      % % $\pcL_{\uptaupp_{1}} =\pcL_{\uptaupp_{2}}$,
      % % which is impossible by induction.
    \end{enumPF}
% \item
%  Suppose $\cO$ is noticed, we many need to consider the additional case where
%  $\bfpp_{\uptau} = \tytb{{x_{1}} y}$ where $x_{1}= c/d$. But $x_{1}=d$ is
%  equivalent to the non-vanishing of $\ncL_{\uptau}$.
% \end{enumPF}
\end{proof}


\begin{lem}\label{c:gd.noticed.inj}
  Suppose $\cO$ is noticed. Then the map $\Upsilon_{\cO}\colon \cL_{\uptau}\mapsto (\pcL_{\uptau},\ncL_{\uptau})$ is injective.
\end{lem}
\begin{proof}
  It suffice to consider the case where $\cO$ is noticed but not +noticed, i.e.
  $C_{2k+1}=C_{2k}+1$. In this case, $n=1$.
  The peduncle $\bfpp_{\uptau}$ have four possible cases:
  \[
    \tytb{rc}, \quad \tytb{cc}, \quad \tytb{cd},\quad \text{or}\quad  \tytb{dd}.
  \]
  By \eqref{eq:gd.ls}, $\pcL_{\uptau} = \dagger\dagger\pcL_{\uptaupp}$.
  % \[
  %   \bfpp_{1} = \tytb{rc}, \bfpp_{2}=\tytb{cc}, \bfpp_{3} = \tytb{cd}, \bfpp_{4} = \tytb{dd}.
  % \]

  Now suppose $\uptau_{1}\neq \uptau_{2}$ such that
  $\pcL_{\uptau_{1}}=\pcL_{\uptau_{2}}$.
  Since $\cOpp$ is +noticed, we have $\uptaupp_{1}=\uptaupp_{2}$ by the induction
  hypothesis (see \Cref{c:gd.pnoticed.p}).
  By \Cref{lem:gd.inj}, this only happens when
  $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}}=\set{\tytb{cd},\tytb{dd}}$.
  Since one of $\ncL_{\uptau_{i}}$ is zero and the other is non-zero, we
  conclude that $\Upsilon_{\cO}(\cL_{\uptau_{1}})\neq \Upsilon_{\cO}(\cL_{\uptau_{2}})$.
\end{proof}

\begin{lem}\label{c:gd.pnoticed.n}
    Suppose $\cO$ is +noticed.
    The map $\nUpsilon_{\cO}\colon \set{\cL_{\uptau}|\ncL_{\uptau}\neq 0}\rightarrow \set{\ncL_{\uptau}\neq 0}$
    is injective.
\end{lem}
\begin{proof}
  The proof is similar to that of \Cref{c:gd.pnoticed.p}.
    We have two cases:
    \begin{enumPF}
      \item $\cL_{\uptau}$ contain an irreducible component $\succ \tytb{-,-}$.
      This is equivalent to $\ncL_{\uptau}$ has an irreducible component
      $\succ\tytb{-}$ and $\cL_{\uptau}\mapsto \ncL_{\uptau}$ will
      not kill any irreducible components. Hence we could recover $\cL_{\uptau}$
      from $\ncL_{\uptau}$.%, and the map $\Upsilon_{1}$.

      \item Now we make a weaker assumption that $\uptau_{1}\neq \uptau_{2}\in \drc(\cO)$ such that
      $\cL_{\uptau_{1}}$ and $\cL_{\uptau_{2}}$ do not contain a component
      $\succ \tytb{-,-}$.
      % We now show that  $\ncL_{\uptau_{1}}=\ncL_{\uptau_{2}}\neq 0$ leads to a
      % contradiction.
      % Clearly,
      % $\ssign(\uptau_{1})=\ssign(\uptau_{2})$

      By \eqref{eq:gd.ls} and the properties in \Cref{lem:u}, we
      see that $\bfpp_{\uptau_{i}}$ must be one of the following
      \[
        \bfpp_{1}=  \tytb{rc,\vdots,r,d} \quad \text{ or } \quad \bfpp_{2}= \tytb{rd,\vdots,r,d}.
      \]
      Without of loss of generality, we have the following possibilities:
      \begin{enumPF}
        \item $\bfpp_{\uptau_{1}}=\bfpp_{\uptau_{2}}=\bfpp_{1}$. We have
        $\pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}$ and obtain the contradiction.
        \item $\bfpp_{\uptau_{1}}=\bfpp_{\uptau_{2}}=\bfpp_{2}$. We have
        $\ncL_{\uptaupp_{1}}=\ncL_{\uptaupp_{2}}$ and obtain the contradiction.
        \item $\bfpp_{\uptau_{1}}=\bfpp_{1}$ and $\bfpp_{\uptau_{2}}=\bfpp_{2}$.
        Now we apply the same argument in the case~\ref{it:c:noticed.bij.4} of
        the proof of \Cref{c:noticed.bij}. We get
        $\maltese \dagger\pcL_{\uptaupp_{1}}=\dagger \ncL_{\uptaupp_{2}}$,
        $\ncL_{\uptaupp_{2}} \supset +$ and a contradiction by looking at the
        associated character on the 2-row $\tytb{-+}$ .
      \end{enumPF}
    \end{enumPF}
    This finished the proof.
\end{proof}

\section{Type B/M case}


\subsection{``Special'' and ``non-special'' diagrams}
\subsubsection{type M}

\begin{defn}\label{def:sp-nsp.M.sp}
  Let $\cO = (C_{2k},C_{2k-1}, \cdots, C_{1},C_{0}=0)\in \dpeNil(M)$
  with $k\geq 1$.
  Let
  \[
  \tau =  (\tau_{2k}, \cdots, \tau_{2})\times  (\tau_{2k-1}, \cdots, \tau_{1}).
  \]
  be a Weyl group representation attached to $\cO\in \dpeNil(M)$.
  We say $\tau$ has
  \begin{itemize}
    \item \idxemph{special shape} if $\tau_{2k}\geq \tau_{2k-1}$;
    \item \idxemph{non-special shape} if $\tau_{2k}< \tau_{2k-1}$.
  \end{itemize}
  Clearly, this gives a partition of the set of Weyl group representations
  attached to $\cO$.

  Suppose $k\geq 1$, $C_{2k}=2c_{2k}-1$ and $C_{2k-1}=2c_{2k-1}+1$.
  The special shape representation $\tau^{s}$
  \[
    \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}
    = (c_{2k},\tau_{2k-2}, \cdots, \tau_{2})\times (c_{2k-1},\tau_{2k-3} \cdots, \tau_{1}).
  \]
  is paired with the non-special shape representation
  \[
    \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} =
     (c_{2k-1},\tau_{2k-2},\cdots, \tau_{2})\times (c_{2k},\tau_{2k-3},\cdots, \tau_{1} )
  \]
  In the paring $\tau^{s}\leftrightarrow \tau^{ns}$, $\tau_{j}$  is unchanged for $j\leq 2k-2$.
  We call $\tau^{s}$ the \emph{special shape} and $\tau^{ns}$ the
  corresponding \emph{non-special shape}
\end{defn}
% We define a bijection between ``special'' diagram $\uptau^{s}$ and
% ``non-special'' diagrams $\uptau^{ns}$.

% \begin{defn}\label{def:sp-nsp.M.sp}

%   Let $\cO\in \Nil(M)$ such that $C_{2k}=2c_{2k}-1$ and $C_{2k-1}=2c_{2k-1}+1$.
%   A representation $\tau^{s}$ attached to $\cO$ has the shape
%   \[
%     \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}=
%     (c_{2k},\tau_{2k-2},\cdots, \tau_{2}) \times (c_{2k-1},\tau_{2k-3},\cdots, \tau_{1})
%   \]
%   is paired with
%   \[
%     \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} =
%     (c_{2k-1},\tau_{2k-2},\cdots, \tau_{2}) \times (c_{2k},\tau_{2k-3},\cdots, \tau_{1})
%   \]
%   where the $c_{j}$ are unchanged for $j\leq 2k-2$.
%   We call $\tau^{s}$ the \emph{special shape} and $\tau^{ns}$ the
%   corresponding \emph{non-special shape}
% \end{defn}

% Note that the shape
% $\tau = (\tau_{2k},\cdots, \tau_{2},0)\times (\tau_{2k-1},\cdots, \tau_{1})$
% is a special shape if and only if $\tau_{2k}>\tau_{2k-1}$.



\begin{defn}\label{def:sp-nsp.M}
  Suppose $C_{2k}$ is odd.
We retain the notation in \Cref{def:sp-nsp.M.sp} where the shapes $\tau^{s}$ and $\tau^{ns}$
correspond with each other.
We define a bijection between $\drc(\tau^{s})$ and $\drc(\tau^{ns})$:
\[
  \begin{tikzcd}[row sep=0em]
    \drc(\tau^{s}) \ar[rr,<->]&\hspace{2em} & \drc(\tau^{ns})\\
    \uptau^{s} \ar[rr,<->]& & \uptau^{ns}
  \end{tikzcd}
\]
Without loss of generality, we can assume
that $\uptau^{s}\in \drc(\tau^{s})$ and $\uptau^{ns}\in \drc(\tau^{ns})$ have the following shapes:
\begin{equation}\label{eq:sp-nsp.M}
  \uptau^{s}:
  \tytb{\cdots\cdots\cdots,{y_{1}}\cdots\cdots,{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},{y_{2}}}
  \times
  \tytb{\cdots\cdots\cdots,{x_{0}}{\cdots}{\cdots},\ ,\ ,\ ,\ }
  \longleftrightarrow \hspace{2em}
  \uptau^{ns}:
  \tytb{\cdots\cdots\cdots,{y_{0}}\cdots\cdots,\ ,\ ,\ ,\ }
  \times
  \tytb{\cdots\cdots\cdots,{x_{1}}{\cdots}\cdots,{*(srcol)r},
    {*(srcol)\vdots},{*(srcol)r},{x_{2}} }
\end{equation}
Here the grey parts have length $(C_{2k}-C_{2k-1})/2$ (could be zero length).
The entries $x_{0}$, $x_{1}$, $y_{0}$ and $y_{1}$ are either all empty or all
non-empty.
% and the rows contains them may be empty. % We remark that the
% value of $v_{0}$ and $w_{0}$ are completely determined by $x_{0}$ and $y_{0}$.
% In particular, $v_{0}$ and $w_{0}$ are non-empty if and only if
% $x_{0}/y_{0}\neq \emptyset$, i.e. $C_{2k-1}\geq 4$.
% We marks the entries of $\uptau^{s}$ and $\uptau^{ns}$ as in
% \eqref{eq:sp-nsp.C}.
The correspondence between $(x_{0},x_{1}, x_{2})$, with
$(y_{0},y_{1},y_{2})$ is given by switching $r$ and $s$,  $d$ and $c$. i.e.
\[
  \begin{cases}
    y_{i} = s \Leftrightarrow x_{i} = r\\
    y_{i} = c \Leftrightarrow x_{i} = d\\
  \end{cases}
  \quad \text{for } i=0,1,2.
\]

We define
\[
  \drcs(\cO) := \bigsqcup_{\tau^{s}} \drc(\tau^{s}) \quad \text{ and }\quad
  \drcns(\cO) := \bigsqcup_{\tau^{ns}} \drc(\tau^{ns})
\]
where $\tau^{s}$ (resp. $\tau^{ns}$)runs over all specail (resp. non-special) shape representations attached to $\cO$.
Clearly $\drc(\cO) = \drcs(\cO)\sqcup \drcns(\cO)$.
\end{defn}
It is easy to check the bijectivity in the above definition, which we leave it
to the reader.



\subsubsection{Special and non-special shapes of type B}
Now we define the notion of special and non-special shape of type B.
\begin{defn}\label{def:sp-nsp.B.sp}
  Let
  \[
    \tau = (\tau_{2k}, \cdots, \tau_{2}) \times (\tau_{2k+1},\tau_{2k-1}, \cdots, \tau_{1})
  \]
  be a Weyl group representation attached to $\cO\in \dpeNil(B)$. We say $\tau$
  has
  \begin{itemize}
    \item \idxemph{special shape} if $\tau_{2k}\geq \tau_{2k-1}$;
    \item \idxemph{non-special shape} if $\tau_{2k} < \tau_{2k-1}$.
  \end{itemize}

  Suppose $k\geq 1$ and
  \begin{equation} \label{eq:B.orb.ds}
    \cO=(C_{2k+1}=2c_{2k+1}+1,C_{2k}=2c_{2k}-1,C_{2k-1}=2c_{2k-1}+1,\cdots,C_{1}>0, C_{0}=0).
  \end{equation}
  A representation $\tau^{s}$ attached to $\cO$ has the shape
  \[
    \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}= (c_{2k},\tau_{2k-2},\cdots, \tau_{2}) \times (c_{2k+1},c_{2k-1},\tau_{2k-3},\cdots, \tau_{1})
  \]
  is paired with
  \[
    \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} = (c_{2k-1},\tau_{2k-2},\cdots, \tau_{2}) \times (c_{2k+1},c_{2k},\tau_{2k-3},\cdots, \tau_{1}).
  \]
  In the paring $\tau^{s}\leftrightarrow \tau^{ns}$ described as the above,
  $\tau_{j}$ are unchanged for $j\leq 2k-2$.
\end{defn}




\subsection{Definition of $\eDD$ for type B and M}


\subsubsection{The defintion of $\upepsilon$.} \label{sec:upepsilon}
\begin{enumerate}[label=(\arabic*).,series=alg2]
  \item When $\uptau\in \drc(B)$, $\upepsilon$ is determined by the ``basal
  disk'' of $\uptau$ (see \eqref{eq:x.uptau} for the definition of $x_{\uptau}$):
  \[
    \upepsilon_{\uptau}:=
    \begin{cases}
      0, & \text{if $x_{\uptau}=d$;} \\
      1, & \text{otherwise.}
    \end{cases}
  \]
  \item When $\uptau\in \drc(M)$, the  $\upepsilon$  is determined by
  the lengths of $\taulf$ and $\taurf$:
  \[
    \upepsilon_{\uptau} :=
    \begin{cases}
      0, & \text{if }\abs{\taulf} - \abs{\taurf} \geq  0;\\
      1, & \text{if }\abs{\taulf} - \abs{\taurf}<0.
    \end{cases}
  \]
\end{enumerate}


\subsubsection{Initial cases}

\begin{enumerate}[resume*=alg2]
  \item Suppose $\cO = (2c_{1}+1)$ has only one column. Then
        $\cOp_{0}:=\eDD(\cO)$ is the trivial orbit of $\Mp(0,\bR)$. $\drc(\cO)$
        consists of diagrams of shape
        $\tau_{L}\times \tau_{R} =\emptyset\times (c_{1},)$.
        The set $\drc(\cOp_{0})$ is a singleton $\set{\uptaup_{0}=\emptyset\times \emptyset}$, and every element
        $\uptau \in \drc(\cO)$ maps to $\uptau_{0}$ (see \eqref{eq:uptau0}):
        \[\tiny
          \drc(\cO)\ni \uptau:= \hspace{1em} \ytb{\emptyset,\none,\none,\none}
          \times \ytb{{x_{1}},\vdots,{x_{n}},{m_{\uptau}}}
          \mapsto \uptaup_{0}:=\emptyset\times \emptyset
        \]
        Here $m_{\uptau}=a$ or $b$ is the mark of $\uptau$.
        We define
        \[
          \bfpp_{\uptau}:=\bfxx_{\uptau} := x_{1}\cdots x_{n} m_{\uptau}.%  \text{ and }x_{\uptau}:=x_{n}
        \]
        We call $\bfpp_{\uptau}=\bfxx_{\uptau}$ the ``peduncle'' part of
        $\uptau$.
\end{enumerate}

\subsubsection{The descent from M to B}
The descent of a special shape diagram is simple, the descent of a non-special shape
reduces to the corresponding special one:
\begin{enumerate}[resume*=alg2]
  \item Suppose $\abs{\taulf} \geq \abs{\taurf} $, i.e. $\uptau$ has special
        shape. Keep $r,d$ unchanged, delete $\taulf$ and fill the remaining part
        with ``$\bullet$'' and ``$s$'' by $\DDr(\uptau^{\bullet})$ using the
        dot-s switching algorithm. The mark $m_{\uptaup}$ of
        $\uptaup:=\eDDo(\uptau)$ is given by the following formula:
        % \footnote{Note that $\taulf$ ends with $s$ or $c$ since
        % $\abs{\taulf}>\abs{\taurf}$}
        \[
        m_{\uptaup}:= \begin{cases}
          a & \text{if  $\taulf$ ends with $s$ or $\bullet$},\\
          b & \text{if $\taulf$ ends with $c$}.
        \end{cases}
        \]

  \item Suppose $\abs{\taulf} < \abs{\taurf}$, i.e. $\uptau$ has non-special
        shape. We define
        \[\eDDo(\uptau):=\eDDo(\uptau^{s})\]
        where $\uptau^{s}$ is the special diagram corresponding to $\uptau$
        defined in \Cref{def:sp-nsp.M}.
\end{enumerate}

\begin{lem}\label{lem:ds.BM}
  Suppose $\cO = (C_{2k},C_{2k-1}, \cdots, C_{0})$ with $k\geq 1$ and $C_{2k}$
  is odd.
  Let $\cOp := \eDD(\cO)=(C_{2k-1},\cdots, C_{0})$.
  Then
  \[
    \begin{split}
      \drcs(\cO) &\xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \drc(\cOp) \\
      \drcns(\cO)&
      \xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \drc(\cOp)
    \end{split}
  \]
  are a bijections.
\end{lem}
\begin{proof}
  The claim for $\drcs(\cO)$ is clear by the definition of descent.
  The claim for $\drcns(\cO)$ reduces to that of $\drcs(\cO)$ using \Cref{def:sp-nsp.M}.
\end{proof}

\begin{lem}\label{lem:gd.BM}
  Suppose $\cO = (C_{2k},C_{2k-1}, \cdots, C_{0})$ with $k\geq 1$ and $C_{2k}$ even.
  Let $\cOp := \eDD(\cO)=(C_{2k-1}+1,\cdots, C_{0})$.
  Then the following map is a bijection
  \[
    \drc(\cO) \xrightarrow{\hspace{2em}\eDDo\hspace{2em}}
    \Set{\uptaup\in \drc(\cOp)| \begin{minipage}{11em}
        $m_{\uptaup}\neq b$ and\\
         $\uptaup_{R,0}$ dose not ends with $s$.
      \end{minipage}
    }. %\subsetneq \drc(\cOp).
  \]
\end{lem}
\begin{proof}
  This is clear by the descent algorithm.
\end{proof}


\subsubsection{Descent from $B$ to $M$}
Now we define the general case of the descent from type $B$ to type $M$.
We assume that $k\geq 1$ i.e. $\cO$ has at least 3 columns.
First note that the shape of $\uptau' = \eDD(\uptau)$ is the shape of $\uptau$ deleting the
most left column on the right diagram.

% We assume $\uptau$ and $\uptau'$ has the following shape where $(y_{1},y_{2})$
% could be empty and $w_{0}$ is non-empty if $\uptau_{R}\neq \emptyset$.
The definition splits in cases below. In all these cases we define
\begin{equation}\label{eq:x.uptau}
 % \bfpp_{\uptau}:=
 \tbfxx_{\uptau} := x_{1}\cdots x_{n}m_{\uptau} \text{ and } \txx_{\uptau} := x_{n}
\end{equation}
which is marked by $s/r/c/d$.
For the part marked by $*/\cdots$ , $\eDD$ keeps $r,c,d$ and maps the rest part consisting of $\bullet$ and $s$ by dot-s switching algorithm.
\begin{enumerate}[resume*=alg2]
  \item When $C_{2k}$ is odd and $\uptau$ has special shape, the descent is given by the following diagram
      \[
        \uptau: \hspace{1em}
        \tytb{
        \cdots\cdots\cdots,
        {\ast}{\cdots}{\cdots},
        {*(srcol)\bullet},
        {*(srcol)\vdots},{*(srcol)\bullet},{y_0},\none,\none,\none}
      \times
      \tytb{\cdots\cdots\cdots,
        {\ast}{\ast}{\cdots},
        {*(srcol)\bullet},
        {*(srcol)\vdots},
        {*(srcol)\bullet},
        {x_{1}},{\vdots},{x_{n}},{m_{\uptau}}}
        \mapsto
       \uptaup: \tytb{\cdots\cdots\cdots,{\ast}{\cdots}{\cdots},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},{y'_{0}},\none,\none,\none}
        \times \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none,\none}
      \]
      Here the grey columns has length $(C_{2k}-C_{2k-1})/2$ and $n = (C_{2k+1}-C_{2k})/2$.
      The  ``$\ast/\cdots$'' part of $\uptaup$ is given by keeping the corresponding
      entries marked by $r/d/c$ in
       $\uptau$ unchange and filling $s/\bullet$ accordingly in the rest of the
       entries.
       The entry $y'_{0}$ of $\uptaup$ is given by the following formula:
       % \footnote{When $x_{1}\cdots x_{n}=r\cdots r$, we have $y_{0}=c$.
       %   Otherwise $x_{1}=s$ or $x_{1}\cdots x_{n} = r\cdots r d$.}
       % \[
       %   y'_{0} := \begin{cases}
       %     s & \text{if $x_{1}=\bullet$ or
       %       $x_{1}\cdots x_{n} m_{\uptau}= r\cdots ra$ or $r\cdots rda$}\\
       %     c & \text{if $x_{1}=s$ or
       %       $x_{1}\cdots x_{n} m_{\uptau}= r\cdots rb$ or $r\cdots rdb$}.
       %   \end{cases}
       % \]
       \[
         y'_{0} := \begin{cases}
           s & \text{if $x_{1}=\bullet$ or
             $(x_{1},m_{\uptau})=(r/d, a)$}\\
           c & \text{if $x_{1}=s$ or
             $(x_{1},m_{\uptau})=(r/d, b)$}.
         \end{cases}
       \]
       % We define $\tbfxx_{\uptau}$ be the diagram by replacing $\bullet$ to $s$
       % in $\bfxx_{\uptau}$.
       %  We define $\tfbfxx_{\uptau}\in \DRC()$
  \item When $C_{2k}$ is odd and $\uptau$ has non-special shape, then
        \[
        \uptau: \hspace{1em}
        \tytb{
        {\cdots}\cdots\cdots,
        {\ast}{\cdots}{\cdots},
        \none,\none,\none,\none,\none,\none,\none}
        \times
        \tytb{\cdots\cdots\cdots,
        {\ast}{\ast}{\cdots},
        {*(srcol)s}{*(srcol)r},
        {*(srcol)\vdots}{*(srcol)\vdots},
        {*(srcol)s}{*(srcol)r},
        {x_{1}}{x_{0}},{\vdots},{x_{n}},{m_{\uptau}}}
        \mapsto
        \uptaup: \tytb{\cdots\cdots\cdots,{\ast}{\cdots}{\cdots},\none,\none,\none,\none,\none,\none,\none}
        \times \tytb{
        \none\cdots\cdots,\none{\ast}{\cdots},
        \none{*(srcol)r},
        \none{*(srcol)\vdots},
        \none{*(srcol)r},
        \none{x'_{0}},\none,\none,\none}
        \]
        Here the grey columns has length $(C_{2k}-C_{2k-1})/2$ and $n = (C_{2k+1}-C_{2k})/2$.
        The  ``$\ast/\cdots$'' part of $\uptaup$ is given by keeping the corresponding
        entries marked by $r/d/c$ in
        $\uptau$ unchange and filling $s/\bullet$ accordingly in the rest of the
        entries.
        The entry $x'_{0}$ of $\uptaup$ is given by the following formula:
        % \footnote{When $x_{1}\cdots x_{n}=r\cdots r$, we have $x_{0}=d$.}
        \[
        x'_{0} := \begin{cases}
          r & \text{if $(x_{1},m_{\uptau})=(r/d, a)$,}\\
          d & \text{if $(x_{1},m_{\uptau})=(r/d, b)$,}\\
          x_{0} & \text{if $x_{1}=s$.}
        \end{cases}
        \]
        Note that
        % \[
        %   x'_{0} := \begin{cases}
        %     r & \text{if $x_{1}\cdots x_{n}= r\cdots r$}\\
        %     x_{0} & \text{otherwise}
        %   \end{cases}
        % \]
        % We define $\tbfxx_{\uptau}:=\bfxx_{\uptau}$.
        %
  \item When $C_{2k}=C_{2k-1}$ is even, we could assume $\uptau$ and $\uptaup$ hase
        the following forms with $n = (C_{2k+1}-C_{2k}+1)/2$.
      \[
        \uptau: \hspace{1em}
        \tytb{
        {\cdots}\cdots\cdots,
        {\ast}{\cdots}{\cdots},
        {y_{0}}\cdots,\none,\none,\none}
      \times
      \tytb{\cdots\cdots\cdots,
        {\ast}{\ast}{\cdots},
        {x_{1}}{x_{0}},{\vdots},{x_{n}},{m_{\uptau}}}
        \mapsto
       \uptaup: \tytb{\cdots\cdots\cdots,{\ast}{\cdots}{\cdots},{y'_{0}}\cdots,\none,\none,\none}
        \times \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none{x'_{0}},\none,\none,\none}
      \]
      In the most of the case, $\uptau'$ is obtained from $\uptau$ by deleting
      the first column of $\uptau_{R}$, keeping $c/r/d$ and filling $s/\bullet$ accordingly.
      The exceptional cases are when $x_{1}=r/d$. In the exceptional case we
      always have $x_{0}=d$.  We define
      \[
        \begin{split}
          x'_{0} & := d, \\
          y'_{0} & := \begin{cases}
            s & \text{if $m_{\uptau}=a$},\\
            c & \text{if $m_{\uptau}=b$}.
          \end{cases}
        \end{split}
      \]
      Note that this definition is similar to that of the special
      shape diagrams in the descent case.
      We define the ``peduncle'' of $\uptau$ to be
      \[
        \bfpp_{\uptau} = \tytb{{x_{1}}{x_{0}}, \vdots, {x_{n}},{m_{\uptau}}}.
      \]
\end{enumerate}

In all the cases, let
$\cO_{1} = (2n,)$ is the trivial nilpotent of type D.
For each $\uptau\in \drc(\cO)$, we define $\bfxx_{\uptau} \in \drc(\cO_{1})$ by
require the following identity of multisets: %the entires of $\bfxx_{\uptau}$ forms the following multiset:
\[
\set{\text{entry of }\bfxx_{\uptau}} =
\begin{cases}
  \set{c, x_{2},\cdots, x_{n}} & \text{if $(x_1,m_{\uptau}) = (\bullet/s,a)$},\\
  \set{s, x_{2},\cdots, x_{n}} & \text{if $(x_1,m_{\uptau}) = (\bullet/s,b)$},\\
  \set{x_{1}, x_{2},\cdots, x_{n}} & \text{otherwise ($x_{1}=r/d$)}.
\end{cases}
\]
In the above definition we include the initial case where $\cO$ is a trivial
orbit of type B. We define $\bfxx_{\uptau}=\emptyset$ when $\cO$ is the trivial
orbit of $\rO(1,\bC)$.

We define the  ``basal disk'' of $\uptau$ as the following:
\[
  x_{\uptau} :=\begin{cases}
    % \emptyset & \text{if $\cO = (1)$}\\
    \bfxx_{\uptau} & \text{if $C_{2k+1}=C_{2k}+1$}.\\
    c & \text{if $x_{n}m_{\uptau} =sa$ or $\bullet a$}\\
    x_{n} & \text{otherwise}. % \text{if $C_{2k+1}-C_{2k}\geq 1$ and $x_{n}m_{\uptau}\neq sa$}\\
  \end{cases}
\]


\subsubsection{A key proposition for descent case}
Now we assume $\cO$ is given by \eqref{eq:B.orb.ds}
Let $\cOp=\eDD(\cO)$ and $\cOpp=\eDD(\cOp)$.



The following lemma is the key property satisfied by our definition
\begin{lem}\label{lem:sp-nsp.B}
  Suppose $k\geq 1$ and
  $\tau^{s}$ and $\tau^{ns}$ are two representations attached to $\cO$ as in
  \Cref{def:sp-nsp.B.sp}.
  Then
  \begin{enumS}
    \item \label{lem:sp-nsp.B.1} For every $\uptau\in \drc(\tau^{s})\sqcup \drc(\tau^{ns})$, the shape
    of $\eDD^{2}(\uptau)$ is
    \[
      \taupp = (\tau_{2k-2},\cdots, \tau_{2})\times  (c_{2k-1},\tau_{2k-3},\tau_{1})
    \]
    \item \label{lem:sp-nsp.B.2} % Let $\cO_{1}= (C_{2k+1}-C_{2k}+1,)\in \Nil(B)$ be the trivial orbit
    % of $\rO(C_{2k+1}-C_{2k}+1,\bC)$.
    We define $\delta\colon \drc(\cO)\rightarrow \drc(\cOpp)\times\drc(\cO_{1})$
    by $\delta(\uptau) = (\eDD^{2}(\uptau),\bfxx_{\uptau})$.
    The following maps are bijective%with the same image
    \[
      \begin{tikzcd}[row sep=0em]
        \drc(\tau^{s})\ar[r,"\delta"] & \drc(\taupp)\times \drc(\cO_{1}) &\ar[l,"\delta"'] \drc(\tau^{ns})\\
        \uptau^{s}\ar[r,maps to] & (\eDD^{2}(\uptau^{s}), \bfxx_{\uptau^{s}})&\\
        & (\eDD^{2}(\uptau^{ns}), \bfxx_{\uptau^{ns}})& \uptau^{ns}\ar[l,maps to]\\
      \end{tikzcd}
    \]
    In particular, we obtain an one-one correspondence
    $\uptau^{s}\leftrightarrow \uptau^{ns}$ such that $\delta(\uptau^{s})=\delta(\uptau^{ns})$.
    \item\label{lem:sp-nsp.B.3}
    Suppose $\uptau^{s}$ and $\uptau^{ns}$ correspond as the above such that
    $\delta(\uptau^{s})=\delta(\uptau^{ns})=(\uptaupp,\bfxx)$. Then
    \begin{equation} \label{eq:sp-nsp-sig}
      \ssign(\uptau^{s})=\ssign(\uptau^{ns})=(C_{2k},C_{2k})+\ssign(\uptaupp)+\ssign(\bfxx).
    \end{equation}
    % with
    % \[
    %   \tsign(\tbfxx) = \begin{cases}
    %     \ssign(x_{1}\cdots x_{n})  & \text{if $x_{1}=r/d$}\\
    %     \ssign(\tbfxx) - (0,1) & \text{otherwise.}\\
    %   \end{cases}
    % \]
    Note that $\ssign(\bfxx)\in \bN\times \bN$.
  \end{enumS}
\end{lem}
\begin{proof}
  By our assumption, we have $c_{2k+1}\geq c_{2k}>c_{2k-1}$ and
  \[
    \tau^{s} = (c_{2k},\tau_{2k-2},\cdots, \tau_{2})\times (c_{2k+1}, c_{2k-1}).
  \]
  The the behavior of $\uptau^{s}$ under the descent map $\eDD$ is illostrated
  as the following:
  \begin{equation}\label{eq:ds2.B.sp}
    \uptau^{s}: \hspace{1em}
    \tytb{
      {*(srcol)\cdots}\cdots\cdots,
      {*(srcol)\ast}{\ast}{\cdots},
      {*(srcol)\bullet},
      {*(srcol)\vdots},{*(srcol)\bullet},{x_0},\none,\none,\none}
    \times
    \tytb{{*(srcol)\cdots}\cdots\cdots,
      {*(srcol)\ast}{\ast}{\cdots},{*(srcol)\bullet},{*(srcol)\vdots},{*(srcol)\bullet},{x_{1}},\vdots,{x_{n}},{m_{\uptau}}}
    \mapsto
    \uptau'^{s}: \hspace{1em}
    \tytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)\ast}{\ast}{\cdots},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},{x'_{0}},
      \none,\none,\none}
    \times \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none,\none}
    \mapsto
    \uptaupp:
    \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none,\none}
    \times \tytb{\none\cdots\cdots,{\none}{\ast}{\cdots},\none{\phantom{m}\mathclap{m_{\uptaupp}}},\none,\none,\none,\none,\none,\none}
  \end{equation}
  The grey part consists of totally $2(c_{2k}-1)=C_{2k}-1$ dots.
  Hence the total signature of the gray part is $(C_{2k}-1,C_{2k}-1)$.
  Note that $\uptau^{s}$ is obtained from the ``$\ast\cdots$'' part of $\taupp$ by attaching the grey part
  and $x_{0},\cdots, x_{n},m_{\uptau}$.

  The descent of a non-special diagram $\uptau^{ns}$:
  \begin{equation}\label{eq:ds2.B.nsp}
        \uptau^{ns}: \hspace{1em}
        \tytb{
        {*(srcol)\cdots}\cdots\cdots,
        {*(srcol)\ast}{\ast}{\cdots},
        \none,\none,\none,\none,\none,\none,\none}
      \times
      \tytb{{*(srcol)\cdots}\cdots\cdots,
        {*(srcol)\ast}{\ast}{\cdots},
        {*(srcol)s}{*(srcol)r},
        {*(srcol)\vdots}{*(srcol)\vdots},
        {*(srcol)s}{*(srcol)r},
        {x_{1}}{x_{0}},{\vdots},{x_{n}},{m_{\uptau}}}
        \mapsto
       {\uptaup}^{ns}: \tytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)\ast}{\ast}{\cdots},\none,\none,\none,\none,\none,\none,\none}
       \times
       \tytb{\none\cdots\cdots,\none{\ast}{\cdots},
         \none{*(srcol)r},
         \none{*(srcol)\vdots},
         \none{*(srcol)r},
         \none{x'_{0}},\none,\none,\none}
       \mapsto
       \uptaupp:
       \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none,\none}
       \times \tytb{\none\cdots\cdots,{\none}{\ast}{\cdots},\none{\phantom{m}\mathclap{m_{\uptaupp}}},\none,\none,\none,\none,\none,\none}
     \end{equation}
     Here the gray parts in $\uptau$ consists of $C_{2k}-1$ marks of $\bullet$, $s$, or
     $r$ and $s$ and $r$ occur with the same multiplicity. Hence the total
     signature of the gray part is $(C_{2k}-1,C_{2k}-1)$.

     To prove the lemma, it suffice to verify the following claims which we leave to the reader:
     \begin{itemize}
       \item In both the special shape and non-special shape cases, the
       following map is bijective:
       \[
       x_{0}x_{1}\cdots x_{n}m_{\uptau^{s/ns}}\mapsto (\bfxx_{\uptau^{s/ns}},m_{\uptaupp}).
       \]
       \item The following equation of signatures holds
       \[
         \ssign( x_{0}x_{1}\cdots x_{n}m_{\uptau} ) - \ssign(m_{\uptaupp})  =\ssign(\bfxx_{\uptau}).
       \]
     \end{itemize}
     In the verification, one can use the fact that $m_{\uptau}=m_{\uptaupp}$
     when $x_{1} = r/d$.

     \trivial[]{
       Suppose $x_{1}=r/d$. Then $x_{0} = c/d$ and
       \[\ssign(x_{0}\cdots x_{n}m_{\uptau})-\ssign(m_{\uptaupp}) = (1,1)+\ssign(x_{1}\cdots x_{n}).\]

       Now we consider the generic cases, i.e. $x_{1}=\bullet/s$:
       In this case, we clain that $\ssign(x_{0}x_{1}) - \ssign(m_{\uptaupp}) = (1,2)$.
       Now
       \[
         \begin{split}
           & \ssign(x_{0}x_{1}\cdots x_{n}m_{\uptau})-\ssign(m_{\uptaupp}) \\
           =& (1,1)+\ssign(x_{2}\cdots x_{n}m_{\uptau}) +(0,1) \\
           = &\begin{cases} (1,1) +\ssign(x_{2}\cdots x_{n}) + \ssign(c)
             & \text{if } m_{\uptau} = a\\
             (1,1) +\ssign(x_{2}\cdots x_{n}) + \ssign(s) & \text{if } m_{\uptau} = b\\
           \end{cases}\\
         \end{split}
       \]

       First consider the special shape diagram $\uptau=\uptau^{s}$.
       \begin{enumPF}
         \item Suppose $m_{\uptaupp}=a$. Then $x_{0}\times x_{1}=\bullet\times \bullet$.
           \item Suppose $m_{\uptaupp}= b$. Then $x_{0}\times x_{1}=c\times s$.
       \end{enumPF}
       Now consider the non-special shape diagram $\uptau=\uptau^{ns}$.
       \begin{enumPF}
         \item Suppose $m_{\uptaupp}=a$. Then
         $\emptyset \times x_{1}x_{0}=\emptyset \times sr$.
         \item Suppose $m_{\uptaupp}= b$. Then
         $\emptyset \times x_{1}x_{0}=\emptyset \times sd$.
       \end{enumPF}
       The macthing between $\uptau^{s}$ and $\uptau^{ns}$ is also clear by the
       above listing of cases.
     }
 \end{proof}



\subsubsection{A key proposition for the generalized descent case}

Now assume $C_{2k}$ is even. By our assumption, we have
$c_{2k+1}\geq c_{2k}=c_{2k-1}$.

\begin{equation}\label{eq:gd.drc.B}
  \uptau: \hspace{1em}
  \tytb{
    {*(srcol)\cdots}\cdots\cdots,
    {y_{0}}{\cdots}{\cdots},
    \none,\none,\none,\none}
  \times
  \tytb{{*(srcol)\cdots}\cdots\cdots,
    {x_{1}}{x_{0}}{\cdots},
    {x_{2}},{\vdots},{x_{n}},{m_{\uptau}}}
  \mapsto
  \uptaup: \tytb{{*(srcol)\cdots}\cdots\cdots,{y'_{0}}{\cdots}{\cdots},\none,\none,\none,\none}
  \times \tytb{\none\cdots\cdots,\none{x'_{0}}{\cdots},\none,\none,\none,\none}
  \mapsto
  \uptaupp: \tytb{\none\cdots\cdots,{\none}{\cdots}{\cdots},\none,\none,\none,\none}
  \times \tytb{\none\cdots\cdots,\none{x''}{\cdots},\none{\phantom{m}\mathclap{m_{\uptaupp}}},\none,\none,\none}
\end{equation}
Here the gray parts in $\uptau$ are two columns of $\bullet$ of length
$C_{2k}/2-1$.

\begin{lem}\label{lem:gd.inj.M}
  In \eqref{eq:gd.drc.B}, $x''=x_{0}$.
  The map $\delta\colon  \drc(\cO)\rightarrow \drc(\cOpp) \times \drc(\cO_{1})$
  given by $\uptau\mapsto (\eDDo^{2}(\uptau),\bfxx_{\uptau})$ is injective.
  Moreover,
  \[
  \ssign(\uptau) =\ssign(\uptaupp) + (C_{2k}-1, C_{2k}-1)+\ssign(\bfxx_{\uptau}).
  \]
  The map $\tdelta\colon \drc(\cO)\rightarrow \drc(\cOpp) \times \bN^{2}\times \bZ/2\bZ$
  given by $\uptau\mapsto (\eDDo^{2}(\uptau), \ssign(\uptau),\upepsilon_{\uptau})$ is injective.
\end{lem}
\begin{proof}
  The claim $x''=x_{0}$, the injectivity of $\delta$ and the siginature formula follows directly from our algorithm.

  Now the injectivity of $\tdelta$ follows from
  $\bfxx_{\uptau}\mapsto (\ssign(\bfxx_{\uptau}), \upepsilon)$ is injective by
  \Cref{c:init.CD}.
  \trivial{
    We can fully recover $\uptau$ from $\bfxx_{\uptau}$ and $\uptaupp$.

    Suppose $\bfxx_{\uptau}$ dose not contains $s$ or $c$.
    Then $x_{1}=r/d$,  $m_{\uptau}=m_{\uptaupp}$, $y_{0}=c$.
    Hence the claim holds.
    \[
      \ssign(\uptau) =\ssign(\uptaupp) + (C_{2k}-2,C_{2k}-2) + \ssign(c) +\ssign(\bfxx_{\uptau})
    \]

    Now assume $\bfxx_{\uptau}$ contain at least one $s$ or $c$.
    Now
    \[
      m_{\uptau} = \begin{cases}
        a & \text{if $\bfxx_{\uptau}$ contains $c$}\\
        b & \text{otherwise}
      \end{cases}
    \]
    Therefore, $\ssign(x_{2}\cdots x_{n}m_{\uptau}) = \ssign(\bfxx_{\uptau}) - (0,1)$.


    Clearly, we can recover $x_{2}\cdots x_{n}$ from $\bfxx_{\uptau}$ by
    deleting the $c$ (if it exists) or a $s$.
    On the other hand, $(y_{0}, x_{1})$ is completely determined by
    $m_{\uptaupp}$:
    \[
      (y_{0},x_{1}) = \begin{cases}
        (\bullet, \bullet) & \text{if $m_{\uptaupp}=a$}\\
        (c, s) & \text{if $m_{\uptaupp}=b$}
      \end{cases}
    \]
    Hence $\ssign(y_{0}x_{1}) = \ssign(m_{\uptaupp}) + (1,2)$.

    Now
    $\ssign(y_{0}x_{0}x_{1}\cdots x_{n}m_{\uptau})  =  \ssign(\bfxx_{\uptau}) +\ssign(x'' m_{\uptaupp}) + (1,2)-(0,1)$.
    This yields the signature identity.
  }
\end{proof}


\subsection{Proof of the type BM case}
We will reduce the proof to the type CD case.

In this section, $k\geq 1$ and
$\cO = (C_{2k+1}, C_{2k}, \cdots,C_{1}, C_{0}=0)\in \dpeNil(B)$.
$\cOp:=\eDD(\cO)$ and $\cOpp := \eDD(\cOp)$.

Take $\uptau\in \drc(\cO)$, we marks the entries in $\uptau$ as in  \cref{eq:ds2.B.sp,eq:ds2.B.nsp,eq:gd.drc.B}.
\subsubsection{Usual decent case}
Thanks to \Cref{lem:sp-nsp.B}, the proof in the descent case is exactly the same
as that in \Cref{sec:pf.ds.CD}.

\subsubsection{Reduction to type CD case in the general descent case.}

Suppose $C_{2k}$ is even.
We define $\tcO = (C_{2k+1}-C_{2k}+1,1,1)\in\dpeNil(D)$ and
$\tcOpp := \eDDo(\tcO)= (2)$.

The key proposition of reduction.
\begin{prop}
 We have  the following properties:
  \begin{enumC}
    \item When $\uptaupp = \eDDo^{2}(\uptau)$ for certain $\uptau\in \drc(\cO)$,
    we have $x_{\uptaupp}\neq s$;
    \item For each $\uptaupp$ such that $x_{\uptaupp}\neq s$, we have a
    bijection
    \[
      \begin{tikzcd}[row sep=0em]
       \bdelta \colon  \set{\uptau\in \drc(\cO)| \eDDo^{2}(\uptau)=\uptaupp} \ar[r] &
        \set{(x_{\tuptau},\bfuu_{\tuptau})| \tuptau\in \drc(\tcO) \text{ s.t.
          } \eDDo^{2}(\tuptau)=x_{\uptaupp}}\\
        \uptau \ar[r,mapsto] & (x_{\uptaupp}, \bfxx_{\uptau})
      \end{tikzcd}
  \]
  where $\bfuu_{\tuptau}$ is defined in \eqref{eq:def.u}.
  \end{enumC}
\end{prop}


The situation could be summarized in the following commutative diagram:
  \[
    \begin{tikzcd}
     & \uptau \ar[r,"\delta",mapsto] \ar[d,mapsto]& (\uptaupp, \bfxx_{\uptau})\ar[d,mapsto]\ar[r,mapsto] & \uptaupp\ar[d,mapsto]\\
     x_{\uptau} \ar[d,leftrightarrow,dashed] &\ar[l,mapsto]  \bfpp_{\uptau}\ar[r,mapsto]\ar[d,leftrightarrow]
     & (x_{\uptaupp}, \bfxx_{\uptau}) \ar[d,equal]\ar[r,mapsto]& x_{\uptaupp} \ar[d,equal]\\
    x_{\tuptau} & \ar[l,mapsto] \tuptau \ar[r,"\delta",mapsto]& (\tuptaupp,\bfuu_{\tuptau})\ar[r,mapsto]& \tuptaupp
    \end{tikzcd}
  \]
  We remark that $x_{\uptau}$ and $x_{\tuptau}$ are equal in the most of the
  case, especially when $n=1$. But there are exceptional cases.

  \begin{proof}
    This follows from a case by case verification according to our algorithm.
    We list all possible cases below:

    When $n=1$, see \Cref{tb:rd1}.% We have the following table:
    \begin{table}[p]
      \[
        \begin{array}{c|c|c|c|c}
          \hline
          \hline
          x_{\uptau} & \tytb{{\txx_{\uptaupp}},{m_{\uptaupp}}} & \bfpp_{\uptau} & (x_{\uptaupp},\bfxx_{\uptau}) & \tuptau_{L} \\
          \hline
          r & \tytb{r,a} &  \tytb{\bullet r,b} & (r,s) & \tytb{sr} \\
          \cline{3-5}
                     &            &  \tytb{\bullet r,a} & (r,c) & \tytb{rc} \\
          \hline
          r & \tytb{r,b} &  \tytb{sr,b} & (r,s) & \tytb{sr} \\
          \cline{3-5}
                     &            &  \tytb{sr,a} & (r,c) & \tytb{rc} \\
          \hline
          c & \tytb{s,a} &  \tytb{\bullet s,b} & (c,s) & \tytb{sc} \\
          \cline{3-5}
                     &            &  \tytb{\bullet s,a} & (c,c) & \tytb{cc} \\
          \hline
          d & \tytb{d,a} & \tytb{\bullet d,b} & (d,s) & \tytb{sd} \\
          \cline{3-5}
                     &            & \tytb{\bullet d,a} & (d,c) & \tytb{cd} \\
          \cline{3-5}
                     &            & \tytb{r d,a} & (d,r) & \tytb{rd} \\
          \cline{3-5}
                     &            & \tytb{d d,a} & (d,d) & \tytb{dd} \\
          \cline{2-5}
                     & \tytb{d,b} & \tytb{s d,b} & (d,s) & \tytb{sd} \\
          \cline{3-5}
                     &            & \tytb{s d,a} & (d,c) & \tytb{cd} \\
          \cline{3-5}
                     &            & \tytb{r d,b} & (d,r) & \tytb{rd} \\
          \cline{3-5}
                     &            & \tytb{d d,b} & (d,d) & \tytb{dd} \\
          \hline
          \hline
        \end{array}
      \]
      \caption{Reduction when $n=1$}
      \label{tb:rd1}
    \end{table}

    Now assume $n\geq 1$.
    We let $\bfxx = x_{1}x_{2}\cdots x_{n}$ and define
    \[
      \bfxx' = \begin{cases}
        \bfxx \text{ deleteing ``$c$''}  & \text{if } c\in \bfxx\\
        \bfxx \text{ deleteing ``$s$''}  & \text{if } c\notin \bfxx, s\in \bfxx\\
        \text{undefined} & \text{otherwise.}
      \end{cases}
    \]
    Now all the cases are listed in \Cref{tb:rd2}.
    % If $c\in \bfxx$, let $\bfxx'$ be the string obtained by deleting  $c$ from
    % $\bfxx$.
    % In the following table, if $c$ occures in $\bfxx$ or
    % $\bfxx'$, we  will view $c$ as $s$ and
    % arrange the order of entries when place them in $\bfpp_{\uptau}$.

    \begin{table}[p]
      \[
        \begin{array}{c|c|c|c|c|c:c}
          \hline
          \hline
          x_{\uptau} & \tytb{{\txx_{\uptaupp}},{m_{\uptaupp}}} & \bfpp_{\uptau} & x_{\uptaupp}, \bfxx_{\uptau}
          & \tuptau_{L} & \multicolumn{2}{ c}{\text{conditions}}\\
          \hline
          r & \tytb{r,a} &  \tytb{\bullet r,{\bfxx'},a} & \tytb{r{,}{\bfxx}} & \tytb{{\bfxx}r,}& x_{1}\neq r& c\in \bfxx  \\
          \cline{5-6}
                     & & & &\tytb{rc,{\bfxx'}} & x_{1}=r& \\
          \cline{3-3}\cline{4-7}
                     &            &  \tytb{\bullet r,{\bfxx'},b} & \tytb{r{,}{\bfxx}} & \tytb{{\bfxx}r}
                        & \multicolumn{2}{c}{c\notin \bfxx,s\in \bfxx} \\
          \hline
          r & \tytb{r,b} &  \tytb{sr,{\bfxx'},a} & \tytb{r{,}{\bfxx}} & \tytb{{\bfxx}r,}& x_{1}\neq r& c\in \bfxx  \\
          \cline{5-6}
                     & & & &\tytb{rc,{\bfxx'}} & x_{1}=r& \\
          \cline{3-3}\cline{4-7}
                     &            &  \tytb{sr,{\bfxx'},b} & \tytb{r{,}{\bfxx}} & \tytb{{\bfxx}r}
                        & \multicolumn{2}{c}{c\notin \bfxx,s\in \bfxx} \\
          \hline
          c & \tytb{s,a} &\tytb{\bullet s,{\bfxx'},a} & \tytb{c{,}{\bfxx}} & \tytb{{\bfxx}c}
                        & c\in \bfxx   & s\in \bfxx \text{ is automatic} \\%\multicolumn{2}{c}{c\in \bfxx}\\
          \cline{3-3}\cline{6-6}
                     &            &\tytb{\bullet s,{\bfxx'},b} &                    &
                        & c\notin \bfxx   &\\%\multicolumn{2}{c}{c\in \bfxx}\\
          \hline
          d & \tytb{d,a} &\tytb{\bullet d,{\bfxx'},a} & \tytb{d{,}{\bfxx}} & \tytb{{\bfxx}d}& \multicolumn{2}{c}{c\in \bfxx}\\
          \cline{3-3}\cline{6-7}
                     &            &\tytb{\bullet d,{\bfxx'},b} &                    &
                        & x_{1}=s & c\notin \bfxx   \\%\multicolumn{2}{c}{c\in \bfxx}\\
          \cline{3-3}\cline{6-7}
                     &            &\tytb{{\bfxx}d,a} &                    &
                        & x_{1}\neq s & c\notin \bfxx   \\%\multicolumn{2}{c}{c\in \bfxx}\\
          \hline
          d & \tytb{d,b} &\tytb{s d,{\bfxx'},a} & \tytb{d{,}{\bfxx}} & \tytb{{\bfxx}d}
                        & \multicolumn{2}{c}{c\in \bfxx}\\
          \cline{3-3}\cline{6-7}
                     &            &\tytb{s d,{\bfxx'},b} &                    &
                        & x_{1}=s & c\notin \bfxx   \\%\multicolumn{2}{c}{c\in \bfxx}\\
          \cline{3-3}\cline{6-7}
                     &            &\tytb{{\bfxx}d,b} &                    &
                        & x_{1}\neq s & c\notin \bfxx   \\%\multicolumn{2}{c}{c\in \bfxx}\\
          \hline
          \hline
        \end{array}
      \]
      \caption{Reduction when $n\geq 1$}
      \label{tb:rd2}
    \end{table}
  \end{proof}

  Thanks to $\bdelta$ defined in  the above lemma, we can use \eqref{eq:gd.ls}.
  The rest of the proof is similar to that in \Cref{sec:pf.gd.CD}.
  We leave the details to the reader.

% \begin{prop}
%   Inductively, we can establish the following properties:
%   \begin{enumS}
%     \item  The local system $\cL_{\uptau}$ has the factorization according to
%     $\txx_{\uptau}$.
%   \end{enumS}
% \end{prop}

\section{Examples}
\subsection{Regular orbit of type C}
  \label{sec:C.reg}
Consider the case that
$\cO = (2,\underbrace{1, \cdots, 1}_{(2n)\text{-terms}})\in \Nil(D)$.
Now $\cOp:=\eDD(\cO)$ is the regular orbit of $\Sp(2n)$.
%$[2k+2,2k+1, \cdots, 2k+1, 2l, 2l,\cdots ]$.
%here we have $2k+1$-columns $2t$.

% Then $\cOp$ is a regular orbit of the corresponding symplectic group.
$\cOp$ is the opposite case compared to the noticed oribts. It is very ``degenerate''.

{\color{red} TBA}

\delete{
By the calculation above, we have
\[
  \cL_{\uptaupp} = \cB_{\uptaupp} \cdot \cP_{\bfpp_{\uptaupp}}.
\]

Now the


\begin{equation} \label{eq:B1-2}
  \begin{array}{c|c|c}
   \bfpp_{\uptaup}=\bfpp_{\uptau}=x_{1}y_{1}  &   \cP_{\uptaupp} & \cP_{\uptaup}\\
    \hline
    sr & \tytb{+-+,=} & \\
    \hline
    sc & \tytb{-+-,=} & \\
    \hline
    sd & \tytb{=\ast=,=} &\\
    \hline
    rc & \tytb{\ast=\ast,+} & \tytb{=\ast=\ast}\\
    \hline
    rd & \tytb{+-+,+} & \tytb{-+-+}\\
    \hline
    cc & \tytb{=\ast=,+} &  \tytb{\ast=\ast=} \\
    \hline
    cd & \tytb{-+-,+} \cup \tytb{\ast=\ast,=} &\tytb{+-+-} \\
    \hline
    dd & \tytb{-+-,+}\cup\tytb{+-+,-} &\tytb{+-+-} \cup \tytb{-+-+}\\
  \end{array}
\end{equation}


\begin{equation} \label{eq:B1-2}
\begin{array}{cc|c|cc}
  \bfxx_{\uptaupp} & \cP_{\uptaupp}         & \cP_{\uptaup} & \bfxx_{\uptau} & \cP_{\uptaupp} \\
  \hline
  src              & \tytb{\ast\cdots ,=} &                                                 \\
  \hline
  srd              & \tytb{+\cdots,=}          &                                                 \\
  \hline
  scc              & \tytb{-\cdots,=}          &                                                 \\
  \hline
  scd              & \tytb{=\cdots,=} &                                                 \\
  sdd              & %\tytb{=\ast=\ast=,=}
                                            &                                                 \\
  \hline
  rcc              & \tytb{\ast\cdots,+} & \tytb{-\cdots}                                                \\
  \hline
  rcd              & \tytb{+\cdots,+} & \tytb{=\cdots}                             \\
  rdd              & %\tytb{+-+-+,+} & \tytb{=\ast=\ast=\ast}                             \\
                                & \\
  \hline
  ccc              & \tytb{-\cdots,+}          & \tytb{+\cdots}                                               \\
  \hline
  ccd              & \tytb{=\cdots,+}          & \tytb{\ast\cdots}                                             \\
  cdd              & \tytb{=\cdots,+}\cup \tytb{+\cdots,=} & \\
  \hline
  ddd              & \tytb{-\cdots,+}\cup \tytb{+\cdots,-}  &
                                                            \tytb{+\cdots} \cup\tytb{-\cdots}                     \\
\end{array}
\end{equation}

When $t$ is even.
In the following
%$\cA_{8}\cap\cA_{9}=\emptyset$.
$\set{\cA_{1},\cA_{2}, \cA_{3},\cA_{4}}$ are disjoint, $\set{\cA_{5},\cA_{6}}$ are disjoint,
and $\set{\cA_{7},\cA_{8},\cA_{9}}$ % and $\set{\cA_{9},\cA_{10}}$
are disjoint.
$\cA_{9}=\set{d\cdots d}$
\begin{equation} \label{eq:B1-2}
\begin{array}{cc|c|cc}
  \bfxx_{\uptaupp} & \cP_{\uptaupp}         & \cP_{\uptaup} & \bfxx_{\uptau} & \cP_{\uptau} \\
  \hline
  s\cA_{1}              & \tytb{\ast\cdots ,=} &                                                 \\
  \hline
  s\cA_{2}              & \tytb{+\cdots,=}          &                                                 \\
  \hline
  s\cA_{3}              & \tytb{-\cdots,=}          &                                                 \\
  \hline
  s\cA_{4}              & \tytb{=\cdots,=} &                                                 \\
  \hline
  r\cA_{5}              & \tytb{\ast\cdots,+} & \tytb{-\cdots}  & sr\cA_{5} & \tytb{\ast\cdots, =}                            \\
                        &                    &                & rc\cA_{5} &\tytb{+\cdots,+}                                   \\
  \hline
  r\cA_{6}              & \tytb{+\cdots,+} & \tytb{=\cdots}    & sr\cA_{6} &  \tytb{+\cdots,=}                        \\
                        &                    &                & rc\cA_{6} &\tytb{\ast\cdots,+}                                   \\
  \hline
  c\cA_{7}              & \tytb{-\cdots,+}          & \tytb{+\cdots} & sc\cA_{7} & \tytb{=\cdots,=}                                        \\
                        &                    &                & cc\cA_{7} &\tytb{-\cdots,+}                                   \\
  \hline
  c\cA_{8}              & \tytb{=\cdots,+}          & \tytb{\ast\cdots} & sc(\cA_{8}\cup \cA_{9}) & \tytb{-\cdots,=}                                   \\
   c\cA_{9}           &   \tytb{=\cdots,+}\cup \tytb{+\cdots,=}     &                & cc(\cA_{8}\cup \cA_{9}) &\tytb{=\cdots,+}                                   \\
  \hline
  d\cA_{9}              & \tytb{-\cdots,+}\cup \tytb{+\cdots,-}  &
                                        \tytb{+\cdots} \cup\tytb{-\cdots}    & sd\cA_{9} & \tytb{=\cdots,=}                 \\
                        &                    &                & rd\cA_{9} &\tytb{+\cdots,+}                                   \\
                        &                    &                & cd\cA_{9} &\tytb{-\cdots,+}  \cup \tytb{\ast\cdots,=}                \\
                        &                    &                & dd\cA_{9} &\tytb{-\cdots,+} \cup \tytb{+\cdots,-}                       \\
\end{array}
\end{equation}

We observe that there are two coincidences:
\begin{enumT}
  \item $\tytb{+\cdots,+}$: clearly $rc\cA_{5}$ and $rd\cA_{9}$ are disjoint.
  \item $\tytb{=\cdots,=}$: clearly $sc\cA_{7}$ and $sd\cA_{9}$ are also disjoint.
\end{enumT}


When $t$ is odd.
In the following
%$\cA_{8}\cap\cA_{9}=\emptyset$.
$\set{\cA_{1},\cA_{2}, \cA_{3},\cA_{4}}$ are disjoint, $\set{\cA_{5},\cA_{6}}$ are disjoint,
and $\set{\cA_{7},\cA_{8},\cA_{9}}$ % and $\set{\cA_{9},\cA_{10}}$
are disjoint.
$\cA_{9}=\set{d\cdots d}$
\begin{equation} \label{eq:B1-2}
\begin{array}{cc|c|cc}
  \bfxx_{\uptaupp} & \cP_{\uptaupp}         & \cP_{\uptaup} & \bfxx_{\uptau} & \cP_{\uptau} \\
  \hline
  s\cA_{1}              & \tytb{\ast\cdots ,=} &                                      \\
  \hline
  s\cA_{2}              & \tytb{+\cdots,=}          &                                     \\
  \hline
  s\cA_{3}              & \tytb{-\cdots,=}          &                                 \\
  \hline
  s\cA_{4}              & \tytb{=\cdots,=} &                                      \\
  \hline
  r\cA_{5}              & \tytb{\ast\cdots,+} & \tytb{=\cdots}  & sr\cA_{5} & \tytb{\ast\cdots,=}                      \\
                        &                    &                & rc\cA_{5} &\tytb{\ast\cdots,+}                         \\
  \hline
  r\cA_{6}              & \tytb{+\cdots,+} & \tytb{-\cdots}    & sr\cA_{6} &  \tytb{+\cdots,=}                    \\
                        &                    &                & rc\cA_{6} &\tytb{+\cdots,+}                          \\
  \hline
  c\cA_{7}              & \tytb{=\cdots,+}          & \tytb{\ast\cdots} & sc\cA_{7} & \tytb{-\cdots,=}                                        \\
                        &                    &                & cc\cA_{6} &\tytb{-\cdots,+}                                \\
  \hline
  c\cA_{8}              & \tytb{-\cdots,+}          & \tytb{+\cdots} & sc(\cA_{8}\cup \cA_{9}) &\tytb{=\cdots,=}             \\
                        &                    &                & cc(\cA_{8}\cup \cA_{9}) &\tytb{=\cdots,+}                                   \\
  c\cA_{9}              & \tytb{-\cdots,+}\cup \tytb{\ast\cdots,=} & \\
  \hline
  d\cA_{9}              & \tytb{-\cdots,+}\cup \tytb{+\cdots,-}  &
                                                            \tytb{+\cdots} \cup\tytb{-\cdots}    & sd\cA_{9} & \tytb{=\cdots,=}                 \\
                        &                    &                & rd\cA_{9} &\tytb{+\cdots,+}                                   \\
                        &                    &                & cd\cA_{9} &\tytb{=\cdots,+}  \cup \tytb{+\cdots,=}                \\
                        &                    &                & dd\cA_{9} &\tytb{-\cdots,+} \cup \tytb{+\cdots,-}                       \\
\end{array}
\end{equation}
}


\section{Matrix coefficient integrals and degenerate principal series}\label{sec:Integrals}

In this section, we define the notion of a $\nu$-bounded representation and investigate the
matrix coefficient integrals of such representations against the oscillator representation as well as certain
degenerate principle series.

\subsection{Matrix coefficients: growth and positivity}

In this subsection, let $G$ be an arbitrary  real reductive group.
\begin{dfnl}
  A (complex valued) function $\ell$ on $G$ is said to be of \emph{logarithmic
    growth} if there is a continuous homomorphism
  $\sigma\colon G\rightarrow \GL_n(\R)$ for some $n\geq 1$, and an integer
  $d\geq 0$ such that
  \[
    \abs{\ell(g)}\leq \left(\log(1+\tr((\sigma(g))^\mathrm{t} \cdot
      \sigma(g)))\right)^d\quad \textrm{for all }g\in G.
  \]

\end{dfnl}

Assume that a maximal compact subgroup $K$ of $G$ is given. Let $\Xi_{G}$ denote Harish-Chandra's $\Xi$-function on $G$ associated to $K$.
\begin{dfnl}
  Let $\nu\in \R$. A function $f$ on $G$ is said to be \emph{$\nu$-bounded} if
  there is a positive function $\ell$ on $G$ of logarithmic growth such that
  \[
    \abs{f(g)}\leq \ell(g) \cdot (\Xi_G (g))^\nu\quad \textrm{for all }g\in G.
  \]
\end{dfnl}

We remark that the definition is independent of the choice of $K$.


\begin{lem}\label{intgrability}
  Assume that the identity connected component of $G$ has a compact center. Then
  for all $\nu>2$, every $\nu$-bounded continuous function on $G$ is integrable
  (with respect to a Haar measure).
\end{lem}

\begin{proof}
  This follows easily from the well-known estimate of Harish-Chandra's
  $\Xi$-function, see \cite[Theorem 4.5.3]{Wa1}.
\end{proof}

\begin{dfnl}
  Let $\nu\in \R$. A Casselman-Wallach representation $\pi$ of $G$ is said to be
  \emph{$\nu$-bounded} if there is a $\nu$-bounded positive function $f$ on $G$,
  and continuous seminorms $\abs{\ }_\pi$ on $\pi$ and $\abs{\ }_{\pi^\vee}$ on
  $\pi^\vee$ such that
  \[
    \abs{\la g\cdot u,v\ra}\leq f(g) \cdot \abs{u}_\pi \cdot \abs{v}_{\pi^\vee},
  \]
  for all $g\in G, \, u\in \pi, \, v\in \pi^\vee$.
\end{dfnl}

%Clearly, a representation of a compact group is $\nu$-bounded for all $\nu\in \bR$.

We also recall the following positivity result on diagonal matrix coefficients, which is a special case of \cite[Theorem A. 5]{HLS}.

\begin{prpl}\label{positivity}
Let $G$ be a real reductive group with a maximal compact subgroup $K$. Let $\pi_1$ and $\pi_2$ be two unitary representations of $G$ such that $\pi_2$ is weakly
contained in the regular representation.
Let
\[
u:=\sum_{i=1}^s u_i\otimes v_i\in \pi_1\otimes \pi_2.
\]
Assume that
\begin{enumC}
\item for all $i,j=1,2,\cdots, s$, the function
  $g\mapsto \la g \cdot u_i, u_j\ra\,\Xi_G (g)$ on $G$ is absolutely integrable with
  respect to a Haar measure $\od\! g$ on $G$;
\item
  $v_1,v_2,\cdots, v_s$ are all $K$-finite.
\end{enumC}
Then the integral
\[%\begin{equation}\label{geq0}
\int_G \la g\cdot u,u \rangle\,\od\! g
\]%\end{equation}
absolutely converges to a nonnegative real number.
\end{prpl}

\subsection{Theta lifting via matrix coefficient integrals}\label{sec:MCI}
We return to the setting of \Cref{sec:descent} so that
$\bfV$ is an $(\epsilon, \dot \epsilon)$-space, $\abfV$ is a
$(-\epsilon, -\dot \epsilon)$-space, and $(\bfW,J_{\bfW},L_{\bfW})$ is a
$(-1,-1)$-space with $\bfW:= \Hom_\bC(\bfV,\abfV)$.
%with a strong real form $J_{\bfW}$ and a compatible Cantan involution $L_{\bfW}$.
Recall that $(\GVr,\GVar) = (\bfG_{\bfV}^{J},\bfG_{\bfV'}^{J'})$ is a dual pair in $\Sp(W)$, where
$W=\bfW^{J_{\bfW}}$.

Let $\rH(W):=W\times \R$
denote the Heisenberg group attached to $W$, with group multiplication
\[
  (u,t)\cdot (u', t'):=(u+u', t+t'+\la u, u'\ra_{\bfW}), \qquad u,u'\in W, \, t, t'\in \R.
\]
Note that $\bfW$ is naturally
identified with a subspace of the complexified Lie algebra of $\rH(W)$. There is a totally complex
polarization $\bfW = \cX\oplus \cY$ where $\cX$ and $\cY$ are the $+\mathbf i$ and $-\mathbf i$
eigenspaces  of $L_{\bfW}$ respectively.
We have a Cartan decomposition:
\[
   G_{\bfW}=\Sp(W)=K_{\bfW}\times S_{\bfW}.
\]
where
$
 S_{\bfW}:=\Set{\exp(X) | X\in \fgg_{\bfW}^{J_\bfW}, \ X L_{\bfW}+L_{\bfW} X=0}.
$


\subsubsection{The oscillator representation}
The group $\tGVr\times \tGVar$ acts on $\oH(W)$ as group automorphisms through the natural action of $\GVr\times \GVar$ on $W$. Using this, we form the semidirect product $(\tGVr\times \tGVar)\ltimes \oH(W)$.
As in   Section \ref{sec:LVB}, we assume that $\mathbb p$ is the parity of $\dim \bfV$ if $\epsilon=1$, and  the parity of $\dim \bfV'$ if $\epsilon '=1$.
\begin{defn}\label{defor}
A smooth oscillator representation associated to $(\bfV,\abfV)$ is a smooth Fr\'echet representation $\omega_{\bfV,\abfV}$ of $(\tGVr\times \tGVar)\ltimes \rH(W)$ of moderate growth such  that
\begin{itemize}
\item as a representation of $\rH(W)$, it is irreducible with central character
  $t\mapsto e^{\bfii\, t}$;
\item $\widetilde K\times \widetilde K'$ acts on  $\omega_{\bfV,\abfV}^{\cX}$ (the space of vectors in
  $\omega_{\bfV,\abfV}$ which are annihilated by $\cX$) through the character $\mktvvp$.
\end{itemize}
\end{defn}

Note that the first condition in \Cref{defor} implies that the space
$\omega_{\bfV,\abfV}^{\cX}$ is one-dimensional. If $G$ is a nontrivial real symplectic group, a quaternionic symplectic group, or a quaternionic orthogonal group which is not isomorphic to $\mathrm O^*(2)$, then the first condition also implies that $\widetilde K$ acts on $\omega_{\bfV,\abfV}^{\cX}$ through the character $\mktvvp|_{\widetilde K}$. Similar result holds for $\widetilde K'$.  The smooth oscillator representation always exists and  is unique up to
isomorphism. From now on we  fix a smooth oscillator representation
$\omega_{\bfV,\abfV}$ for each rational dual pair $(\bfV,\abfV)$.

% \begin{lem}
% The space
% \[
%   \Set{u\in \omega_{\bfV,\abfV}\mid \textrm{$u$ is annihilated by some power of $\cX$}}
% \]
% is dense and therefore is naturally a Harish-Chandra module of $\omega_{\bfV,\abfV}$.
% \end{lem}

\medskip

Let $\Psi_{\bfW}$ be the positive function on $G_{\bfW}$ which is bi-$K_{\bfW}$-invariant such that
  \[
  \Psi_{\bfW}(g)=\prod_{a} (1+a)^{-\frac{1}{2}}, \quad \textrm{for every } g\in S_{\bfW},
  \]
  where $a$ runs over all eigenvalues of $g$, counted with multiplicities. By abuse of notation, we still use $\Psi_{\bfW}$ to denote the pullback function through the covering map $\wtG_{\bfW}\rightarrow G_{\bfW}$.

  % Note that the representation $(\omega_{V,\acute{V}})|_{\rH(W)}$ uniquely
  % extends to a representation of $\wtG_{\bfW}\ltimes \rH(W)$, which is still
  % denoted by $\omega_{V,\acute{V}}$.  Likewise, the contragradient
  % representation %$\omega_{V,\acute{V}}^\vee$ is also viewed as a
  % representation of $\wtG_{\bfW}\ltimes \rH(W)$.


\begin{lem}\label{estosc}
 Extend the irreducible representation $\omega_{\bfV, \abfV}|_{\rH(W)}$ to the group $\wtG_{\bfW}\ltimes \rH(W)$. Then there exists continuous seminorms $\abs{\,\cdot\,}_1$ on
  $\omega_{\bfV,\abfV}$ and $\abs{\,\cdot\,}_2$ on
  $\omega_{\bfV,\abfV}^\vee $ such that
\[
  \abs{\inn{ g\cdot \phi}{ \phi'}}\leq \Psi_{\bfW}(g)\cdot \abs{\phi}_1 \cdot
  \abs{\phi'}_2, \quad \textrm{for all } g\in \wtG_{\bfW},\, \phi\in
  \omega_{\bfV, \abfV}, \, \phi'\in \omega_{\bfV, \abfV}^\vee.
\]
\end{lem}
\begin{proof} This is in the proof of \cite[Theorem 3.2]{Li89}.
\end{proof}

Define
\[%\begin{equation}\label{eq:dimo}
  \dimo \bfV:=\left\{
    \begin{array}{ll}
      \dim \bfV,  & \hbox{if $G$ is real symplectic;} \\
      \dim \bfV-1, & \hbox{if $G$ is quaternionic symplectic;} \\
      \dim \bfV-2, & \hbox{if $G$ is real orthogonal;} \\
      \dim \bfV-3, & \hbox{if $G$ is quaternionic orthogonal.} \\
    \end{array}
  \right.
\]%\end{equation}


Let $\Psi_{\bfW}|_{\tGVr\times \tGVar}$ denote the pull back of
$\Psi_{\bfW}$ through the natural homomorphism
$\tGVr\times \tGVar\rightarrow \wtG_{\bfW}$.



\begin{lem}\label{estosc2}
  Assume that both $\dimo \bfV$ and $\dimo \abfV$ are
  positive. Then the pointwise inequality
\[
  \Psi_{\bfW}|_{\tGVr\times \tGVar}\leq  (\Xi_{\tGVr})^{\frac{\dim \abfV}{\dimo \bfV}}  \cdot (\Xi_{\tGVar})^{\frac{\dim \bfV}{\dimo \abfV}}
\]
holds.
\end{lem}
\begin{proof}
This is easy to check, by using the  well-known estimate of  Harish-Chandra's $\Xi$-function (\emph{cf}.  \cite[Theorem 4.5.3]{Wa1}.)

%\mjj{reference/proof?}
\end{proof}


\subsubsection{Matrix coefficient integrals against oscillator representations}

 Let $\pi$ be a  Casselman-Wallach representation of $\tGVr$.


 \begin{defn}\label{defn:CR}
   Assume that $\dimo \bfV>0$. The pair $(\pi, \abfV)$ is said to be in the
   \emph{convergent range} if
   \begin{itemize}
   \item $\pi$ is $\nu_\pi$-bounded for some
     $\nu_\pi>2-\frac{\dim \abfV}{\dimo \bfV}$;
     \item
     %$\pi$ is $\mathbb p$-genuine, that is,
     if $G$ is a real symplectic group, then $\varepsilon_G$ acts on $\pi$ through the scalar multiplication by $(-1)^{\dim \bfV'}$.
        \end{itemize}
\end{defn}

In the rest of this section, assume that $\dimo \bfV>0$ and the pair $(\pi, \abfV)$ is in the convergent range.
% \begin{lem}\label{intpi}
Consider the following integral:
\begin{equation}\label{intpios}
  \xymatrix@R=0em@C=3em{
   (\pi\widehat \otimes \omega_{\bfV,\abfV})\times (\pi^\vee \widehat \otimes
   \omega_{\bfV,\abfV}^\vee)
   \ar[r]&\bC,\hspace*{5em}\\
   (u,v)\ar@{|->}[r] &\int_{\tGVr} \inn{g\cdot u}{v} \rdd g.
   }
\end{equation}

\begin{lem}\label{intpi}
The integrals in \cref{intpios} are absolutely convergent and yield a continuous bilinear map.
\end{lem}
\begin{proof}
This is implied by Lemma \ref{estosc2} and Lemma \ref{intgrability}.
\end{proof}


In view of Lemma \ref{intpi}, we define
\begin{equation}\label{thetab0}
  \Thetab_{\bfV,\abfV}(\pi):=\frac{\pi\widehat \otimes \omega_{\bfV,\abfV}}{\textrm{the left kernel of \eqref{intpios}}}.
\end{equation}
This is a Casselman-Wallach representation of $\tGVar$, since it is a quotient of the full theta lift  $(\pi\widehat \otimes \omega_{\bfV,\abfV})_G$ (the Hausdorff coinvariant space).
%\mjjc{Why it is Casselman-Wallach?}



\begin{lem}\label{intpi2}
Assume that $\dimo \abfV>0$. Then the representation
$\Thetab_{\bfV,\abfV}(\pi)$ is $\frac{\dim \bfV}{\dimo \abfV}$-bounded.
\end{lem}
\begin{proof}
This is also implied by Lemma \ref{estosc2} and Lemma \ref{intgrability}.
\end{proof}

\subsubsection{Unitarity}


\begin{thm}\label{positivity0}
Assume that $\dim \abfV\geq \dimo \bfV$ and $\pi$ is  $\nu_\pi$-bounded for some
\[
  \nu_\pi>\begin{cases}
    2-\frac{\dim \abfV}{\dimo \bfV},&\text{if $\dimo \bfV$ is even,}\medskip\\
    2-\frac{\dim \abfV-1}{\dimo \bfV}, &\text{if $\dimo \bfV$ is odd.}
  \end{cases}
\]
Then $\Thetab_{\bfV,\abfV}(\pi)$ is unitarizable if  $\pi$ is unitarizable.
Moreover, when $\pi$ is irreducible and unitarizable, and $\Thetab_{\bfV,\abfV}(\pi)$ is nonzero,
then $\Thetab_{\bfV,\abfV}(\pi)$ is irreducible unitarizable.
\end{thm}

\begin{proof}
Assume that $\pi$ is unitarizable. For the first claim, it suffices to show that
\begin{equation}\label{intpo}
  \int_{\tGVr} \inn{g\cdot u}{u}\od\! g\geq 0\quad \text{for all $u$ in a dense subspace of $\pi\widehat \otimes \omega_{\bfV,\abfV}$.}
\end{equation}
Here $\la\,,\,\ra$ denotes a Hermitian inner product on
$\pi\widehat \otimes \omega_{\bfV,\abfV}$ which is invariant under
$\tGVr\times ((\tGVr\times \wtG')\ltimes \rH(W))$.

Take an orthogonal decomposition
\[%\begin{equation}\label{decvi}
  \abfV=\abfV_{1}\oplus \abfV_{2}
\]%\end{equation}
which is stable under both $J'$ and $L'$ such that
\[
  \dim \abfV_2=
  \begin{cases}
    \dimo \bfV, &\text{if $\dimo \bfV$ is even.}\medskip\\
    \dimo \bfV+1, &\text{if $\dimo \bfV$ is odd.}
  \end{cases}
\]
(When $\dimo \bfV$ is odd, $\dim \abfV$ is always even.) Write
\[
  \pi\whotimes \omega_{\bfV, \abfV}=(\pi\whotimes \omega_{\bfV,\abfV_1})\whotimes \omega_{\bfV, \abfV_2}.
\]
Note that the Hilbert space completions of $\pi\whotimes \omega_{\bfV,\abfV_1}$ and $\omega_{\bfV, \abfV_2}$, viewed as unitary representations of $\tGVr$,
satisfy the hypothesis for $\pi _1$ and $\pi _2$ in Proposition \ref{positivity}. For the latter, see \cite[Theorem 3.2]{Li89}. Thus \eqref{intpo}
follows by Proposition \ref{positivity}.


The second claim follows from the fact that $\Thetab_{\bfV,\bfV'}(\pi)$ is a
quotient of $(\omega_{\bfV,\bfV'}\whotimes \pi)_G$ which is of finite length and
has a unique irreducible quotient  \cite{Howe89}.
\end{proof}






\subsection{Degenerate principal series}\label{secdege}
\def\GLE{\GL(\bfE)^{J_{\bfU}}}
\def\GLEz{\GL_{\bfE_0}}
\def\GLE{{\GL_{\bfE}}}
\def\wtGLE{\widetilde{\GLE}}
\def\wtGLEz{\widetilde{\GLEz}}
\def\wtPE{\widetilde{P_\bfE}}
\def\JU{{J_{\bfU}}}
\def\LU{{L_{\bfU}}}
\def\wtGU{\widetilde{G}_\bfU}

Let $(\bfU,\JU,\LU)$ be a nonzero $(\epsilon, \dot \epsilon)$-space which is
split in the sense that there is a $J_{\bfU}$-stable totally isotropic subspace
$\bfE$ of $\bfU$ whose dimension equals half of that of $\bfU$.
Then we have a
complete polarization
\begin{equation}\label{eq:UEE}
  \bfU=\bfE\oplus \bfE', \quad \textrm{where $\bfE':=\LU(\bfE)$ is also totally isotropic}.
\end{equation}
Define notations as in \Cref{sec:MC},  for example $G_\bfU := \bfG_{\bfU}^{\JU}$.
The parabolic subgroup $P_{\bfE}$ of $G_{\bfU}$
stabilizing $\bfE$, has a Levi decomposition
\[
  P_{\bfE}=\GLE\ltimes N_{\bfE},
\]
where $N_{\bfE}$ is the unipotent radical and $\GLE\cong \GL(\bfE)^{\JU}$
is the stabilizer of  the polarization \eqref{eq:UEE} in $G_\bfU$. Since the covering
$\wtPE\rightarrow P_{\bfE}$ uniquely splits over $N_{\bfE}$, we view $N_{\bfE}$
as a subgroup of $\wtPE$. Thus we have a decomposition
\[
  \wtPE=\wtGLE\ltimes N_{\bfE}.
\]


In this section, we assume that $\mathbb p$ is the parity of $\dim \bfE +1$ if $G_\bfU$ is real orthogonal or real symplectic, and the parity of $\dim \bfE $ if $G_\bfU$ is quaternionic.
Let $\chi_{\bfE}$ be a character of $\wtGLE$ as in \mbox{\Cref{tablechi}}.  In
the real symplectic case, $\varepsilon_\bfU$ denotes the nontrivial element in the kernel of the
covering $\wtGU\rightarrow G_\bfU$,  and there are two choices of $\chi_{\bfE}$ if $\bfU$ is moreover nonzero.  In the
quaternionic case, $\det: \GLE\rightarrow \R_+^\times$ denotes the reduced
norm.



\begin{table}[h]
   \centering % used for centering table
  \begin{tabular}{c c c} % centered columns (4 columns)
    $G_{\bfU}$ & \vline & $\chi_{\bfE}$\\ % inserting body of the table
    \hline
    real orthogonal & \vline & $1$ \\
    \hline
    real symplectic  & \vline  &
                                 $\chi_{\bfE}^4=1$,$\ $  $\chi_{\bfE}(\varepsilon_{\bfU})=(-1)^{\mathbb p}$ \\
    \hline
    quaternionic orthogonal   & \vline  &
                                          $ \det^{\frac{1}{2}}$\\
    \hline
    quaternionic symplectic   & \vline  &
                                          $ \det^{-\frac{1}{2}}$\\
    \hline
  \end{tabular}\\
\vspace*{.5em}
 \caption{The character  $\chi_{\bfE}$}\label{tablechi}
  \label{table:nonlin} % is used to refer this table in the text
\end{table}


For each character $\chi$ of $\wtGLE$, define the degenerate principal series
\[
  \RI( \chi):=\Ind_{\wtPE} ^{\wtGU}  \chi.
\]
We are particularly interested in $\RI( \chi_{\bfE})$, which plays a critical role in the study of theta correspondence.

Define a positive function on $\wtGU$ by setting
\[
  \Xi_{\bfU}(g):=\int_{\wtK_{\bfU}} f_0(xg) \od \! x,\qquad g\in \wtG_{\bfU},
\]
where $f_0$ denotes the element of  $\Ind_{\wtP_{\bfE}} ^{\wtG_{\bfU}}  \abs{\chi_{\bfE}}$ whose restriction to $\wtK_{\bfU}$ is the constant function $1$, and $\od \! x$ denotes the normalized Haar measure on $\wtK_{\bfU}$.  This function is independent of $\bfE$.


Identify the representation $\RI(\chi_\bfE)^\vee$ with $\RI(\chi_\bfE^{-1})$ via the
paring
\[
  (f_1, f_2)\mapsto \inn{ f_1}{f_2}:= \int_{\wtK_\bfU} f_1 (x) f_2(x) \rdd x,
  \quad f_1\in \RI(\chi_\bfE),\, f_2\in \RI(\chi_\bfE^{-1}).
\]
The following lemma is clear from the definition of $\Xi_{\bfU}$.
\begin{lem}\label{esti}
  For all $f_1\in \RI( \chi_{\bfE})$, $f_2\in \RI( \chi_{\bfE}^{-1})$ and
  $g\in \wtG_{\bfU}$,
  \[\abs{\la g \cdot f_1, f_2\ra}\leq \Xi_{\bfU}(g) \cdot \max_{x\in
      \wtK_{\bfU}} \abs{f_1(x)} \cdot \max_{x\in \wtK_{\bfU}} \abs{f_2(x)}. \qed
  \]
\end{lem}



\subsection{Matrix coefficient integrals against degenerate principal series}
\label{sec:DP}


Now we assume that $(\bfV,J,L)$ is a non-degenerate
$(\epsilon, \dot \epsilon)$-subspace of $\bfU$ so that
\[
  J = J_{\bfU}|_{\bfV}\quad
  \textrm{and}\quad L = L_{\bfU}|_{\bfV}.
\]
Then $\wtG := \wtG_{\bfV}$ is naturally a
closed subgroup of $\wtG_{\bfU}$. Further assume that
$$\dim \bfV \leq \dim \bfE.$$  We are interested in the growth of
$\Xi_{\bfU}|_{\wtG}$.



\begin{lem}\label{boundxi}
  Assume that $\dimo \bfV>0$. Then $\Xi_{\bfU}|_{\wtG}$ is
  $\nu_{\bfU,\bfV}$-bounded, where
  \begin{equation}
    \label{nuuv}
    \nu_{\bfU,\bfV}:=
    \begin{cases}
      \frac{\dim \bfU-2}{2\dimo \bfV},&\hbox{if $G$ is real orthogonal;}\\
      \frac{\dim \bfU+2}{2\dimo \bfV}, &\hbox{if $G$ is real  symplectic;} \\
      \frac{\dim \bfU}{2\dimo \bfV}, &\hbox{if $G$ is quaternionic.}
    \end{cases}
  \end{equation}
\end{lem}
\begin{proof}
  In view of the estimate of Harish-Chandra's $\Xi$-function as in \cite[Theorem
  4.5.3]{Wa1}, and the estimate of $\Xi_{\bfU}$ using \cite[Corollary
  3.6.8]{Wa1}, the lemma is routine to
  check.% by using a explicit choice of the information of the root systems in \Cref{rootsys}.
\end{proof}


Let $\pi$ be a $\mathbb p$-genuine Casselman-Wallach representation of
$\wtG$. Further assume that $\dimo \bfV>0 $ and
\begin{equation}\label{bnuv}
  \textrm{
    $\pi$ is $\nu_\pi$-bounded for some $\nu_\pi>2-\nu_{\bfU,\bfV}$,}
\end{equation}
where $\nu_{\bfU,\bfV}$ is as in \eqref{nuuv}.

Let $\cJ$ be a subquotient of the degenerate principal series
$\RI(\chi_{\bfE})$.

\begin{lem}\label{intpi00}
  The integrals in
  \begin{equation}\label{intpi0}
    \begin{array}{rcl}
      (\pi\widehat \otimes \cJ)\times (\pi^\vee \widehat \otimes \cJ^\vee)&\rightarrow &\C\\
      (u,v)&\mapsto &\int_{\wtG} \inn{g\cdot u}{v}\od\! g,
    \end{array}
  \end{equation}
  are absolutely convergent and define a continuous bilinear map.
\end{lem}
\begin{proof}
  By \Cref{esti}, there is a continuous seminorm $\abs{\,\cdot\,}_{\cJ}$ on
  $\cJ$ and a continuous seminorm $\abs{\,\cdot\,}_{\cJ^\vee}$ on $\cJ^\vee$
  such that
  \[
    \abs{\la g\cdot v_1, v_2\ra}\leq \Xi_{\bfU}(g) \cdot \abs{v_1}_{\cJ} \cdot
    \abs{v_2}_{\cJ^\vee}, \quad \textrm{for all }v_1\in \cJ, \,v_2\in \cJ^\vee,
    \,g\in \wtG_{\bfU}.
  \]

  Take a positive function $\ell$ on $\wtG$ of logarithmic growth, and
  continuous seminorms $\abs{\ }_\pi$ on $\pi$ and $\abs{\ }_{\pi^\vee}$ on
  $\pi^\vee$ such that
  \[
    \abs{\la g\cdot u_1,u_2\ra}\leq \ell(g) \cdot (\Xi_{\wtG}
    (g))^{\nu_\pi}\cdot \abs{u_1}_\pi \cdot \abs{u_2}_{\pi^\vee},
  \]
  for all $g\in \wtG, \, u_1\in \pi, \, u_2\in \pi^\vee$.

  Let $\abs{\,\cdot\,}_{\pi\widehat \otimes \cJ}$ denote the continuous seminorm
  of $\pi\widehat \otimes \cJ$ which is the projective product of
  $\abs{\,\cdot\,}_{\pi}$ and $\abs{\,\cdot\,}_{\cJ}$. Likewise let
  $\abs{\,\cdot\,}_{\pi^\vee\widehat \otimes \cJ^\vee}$ denote the continuous
  seminorm of $\pi^\vee\widehat \otimes \cJ^\vee$ which is the projective
  product of $\abs{\,\cdot\,}_{\pi^\vee}$ and $\abs{\,\cdot\,}_{\cJ^\vee}$. Then
  it is easy to see that
  \begin{equation}
    \label{estl}
    \abs{\inn{g\cdot w_1}{w_2}}\leq \ell(g) \cdot (\Xi_{\wtG} (g))^{\nu_\pi}\cdot \Xi_{\bfU}(g)\cdot \abs{w_1}_{\pi\widehat \otimes \cJ} \cdot \abs{w_2}_{\pi^\vee\widehat \otimes \cJ^\vee},
  \end{equation}
  for all
  $g\in \wtG, \, w_1\in \pi\widehat \otimes \cJ, \, w_2\in \pi^\vee\widehat
  \otimes \cJ^\vee$. Thus the lemma follows by \Cref{intgrability} and
  \Cref{boundxi}.
\end{proof}

The orthogonal complement $\bfV^\perp$ of $\bfV$ in $\bfU$ is naturally an
$(\epsilon,\dotepsilon)$-space with $J_{\bfV^\perp} := J_{\bfU}|_{\bfV^\perp}$ and
$L_{\bfV^\perp} := L_{\bfU}|_{\bfV^\perp}$.
Define
\begin{equation}
  \label{defqi}
  \CR_{\cJ}(\pi):=\frac{\pi\widehat \otimes \cJ}{\text{the left kernel of the bilinear map \eqref{intpi0} }}.
\end{equation}
It is a smooth Fr\'echet representation of $\wtG_{\bfV^\perp}$ of moderate
growth.
% where $(\bfV^\perp,J_{\bfV^\perp},L_{\bfV^\perp})$ is an denotes the orthogonal complement of $\bfV$ in
% $\bfU$.


Let $(\bfV^-,J_{\bfV^-},L_{\bfV^-})$ denote the
$(\epsilon, \dot \epsilon)$-space which equals $\bfV$ as a vector space, and is
equipped with the form $-\innbfv{}{}$,
the conjugate linear map $J_{\bfV^-}=J$, and the linear map $L_{\bfV^-}=-L$. Then we
have an obvious identification $G_{\bfV^-}=G_{\bfV}$.  We identify $\bfV^-$ with an $(\epsilon,
\dotepsilon)$-subspace of $\bfV^\perp$ and fix a $J_\bfU$-stable subspace
$\bfE_0$ in $\bfE$ such that
\begin{equation}
\label{eq:Vperp.dec}
  \bfV^\perp=\bfV^-\oplus (\bfE_0\oplus \bfE_0'), \quad  \bfE=\bfV^\triangle \oplus \bfE_0\quad \textrm{and}\quad \bfE'=\bfV^\nabla\oplus \bfE_0',
\end{equation}
where $\bfE_0'=L_{\bfV^\perp} (\bfE_0)$,
\[
\bfV^\triangle:=\{(v,v)\in \bfV\oplus \bfV^-\mid v\in \bfV\}\quad\textrm{and}\quad \bfV^\nabla:=\{(v,-v)\in \bfV\oplus \bfV^-\mid v\in \bfV\}.
\]
In particular, $G:=G_{\bfV}$ is identified with a subgroup of $G_{\bfV^\perp}$.
Let $\GLEz := \GL(\bfE_0)^{J_{\bfV^\perp}|_{\bfE_0}}$ and let
\[
  P_{\bfE_0}=M_{\bfE_0}\ltimes N_{\bfE_0}
\]
denote the parabolic subgroup of $G_{\bfV^\perp}$ stabilizing $\bfE_0$, where
$N_{\bfE_0}$ denotes the unipotent radical, and $M_{\bfE_0}=G\times
\GLEz$ is the Levi subgroup stabilizing the first decomposition
in \eqref{eq:Vperp.dec}.

Let $\chi_{\bfE_0}$ denotes the restriction of $\chi_{\bfE}$ to
$\wtGLEz$. Then $\pi\otimes \chi_{\bfE_0}$,
which is preliminarily a representation of $\wtG\times
\wtGLEz$, descends to a representation of
$\wtM_{\bfE_0}$.

\medskip

The rest of this section is devoted to a proof of the following proposition.

\begin{prpl}\label{est002}
There is an isomorphism
\[
\CR_{\RI(\chi_{\bfE}) }(\pi)\cong   \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} \left(\pi\otimes \chi_{\bfE_0}\right)
\]
of  representations of $\wtG_{\bfV^\perp}$.
\end{prpl}


Identify $\RI(\chi_{\bfE})$ with the space of smooth sections of the line bundle
   \[
   \CL(\chi_{\bfE}):=\wtP_{\bfE}\backslash ( \wtG_{\bfU}\times (\chi_{\bfE}\otimes \rho_{\bfE}))
   \]
    over $ \wtP_{\bfE}\backslash  \wtG_{\bfU}$, where $\rho_{\bfE}$ denotes the
    positive character of $\wtP_{\bfE}$ whose square is the modular character.

Note that $\wtG^\circ_{\bfU}:= \wtP_{\bfE} \wtG \wtG_{\bfV^\perp}$
   is open in $ \wtG_{\bfU}$.
 Put
  \[
    \RI^\circ(\chi_{\bfE}):=\Set{f\in \RI(\chi_{\bfE})| \parbox{.4\linewidth}{
        $(Df)|_{\wtG_{\bfU}\setminus
          \wtG^\circ_{\bfU}}=0$ for all left invariant differential operators
        $D$ on $\wtG_{\bfU}$}}.
   \]
 It is identical to  the space of Schwartz sections of $\CL(\chi_{\bfE})$ over $ \wtP_{\bfE}\backslash   \wtG^\circ_{\bfU}$.  Similarly we define a subspace $\RI^\circ(\chi_{\bfE}^{-1})$ of $\RI(\chi_{\bfE}^{-1})$.



As in \eqref{intpi0}, we define a continuous bilinear map
\begin{equation}\label{picirc}
   (\pi\widehat \otimes \RI^\circ(\chi_{\bfE}))\times (\pi^\vee \widehat \otimes \RI^\circ(\chi_{\bfE}^{-1}))\rightarrow \C.
  \end{equation}
  Using this map, we define a representation $\CR_{\RI^\circ(\chi_{\bfE})}(\pi)$ of $\wtG_{\bfV^\perp}$  as in \eqref{defqi}.


  Put
  \begin{equation}\label{eq:P'E0}
    P'_{\bfE_0}:=\GLEz\ltimes N_{\bfE_0}.
  \end{equation}

 \begin{lem} There is a canonical isomorphism
  \begin{equation}
    \label{isopit0}
    \pi\widehat \otimes  \RI^\circ(\chi_{\bfE})\cong
    \ind_{\wtP'_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi\otimes \chi_{\bfE_0})
  \end{equation}
  of representations of $\wtG\times \wtG_{\bfV^\perp}$, where
  $\wtG$ acts diagonally on the left hand side of \eqref{isopit0}, and it
  acts on the right hand side of \eqref{isopit0} by
  \[
    (g\cdot f)(x)=g\cdot (f(g^{-1}x)),\quad f\in
    \ind_{\wtP'_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi\otimes \chi_{\bfE_0}),\, g\in
    \wtG, \,x\in \wtG_{\bfV^\perp}.
  \]
\end{lem}

   \begin{proof}
Note that
  \[
  \wtP_{\bfE}\backslash   \wtG^\circ_{\bfU}=\wtP'_{\bfE_0}\backslash   \wtG_{\bfV^\perp}
  \]
  and thus
  \begin{equation}\label{isorii0}
    {\RI^\circ(\chi_{\bfE})}\cong \ind_{\wtP'_{\bfE_0}}^{\wtG_{\bfV^\perp}}  \chi_{\bfE_0}
  \end{equation}
  as representations of $\wtG \times \wtG_{\bfV^\perp}$, where
  $\wtG$ acts on the right hand side of \eqref{isorii0} by
  \[
    (g\cdot f)(x)=f(g^{-1}x),\quad f\in
    \ind_{\wtP'_{\bfE_0}}^{\wtG_{\bfV^\perp}} \chi_{\bfE_0},\, g\in \wtG,
    \,x\in \wtG_{\bfV^\perp} .
  \]
  The lemma then easily follows by \eqref{isorii0}.
\end{proof}


\begin{lem}\label{isoipi}
  The representation $\CR_{\RI^\circ(\chi_{\bfE})}(\pi)$ is isomorphic to
  $\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}}\left(\pi\otimes
    \chi_{\bfE_0}\right)$.
\end{lem}
\begin{proof}
  Similar to \eqref{isopit0}, we have a canonical  isomorphism
  \begin{equation}
    \label{isopit1}
    \pi^\vee\wtotimes  \RI^\circ(\chi_{\bfE}^{-1})\cong  \ind_{\wtP'_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi^\vee\otimes \chi_{\bfE_0}^{-1}).
  \end{equation}


It is clear that the continuous linear map
\[
  \begin{array}{rcl}
 \xi: \ind_{\wtP'_{\bfE_0}}^{\wtG_{\bfV^\perp}}  (\pi\otimes \chi_{\bfE_0})&\longrightarrow & \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi\otimes \chi_{\bfE_0}),\\
    f &\mapsto & \left(x\mapsto \int_{\wtP_{\bfE_0}/\wtP'_{\bfE_0}}( \rho_{\bfE_0}(g))\cdot  (g\cdot (f(g^{-1}x)))\od \!g \right),
    \end{array}
\]
is $\wtG_{\bfV^\perp}$-intertwining and surjective, where $\rho_{\bfE_0}$
denotes the positive character of $ \wtP_{\bfE_0}$ whose square is the modular
character, and $\rdd g$ denotes a $\wtP_{\bfE_0}$-invariant positive Borel
measure on $\widetilde{\RP}(\bfE_0)/ \widetilde{\RP}'(\bfE_0)$.  Similarly, we
define a $\wtG_{\bfV^\perp}$-intertwining surjective continuous linear map
\begin{equation}
\label{xip}
 \xi'\colon \ind_{\wtP'_{\bfE_0}}^{\wtG_{\bfV^\perp}}  (\pi^\vee\otimes \chi_{\bfE_0}^{-1})\rightarrow \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi^\vee\otimes \chi_{\bfE_0}^{-1}).
\end{equation}


It is elementary to see that, when the invariant measures are suitably normalized,
\begin{equation}\label{picirc2}
\inn{\xi(f)}{\xi'(f')} =\int_{\wtG} \inn{ g\cdot f}{ f'} \rdd\!g,
\end{equation}
for all $f$ and $f'$ in the domains of $\xi$ and $\xi'$, respectively. Note that
under isomorphisms \eqref{isopit0} and \eqref{isopit1}, the paring between the
domains of $\xi$ and $\xi'$ as in the right hand side of \eqref{picirc2} agrees
with the paring \eqref{picirc} between
$ \pi\widehat \otimes \RI^\circ(\chi_{\bfE}) $ and
$ \pi^\vee\widehat \otimes \RI^\circ(\chi_{\bfE}^{-1})$. Thus the lemma follows
as the natural pairing between
$\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi\otimes \chi_{\bfE_0})$ and
$\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi^\vee\otimes \chi_{\bfE_0}^{-1})$
is non-degenerate.
\end{proof}



\begin{lem}\label{imb}
Let $u\in \pi\widehat \otimes \RI(\chi_{\bfE})$. If
\begin{equation}\label{intguv0}
  \int_{\wtG} \la g\cdot u, v\ra\od\! g =0
\end{equation}
for all $v\in \pi^\vee \widehat \otimes \RI^\circ(\chi_{\bfE}^{-1})$, then \eqref{intguv0} also holds for all $v\in  \pi^\vee \widehat \otimes \RI(\chi_{\bfE}^{-1})$.
\end{lem}

\begin{proof}
Take a sequence $(\eta_1, \eta_2, \eta_3, \cdots)$ of real valued smooth functions on $\wtP_{\bfE}\backslash \wtG_{\bfU}$ such that
\begin{itemize}
\item
for all $i\geq 1$,  $\mathrm{supp}(\eta_i)\subset \wtP_{\bfE}\backslash  \wtG^\circ_{\bfU}$ and $ 0\leq  \eta_i(x)\leq \eta_{i+1}(x)\leq 1$ for all $x\in  \wtP_{\bfE}\backslash \wtG_{\bfU}$; \smallskip
 \item
 $\bigcup_{i=1}^\infty \eta_i^{-1}(1)= \wtP_{\bfE}\backslash  \wtG^\circ_{\bfU}$.
\end{itemize}
Let $v\in   \pi^\vee \widehat \otimes\RI(\chi_{\bfE}^{-1})$. Note that $\eta_i \RI(\chi_{\bfE}^{-1})\subset \RI^\circ(\chi_{\bfE}^{-1})$. Thus $\eta_i v\in \pi^\vee \widehat \otimes \RI^\circ(\chi_{\bfE}^{-1})$.

In the proof of \Cref{intpi00}, take $\cJ=\RI(\chi_{\bfE})$ and
\[
  \abs{f_1}_{\cJ}= \max_{x\in \wtK_{\bfU}}\{\abs{f_1(x)}\mid x\in \wtK_{\bfU}\} \quad \textrm{and}\quad  \abs{f_2}_{\cJ^\vee}= \max_{x\in \wtK_{\bfU}}\{\abs{f_2(x)}\mid x\in \wtK_{\bfU}\},
\]
for all $f_1\in \RI(\chi_{\bfE})$, $f_2\in \RI(\chi_{\bfE}^{-1})$. Then
\[
  \abs{\eta_i v}_{\pi^\vee\widehat \otimes \cJ^\vee}\leq \abs{v}_{\pi^\vee\widehat \otimes \cJ^\vee}.
\]
Thus by \eqref{estl} and  Lebesgue's dominated convergence theorem,
\[
  \int_{\wtG} \inn{g\cdot u}{v}\od\! g
  =\lim_{i\rightarrow +\infty} \int_{\wtG} \inn{g\cdot u}{\eta_i v}\od\! g =0.
\]


\end{proof}



\begin{lem}\label{imb2}
Let $u\in \pi\widehat \otimes \RI(\chi_{\bfE})$. Then there is a vector $u'\in  \pi\widehat \otimes \RI^\circ(\chi_{\bfE})$ such that
\[%\begin{equation}\label{intguv02}
  \int_{\wtG} \inn{g\cdot u}{v}\od\! g = \int_{\wtG} \inn{g\cdot u'}{v}\od\! g
\]%\end{equation}
for all $v\in \pi^\vee \widehat \otimes \RI^\circ(\chi_{\bfE}^{-1})$.
\end{lem}
\begin{proof}
  Similar to Lemma \ref{imb}, we know that for every
  $v\in \pi^\vee \widehat \otimes \RI^\circ(\chi_{\bfE}^{-1})$, if
  \begin{equation}
    \label{intguv3} \int_{\wtG} \la g\cdot u', v\ra\od\! g =0 \quad
    \textrm{for all $u'\in \pi \widehat \otimes \RI^\circ(\chi_{\bfE})$,}
  \end{equation}
  then
  \eqref{intguv3} also holds for all
  $u'\in \pi \widehat \otimes \RI(\chi_{\bfE})$. The proof of \Cref{isoipi}
  shows that $v$ satisfies \eqref{intguv3} if and only if it is in the kernel of
  $\xi'$. Here $\xi'$ is as in \eqref{xip}, and
  $\pi^\vee \widehat \otimes \RI^\circ(\chi_{\bfE}^{-1})$ is identified with
  $ \ind_{\wtP'_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi^\vee\otimes
  \chi_{\bfE_0}^{-1})$ as in \cref{isopit1}.  Thus the continuous linear
  functional
 \[
   \xymatrix@R=0em{
    \pi^\vee \widehat\otimes \RI^\circ(\chi_{\bfE}^{-1}) \ar[r]& \bC,\\
    v \ar@{|->}[r]&  \int_{\wtG} \inn{g\cdot u}{v}\od\! g
    }
 \]
 descents to a continuous linear functional
 \[
   \varphi_u: \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi^\vee\otimes
   \chi_{\bfE_0}^{-1})\longrightarrow \bC.
 \]

 Using the theorem of Dixmier-Malliavin \cite[Theorem 3.3]{DM}, we write
 \[
   u=\sum_{i=1}^{s} \int_{\wtG_{\bfV^\perp}} \phi_i(g)  g\cdot u_i\od\! g,
 \]
 where $\phi_i$'s are compactly supported smooth functions on $\wtG_{\bfV^\perp}$, and $u_i$'s are elements of $\pi\widehat \otimes \RI(\chi_{\bfE})$. Here $\wtG_{\bfV^\perp}$ acts on $\pi\widehat \otimes \RI(\chi_{\bfE})$ through the restriction of the action of $\wtG_{\bfU}$ on $\RI(\chi_{\bfE})$.
 Then it is easily checked that for every $v'\in  \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi^\vee\otimes \chi_{\bfE_0}^{-1})$,
 \[
   \varphi_u(v')=\sum_{i=1}^{s}  \varphi_{u_i}\left( \int_{\wtG_{\bfV^\perp}} \phi_i(g^{-1})  g\cdot v'\od\! g\right).
 \]
This equals the evaluation at $v'$ of the linear functional
  \[
   \sum_{i=1}^{s}  \int_{\wtG_{\bfV^\perp}} \phi_i(g)  g\cdot \varphi_{u_i}\od\! g.
 \]
By \cite[Lemma 3.5]{SZ1},  the above functional  equals the pairing with an element of  $\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} (\pi\otimes \chi_{\bfE_0})$, and the lemma then follows by the proof of Lemma \ref{isoipi}.
\end{proof}


Now Proposition \ref{est002} follows by Lemmas \ref{isoipi}, \ref{imb} and \ref{imb2}.

\subsection{Degenerate principal series and Rallis quotients}\label{sec:DPandRQ}

%\subsubsection{Rallis quotients}\label{secrallis}
We are in the setting of \Cref{sec:MCI} and \Cref{secdege}. Assume that $\dimo \abfV>0$. Recall $\bfU=\bfE\oplus \bfE'$ from \eqref{eq:UEE}
and assume that
\begin{equation}
  \label{dimu}
  \dim \bfE =\dim \abfV+\delta , \quad  \textrm{where } \delta :=\begin{cases}
        1, \quad&\text{if $G_\bfU$ is real orthogonal;} \\
    -1,\quad& \text{if $G_\bfU$ is real symplectic;} \\
    0, \quad&\text{if $G_\bfU$ is quaternionic. }
  \end{cases}
\end{equation}
The Rallis quotient
$(\omega_{\abfV,\bfU})_{\tGVar}$ is an irreducible unitarizable
representation of $\wtG_{\bfU}$ (\emph{cf}. \cite{Ra,KR,Ya}).
Let $1_{\abfV}$ denote the trivial representation of $\tGVar$.  Then
$(1_{\abfV}, \bfU)$ is in the convergent range.

\begin{lem}\label{lem:coinv}
One has that
\[
  \Thetab_{\abfV,\bfU}(1_{\abfV})\cong (\omega_{\abfV,\bfU})_{\tGVar}.
\]

\end{lem}
\begin{proof}
Since $(\omega_{\abfV,\bfU})_{\tGVar}$ is irreducible and $\Thetab_{\abfV,\bfU}(1_{\abfV})$ is obviously a quotient of $(\omega_{\abfV,\bfU})_{\tGVar}$, it suffices to show that $\Thetab_{\abfV,\bfU}(1_{\abfV})$ is nonzero.

Write $V'_0$ for the standard real or quaternionic representation of $G'$. As
usual, realize both $\omega_{\abfV,\bfU}$ and $\omega_{\abfV,\bfU}^\vee$ on the
space of Schwartz functions on ${V'_0}^d$, where $d=\dim \bfE$ if $G'$ is
real orthogonal or real symplectic, and $d=\frac{1}{2} \dim \bfE$ if $G'$ is
quaternionic. Take a positive valued Schwartz function $\phi$ on
${V'_0}^d$. Then
\[
  \inn{ g\cdot \phi}{ \phi}=\int_{{V'_0}^d} \phi(g^{-1}\cdot x) \cdot \phi(x)
  \od \! x>0, \quad \textrm{for all }g\in \tGVar.
\]
Thus
\[
  \int_{\tGVar} \inn{ g \cdot \phi}{ \phi} \od\! g \neq 0,
\]
and the lemma follows.
\end{proof}

Let $\chi_{\bfE}$ be as in \Cref{secdege}. The relationship between the degenerate principle series representation $\RI(\chi_{\bfE})$ and
Rallis quotients is summarized in the following lemma (see \cite[Theorem 2.4]{Ku}, \cite[Introduction]{LZ1}, \cite[Theorem 6.1]{LZ2} and  \cite[Sections 9 and 10]{Ya}).
\begin{lem}\label{degens}%The following statements hold true.
\begin{enumC}
\item  \label{it:degens.OR} If $G_\bfU$ is real orthogonal,  then
\[
\RI(\chi_{\bfE})\cong (\omega_{\abfV,\bfU})_{\tGVar} \oplus ( (\omega_{\abfV,\bfU})_{\tGVar} \otimes \sgn_{\bfU}),
\]
where $\sgn_{\bfU}$ denotes the sign character of the orthogonal group $\wtG_{\bfU}$.

\item \label{it:degens.SP} If $G_\bfU$ is real symplectic,  then
\[
    \RI(\chi_{\bfE})\oplus  \RI(\chi'_{\bfE})\cong \bigoplus_{\bfV''} (\omega_{\bfV'',\bfU})_{\wtG_{\bfV''}},
\]
where $\chi'_{\bfE}\neq \chi_{\bfE}$ is the character which also satisfies the condition in Table \ref{tablechi}, and $\bfV''$ runs over the isomorphism classes of $(1,1)$-spaces whose dimension equals that of $\abfV$.

\item \label{it:degens.SPQ}  If $G_\bfU$ is quaternionic symplectic,  then
\[
\RI(\chi_{\bfE})\cong  (\omega_{\abfV,\bfU})_{\tGVar} .
\]

\item \label{it:degens.OQ} If $G_\bfU$ is quaternionic orthogonal,  then there is an exact sequence
\[
\xymatrix{
0\ar[r] &\bigoplus_{\bfV''} (\omega_{\bfV'',\bfU})_{\wtG_{\bfV''}} \ar[r]&
\RI(\chi_{\bfE})  \ar[r]& \bigoplus_{\bfV'''}
(\omega_{\bfV''',\bfU})_{\wtG_{\bfV'''}}\ar[r]& 0,
}
\]
where $\bfV''$ runs over the isomorphism classes of $(-1,1)$-spaces whose
dimension equals that of $\abfV$, and $\bfV'''$ runs over the isomorphism classes
of $(-1,1)$-spaces whose dimension equals $\dim \abfV-2$. \qed
\end{enumC}
\end{lem}

Thanks to \Cref{lem:coinv},
$(\omega_{\bfV',\bfU})_{\wtG_{\bfV'}}$
and $(\omega_{\bfV'',\bfU})_{\wtG_{\bfV''}}$ in \Cref{degens} can be
replaced by $\Thetab_{\bfV',\bfU}(1_{\bfV'})$ and
$\Thetab_{\bfV'',\bfU}(1_{\bfV''})$ respectively.



\section{Associated characters of theta lifts}\label{sec:AC}

In this section we will prove \Cref{prop:Ch.eq} which gives a formula for the
associated character of a certain theta lift in the convergent range.

Throughout this section, we fix a rational dual pair $(\bfV,\bfV')$ and
we retain the notation in \Cref{sec:descent} and Section \ref{sec:MCI}.
As in Section \ref{sec:LVB}, we also
assume that $\mathbb p$ is the parity of $\dim \bfV$ if $\epsilon=1$,
and  the parity of $\dim \bfV'$ if $\epsilon'=1$.

\subsection{An upper bound on the associated character of certain theta lift}

\subsubsection{Associated characters and associated cycles}\label{sec:def.AC}

We recall fundamental results of Vogan \cite{Vo89}.  Suppose
$\cO \in \Nil_{\bfG}(\fgg)$ is a  nilpotent orbit. A finite length
$(\fgg,\wtK)$-module $\pi$ is said to be \emph{$\cO$-bounded}
(or \emph{bounded by $\cO$}) if
the associated variety  of the annihilator ideal $\Ann(\pi)$
is contained in $\bcO$. It follows from \cite[Theorem 8.4]{Vo89}
that  $\pi$ is $\CO$-bounded if and only if  its associated
variety $\AV(\pi)$ is contained in
$\overline \cO\cap \fpp$.
%Equation (1.5)(b)
Let
$\cM^{\mathbb p}_{\cO}(\fgg,\wtK)$ denote the category of $\bpp$-genuine
$\cO$-bounded
finite length $(\fgg,\wtK)$-modules, and write
$\cK^{\mathbb p}_{\cO}(\fgg,\wtK)$ for its Grothendieck group.
Recall the group $\cK^{\mathbb p}_{\cO}(\wtbfK)$ from  \Cref{sec:LVB}.
From \cite[Theorem~2.13]{Vo89},  we have a canonical homomorphism
\[
\xymatrix{
  \Ch_\cO\colon   \cK^{\mathbb p}_\cO(\fgg, \wtK)\ar[r]& \cK^{\mathbb p}_{\cO}(\wtbfK).
}
\]
For a $\mathbb p$-genuine $\cO$-bounded $(\fgg,\wtK)$-module $\pi$ of finite
length,
we call $\Ch_{\cO}(\pi)$ the
associated character of $\pi$.

Let $\mu\colon \cK^{\mathbb p}_{\cO}(\wt{\bfK})\rightarrow \bZ[(\cO\cap \fpp)/\bfK]$ be
the map of taking dimensions  of the isotropy representations.
Post-composing $\mu$ with $\Ch_\cO$ gives the associated cycle map:
\[
\xymatrix{
\AC_{\cO} \colon \cM^{\mathbb p}_\cO(\fgg,\wtK) \ar[r]& \bZ[(\cO\cap \fpp)/\bfK].
}
\]
For any $\pi$ in $\cM^{\mathbb p}_{\cO}(\fgg,\wtK)$ and a nilpotent $\bfK$-orbit
$\sO\subset\cO\cap \fpp$, let $\rcc_\sO(\pi)$ denote the multiplicity of $\sO$
in $\AC_{\cO}(\pi)$.
For a $\mathbb p$-genuine Casselman-Wallach representation of $\wtG$,
the notion of $\cO$-boundedness,
and its associated character is defined by using its Harish-Chandra module.

\subsubsection{Algebraic theta lifting}\label{sec:ATL}
 Write
$
  \sY_{\bfV,\bfV'}
  $ for the subspace of $\omega_{\bfV,\bfV'}$ consisting of all the vectors which are annihilated by some powers of $\cX$. This is a dense subspace of $\omega_{\bfV,\bfV'}$ and is naturally  a $((\fgg\times \fgg')\ltimes \h(W), \wtK\times \wtK')$-module. Here $\h(W)$ denotes the complexified Lie algebra of $\rH(W)$.

  \begin{defn}
For each $\mathbb p$-genuine $(\fgg',\wtK')$-module $\pi'$ of finite length,
define
\[
  \Thetav_{\bfV',\bfV}(\pi'):= \left(\sY_{\bfV,\bfV'}\otimes \pi' \right)_{\fgg', \wtK'},\qquad
  \text{(the coinvariant space).}
\]
\end{defn}

For each $\mathbb p$-genuine finite length $(\fgg',\wtK')$-module $\pi'$,
the $(\fgg,\wtK)$-module
$\Thetav_{\bfV',\bfV}(\pi')$, also abbreviated as $\Thetav(\pi')$,
is $\bpp$-genuine and of finite length \cite{Howe89}.
Recall the
notations in \Cref{sec:LD},
in particular the map $\oliftc_{\bfV',\bfV}$ in
\cref{def:LC}.
We have the following estimate of the size of
$\Thetav_{\bfV',\bfV}(\pi')$.

\begin{lem}[{\cite[Theorem~B and Corollary~E]{LM}}]\label{cor:Cbound}
For each $\mathbb p$-genuine $(\fgg',\wtK')$-module $\pi'$ of finite length,
\[
\AV(\Thetav(\pi')) \subset M(M'^{-1}(\AV(\pi'))).
\]
Consequently, if $\pi$ is $\cO'$-bounded for a nilpotent
orbit $\cO'\in \Nil_{\bfG'}(\fgg')$, then $\Thetav(\pi')$ is
$\oliftc_{\bfV',\bfV}(\cO')$-bounded.
\end{lem}


\subsubsection{The bound in the descent and good generalized descent cases}\label{sec:EAC}
We will prove an upper bound of associated characters in the descent and good
generalized descent cases. %Recall that $(\bfV,\bfV')$ is a rational dual pair.
%The later case is similar to Gomez-Zhu's second paper.

\begin{thm}\label{prop:GDS.AC}
  Let $\cO\in \NilGC$ and $\cO'\in \NilGCp$ .  Suppose that
  \begin{enumC}
  \item \label{it:case.D} $\cO'$ is a descent of $\cO$, that is,  $\cO' = \DDc(\cO)$, or
  \item \label{it:case.GD} $\cO$ is good for generalized descent (see \Cref{def:GD.good}) and $\cO' = \gDDc_{\bfV,\bfV'}(\cO)$.
  \end{enumC}
  Then for every $\mathbb p$-genuine $\CO'$-bounded $(\fgg',\wtK')$-module $\pi'$ of finite length,  $\Thetav(\pi')$ is $\cO$-bounded and
  \[
    \Ch_{\cO}\Thetav(\pi')\preceq \dliftv_{\cO',\cO}(\Ch_{\cO'}(\pi')).
  \]
\end{thm}

\begin{proof}%[Proof of \Cref{prop:DS.AC} and \Cref{prop:GDS.AC}]
With the geometric properties investigated in \Cref{sec:GM}, the proof to be given is
similar to that of \cite[Theorem~C]{LM}.

% First, the $\CO$-boundedness of $\Thetav(\pi)$ is clear from \Cref{cor:Cbound},
% \cref{eq:def.LsO22} and \Cref{lem:GDS.set}.

We recall some results in \cite{LM}. There are natural
good filtrations on $\pi'$ and $\bbThetav(\pi')$ generated by the minimal degree
$\wtK'$-types and $\wtK$-types, respectively. Define
\[
  \sA := \Gr \pi' \otimes \mktvvp|_{\wtK'}
  % = \left(\Gr \pi'\otimes \mktvvp^{-1}|_{\wtK'}\right)^\vee
  \quad \text{and} \quad
  \sB := \Gr \Thetav(\pi') \otimes \mktvvp^{-1}|_{\wtK}.
\]
We view $\sA$ and $\sB$  as a $\bfK'$-equivariant coherent sheaf on
$\fpp'^*\cong \fpp'$ and a $\bfK$-equivariant coherent sheaf on
$\fpp^* \cong \fpp$, respectively. Moreover, $\AV(\pi') = \Supp(\sA)$ and $\AV(\Thetav(\pi')) = \Supp(\sB)$.

Recall the moment maps defined in \Cref{sec:dpmm}.
% \[
% \xymatrix@R=0em@!C=7em{
% \fpp' & \ar[l]_{M'} \cX \ar[r]^{M}& \fpp\\
% \sA \ar@{..>}[r]& M'^*(\sA)^{\bfK'} \ar@{..>}[r] & M_*\left(M'^*(\sA)^{\bfK'}\right)
% }
% \]
Define the following right exact functor
\[
\slift\colon \sF \mapsto (M_*(M'^*(\sF)))^{\bfK'}
\]
from the category of $\bfK'$-equivariant quasi-coherent sheaves on $\fpp'$ to
the category of $\bfK$-equivariant quasi-coherent sheaves on $\fpp$, where
$\sF$ is a $\bfK'$-equivariant quasi-coherent sheave on $\fpp'$, and
$M'^*$ and $M_*$ denote the pull-back and push-forward functors respectively. %  of
% quasi-coherent sheaves respectively.
There is a canonical surjective morphism of
$\bfK$-equivariant sheaves on $\fpp$ as follows:
(\emph{cf}. \cite[Equation~(16)]{LM})
\[%\begin{equation}\label{lem:LM.E}
% \xymatrix{
% (M_*(M'^*(\sA)))^{\bfK'} \ar@{->>}[r]& \sB.
% }
\xymatrix{
\cQ \colon \slift(\sA) \ar@{->>}[r]& \sB.
}
\]%\end{equation}
% Here $M'^*(\sA)^{\bfK'}$ denote the $\bfK$-equivariant coherent sheaf on $\CX$
% whose global sections is the space of $\bfK'$-invariant global sections of
% $M'^*(\sA)$.

Note that the first equality of \eqref{eq:def.LsO22} and the first assertion of
\Cref{lem:GDS.set} imply that
$\Supp(\slift(\sA))$ % $(M_*(M'^*(\sA)))^{\bfK'}$
is contained in $M(M'^{-1}(\Supp(\sA)))\subset \bcO\cap \fpp$. In particular, $\Thetav(\pi)$ is $\CO$-bounded.

% In order to prove the theorem, it suffice to assume that
% Without loss of generality, we now assume $\sA$
% is irreducible as a $\bfK'$-equivariant coherent sheaf on $\fpp'$ since
% associated character is defined using filtrations.
% In particular,
% $\sA$ is naturally a $(\bC[\overline{\sO'_0}],\bfK')$-module for a nilpotent
% $\bfK'$-orbit $\sO'_0$ in $\bcOp\cap \fpp'$

According to % \cite[Proof of Lemma 2.11]{Vo89} or
\cite[Proposition~4.3]{LM}, we may fix a finite filtration
$$0 = \sA_0 \subset \cdots \subset \sA_l \subset \cdots \subset \sA_f=\sA\qquad (f\geq 0)$$
of $\sA$ by $\bfK'$-equivariant coherent sheaves on
$\fpp'$ such that for any $1\leq l\leq f$,
the space of global sections of
$\sA^l := \sA_l/\sA_{l-1}$ is an irreducible $(\bC[\overline{\sO'_l}],\bfK')$-module for a
nilpotent $\bfK'$-orbit $\sO'_l$ in $\bcOp\cap \fpp'$.

Let $\sO$ be a $\bfK$-orbit in $\cO\cap \fpp$. If $\sO$ does not admit a
generalized descent, then $$\sO\cap M(\cX) = \emptyset,$$
and $\sO$ does not appear
in the support of $\Ch_\cO(\Thetav(\pi))$.


Now suppose that $\sO$ admits a generalized descent
$\sO' := \gDD_{\bfV,\bfV'}(\sO)\in \Nil_{\bfK'}(\fpp')$. Retain the notation in
\Cref{sec:lift.AC} where an $(\epsilon',\dotepsilon')$-space decomposition
$\bfV' = \bfV'_1\oplus \bfV'_2$ and an element
   \[
     T\in \CX_1^\circ:=\Set{w\in\Hom(\bfV,\bfV'_1)\mid w
     \textrm{ is surjective}}
     \cap \CX\subseteq \CX^{\mathrm{gen}}
\]
 is fixed such that $X := M(T)\in \sO$ and $X':=M'(T)\in \sO'$.


% Put
% \[
% \fpp_\sO:=\fpp\setminus((\overline \CO\cap \fpp)\setminus \sO).
% \]
% It is a Zariski open subset of $\fpp$, and $\sO$ is a Zariski closed subset of it. Lemma \ref{lem:GDS.sh3} implies that if  $\sO'_l=\sO'$ ($1\leq l\leq f$), then the quasi-coherent sheaf  $\slift(\sA^l)|_{\fpp_\sO}$ descends to a quasi-coherent sheaf on $\sO$.
% Put %$r := \dim \bfV' - \dim \Ker{X}$
% \[
%   U:=\Set{A\in \fpp|\rank A\geq \dim \bfV' -\dim X } \quad \text{ and }\quad
% Y := U\cap M(M'^{-1}(\bsOp)).
% % \overline \CO\cap \fpp)\setminus \sO).
% \]
% Clearly $U$ is a Zariski open subset of $\fpp$ and $Y$ is a Zariski closed subset of
% it.

For $1\leq l \leq f$, if  $\sO'_l=\sO'$, then \Cref{lem:DS.U} and \Cref{lem:GDS.U} ensure  that
there exists a Zariski open set $U$ in $\fpp$ such that $U \cap
M(M'^{-1}(\bsOp)) = \sO$ and the
quasi-coherent sheaf  $\slift(\sA^l)|_{U}$ descends to a quasi-coherent sheaf on the closed subvariety $\sO$ of $U$. (Thus $\slift(\sA^l)$ is generically reduced around
$X$ in the sense of  \cite[Proposition~2.9]{Vo89}.)



%We now suppose $\sO_l = \sO'$ and let $Y := M(M^{-1}(\bsOp))$.
%Recall the definition of generically reduced in \cite[Proposition~2.9]{Vo89}

\begin{claim*}
Assume that $\sO'_l=\sO'$ ($1\leq l\leq f$). Then we have  the following isomorphism
%  holds in the Grothendieck group of the in the category
of algebraic representations of $\bfK_X$:
\[% \begin{equation}\label{isoii}
   i^*_{X}(\slift(\sA^l))\cong (i^*_{X'}(\sA^l))^{\bfK'_2} \circ \alpha_1.
 \]%\end{equation}
 % The following equality holds % in the Grothendieck group of the
 % in the category of algebraic representations of $\bfK_X$.
 Here $\alpha_1$ is
 defined in \cref{eq:def.alpha1}, $i_X\colon \set{X}\hookrightarrow \fpp$ and
 $i_{X'}\colon \set{X'}\hookrightarrow \fpp'$ are the inclusion maps, and
 $i^*_{X}$ and $ i^*_{X'}$ are the associated pull-back functors of the
 quasi-coherent sheaves.
\end{claim*}
%\begin{proof}
%According to the defintion of $\dliftv_{\sO',\sO}$ in \Cref{sec:lift.AC}, case
%\ref{it:case.D} may be viewed as a special case of \ref{it:case.GD} with
%$\bfK'_1 = \bfK'$ and $\bfK'_2$ trivial, we only give the proof of case
%\ref{it:case.D} and indicate necessary changes for case \ref{it:case.D}.

%Since $\dliftv_{\cO',\cO}$ is a Grothendieck group homomorphism.

% For the proof of \eqref{isoii}, we assume without loss of generality that $\sA$
% is irreducible as a $\bfK'$-equivariant coherent sheaf on $\fpp'$. In
% particular,
% $\sA$ is naturally a $\bC[\overline{\sO'_0}],\bfK')$-module for a nilpotent
% $\bfK'$-orbit in $\cO'\cap \fpp'$ (cf. \cite[Proof of Lemma 2.11]{Vo89}).

  \def\mX{\rmm_{\fpp}(X)} \def\kX{\kappa(X)}
  \def\ZX{\cZ_X}
  \def\ZXO{Z_{X,\bsOp}}

  Let $\mX$ be the maximal ideal of $\bC[\fpp]$ associated to $X$, and $\kX := \bC[\fpp]/\mX$
  be the residual field at $X$.
  Let
  \[
  \ZXO := \Set{w\in \cX|M(w) = X, M'(w)\in \bsOp}.
\]
Then $T\in \ZXO$ and
$$\bC[\ZXO] = \bC[\cX]\otimes_{\bC[\fpp]\otimes
  \bC[\fpp']}(\kX\otimes\bC[\bsOp])$$
  by \Cref{lem:DS.sh} and
\Cref{lem:GDS.sh}.
% This also implies that for a sufficiently small Zariski
% open set $U$ of $\fpp$ containing  $X$, the scheme
% theoretical pre-image $\cX \times_{M\times M'}(U\times \bsO')$ is reduced
% (cf. the proof of \Cref{lem:GDS.sh}).
\trivial[h]{ Write
  $\cZ_{U,\bsOp} = \cX_{\breve{M}}(U\times \bsOp)$.  By considering the morphism
  $\cZ_{\sO,\bsOp}:=\cX_{\breve{M}}(\sO\times \bsOp) \rightarrow \sO$, we see
  that $\cX_{\breve{M}}(\sO\times \bsOp)$ is reduced. Note that $\sO$ is an open
  set in the closed set $M(M'^{-1}(\bsOp))$. Hence, one can find an open set $U$
  in $\fpp$ such that $Y:= U\cap M(M'^{-1}(\bsOp)) \subset \sO$ and
  $\cZ_{U, \bsOp}$ is reduced for this $U$.  Suppose
  $U = D_f := \set{X|f(X)\neq 0}$ for certain $f\in \bC[\fpp]$. Let $\cP$ be the
  prime ideal correspond to the irreducible component of $\bsO$ containing
  $X$. We could assume $Y$ is contained in the irreducible component.  Now
  consider the situation that $U \leftarrow \cX_f \rightarrow \fpp$. Where
  $\cX_f = \set{w \in \cX|f(M(w))\neq 0}$ is an open set in $\cX$, clearly
  $\bC[\cX_f] = f^{-1}\bC[\cX]$.  Now $f^{-1} \cP$ is the ideal correspond to
  $Y\subset U$.  $\cZ_{U,\bsOp}$ is reduced implies that the ideal vanishing on
  it is given by $\bC[\cX_f] (M'^*(\cI_{\bcOp}))$, where $\cI_{\bcOp}$ is the
  ideal of $\bcOp$. For any $p\in \cP$, $M^*(p)$ vanishes on the underlying set
  of $\cZ_{U,\bsOp}$. Hence $f^s p = h M'^*(a)$ for certain positive integer
  $s$, $h\in \bC[\cX]$ and $a \in \cI_{\bcOp}$. This implies $f^sp$ act on
  $\bC[\cX]\otimes_{\bC[\fpp]}\bC[\bsOp]\otimes_{\bC[\bsOp]}A^l$ by zero,
  i.e. $M_*(M'^*(\sA^l))$ is generically reduced along $\cP$. }


  Let  $A^l$ be the module of global sections of $\sA^l$. We have
  \[
    \begin{split}
       %i^*_{X}(M_*(M'^*(\sA^l)^{\bfK'})) & =
      i^*_{X}(\slift(\sA^l)) &=
      \kX\otimes_{\bC[\fpp]}\left(\bC[\cX]\otimes_{\bC[\fpp']}\bC[\bsOp]\otimes_{\bC[\bsOp]}
        A^l\right)^{\bfK'}\\
      & = \left(\bC[\cX]\otimes_{\bC[\fpp]\otimes \bC[\fpp']}(\kX\otimes
        \bC[\bsOp])\otimes_{\bC[\bsOp]}A^l \right)^{\bfK'}\\
      & = (\bC[\ZXO]\otimes_{\bC[\bsOp]}A^l)^{\bfK'}.\\
    \end{split}
  \]

Let $\rho':=i^*_{X'}(\sA^l)$ be the isotropy
representation of $\sA^l$ at $X'$.
  Since  $\ZXO$ is the $\bfK'\times \bfK_X$-orbit of $T$ by
\Cref{lem:DS.sh}~\ref{it:DS.G2} and  \Cref{lem:GDS.sh}~\ref{it:GDS.sh.1}, by  considering  the diagram (\emph{cf}. \cite[Section~4.2]{LM})
  \[
    \xymatrix{
      \set{X'} \ar@{^(->}[d]& \ar[l] \ar[rd]\ar@{^(->}[d] \set{T}&\\
      \bsOp & \ar[l]_{M'} \ar[r]^{M}\ZXO & \set{X},}
  \]
we know that
$\bC[\ZXO]\otimes_{\bC[\bsOp]}A^l$ is
  isomorphic to the algebraically induced representation $\Ind_{\bfS_T}^{\bfK'\times \bfK_X} \rho'$, where $\bfS_T$ is the stabilizer  group as in \eqref{labst}, and $\rho'$ is
  viewed as an $\bfS_T$-module via the natural projection
  $\bfS_T\rightarrow \bfK'_{X'}$.  Now by Frobenius reciprocity, we have
  \[
     % i^*_{X}(M_*(M'^*(\sA)^{\bfK'}))
    i^*_{X}(\slift(\sA^l))
    \cong (\Ind_{\bfS_T}^{\bfK'\times \bfK_X} \rho')^{\bfK'} =
    (\Ind_{\bfK'_2\times (\bfK'_{1,X'_1}\times_{\alpha_1}\bfK_X)}^{\bfK'\times
      \bfK_X} \rho')^{\bfK'} = (\rho')^{\bfK'_2} \circ \alpha_1.
  \]
  This finishes the proof of the claim.
%\end{proof}

\medskip

On the other hand,   if $\sO'_l\neq \sO'$, then \cref{eq:GD.min} implies that
$$\sO\cap  M(M'^{-1}(\overline{\sO'_l})) = \emptyset,$$
and hence $\sO$ is not contained in $\Supp(\cL(\sA^l))$. % Hence \cref{isoii} holds since its both sides are zero.
In conlcusion, the following inequality holds in the Grothedieck group of the category of algebraic representations of $\bfK_X$:
\[
  \chi(X, \sB)\preceq  \chi(X, \slift(\sA))\preceq \sum_{l=1}^f \chi(X, \slift(\sA^l))=\sum_{l=1}^f (i^*_{X'}(\sA^l))^{\bfK'_2} \circ \alpha_1=\chi(X', \sA)^{\bfK'_2}\circ \alpha_1,
\]
where $\chi(X,\,\cdot\,)$ indicates the  virtual character
of $\bfK_X$ attached to a $\bfK$-equivariant coherent sheaf on $\fpp$ whose
support is contained in $\overline \CO\cap \fpp$, and similarly for
$\chi(X',\,\cdot\,)$ (cf. \cite[Definition~2.12]{Vo89}).
This finishes the proof of the theorem.
\trivial[h]{Although we do
  not claim that $\slift(\sA_l)$ is a coherent sheave, $\sG_l$ is coherent since
  it is a sub-sheave of the coherent sheave $\sB$.  The coherent sheave
  $\sG_l/\sG_{l-1}$ is generically reduced along the irreducible component of
  $\bsO$ containing $X$ if its support contains $\bsO$ by the above claim (see
  \cite[Proposition~2.9 (d)]{Vo89} for the definition of generically reduced).
}
\end{proof}






% \subsubsection{Formula on the associated characters of certain semi-stable range
%   lifting}
% We retain Binyong's setting:

% Assume in this subsection that $\dimo \aV>0$. Then  there is a nonzero split $(\epsilon, \dot \epsilon)$-space $U$ such that
% \begin{equation}
% \label{dimu}
%   \dim U=
%   \begin{cases}
%       2\dim \acute{V},\quad&\textrm{if $\epsilon \dot \epsilon=-1$;}\medskip\\
%       2\dim \acute{V}-2,\quad&\textrm{if $(\epsilon, \dot \epsilon)=(-1,-1)$;}\medskip\\
%       2\dim \acute{V}+2,\quad&\textrm{if $(\epsilon, \dot \epsilon)=(1,1)$.}
%     \end{cases}
% \end{equation}



\subsection{An equality of associated characters in the convergent range}
In this subsection, we assume that
$\dimo \bfV>0$.  The purpose of this section is to prove the following theorem.
% %We retain the notation in \Cref{sec:MCI} where

% % For any Casselman-Wallach representation $\pi$ of $\tGVr$, write $\pi^{\mathrm{alg}}$ for the space of $\wtK_{\bfV}$-finite vectors in $\pi$. It is naturally a $(\g_{\bfV}, \wtK_{\bfV})$-module of finite length.
% % For $\CO\subset \Nil_{\bfG_{\bfV}}(\g_{\bfV})$, we say that $\pi$ is $\CO$-bounded if $\pi^{\mathrm{alg}}$ is $\CO$-bounded. When this is the case, we write $\Ch_\CO(\pi):=\Ch_\CO(\pi^\mathrm{alg})$. We also write $\Ch_\sO(\pi):=\Ch_\sO(\pi^\mathrm{alg})$, if there is a $\bfK_{\bfV}$-orbit $\sO$ in $\CO\cap \p_{\bfV}$ such that $\pi^{\mathrm{alg}}$ is $\sO$-bounded.
% \item
% \ite



%\mjjc{Is it possible to extend to the case $c_{0}(\acO) \geq c_1(\acO)+1$?}
\begin{thm}\label{prop:calas}\label{prop:Ch.eq}
Let  $\cO\in \Nil_{\bfG}(\fgg)$ and  $\acO\in \Nil_{\bfG'}(\fgg')$  such that
    $\cO$ is the descent of $\cO'$.  Write $\bfD(\cO') =
    [c_0,c_1, \cdots, c_k]$ ($k\geq 1$).  Assume that
   $c_0> c_1$ when $G$ is a real symplectic group.  Then for every $\cO$-bounded Casselman-Wallach representation $\pi$ of $\wtG$ such that $(\pi, \bfV')$ is in
  the convergent range (see \Cref{defn:CR}), $\Thetab_{\bfV,\abfV}(\pi)$ is $\acO$-bounded and
  \begin{equation}\label{eq:LCh}
    \Ch_{\acO}(\Thetab_{\bfV,\abfV}(\pi))= \dliftv_{\cO,\acO} (\Ch_{\cO}(\pi)).
  \end{equation}
\end{thm}
\begin{remark}
  When $(\bfV, \abfV)$ is in the stable range, \Cref{prop:Ch.eq} is proved for unitary representations $\pi $ in \cite{LM}.
\end{remark}


We keep the setting of Theorem \ref{prop:Ch.eq}. First observe that the Harish-Chandra module of $\Thetab_{\bfV,\abfV}(\pi)$ is isomorphic to a quotient of
$\Thetav(\pi^{\mathrm{al}})$, where $\pi^{\mathrm{al}}$ denotes the  Harish-Chandra module of $\pi$. Thus Theorem \ref{prop:GDS.AC} implies that $\Thetab_{\bfV,\bfV'}(\pi)$ is $\cO'$-bounded and
\begin{equation}\label{boundch}
\Ch_{\acO}\Thetab_{\bfV,\bfV'}(\pi)\preceq \dliftv_{\cO,\cO'}(\Ch_{\cO}(\pi)).
\end{equation}
We will devote the rest of this section to prove that the equality in \eqref{boundch}
holds.

\subsubsection{Doubling}
We consider a two-step theta lifting.
Let $\bfU$ be as in \eqref{dimu}.  We realize $\bfV$ as a non-genenerate
$(\epsilon, \dot \epsilon)$-subspace of $\bfU$ and write $\bfV^\perp$ for the
orthogonal complement of $\bfV$ in $\bfU$, which is also an
$(\epsilon, \dot \epsilon)$-space.

Note that $\dimo \abfV >0$ and Lemma \ref{intpi2} implies that
$(\Thetab_{\bfV, \abfV}(\pi), \bfV^\perp)$ is in the convergent range. Comparing
\eqref{nuuv} with \eqref{dimu}, we have
$\nu_{\bfU,\bfV}=\frac{\dim \abfV}{\dimo \bfV}$. Thus \eqref{bnuv} holds
and $\CR_{\Thetab_{\bfU}(1_{\abfV})}(\pi)$ is defined by \Cref{intpi00}.


\begin{lem}
One has that
\begin{equation}
\label{thetabv}
  \Thetab_{\abfV,\bfV^\perp}(\Thetab_{\bfV,\abfV}(\pi))\cong \CR_{\Thetab_{\abfV,\bfU}(1_{\abfV})}(\pi).
\end{equation}

\end{lem}
\begin{proof}
 Note that the integral in
\begin{equation}\label{intt}
  \xymatrix@R=0em{
    (\pi\totimes \omega_{\bfV,\abfV}\totimes\omega_{\abfV,\bfV^\perp})\times
    (\pi^\vee \totimes \omega_{\bfV,\abfV}^\vee\totimes \omega_{\abfV,\bfV^\perp}^\vee)
    \ar[r] &\bC\\
    (u,v)\ar@{|->}[r] &\int_{\wtG\times \widetilde{G'}} \inn{g\cdot u}{v}\od\! g
  }
\end{equation}
is absolutely convergent and defines a continuous bilinear map.
In view of Fubini's theorem and \Cref{lem:coinv}, the lemma follows as both sides of \eqref{thetabv} are isomorphic to the quotient of $\pi\widehat \otimes \omega_{\bfV,\abfV}\widehat \otimes \omega_{\abfV,\bfV^\perp}$ by the left radical of the pairing \eqref{intt}.
\end{proof}

We will use \cref{thetabv} freely in the rest of this section.

\subsubsection{On certain induced orbits}\label{subsec:induced}


The main step in the proof of \Cref{prop:Ch.eq} consists of comparison of bound of the associated cycle of
$\Thetab_{\abfV,\bfV^\perp}(\Thetab_{\bfV,\abfV}(\pi))$ with the formula (due to Barbasch) of the wavefront cycle of
a certain parabolically induced representation.

 In this section, let $\fgg_\bR
=\fgg^J$ be the Lie algebra of $G$, which is identified with its dual space $\fgg^*_\R$ under the trace from. Let $\Nil_{G}(\mathbf i \fgg_\bR)$
denote the set of nilpotent $G$-orbits in $\mathbf i\fgg_\bR$. Similar notation will be used without further explanation. For example, for every Levi subgroup $M$  of $G$, $\fmm_\bR$ denotes its Lie algebra, which is  identified with the dual space $\fmm^*_\bR$ by using the trace form on $\fgg$.

 Let
\[
\KS\colon \Nil_{G}(\mathbf i\fgg_\bR) \rightarrow \Nil_{\bfK}(\fpp)
\]
 be the natural
bijection given by the Kostant-Sekiguchi correspondence
(\emph{cf}. \cite[Equation~(6.7)]{SV}).
By abuse of notation, we also let $\ssD$ denote the map $\ssD\circ
\KS\colon  \Nil_{G}(\mathbf i\fgg_\bR) \rightarrow \ssP$. See \Cref{subsec:SYD} for the parametrization map $\ssD \colon
\Nil_{\bfK}(\fpp) \rightarrow \ssP$.


\begin{thm}[\emph{cf}. Barbasch {\cite[Corollary~5.0.10]{B.Orbit}}]\label{thm:Bar}
  Let $G_1$ be an arbitrary real reductive group and let $P_1$ be a real
  parabolic subgroup of $G_1$, namely a closed subgroup of $G_1$ whose Lie
  algebra is a parabolic subalgebra of $\g_{1,\bR}$. Let $N_1$ be the unipotent
  radical of $P_1$ and $M_1:=P_1/N_1$. Write
  $$r_1: \bfii (\fgg_{1, \bR}/\fnn_{1, \bR})^*\longrightarrow \bfii \, \fmm_{1,
    \bR}^*$$ for the natural map.  Let $\pi_1$ be a Casselman-Wallach
  representation of $M_1$ with the wavefront cycle
\[
\WF(\pi_1) =
\sum_{\sOR\in \Nil_{M_1}(\bfii \frak m^*_{1,\bR})} \rcc_{\sOR} [\sOR].
\]
Then
\[
\WF(\Ind^{G_1}_{P_1} \pi) = \sum_{(\sOR, \sOR')} \rcc_{\sOR}\frac{\# C_{G_1}(v')}{\#
  C_{P_1}(v')}
[\sOR'],
\]
where the summation runs over all pairs $(\sOR, \sOR')$ such that $\sOR \in \Nil_{M_1}(\bfii \frak m^*_{1,\bR})$ and $\sOR' \in \Nil_{G_1}(\bfii \frak g^*_{1,\bR})$ is an induced orbit of $\sOR$, $v'$ is an element  of  $\sOR'\cap r_1^{-1}(\sOR)$, and $C_{G_1}(v')$ and $C_{P_1}(v')$ are the component groups of the centralizers of
$v'$ in $G_1$ and $P_1$, respectively.
\end{thm}

\begin{remarks}
\begin{enumR}
\item While Barbasch proved the theorem when $G_1$ is the real points of a connected
  reductive algebraic group, his proof still works in the slightly more general setting of \Cref{thm:Bar}.
\item The notion of induced nilpotent orbits was introduced by Lusztig and Spaltenstein for complex reductive groups \cite{LS}. For a real reductive group $G_1$, a nilpotent orbit $\sOR' \in \Nil_{G}(\mathbf i \fgg^*_{1,\bR})$ is called an induced orbit of a nilpotent orbit $\sOR\in
  \Nil_{M_1}(\mathbf i \fmm_{1,\bR}^*)$ if $\sOR'\cap r_1^{-1}(\sOR)$ is open in
  $r_1^{-1}(\sOR)$ (see \cite[Definition~5.0.7]{B.Orbit} or \cite{Ohta2}).
  We write $\Ind_{P_1}^{G_1} \sOR$ for the set of all induced orbits of $\sOR$. Similar notation applies for a complex reductive group.
  %When $G_1$ is moreover a  complex reductive group,  write $\fgg_1$ for its Lie algebra and write $\fmm_1$ for the Lie algebra of $M_1$. Then for each complex nilpotent orbit $\cO_{1}\in \Nil_{M_1}(\fmm^*_{1})$, the induced %orbit $\Ind_{P_1}^{G_1} \cO_{1}\in \Nil_{G_1}(\fgg^*_{1})$ is similarly defined, as in \cite[Chapter 7]{CM}.

  \item   According to the fundamental result of Schimd-Vilonen \cite{SV}, the wave front cycle
  and the associated cycle agree under the Kostant-Sekiguchi correspondence. We thank Professor Vilonen for confirming that their result extends
  to nonlinear groups. Therefore the associated cycle of a parabolically induced
  representation as in the above theorem of Barbasch is also determined.
\end{enumR}
\end{remarks}

We now consider induced orbits appearing in our cases.
Retain the setting in \Cref{sec:DP} (see \cref{eq:Vperp.dec} and onwards), where
\[
\bfVpe = \bfEz \oplus \bfVn \oplus \bfEzp,
\]
$M_{\bfE_0}=G
\times \GL_{\bfE_0}$ and
the parabolic subgroup of $G_{\bfV^\perp}$ stabilizing
$\bfE_0$ is $P_{\bfE_0}=M_{\bfE_0}\ltimes N_{\bfE_0}$.

%  where $\bfEz$, $\bfEzp$ is an isotropic subspace of $\bfU$ and $\bfE^*$ % = L (\bfE)$
% is an isotropic subspace dual to $\bfE$ and $\bfV_0 = (\bfE\oplus
% \bfE^*)^\perp$.

%
% Let $\bfP$ be the (maximal) parabolic subgroup of $\bfG$ stabilize $\bfL$.
% Let $P := \bfP^J$ be the (maximal) parabolic subgroup of $G$ and
% $M:=\GL \times G_0$ where $\bfG_0 = \rU(\bfV_0)$, $G_0 = \bfG_0^J$ and $\GL = \GL_D(\bfE)$.
Recall that $\bfD(\acO) =[c_0, \cdots, c_k]$  and $\bfD(\cO) = [c_1,\cdots, c_k]$.
Put $l :=\dim \bfEz$. In the notation of \eqref{dimu}, we have
\begin{equation}\label{eq:dim-ine}
  l=c_0+\delta\geq c_1.
\end{equation}
Note that if $\bfG$ is an orthogonal group, then $c_0-c_1$ is even. Hence $l-c_1$ is odd if $G$ is real orthogonal and $l-c_1$ is even if $G$ is quaternionic orthogonal. View $\cO$ as a nilpotent orbit in $\fmm_{\bfE_0}$ via inclusion.
The following lemma is clear (\emph{cf}. \cite[Section~7.3]{CM}).
\begin{lem}\label{lem:indC}
%Assume that  $l  \geq c_1$.
\begin{enumT}
\item \label{it:indC.1}
If $G$ is a real orthogonal group, then
\[
\bfD(\Ind_{\bfP_{\bfEz}}^{\bfG_{\bfVpe}}\cO) = [l+1,l-1, c_1, \cdots, c_k].
\]
\item \label{it:indC.2}
Otherwise,
\[
  \bfD(\Ind_{\bfP_{\bfEz}}^{\bfG_{\bfVpe}}\cO) = [l,l, c_1,\cdots, c_k].
\]
\end{enumT}
\end{lem}

\medskip

% We will compare the induced orbit with the orbit obtained from the double theta lift, namely first via the dual pair $(\bfV, \abfV)$ and then via the dual pair
% $(\abfV, \bfVpe)$.



By  \cite[Theorem~5.2 and 5.6]{DKPC}, the complex nilpotent orbit
\[\cO^\perp:=\oliftc_{\abfV,\bfVpe}(\acO)= \oliftc_{\abfV,\bfVpe}(\oliftc_{\bfV,\abfV}(\cO))\]
is given by
\[
  \bfD(\cO^\perp )= \begin{cases}
  [c_0+2, c_0, c_1, \cdots, c_k], &\text{if $G$ is a real orthogonal group;}\\
  [c_0-1,  c_0-1, c_1, \cdots, c_k],&\text{if $G$ is a real symplectic group; }\\
  [c_0, c_0, c_1, \cdots, c_k], &\text{otherwise.}
    \end{cases}
  \]
This implies that
\[
  \cO^\perp = \Ind_{\bfP_{\bfEz}}^{\bfG_{\bfVpe}}\cO.
\]
% Also note that $\Thetab_{\abfV, \bfV^\perp}((\Thetab_{\bfV, \abfV}(\pi))$ is $\cO^\perp$-bounded. %\Cref{cor:Cbound}.


% Suppose $\cO_0\in \Nil_{\bfG_0}(\fgg_0)$, $X_0\in\cO_0$ and $\Vker := \Ker X_0$ such that
% $l-\dim \Vker $ is odd and $\bfG$ is an orthogonal group.  Then
% $\Ind_{P}^G\cO_0 = \cO$ where $\cO$ has Young diagram


View each orbit in $\Nil_G(\bfii \fgg_\bR)$ as an orbit in $\Nil_{M_{\bfE_0}}(\bfii\, \fmm_{\bfE_0}^J)$ via inclusion.
We state the result for the induction of real nilpotent orbits in the following lemma.
The proof will be given in \Cref{sec:pf.indR}, which is by elementary matrix manipulations.


\begin{lem}\label{lem:indR}
% Retain the setting in \Cref{lem:indC} and view $d_i$'s as signatures:
Let $\sOR\in \Nil_G(\bfii\fgg_\bR)$ be a real nilpotent orbit in $\cO$ with $\ssD(\sOR) =
[d_1,\cdots, d_k]$. %Let  $X_0$ be an element in $\sOR$.
%Let $X\in \sOpe$.
\begin{enumT}
\item \label{it:indR.1}
Suppose $G$ is a real orthogonal group. Then $\Ind_{P_{\bfE_0}}^{G_{\bfVpe}} \sOR$ consists of a single orbit $\sOpeR$ with
\[
\ssD(\sOpeR) = [d_1+s+(1,1), \ckdd_1+\ckss, d_1, \cdots, d_k],
\]
where $s:= (\frac{l-c_1-1}{2},\frac{l-c_1-1}{2})\in \bZ_{\geq 0}^2$. % is the unique signature such that $\sOpe$ is a real nilpotent orbit of
% $G_{\bfVpe}$.
Moreover, the natural map $C_{P_{\bfE_0}}(X) \rightarrow C_{G_{\bfVpe}}(X)$ is
  injective and its image has index $2$ in $C_{G_{\bfVpe}}(X)$ for $X\in \sOpeR \cap (\sOR+\bfii\, \fnn_{\bfE_0}^J)$.
 % \footnote{Here we use the fact that the Witt class of $\bfVpe \oplus \bfVn$ is trivial.}
\item
\label{it:indR.2}
Otherwise, $
  \Ind_{P_{\bfE_0}}^{G_{\bfVpe}} \sOR$ equals the set
  \[
    \Set{
      \sOpeR \in \Nil_{G_{\bfVpe}}(\bfii \fgg_{\bfVpe}^J)|\begin{aligned} &\ssD(\sOpeR) =  [d_1+s, \ckdd_1+\ckss, d_1, \cdots, d_k] \text{ for a signature} \\
      &\text{$s$ of a $(-\epsilon, -\dot \epsilon)$-space of dimension $l-c_1$}\end{aligned}}.
  \]Moreover, the natural map
  $C_{P_{\bfE_0}}(X) \rightarrow C_{G_{\bfVpe}}(X)$ is an isomorphism for $X\in \sOpeR\cap (\sOR+\bfii \,\fnn_{\bfE_0}^J)$.
\end{enumT}
\end{lem}

Here $C_{P_{\bfE_0}}(X)$ and $C_{G_{\bfVpe}}(X)$ are the component groups as in \Cref{thm:Bar}.
Under the setting of \Cref{lem:indR}, we see that $\Ind_{P_{\bfE_0}}^{G_{\bfVpe}} \sOR$ consists of a single orbit when $G$ is a
real orthogonal group or a quaternionic symplectic group.

For each $\sO\in \Nil_{\bfK}(\fpp)$, let
\[
\Ind_{P_{\bfE_0}}^{G_{\bfVpe}}\sO := \Set{\KS(\sOR)|\sOR\in \Ind_{P_{\bfE_0}}^{G_{\bfVpe}}(\KS^{-1}(\sO))}.
\]





\subsubsection{Finishing the proof when $G$ is a real orthogonal group}\label{sec:PC.ro}
% In this subsection, assume that $(\epsilon, \dot \epsilon)=(1,1)$ so that $G_{\bfV}$
% is a real orthogonal group.
% \begin{lem}\label{decomind1}
% One has that
% \[
%   \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} \left(\pi\otimes
%     \chi_{\bfE_0}\right)\cong \Thetab_{\bfV^\perp}(\Thetab_{\abfV}(\pi))\oplus
%   \left( (\Thetab_{\bfV^\perp}(\Thetab_{\abfV}(\pi\otimes \sgn_{\bfV})))\otimes
%     \sgn_{\bfV^\perp}\right)
% \]
% \end{lem}
% \begin{proof}
Let $\sgn_{\bfV}$ and $\sgn_{\bfVpe}$ be the sign character of the orthogonal
groups $G$ and $G_{\bfVpe}$
respectively.
 By \Cref{est002}, \Cref{degens}~\ref{it:degens.OR}
 and \Cref{lem:coinv}, we have
\begin{equation}\label{eq:decomind1}
  \begin{split}
    &\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} \left(\pi\otimes
      \chi_{\bfE_0}\right) \\
    &
    \cong \CR_{\RI(\chi_{\bfE})} (\pi)
    \cong \CR_{\Thetab_{\abfV,\bfU}(1_{\abfV})}(\pi)\oplus \CR_{\Thetab_{\abfV,\bfU}(1_{\abfV}) \otimes \sgn_{\bfU}}(\pi)\\
    &\cong \Thetab_{\abfV,\bfV^\perp}(\Thetab_{\bfV,\abfV}(\pi))\oplus
    (\Thetab_{\abfV,\bfV^\perp}(\Thetab_{\bfV,\abfV}(\pi\otimes \sgn_{\bfV})))\otimes
    \sgn_{\bfV^\perp}.
  \end{split}
\end{equation}
% \]
% \end{proof}


By \Cref{thm:Bar}, \Cref{lem:indC}, \Cref{lem:indR}~\ref{it:indR.1} and \cite[Theorem~1.4]{SV}, the representation
  $\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} \left(\pi\otimes
    \chi_{\bfE_0}\right))$ is $\CO^\perp$-bounded, and
  \begin{equation}
    \label{chop1}
    \AC_{\CO^\perp}(\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} \left(\pi\otimes
      \chi_{\bfE_0}\right))=2 \sum_{\sO} \rcc_\sO(\pi) [\sO^\perp ],
  \end{equation}
  where the summation runs over all $\KV$-orbits $\sO$ in $\CO\cap \p_{\bfV}$, and
  $\sO^\perp$ is the unique induced orbit in $\Ind_{P_{\bfE_0}}^{G_{\bfVpe}}\sO$.

  On the other hand, by the explicit formula for the descents  of nilpotent orbits,
  we have
  \[
    \DD_{\abfV,\bfV} (\DD_{\bfVpe,\abfV}(\sO^\perp))=\sO.
  \]
  %$\sO^\perp = \olift_{\abfV,\bfV^\perp}(\olift_{\bfV,\abfV}(\sO))$
  %(see \cref{eq:def.LsO} for the defintion of $\olift_{\bfV,\abfV}$).
  Applying \Cref{prop:GDS.AC} twice, we have
  \begin{equation}
    \label{chop2}
    \begin{split}
      \AC_{ \CO^\perp}(\Thetab_{\abfV,\bfVpe}(\Thetab_{\bfV,\abfV}(\pi))) &\preceq
      \sum_{\sO} \rcc_\sO(\pi) [\sO^\perp ], \quad \text{and}\\
      \AC_{ \CO^\perp} (\Thetab_{\abfV,\bfVpe}(\Thetab_{\bfV,\abfV}(\pi\otimes
      \sgn_{\bfV})))\otimes \sgn_{\bfV^\perp}) &\preceq \sum_{\sO}
      \rcc_\sO(\pi) [\sO^\perp ]
    \end{split}
  \end{equation}
  where the summations  run over the same set as the right hand side of \cref{chop1}.

In view of \cref{eq:decomind1,chop1,chop2}, we conclude that both inequalities in \eqref{chop2} are equalities. Thus \eqref{eq:LCh} follows. % by using  \Cref{prop:GDS.AC} again.
% by Lemma \ref{lemb1}.

\subsubsection{Finishing the proof when $G$ is a real symplectic group}\label{sec:PC.rsp}
Let $\abfV_1, \abfV_2, \cdots, \abfV_s$ be a list of representatives of the
isomorphic  classes of all $(1,1)$-spaces %($(-\epsilon, -\dotepsilon)$-spaces)
with dimension $\dim \abfV$.

% \begin{lem}\label{}
% One has that
% \[
%   \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} \left(\pi\otimes \chi_{\bfE_0}\right) \oplus
%   \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} \left(\pi\otimes \chi'_{\bfE_0}\right)\cong
%   \bigoplus_{i=1}^s \Thetab_{\bfV^\perp}(\Thetab_{\abfV_i}(\pi)).
%  \]
% \end{lem}
% \begin{proof}

By \Cref{est002}, \Cref{degens}~\ref{it:degens.SP} and \Cref{lem:coinv}, we have
\begin{equation}
\label{decomind2}
\begin{split}
  & \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfVpe}} \left(\pi\otimes \chi_{\bfE_0}\right)
  \oplus \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfVpe}} \left(\pi\otimes \chi'_{\bfE_0}\right)\\
 &\cong \CR_{\RI(\chi_{\bfE})} (\pi)\oplus \CR_{\RI(\chi'_{\bfE})} (\pi)\\
 &\cong \bigoplus_{i=1}^s \CR_{\Thetab_{\abfV_i,\bfU}(1_{\abfV_i})}(\pi)
 \cong \bigoplus_{i=1}^s \Thetab_{\abfV_i,\bfVpe}(\Thetab_{\bfV,\abfV_i}(\pi)).
\end{split}
\end{equation}


By \Cref{thm:Bar}, \Cref{lem:indC}, \Cref{lem:indR}~\ref{it:indR.2} and \cite[Theorem~1.4]{SV},
 $\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfVpe}} \left(\pi\otimes \chi_{\bfE_0}\right)$ and
  $\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfVpe}} \left(\pi\otimes \chi'_{\bfE_0}\right)$ are
$\CO^\perp$-bounded, and
  \begin{equation}
    \label{chops1}
    \AC_{\CO^\perp}(\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfVpe}} \left(\pi\otimes
      \chi_{\bfE_0}\right))
    =\AC_{\CO^\perp}(\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}}
    \left(\pi\otimes \chi'_{\bfE_0}\right))
    =\sum_{\sO, \sOpe}  \rcc_\sO(\pi) [\sO^\perp ],
  \end{equation}
  where the summation runs over all pairs $(\sO,\sOpe)$, where $\sO$ is a
  $\KV$-orbit in $\cO\cap \fpp_{\bfV}$ and $\sOpe\in \Ind_{P_{\bfE_0}}^{G_{\bfVpe}}\sO$.
  % and
  % $K_{V^\perp}$-orbits $\sO^\perp\subset \CO^\perp\cap \p_{V^\perp}$ such that
  % $\mathrm{Desc}^2(V^\perp, \sO^\perp)$ is isomorphic to $(V, \sO)$.
% \end{lem}
% \begin{proof} and the explicit formula of
% the theta lifting of nilpotent orbits.
% \end{proof}


  Applying \Cref{prop:GDS.AC} twice, %\footnote{When applying \Cref{prop:GDS.AC} for the generalized descent, note that the dimension of an invariant
    % subspace is obviously less than or equal to the dimension of the total space.}
    we see that $\Thetab_{\abfV_i,\bfV^\perp}(\Thetab_{\bfV,\abfV_i}(\pi))$ is
  $\cO^\perp$-bounded ($1\leq i\leq s$), and
\[
  \sum_{i=1}^s
  \AC_{\cO^\perp}(\Thetab_{\abfV_i,\bfVpe}(\Thetab_{\bfV,\abfV_i}(\pi)))\preceq\sum_{i=1}^s
  \sum_{\sO,\sOpe} \rcc_\sO(\pi) [\sO^\perp ],
\]
where the inner summation runs over all pairs of orbits $(\sO,\sOpe)$ such that
\begin{equation}\label{eq:Sp.gdd}
\DD_{\bfV_i', \bfV}(\gDD_{\bfVpe,\abfV_i}(\sOpe)) = \sO.
\end{equation}
By \Cref{lem:indR}~\ref{it:indR.2} and \cref{eq:GD}, such kind of
pairs $(\sO,\sOpe)$ are the same as those of the right hand side of
\eqref{chops1}. Suppose $\ssD(\sOpe) = [d,\ckdd,d_1,\cdots, d_k]$, then
$\ssD(\sO) = [d_1,\cdots, d_k]$ and \cref{eq:Sp.gdd} holds
for exactly two $\abfV_i$, having signature $\ckdd+\sign{\bfV}+(1,0)$ and
$\ckdd+\sign{\bfV}+(0,1)$ respectively. Hence we have
\begin{equation}
  \label{chops2}
  \sum_{i=1}^s \AC_{\CO^\perp}(\Thetab_{\abfV_i,\bfV^\perp}(\Thetab_{\bfV,\abfV_i}(\pi)))\preceq \sum_{\sO, \sO^\perp}
  2\rcc_\sO(\pi) [\sO^\perp ],
\end{equation}
where the summation is as in the right hand
side of \eqref{chops1}.

In view of \cref{decomind2}, \cref{chops1} and \cref{chops2},
the equality holds in \eqref{chops2}. Thus \cref{eq:LCh} holds. % as before.


\subsubsection{Finishing the proof when $G$ is a quaternionic symplectic group}
% In this subsection, assume that $(\epsilon, \dot \epsilon)=(-1,1)$ so that
% $G_{\bfV}$ is a quaternionic symplectic group.

Using \Cref{est002}, \Cref{degens}~\ref{it:degens.SPQ}, \Cref{lem:coinv}, \Cref{thm:Bar},
\Cref{lem:indR}~\ref{it:indR.2}, \cite[Theorem~1.4]{SV} and \Cref{prop:GDS.AC}, and a
similar argument as in \Cref{sec:PC.ro} shows that
\begin{align}\label{chopqs0}
  \Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfVpe}} \left(\pi\otimes
  \chi_{\bfE_0}\right) & \cong \CR_{\RI(\chi_{\bfE})} (\pi)\cong \Thetab_{\abfV,\bfVpe}(\Thetab_{\bfV,\abfV}(\pi))\\
  \label{chopqs1}
  \AC_{\cO^\perp}(\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfVpe}} \left(\pi\otimes
  \chi_{\bfE_0}\right))
  &  = \sum_{\sO} \rcc_\sO(\pi) [\sOpe ], \quad \text{and}\\
  \label{chopqs2}
  \AC_{\CO^\perp}(\Thetab_{\abfV,\bfVpe}(\Thetab_{\bfV,\abfV}(\pi))) &\preceq \sum_{\sO} \rcc_\sO(\pi) [\sOpe ],
\end{align}
  Here
  the summations run over all
  $\bfK_{\bfV}$-orbit $\sO$ in  $\cO\cap \fpp_{\bfV}$, and $\sOpe$ is the unique induced orbit in $\Ind_{P_{\bfE_0}}^{G_{\bfVpe}}\sO$.
  Note that
   \[
 \DD_{\abfV,\bfV} (\DD_{\bfVpe,\abfV}(\sO^\perp))=\sO.
\]
Now \eqref{chopqs0}, \eqref{chopqs1} and \eqref{chopqs2}
imply that \eqref{chopqs2} is an equality and so \cref{eq:LCh} holds.
%We leave the details to the reader.


\subsubsection{Finishing the proof when $G$ is a quaternionic orthogonal group}
% In this subsection, assume that $(\epsilon, \dot \epsilon)=(1,-1)$ so that
% $G_{\bfV}$ is a quaternionic orthogonal group.


Let $\abfV_1, \abfV_2, \cdots, \abfV_s$ be a
list of representatives of the isomorphic  classes of all $(-1,
1)$-spaces with dimension $\dim \abfV$.




\begin{lem}\label{decomindq}
One has that
\[
  \Ch_{\CO^\perp}( \CR_{\RI(\chi_{\bfE})} (\pi))=\sum_{i=1}^s \Ch_{\CO^\perp}( \CR_{\Thetab_{\abfV_i,\bfU}(1_{\abfV_i})} (\pi)).
 \]
\end{lem}
\begin{proof}
For simplicity, write $0\rightarrow I_1\rightarrow I_2\rightarrow I_3\rightarrow
0$ for the exact sequence in \Cref{degens}~\ref{it:degens.OQ}.
% Note that the natural map
% \[
%  \cR_{I_1}(\pi) \rightarrow \cR_{I_2}(\pi)
% \]
% is injective.
Note that $\cR_{I_2}(\pi)$ is $\cO^\perp$-bounded by \Cref{est002},
\Cref{thm:Bar} and \cite[Theorem~1.4]{SV}.
By the definition in \cref{defqi}, we could view $\cR_{I_1}(\pi)$ as a
subrepresentation of  $ \cR_{I_2}(\pi)$ which is also $\cO^\perp$-bounded.

Since $G$ acts on $\cR_{I_2}(\pi)$ trivially, the natural homomorphism
\[
  \pi\totimes I_3\cong \pi\totimes I_2/\pi \totimes I_1\longrightarrow \cR_{I_2}(\pi)/\cR_{I_1}(\pi)\]
descents to a surjective homomorphism
\[
  (\pi\totimes  I_3)_{G}\longrightarrow \cR_{I_2}(\pi)/\cR_{I_1}(\pi).
\]
For each $(-1,1)$-space $\bfV'''$ of dimension $\dim
\abfV-2$, by applying \Cref{cor:Cbound} twice,
we see that
\[
(\pi\totimes (\omega_{\bfV''',\bfU})_{ G_{\bfV'''}})_{G}\cong ((\pi\totimes \omega_{\bfV,\bfV'''})_G\totimes \omega_{\bfV''',\bfVpe})_{ G_{\bfV'''}}
\]
 is
bounded by
$\oliftc_{\bfV''', \bfVpe}(\oliftc_{\bfV,\bfV'''}(\cO))$. Using formulas in  \cite[Theorem~5.2 and 5.6]{DKPC}, one checks that the latter set is contained in the boundary of  $\cO^\perp
$. Hence
\[
\Ch_{\cO^\perp}(\cR_{I_2}(\pi)/\cR_{I_1}(\pi)) = 0
\] and the lemma follows.
\end{proof}

Using \Cref{thm:Bar}, \Cref{lem:indR}~\ref{it:indR.2}, \cite[Theorem~1.4]{SV}, \Cref{prop:GDS.AC} and a
similar argument as in \Cref{sec:PC.rsp}, we have
% \begin{lem}
%   The representation
%   $\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} \left(\pi\otimes \chi_{\bfE_0}\right)$ is
%   $\CO^\perp$-bounded, and
  \begin{align}
    \label{chopq1}
      \AC_{\CO^\perp}(\Ind_{\wtP_{\bfE_0}}^{\wtG_{\bfV^\perp}} \left(\pi\otimes
        \chi_{\bfE_0}\right)) &= \sum_{\sO, \sO^\perp} \rcc_\sO(\pi) [\sO^\perp ],
      \quad \text{and}\\
    \label{chopq2}
      \bigoplus_{i=1}^s \AC_{
        \CO^\perp}(\Thetab_{\abfV_i, \bfV^\perp}(\Thetab_{\bfV,\abfV_i}(\pi)))& \preceq
      \sum_{\sO, \sO^\perp} \rcc_\sO(\pi) [\sO^\perp ].
  \end{align}
  Here
  the summations run over all pairs $(\sO,\sO^\perp)$ such that $\sO^\perp$ is a
  $\bfK_{\bfVpe}$-orbit in  $\cO^\perp\cap \fpp_{\bfVpe}$ and $\sO =
  \DD_{\abfV_i,\bfV}(\DD_{\bfVpe,\abfV_i}(\sO^\perp))$ for a unique $(-1,1)$-space $\abfV_i$.

 In view of \Cref{est002},  \Cref{decomindq}, \eqref{chopq1} and \eqref{chopq2}, we see that the
 equality holds in \eqref{chopq2}. Thus \cref{eq:LCh} holds.




\section{The unipotent representations construction and iterated theta lifting}\label{sec:unipot}
In this section, we will prove \Cref{main}. Recall that $\bfV$ is an
$(\epsilon,\dotepsilon)$-space and $\cO\in
\Nil^{\mathbb p}_{\bfG}(\fgg)$. Since  \Cref{main} is obvious when $\cO$ is the zero orbit, we assume without loss of generality that $\cO$ is not the zero orbit.

\subsection{The construction}\label{sec:cons}
Suppose there is a $\bfK$-orbit $\sO\in \cO\cap \fpp$.
Define a sequence $(\bfV_0, \sO_0), (\bfV_1, \sO_1), \cdots,  (\bfV_k, \sO_k)$ ($k\geq 1$)  such
that
\begin{itemize}
\item
$\bfV_j$ is a nonzero $((-1)^j\epsilon,(-1)^j\dotepsilon)$-space for all $0\leq j\leq k$;
\item
$(\bfV_0, \sO_0)=(\bfV, \sO)$, and  $\sO_j =
\DD_{\bfV_{j-1}, \bfV_j}(\sO_{j-1})\in \Nil_{\bfK_{\bfV_j}}(\fpp_{\bfV_j})$ for all $1\leq j\leq k$;
\item
 $\sO_k$ is the zero orbit.
 \end{itemize}
 Let $\cO_j$ denote the nilpotent
 $G_{\bfV_j}$-orbit containing $\sO_j$ ($0\leq j\leq k$).
 To ease the notation, we also let
 $\bfV_{k+1}$ be the zero $((-1)^{k+1}\epsilon,(-1)^{k+1}\dotepsilon)$-space
 and let $\sO_{k+1}\in  \Nil_{\bfK_{\bfV_{k+1}}}(\fpp_{\bfV_{k+1}})$
 and $\cO_{k+1}\in \Nil_{\bfG_{\bfV_{k+1}}}(\fgg_{\bfV_{k+1}})$ be $\set{0}$.


Let
\begin{equation}\label{eq:eta}
\eta=\chi_0\boxtimes \chi_1\boxtimes \cdots \boxtimes \chi_k
\end{equation}
be a character of
$G_{\bfV_0}\times G_{\bfV_1}\times \cdots \times G_{\bfV_k}$.
For $0\leq j\leq k$, put
\[
\eta_j:= \chi_j\boxtimes \chi_{j+1}\boxtimes \cdots \boxtimes \chi_k.
\]


For $0\leq j<k$, write
\[
  \omega_{\sO_j}:=\omega_{\bfV_{j}, \bfV_{j+1}}\whotimes \omega_{\bfV_{j+1},
    \bfV_{j+2}} \whotimes \cdots \whotimes \omega_{\bfV_{k-1},\bfV_k},
\]
and one checks that the integrals in
\begin{equation}\label{intunip}
\xymatrix@R=0em{
   (\omega_{\sO_j}\otimes \eta_j) \times  (\omega_{\sO_j}^\vee \otimes
   \eta_j^{-1}) \ar[r] &\bC, \hspace*{12em}\\
   (u,v) \ar@{|->}[r] &\displaystyle\int_{\wtG_{\bfV_{j+1}}\times \wtG_{\bfV_{j+2}}\times \cdots \times \wtG_{\bfV_k}} \la g \cdot u,v\ra\od\! g,
}
\end{equation}
are absolutely convergent and define a continuous bilinear map using \Cref{estosc}.
Define
\[%\begin{equation}\label{pisoeta0}
  \pi_{\sO_j, \eta_j}:=\frac{\omega_{\sO_j}\otimes \eta_j}{\text{the left kernel of \eqref{intunip}}}\, ,
\]%\end{equation}
which is a Casselman-Wallach representation of $\wtG_{\bfV_j}$, as in \eqref{thetab0}. Set
$\pi_{\sO_k, \eta_k} := \chi_k$ by convention.

For  $0\leq j\leq k$, let $ \chi_i|_{\wtbfK_{\bfV_i}}$ denote the algebraic character whose restriction to $\wtK_{\bfV_i}$ equals  the pullback of $\chi_i$ through the natural homomorphism $\wtK_{\bfV_i}\rightarrow G_{\bfV_i}$.
Let $\cE_{\sO_k, \chi_k}$ denote the $\wtbfK_{\bfV_k}$-equivariant algebraic line bundle on the zero orbit $\sO_k$ corresponding to  $\chi_k|_{\wtbfK_{\bfV_k}}$. Inductively define
\[
  \cE_{\sO_j,\eta_j}:=\chi_j|_{\wtbfK_{\bfV_j}}\otimes \dliftv_{\sO_{j+1},\sO_{j}}( \cE_{\sO_{j+1}, \eta_{j+1}}), \quad 0\leq j<k.
\]
This is an admissible orbit datum over $\sO_i$ by \cref{eq:l.adm}.



\begin{thm}\label{thmunip} For each $0\leq j\leq k$,  $\pi_{\sO_j, \eta_j}$ is  an
 irreducible, unitarizable,
  $\cO_j$-unipotent representation whose associated character
  \begin{equation}\label{eqchj}
    \Ch_{\cO_j}( \pi_{\sO_j, \eta_j})  = \cE_{\sO_j, \eta_j}.
          \end{equation}
  Moreover,
  \begin{equation}
    \Thetab_{\bfV_{j+1}, \bfV_{j}}(\pi_{\sO_{j+1},
      \eta_{j+1}})\otimes \chi_{j} =\pi_{\sO_{j},\eta_{j}} \quad\textrm{for all }\, 0\leq
    j<k-1. \label{eq:pij}
  \end{equation}
\end{thm}
\begin{proof}
  Since $\cO\in \Nil^{\mathbb p}_{\bfG}(\fpp)$, one verifies that
  \begin{itemize}
  \item $\dimo \bfV_j>0$ for $0 \leq j< k$,
  \item $\dim \bfV_{j+1}+ \dim \bfV_{j-1} > 2 \dimo \bfV_j$ for
    $1\leq j \leq k$, and
  \item
    $\pi_{\sO_j, \eta_j}$ is  $\bpp$-genuine for $0\leq j\leq k$.
      \end{itemize}
  The representation $\pi_{\cO_k,\eta_k}$ clearly satisfies all claims in the
  theorem.  % If $\dimo \bfV_k\leq 0$,
  For $j = k-1$,  $\pi_{\sO_{k-1},\eta_{k-1}}$ is the twist by $\chi_{k-1}$ of
  the theta lift of character $\chi_k$ in the stable range.
  It is known that the statement of \Cref{thmunip} holds in this case (\emph{cf}. \cite[Section~2]{Li89} and \cite[Section~1.8]{LM}).

  We now prove the theorem by induction. Assume the theorem holds for
  $j+1$ with $1\leq j+1\leq k-1$.
   Applying \Cref{intpi} and \Cref{intpi2}, we see that
  $(\pi_{\sO_{j+1}, \eta_{j+1}}, \bfV_{j})$ is in the convergent range. Thus  % the
  % integrals in \cref{intunip} are absolutely convergent and
  \cref{eq:pij} holds by Fubini's theorem.  By \cite[Theorem 1.19]{PrzInf},
  $\rU(\fgg_{\bfV_j})^{\bfG_{\bfV_j}} $ acts on $\pi_{\sO_{j}, \eta_{j}}$
  through the character $\lambda_{\cO_j}$.  By \Cref{prop:calas},
  $\pi_{\sO_{j}, \eta_{j}}$ is $\cO_{j}$-bounded and \cref{eqchj} holds.  The
  unitarity and irreducibility of $\pi_{\sO_{j}, \eta_{j}}$ follows from
  \Cref{positivity0}.

  By \Cref{defunip1}, $\pi_{\sO_j,\eta_j}$ is thus $\cO_j$-unipotent. This
  finishes the proof of the theorem.
\end{proof}



\section{Concluding remarks}
We record the following result, which is a form of automatic continuity.

\begin{prop}Retain the setting in \Cref{sec:cons}.
  The representation $ \pi_{\sO, \eta}$ is isomorphic to
  \begin{equation}\label{anatheta}
    (\omega_{\bfV_0, \bfV_1}\whotimes \omega_{\bfV_1, \bfV_2} \whotimes \cdots
    \whotimes \omega_{\bfV_{k-1},\bfV_k}\otimes \eta)_{
      \wtG_{\bfV_1}\times \wtG_{\bfV_2}\times \cdots \times  \wtG_{\bfV_k}},
  \end{equation}
  and its underlying Harish-Chandra module is isomorphic to
  \begin{equation}\label{algtheta}
    (\sY_{\bfV_0, \bfV_1} \otimes \sY_{\bfV_1, \bfV_2} \otimes \cdots
    \otimes \sY_{\bfV_{k-1},\bfV_k}\otimes \eta )_{
      (\g_{\bfV_1}\times \g_{\bfV_2}\times \cdots \times \g_{\bfV_k},
      \wtbfK_{\bfV_1}\times  \wtbfK_{\bfV_2}\times \cdots \times \wtbfK_{\bfV_k})}.
  \end{equation}
\end{prop}
\begin{proof}
  Note that the representation $ \pi_{\sO, \eta}$ is a quotient of the
  representation \eqref{anatheta}, and the underlying Harish-Chandra module of
  \eqref{anatheta} is a quotient of \eqref{algtheta}. Thus it suffices to show
  that \eqref{algtheta} is irreducible.  We prove by induction on $k$. Assume that $k\geq 1$ and
  \[
    \pi_1:= (\sY_{\bfV_1, \bfV_2} \otimes \cdots \otimes
    \sY_{\bfV_{k-1},\bfV_k}\otimes \eta_1)_{(\g_{\bfV_2}\times
      \cdots \times \g_{\bfV_k}, \widetilde{\bfK}_{\bfV_2}\times \cdots \times \widetilde{\bfK}_{\bfV_k})}
  \]
  is irreducible. Then $\pi_1$ is isomorphic to the Harish-Chandra module of
  $ \pi_{\sO_1, \eta_1}$.  The representation \eqref{algtheta} is isomorphic to
  \[
    \pi_0:= \chi_0 \otimes (\sY_{\bfV_0, \bfV_1} \otimes \pi_1)_{(\g_{\bfV_1},
      \widetilde{\bfK}_{\bfV_1})}.
  \]
  We know that  $\rU(\fgg)^{\bfG} $ acts on $\pi_{\sO, \eta}$ through the character $\lambda_{\cO}$ (\emph{cf}. \cite{PrzInf}), and by
  \Cref{cor:Cbound}, $\pi_0$ is $\cO$-bounded.  Thus every irreducible
  subquotient of $\pi_0$ is $\cO$-unipotent.  \Cref{prop:GDS.AC}
  implies that $\AC_{\cO}(\pi_0)$ is bounded by $1\cdot [\sO]$. Now
  \Cref{main} implies that $\pi_0$ must be irreducible.
\end{proof}

Finally, we remark that the Whittaker cycles (attached to $G$-orbits in $\cO\cap \mathbf i \frak g_\bR$) of all unipotent representations in  $\Piunip_{\cO}(\wtG)$ can be calculated  by using \cite[Theorem 1.1]{GZ}. These agree with the associated cycles under the Kostant-Sekiguchi correspondence.



\appendix

\section{Combinatorial parameterization of special unipotent representations}
\subsection{Parameterize of Unipotent representations}
We fix an abstract complex Cartan subgroup $\bfH_a$ and $\fhh_a$ in $\bfG$ and a
set of simple roots $\Pi_a$.  Let $\cP(\bfG)$ be the set of all Langlands
parameters of $G$-modules with character $\rho$ (i.e. the infinitesimal
character of the trivial representation). For $\gamma\in \cP(\bfG)$, let
$\cL(\gamma)$, $\cS(\gamma)$ and $\Phi_\gamma$ be the corresponding Langlands
quotient, standard module and coherent family such that
$\Phi_\gamma(\rho) = \cL(\gamma)$. Let $\cM(\bfG)$ be the span of $\cL(\gamma)$.
Let $\set{\bB}$ be the set of all blocks. Then $\cP(\bfG) = \bigsqcup_\cB \cB$.
The Weyl group $W = W(G)$ acts on $\cM(\bfG)$ by coherent continuation.  Let
$\cM_{\cB}$ be the submodule of $\cM(\bfG)$ spand by $\gamma\in\cB$, then
\[
  \cM(\bfG) = \bigoplus_\cB \cM_{\cB}
\]
Let $\tau(\gamma)\subset \Pi_a$ be the $\tau$-invariant of $\gamma$.

Let $\ckcO$ be even orbit. $\lambda= \half \ckhh$.  Define
\[
  S(\lambda) = \set{\alpha\in \Pi_a| \inn{\alpha}{\lambda}=0}.
\]
Let $\cP_{\lambda}(\bfG)$ be the set of all Langlands parameters with
infinitesimal character $\lambda$. Let $T_{\lambda,\rho}$ be the translation
functor.  Let
\[
  \cB(S) = \set{\gamma\in \cB|S\cap \tau(\gamma)=\emptyset}
\]
and
\[
  \cP(\bfG,S) = \bigsqcup_{\cB} \cB(S)
\]


Then
\[
  \begin{tikzcd}[row sep=0em]
    \cP(\bfG,S) \ar[r] & \cP_{\lambda}(\bfG)\\
    \gamma \ar[r, maps to]& T_{\lambda, \rho}(\gamma)
  \end{tikzcd}
\]

Let $\cO$ be a complex nilpotent orbit in $\fgg$.  Let
\[
  \cB(S,\cO) = \set{\gamma\in \cB(S)|\AVC(\cL(\gamma))\subset \bcO}
\]

Let
\[
  \begin{aligned}
    m_S(\sigma) &= [\sigma: \Ind_{W(S)}^{W}\bfone]\\
    m_\cB(\sigma)& = [\sigma: \cM_\cB]
  \end{aligned}
\]

Barbasch \cite[Theorem~9.1]{B10} established the following theorem.
\begin{thm}
  \[
    |\cB(S,\cO)| = \sum_{\sigma} m_\cB(\sigma)m_S(\sigma)
  \]
  Here $\sigma\times \sigma$ running over the $W\times W$ appears in the double
  cell $\cC(\cO)$.
\end{thm}
\begin{proof}
  We need to take the graded module of $\cM(\bfG)$ with respect to the
  $\LRleq$. By abuse of notation, we identify the basis $\cP(\bfG)$ with its
  image in the graded module.  Note that $S\cap \tau(\lambda)=\emptyset$ if and
  only if $W(S)$ acts on $\gamma$ trivially by \cite[Lemma~14.7]{V4}.  On the
  other hand, by \cite[Theorem~14.10, and page 58]{V4},
  $\AVC(\cL(\gamma))\subset \bcO$ only if $\gamma$ generate a $W$-module in the
  double cell of $\cO$.
\end{proof}

Now assume $S=S(\lambda)$. By \cite[Cor~5.30 b) and c)]{BVUni},
$[\sigma: \Ind_{W(S)}^{W}\bfone]=[\bfone|_{W(S)}:\sigma]\leq 1$.

\subsection{Combinatorics of Weyl group representations}
The irreducible representations of $S_n$ are parameterized by Young diagrams.
We use the notation that the trivial representation corresponds to a row and the
sign representation corresponds to a column.
\[
  triv \leftrightarrow \ytableaushort{n \ b o x e s} \quad \sgn \leftrightarrow
  \ytableaushort{n,\ ,b,o,x,e,s}
\]
\trivial{ This notation coincide with the Springer correspondence, where a row
  of boxes represents the regular nilpotent orbit and the corresponding
  representation is the trivial representation.  The trivial orbit yeilds the
  sign representation.  }

Under the above paramterization, $\tau\mapsto \tau\otimes \sgn$ is described by
the transpose of Young diagram. The branching rule is given by
Littlewoods-Richardson.  Let $\cK = \bigoplus_n \Groth(S_n)$ be the graded ring
of the Grothendieck groups of $S_n$.  This yeilds well defined ring structure on
the graded algebra
\[
  \mu \nu :=\Ind_{S_{|\mu|}\times S_{|\nu|}}^{S_{|\mu|+|\nu|}}\mu\otimes \nu.
\]

Notation, we will use $[r_1, r_2, \cdots, r_k]$ or $(c_1,c_2, \cdots, c_k)$
denote the Young diagram, where $\set{r_i}$ denote the lengthes of its rows and
$\set{c_i}$ denote the lengthes of its columns.

Let $W_n$ denote the Weyl group of type BC: $W_n = S_n \ltimes \set{\pm 1}^n$.
Now $\Irr(W_n)$ is paramterized by a pair of Young diagram, we use the notation
$\mu\times \nu$.

As the tensor algebra, $\bigoplus_n \Groth(W_n)\cong \cK\otimes \cK$ via
$\mu\times \nu \mapsto \mu \otimes \nu$.

The branching rule is given by:
$(\mu_1\times \nu_1)(\mu_2\times \nu_2) = (\mu_1\mu_2)\times (\nu_1 \nu_2)$.
The sgn repersentation of $W_n$ is parameterized by $\emptyset\times (n)$.  From
the definitioin of the identification of bipartition with $\Irr(W_n)$, we also
have
\[
  (\mu\times \nu) \otimes \sgn = \nu^t\times \mu^t.
\]

We also will use the following branching formula:
\[
  \Ind_{S_n}^{W_n} \triv = \sum_{\substack{a,b,\\ a+b=n}} [a]\times [b],
\]
and
\begin{equation}\label{eq:SW2}
  \Ind_{S_n}^{W_n} \sgn = \sum_{\substack{a,b,\\ a+b=n}}
  (a)\times (b).
\end{equation}
\trivial{ Sketch of the proof of the first formula, the dimension of LHS is
  $n!2^n/n! = 2^n$.  On the other hand, by Mackey theory,
  $[LHS:\Ind_{W_a\times W_b}^{W_n} \triv \otimes \chi ] \geq 1$ since
  $S_n\cap W_a\times W_b = S_a\times S_b$.  Therefore, $LHS\supset RHS$.  On the
  other hand, dimension of RHS is $\sum_{a} n!/a!b! = 2^n$.  This finished the
  proof.  The proof of the second formula is similar. One also can obtain it by
  tensoring with $\sgn$ of the first formula.  }

\subsubsection{Coherent continuation representations}

{\color{red} TBA}


\section{A few geometric facts}
%\section{Some Geometries}
\def\dbM{\breve{M}}
\def\dbMM{\breve{MM}}
\def\dbX{\breve{X}}
\def\dbfpp{\breve{\fpp}}
\def\ZdbX{\cZ_{\dbX}}
\def\aV{\acute{V}}

\subsection{Geometry of moment maps}\label{sec:GM}
In this section, let $(\bfV,\bfV')$ be a rational dual
pair. % such that $\dim \bfV' \leq \dim \bfV$.
We use the notation of \Cref{sec:descent}.
Write
 $\dbfpp := \fpp\oplus \fpp'$ and
\[
\xymatrix{
\dbM := M\times M' \colon \cX \ar[r]& \dbfpp
= \fpp\times \fpp'.
}
\]


%For $w\in \cX$, let $\dbX := (X,X') := (M(w), M'(w))$.

% For a vector space $\bfA$ with a reductive algebriac group $\bfE$ action, let
% $\bfA//\bfE$ denote its affine quotient.

When there is a morphism $f\colon A\rightarrow B$ between smooth
algebraic varieties, let $\rdd f_a\colon \rT_aA
\rightarrow \rT_{f(a)}B$ denote the tangent map at a closed point $a\in A$, where
$\rT_aA$ and $\rT_{f(a)} B$ are the tangent spaces. For a
sub-scheme $S$ of $B$, let $A\times_fS$ denote the scheme
theoretical inverse image of $S$ under $f$, which is a subscheme of $A$.
Along the proof, we will use the Jacobian criterion for
regularity in various places (see \cite[Theorem~2.19]{LiuAG}).


\trivial[h]{
\subsubsection{Fiber of the moment map}\label{sec:F.M}
% In this section, we assume that $(\bfV,\bfV')$ is a rational dual pair and
% $\colon \cX\longrightarrow \fpp$ is the moment map.

We will study the fiber $M^{-1}(X)$ for an element $X\in \Im(M)$. %, using Luna's slice theory.

From the general theory of affine quotient, we know that
  $M^{-1}(X)$ contains a unique closed $\bfK'$-orbit.
Set
\[
\cX_r = \Set{w\in \cX\subset \Hom(\bfV,\bfV')| \rank w\leq r}.
\]

The following lemma is a easy exercise in linear algebra, which we leave to the reader.
\begin{lem}\label{lem:F.cl}
Let $X\in\Im(\MMP)$. Suppose $\rank X = r$.
Then $\cX_r\cap \MMP^{-1}(X)$ is the unique closed $\bfK'$-orbit in $\MMP^{-1}(X)$.
Moreover, for any $w\in \cX_r\cap \MMP^{-1}(X)$ its image is a non-degenerate
$L'$-invariant subspace of $\bfV'$. \qed
\end{lem}

\begin{proof}
  % Since the general moment maps are build from those of compact dual pairs (where
  % $G' = K'$).
  Clearly $\bfW_r\cap \MMP^{-1}(X)$ is closed. Suppose it is non-empty then it
  would be a single $\bfK'$-orbit by Witt's theorem \cite[3.7.1]{Howe95} and the
  explicit formula of moment maps (see for example \cite[Appendix A]{LM}) since
  $\Ker w_1 = \Ker X = \Ker w_2$ for any two $w_1, w_2 \in \bfW_r \cap \MMP^{-1}(X)$.

  Now we show that $\cX_r\cap \MMP^{-1}(X)$ is non-empty.

  Take a $L$-invariant decomposition $\bfV = \bfV_+\oplus \bfV_-\oplus \bfV_1 \oplus \bfV_0$,
  such that
  \begin{enumIL}
  \item
    $\Ker X = \bfV_+\oplus \bfV_1$;
  \item $\Im X=(\Ker X)^\perp = \bfV_0\oplus \bfV_+$;
  \item $\bfV_0$, $\bfV_1$ and $\bfV_+\oplus \bfV_-$ are non-degenerate subspaces.
  \end{enumIL}
  \trivial[h]{By $\inn{Xv_1}{v_2} = \inn{v_1}{-Xv_2}=0$ for $v_1\in V$ and
    $v_2\in \Ker X$, we see $\Im X \subseteq (\Ker X)^\perp$. The equality
    follows from dimension counting.}
  \begin{claim*}
    \begin{enumC}
    \item $w|_{\bfV_0\oplus \bfV_-}$ is injective, its image
      $\bfV'_0 := w(\bfV_0\oplus \bfV_-)$ is a non-generate subspace of $\bfV'$.
    \item
      $\bfV'_+ := w|_{\bfV_1\oplus \bfV_+}$ is in the radical of $\Im w$.
    \item We have $w \bfV = \bfV'_0\oplus \bfV'_+$ and
      $\dim \bfV'_0 = \rank X$.
    \item $\bfV'_0$ and $\bfV'_+$ are $L'$-invariant.
    \end{enumC}
  \end{claim*}
  \begin{proof}
    Note that $X|_{\bfV_0\oplus \bfV_-}\colon \bfV_0\oplus \bfV_- \rightarrow \bfV_0\oplus
    \bfV_+$ is an isomorphism.
    For any $0\neq v_1\in \bfV_0\oplus
    \bfV_-$, there exits $v_2\in \bfV_0\oplus \bfV_-$ such that $0\neq
    \inn{v_1}{X v_2} = \innp{w v_1}{w
      v_2}$. In particular,  $w^\mstar v_1\neq 0$.

    On the other hand,  $v_1\in \bfV_1\oplus \bfV_+ = \Ker X$, $v\in \bfV$, we have
    $\innp{w v}{w v_1} =\inn{v}{Xv} = 0$.
    The rest is clear.
  \end{proof}
  Now take a $L'$-invariant decomposition $\bfV' = \bfV'_0 \oplus (\bfV'_+
  \oplus \bfV'_-)$ and write
  $w = (w_0, w_+) \in \Hom(\bfV,\bfV'_0)\oplus \Hom(\bfV,\bfV'_+)$.
  It is easy to check that $w_0\in \cX_r\cap \MMP^{-1}(X)$ and the rest part of
  the lemma is clear.
\trivial{
 Note that
  $w^\mstar = w_0^\mstar + w_+^\mstar$ with $w_0^\mstar \in \Hom(\bfV'_0,\bfV)$ and
  $w_+^\mstar\in \Hom(\bfV'_-,\bfV)$.
  Now $\rank w_0 = \dim \bfV'_0 = \rank X$ and
  $\MMP(w_0) = w_0^\mstar w_0  = (w_0^\mstar + w_+^\mstar)(w_0+ w_+) = \MMP(w)
  = \Gamma$.
  Hence we have constructed an element $w_0\in \cX_s\cap \MMP^{-1}(X)$.
}
\end{proof}
}

\trivial[h]{
Fix $w\in \cX_r\cap \MMP^{-1}(X)$. By \Cref{lem:F.cl}
 we have an orthogonal decomposition
\[%\begin{equation}\label{eq:GD.dV}
  \bfV' = \bfV'_0\oplus
  \bfV'_1  \quad \text{with}\quad \bfV'_1 := w \bfV.
\]%\end{equation}

Now the stabilizer $\bfK'_w$ of $w$ in $\bfK'$ is naturally identified with
% \bfK'_0 :=
$\bfG_{\bfV'_0}^{L'}$.

  \def\ssfkkp{{}^{\boxslash}\fkk'}
  \def\sscX{{}^\boxslash\cX}
  \def\oocX{{}^1\cX}
  \def\zzcX{{}^0\cX}
  \def\ozcX{{}^{10}\cX}
  \def\zocX{{}^{01}\cX}
  \def\iicX{{}^{i}\cX}

  Fix a $L$-invariant decomposition $\bfV = \bfV_1\oplus \bfV_0$ where
  $\bfV_0 := \Ker X$ and $\bfV_1$ is a complement of $\bfV_0$. We have a decomposition
  $\cX = \ozcX \oplus \zocX \oplus \oocX\oplus \zzcX$ where
  \begin{enumI}
  \item
    $\ozcX = \cX \cap \Hom(\bfV_1,\bfV'_0)$ and
    $\zocX = \cX \cap \Hom(\bfV_0,\bfV'_1)$,
  \item $\iicX = \cX \cap \Hom(\bfV_i,\bfV'_i)$ for $i=0,1$.
  \end{enumI}

  Let
  $\ssfkkp = \fkk' \cap (\Hom(\bfV'_1, \bfV'_0)\oplus \Hom(\bfV'_0,\bfV'_1))$.  Since
  $\bfV'_1\perp \bfV'_0$, % $\ssfkkp \cong \Hom(\bfV'_1, \bfV'_0)\cap \fkk$ and
  $\ssfkkp \xrightarrow{\cdot w} \Hom(\bfV_1,\bfV')\cap \cX =: \ozcX$.  Now the
  tangent space of the orbit $\bfK'w$ at $w$ is
  $\rT_w(\bfK'w) = \fkk'\cdot w = T_1 \oplus \ozcX$ where $T_1 \subset \oocX$.  Let
  $N_1$ be any complement of $T_1 \subset \oocX$.  Therefore,
  \[
    N:=N_1 \oplus \zocX \oplus \zzcX
  \]
  is a $\bfK'_w$-invariant complement of
  $T_w(\bfK'w)$ in $\cX$.
  As $\bfK'_w$-module, $N$ is the direct sum of trivial
  modules with $\zzcX$. Therefore, its null cone $\fN_w$ is precisely the null cone
  of $\zzcX$ under $\bfK'_w$.

  By \cite[Section~6.3]{PV}, we have the following diagram where the
  horizontal morphisms are \'etale and the vertical morphisms are affine
  quotients.
  \[
    \xymatrix@C=3em{
      \bfK' \times_{\bfK'_w} N \ar[r] \ar[d]_<>(.5){\circnuma{1}}& \cX \ar[d]^{\MMP}\\
     \makebox[0em][r]{$N//\bfK'_w =\;$}\bfK' \times_{\bfK'_w} N//\bfK' \ar[r] &  \Im(\MMP)
     }
  \]
  Fix a slice $S$ at the identity of the right $\bfK'_w$-action on $\bfK'$.
  Now the morphism $\circnuma{1}$   \'etale locally
  looks like
  \[%\begin{equation}\label{eq:M.local}
    S\times N_1\times \zocX\times \zzcX \longrightarrow  N_1\times \zocX\times
    (\zzcX//\bfK'_w).
  \]%\end{equation}

  The fiber $M^{-1}(X)$ is equivariantly isomorphic to
  $\bfK'\times_{\bfK'_w}\fN_w$ (\emph{cf}.  \cite[Theorem~6.6]{PV}).


\trivial[h]{
  \medskip


\begin{defn}
  For any $L$-invariant subspace $\bfA \subset \bfV$.  Define
  $\ssign\bfA = (\dim \bfA^{L,1}, \dim \bfA^{L,-1})$ (resp.
$(\dim \bfA^{L,i}, \dim \bfA^{L,-i})$) if $\dotepsilon=1$ (resp.
$\dotepsilon = -1$).
\end{defn}
}
}


\subsubsection{Scheme theoretical results on descents}\label{sec:Sdes}

% Assume $\dim \bfV' \leq \dim \bfV$.

\begin{lem}[{\cf \cite[Lemma~13 and Lemma 14]{Ohta}}]\label{lem:DS.sh}
Suppose $\sO'\in \Nil_{\bfK'}(\fpp')$ is the descent of $\sO\in \Nil_\bfK(\fpp)$.
Fix $X\in \sO$ and
% \[
% (\MMP(w),\MMP'(w)) = (X,X')\in \sO\times \sO'.
% \]
let
\[
\ZX := \cX\times_{M}\set{X}
\]
be the scheme theoretical
inverse image of $X$ under the moment map $M: \CX\rightarrow \fpp$. Then
\begin{enumT}
\item\label{it:DS.G1} $\ZX$ is smooth (and hence reduced);
\item\label{it:DS.G3}   $\ZX$ is
  a single free $\bfK'$-orbit in $\Xo$;
\item\label{it:DS.G2}$M'(\ZX) = \sO'$ and $\ZX = \cX\times_{\dbM}( \set{X} \times\bsOp)$.
\end{enumT}
\end{lem}
 \begin{proof}
  Fix a point  $w\in \cX^\circ$ such that $M(w)=X$. It is elementary to see that
  \[
  M^{-1}(X)=\bfK'\cdot w
  \]
  is a single $\bfK'$-orbit. This orbit is clearly Zariski closed and the
  stabilizer $\Stab_{\bfK'}(w)$ of $w$ under the $\bfK'$-action is trivial. This
  proves part \cref{it:DS.G3} and the first assertion of part \cref{it:DS.G2}.

  We identify the tangent space $\rT_w\cX$ with $\cX$.  Let $N\subset \cX$
be a complement of $\rT_w (\bfK'\cdot w)$ in $\rT_w \cX$.
By \cite[Section~6.3]{PV}, there is an affine open subvariety $N^\circ$ of $N$ containing $0$ such that  the diagram
%and the vertical morphisms $\circnuma{1}$ is the projection,
\[%\label{dg:FR}
    \xymatrix@C=6em{
      \bfK' \times N^\circ \ar[r]^<>(.5){(k',n)\mapsto k'\cdot (w+n)} \ar[d]_<>(.5){\text{projection}}& \cX \ar[d]^{\MMP}\\
    N^\circ \ar[r]^<>(.5){n\mapsto M(w+n)}&  \MMP(\cX)
     }
\]
is  Cartesian and the
horizontal morphisms are \'etale. Therefore the scheme $\cX\times_M\set{X}$ is a smooth algebraic variety. This proves part (i), and the second assertion of (iii) then easily follows.
\end{proof}



%In this subsection, we assume that $\dim \bfV \geq \dim \bfV'$.
\begin{remark} Retain the setting of \Cref{lem:DS.sh}.
 Suppose $w\in \Xo$ realizes the descent from $X$ to  $X' \in \fpp'$. Let $\dbX :=
  (X,X')\in \fpp\oplus \fpp'$ and
  $\bfK'_{X'}$ be the stabilizer of $X'$ under the $\bfK'$-action.
  By the $\bfK'$-equivariance,  the map $\ZX\rightarrow \sO'$ is  a
  smooth morphism  between smooth schemes.
  Hence the scheme theoretical fibre
  $$\ZdbX := \cX\times_{\dbM}\set{\dbX} = \ZX\times_{M'|_{\ZX}}\set{X'}$$ is
  smooth and equals the orbit $\bfK'_{X'}\cdot w$.
% Moreover we have an exact
%   sequence
% \[
% \xymatrix{
% 0 \ar[r]& \rT_w\ZdbX\ar@{^(->}[r] & \rT_{w}\ZX \ar[r]^{\rdd
% M'_w} & \rT_{X'}\fpp'.
% }
% \]
% As a consequence of $\cX \rightarrow M(\cX)$ is smooth at $w$, we have the
% following exact sequence:
% \[
% \xymatrix@C=3em{
% 0 \ar[r] & \rT_w \ZX \ar@{^(->}[r] & \rT_{w} \cX  \ar[r]^{\rdd M_w}& \rT_{X}\fpp.
% }
% \]
% where $\circnuma{1}$ is $X' \mapsto X'\circ w$ and $\circnuma{2}$ is $b\mapsto
% w^\mstar b
% + b^\mstar w$.
%In other words, we will have an exact sequence
Consequently,  we have an exact sequence by the Jacobian criterion for
regularity:
\begin{equation}\label{eq:DS.T1}
\xymatrix@C=4em{
0 \ar[r] & \rT_w\ZdbX \ar[r] & \rT_w\cX \ar[r]^<>(.5){\rdd \dbM_w} & \rT_X\fpp
\oplus \rT_{X'}\fpp'.
%\\
%         & \fkk_{X'} \ar[r]\ar@{=}[u] & \cX \ar[r]\ar@{=}[u] & \fpp\oplus \fpp' \ar@{=}[u]
}
\end{equation}
\end{remark}



\begin{lem}\label{lem:DS.U}
Retain the setup in \Cref{lem:DS.sh}. Let
\[
  U:= \fpp \setminus((\bcO\cap \fpp) \setminus \sO)  % \quad \text{ and } \quad
\]
and   $\cZ_{U,\bsOp} := \cX\times_{\dbM}(U\times \bsOp)$.
Then
\begin{enumT}
\item \label{it:DS.U1} $U$ is a Zariski open subset of $\fpp$ such that
  $U\cap M(M'^{-1}(\bsOp)) = \sO$;
\item \label{it:DS.U2} $\cZ_{U,\bsOp}$ is smooth and it is a single
  $\bfK\times \bfK'$-orbit.
\end{enumT}
\end{lem}
\begin{proof}
% Since to see that
% $M^{-1}(U) = \cX^\circ$. %  = M(\cX) \cap \set{X\in \fpp|\rank X\geq \dim \bfV}$ is Zariski open
% % dense in $M(\cX)$.
% Let $U =  \Set{X\in\fpp|\rank X \geq \dim \bfV}$.
Part~\cref{it:DS.U1} is clear by \cref{eq:def.LsO22}. It is also clear that the
underlying set of $\cZ_{U, \bsOp}$ is a single $\bfK\times \bfK'$-orbit by \Cref{lem:DS.sh}~\cref{it:DS.G2}.

Note that $M'|_{\cX^\circ}$ is smooth because $\rdd M'_w \colon \rT_w\cX^\circ \longrightarrow
\rT_{M'(w)}\fpp'$ is surjective for each $w\in
\cX^\circ$ (\emph{cf}. \cite[Proposition~10.4]{HS}). Since  smooth morphisms are stable under base changes and compositions, the scheme  $\cX^\circ\times_{M'}\sO'$ is a smooth algebraic variety. Also note that $\cZ_{U,\bsOp}$ is an open subscheme of  $\cX^\circ\times_{M'}\sO'$. Thus it is smooth.
\end{proof}

%To prove part~\cref{it:DS.U2}, n
%Since $\cZ_U := \cX
%\times_M{U}$ is the open subscheme  contained in $\cX^\circ \subset\cX$.
%Then the morphism
%$\cZ_{U,\bsOp}\rightarrow \bsOp$ is smooth and  the fiber $\cZ_{U, X''}:=
%\cX \times_{\dbM}(U\times \set{X''})$ is smooth for each
%$X''\in \sO'$. Also note that $\cZ_{U,X''}$ is empty if $X''\notin
%\sO'$. Hence,
%\cite[Proposition~11.3.13]{EGAIV3} yields that $\cZ_{U,\bsOp}$ is reduced.
%The smoothness of $\cZ_{U,\bsOp}$ follows since it is a $\bfK\times
%\bfK'$-orbit.

 \trivial[h]{The surjectivity of $\rdd M'_w$ follows form the claim for $\rdd \bfM'_w\colon \rT_w
  \bfW\rightarrow \rT_{M'(w)}\fgg'$. Note that
  $w$ is surjective. Hence $\Hom(\bfV,\bfV') \rightarrow \Hom(\bfV',\bfV'):
  b\mapsto w b^\mstar$ is surjective. But $\Hom(\bfV',\bfV')\rightarrow \fgg':
  A\mapsto \half(A^*+A)$ is also surjective. This prove
  $\rdd\bfM'_w$ is surjective.

  $\cZ_{U,\bsOp}\rightarrow \bsOp$ is smooth since it is a base change of the
  smooth map $\cZ_{U}\rightarrow \fpp'$. Same reason, $\cZ_{U,X''}$ is smooth.  }


\begin{remark}
  Suppose $w\in \Xo$ realizes the descent from $X\in \sO$ to
  $X' \in \sO'\subset \fpp'$.  By the proof of \Cref{lem:DS.U},
  \[
  \cZ_{U,X'} :=\cX\times_{\dbM}(U\times\{X'\})= \bfK\bfK'_{X'}\cdot w
  \]
  is smooth. Similar to the remark of \Cref{lem:DS.sh}, this
   yields % Since $M'^{-1}(X')\cap \cX^\circ$
  % is a single orbit $\bfK\times \bfK'_{X'}$-orbit. The smoothness at $w$ yields
  an exact sequence:
\begin{equation}\label{eq:ES.UD}
\xymatrix@C=7em{
\fkk\oplus \fkk'_{X'} \ar[r]_<>(.5){(A,A') \mapsto A'w - wA}& \cX\ar[r]^{\rdd
  M'_w}_<>(.5){b\mapsto b w^\mstar +wb^\mstar} & \fpp'.\\
}
\end{equation}
\end{remark}



\subsubsection{Scheme theoretical results on generalized descents of good orbits}
%In this subsection, we still assume that $\dim \bfV' \leq \dim \bfV$.

%The following lemma is key to the proof of \cref{prop:GDS.AC}.

\begin{lem}\label{lem:GDS.sh}
  Suppose $\sO\in \Nil_{\bfK}(\fpp)$ is good for generalized descent
  (see \Cref{def:GD.good}) and
  $\sO' = \gDD_{\bfV,\bfV'}(\sO)\in \Nil_{\bfK'}(\fpp')$. Fix $X\in \sO$ and
  let $\ZX := \cX\times_{\dbM}(\set{X}\times\bsOp)$. Then
\begin{enumT}
\item\label{it:GDS.sh.2} $\ZX$ is smooth;
\item\label{it:GDS.sh.1} $\ZX$ is a single $\bfK'$-orbit;
\item\label{it:GDS.sh.3} $\ZX$ is contained in $\Xg$ and  $M'(\ZX) = \sO'$.

%\item\label{it:GDS.sh.3} $\cX\times_{\dbM}(U\times\bsOp)$ is reduced and smooth, and is a single $\bfK\times \bfK'$-orbit.
\end{enumT}
\end{lem}
\begin{proof} Part~\cref{it:GDS.sh.1} follows from \cite[Table~4]{DKP2}. Part~\cref{it:GDS.sh.3} follows from part~\cref{it:GDS.sh.1}. By the generic smoothness, in order to prove
  part~\cref{it:GDS.sh.2}, it suffices to show that $\ZX$ is reduced.
  % We may assume the complex group case first.
  % Fix a $w\in \ZX$ and let $X' := \MMP'(w)$.
  Note that the $\bfK'$-equivariant morphism $\xymatrix{\ZX\ar[r]^{M'}&\sO'}$ is
  flat by generic flatness \cite[Th\'eor\`eme~6.9.1]{EGAIV2}.
  % \trivial[h]{
  % The statement of generic flatness is:
  % \begin{thm*}
  %   Suppose $Y$ is a locally noetherian integral scheme, $u\colon X\rightarrow
  %   Y$ is a morphism of finite type and $\sF$ is a coherent $\sO_X$-module.
  %   Then there exist a non-empty open subscheme $U$ of $Y$ such that
  %   $\sF|_{u^{-1}(U)}$ is flat over $U$.
  % \end{thm*}
  % WLOG, applying the theorem to an irreducible component of $\sO'$ with
  % $\sF = \sO_X$ get the claim.  }
  By \cite[Proposition~11.3.13]{EGAIV3}, to show that $\ZX$ is reduced, it
  suffices to show that
  $$\ZdbX := \ZZ_X \times_{M'|_{\ZX}}\set{X'} = \cX \times_{\dbM}\set{\dbX}$$
  is reduced, where $X'\in \sO'$ and $\dbX:=(X,X')$.
  Let $w\in\ZdbX$ be a closed point. Then $\bfK'\cdot w$ is the underlying set of $\ZX$, and
  $Z_{\dbX}:=\bfK'_{X'}\cdot w$ is the underlying set of
  $\ZdbX$.  By
  the Jacobian criterion for regularity, to complete the proof of the lemma, it remains to prove the following claim.

  \begin{claim*}
    The following sequence is exact:
    \[%\begin{equation} \label{eq:GDS.T1}
        \xymatrix@C=4em{ 0 \ar[r] & \rT_w
        Z_{\dbX} \ar[r] & \rT_w\cX \ar[r]^<>(.5){\rdd \dbM} &
        \rT_{X}{\fpp}\oplus \rT_{X'}{\fpp'}. }
    \]%\end{equation}
  \end{claim*}

We prove the above claim in what follows.
    Identify $\rT_w\cX$, $\rT_X\fpp$ and $\rT_{X'}\fpp'$ with $\cX,\fpp$ and
    $\fpp'$ respectively and view $\rT_{w} Z_{\dbX}$ as a quotient of
    $\fkk'_{X'}$. It suffices to show that the following sequence is exact:
    \begin{equation}\label{eq:GDS.T2}
      \xymatrix@R=0em@C=9em{
        \fkk'_{X'} \ar[r]_<>(.5){A' \mapsto A'w}& \cX\ar[r]^<>(.5){\rdd \dbM_{w}}_<>(.5){ b\mapsto (b^\mstar w+w^\mstar b, b w^\mstar + w b^\mstar) }&
        \makebox[0em][l]{$\fpp\oplus \fpp' =\dbfpp$.}\\
      }
    \end{equation}

    In fact, we will show that the following sequence
    \begin{equation}\label{eq:GDS.T3}
      \xymatrix@C=4em{
        \fgg'_{X'} \ar[r]& \bfW \ar[r] & \fgg\oplus \fgg'
      }
    \end{equation}
    is exact, where $\fgg'_{X'}$ is the Lie algebra of the stabilizer group $\Stab_{\bfG'}(X')$ and
  the  arrows are defined by the same formulas in \cref{eq:GDS.T2}. Then the
    exactness of \cref{eq:GDS.T2} will follow since \cref{eq:GDS.T3} is compatible
    with the natural $(L,L')$-actions. %Cartan involutions.
    % \trivial{ Note that there is a $\bZ/4\bZ$-grading on these spaces;
    % $\fkk'_{X'}$(resp. $\cX$ and $\dbfpp$) is the grade $0$(resp. $1$ and $2$)
    % part of $\fgg'_{X'}$(resp. $W$ and $\fgg\oplus \fgg'$). Moreover, each
    % arrow raise the grading by $1$.  }

    % We retain the notation in \Cref{sec:F.M} and the decomposition
    % \cref{eq:GD.dV} and
    We now prove the exactness of \cref{eq:GDS.T3}.
    Let $\bfV'_1:=w\bfV$ and $\bfV'_2$ be the orthogonal complement of
    $\bfV'_1$ so that \[ \bfV' = \bfV'_1\oplus
    \bfV'_2.
    \]
    Let $\bfW_i := \Hom(\bfV,\bfV'_i)$ and $\fgg'_i := \fgg_{\bfV'_i}$ for
    $i=1,2$. Let
    $*\colon \Hom(\bfV'_1,\bfV'_2) \rightarrow \Hom(\bfV'_2,\bfV'_1)$ denote the
    adjoint map.  We have $\bfW =\bfW_1\oplus \bfW_2$ and $\fgg' = \fgg'_{1}\oplus \fgg'_2 \oplus \fgg'^{\boxslash}$, where
    \[ \fgg^{\boxslash}:= \Set{\begin{pmatrix}
          0 & -E^*\\
          E & 0
        \end{pmatrix}|E\in \Hom(\bfV'_1,\bfV'_2)}.
    \]
    Now $w$ and $X'$ are naturally identified with an element
    $w_1$ in $\bfW_1$
    and an element $X_1'$ in  $\fgg'_1$, respectively.  We have $\fgg'_{X'} = \fgg'_{1,X'_1}\oplus \fgg'_2 \oplus \fgg'^{\boxslash}_{X'_1}$, where %$\fgg'_{1,X'_1}:= \set{T'_1\in \fgg'_1| [T'_1,X'_1]=0}$ and
    % \begin{equation}\label{eq:fggslash}
    \[ \fgg^{\boxslash}_{X'_1} = \Set{\begin{pmatrix}
          0 & -E^*\\
          E & 0
        \end{pmatrix}|E\in \Hom(\bfV'_1,\bfV'_2),\ E X'_1 = 0}.
    \]

    Now maps in \cref{eq:GDS.T3} have the following forms respectively:
    \begin{align*}
      \fgg'_{X'}\ni  A' =  (A'_1,A'_2,{\tiny \begin{pmatrix}0 &
          -E^*\\E &0\end{pmatrix}}) \mapsto &\; A'w = (A'_1 w_1, E w_1)\in \bfW  \qquad \text{and}\\
      \bfW \ni (b_1,b_2) \mapsto & \left(b_1^\mstar w_1 + w_1^\mstar b_1, \begin{pmatrix}
          b_1 w_1^\mstar + w_1b_1^\mstar & w_1 b_2^\mstar\\
          b_2 w_1^\mstar & 0
        \end{pmatrix}\right)\in \fgg\oplus \fgg'.
    \end{align*}
    \trivial[h]{

      \[
        \begin{pmatrix}
          b_1\\
          b_0
        \end{pmatrix}
        \begin{pmatrix}
          w_1^\mstar & 0
        \end{pmatrix}
        +
        \begin{pmatrix}
          w_1\\
          0
        \end{pmatrix}
        \begin{pmatrix}
          b_1^\mstar & b_0^\mstar
        \end{pmatrix}
        = \begin{pmatrix}
          b_1 w_1^\mstar + w_1b_1^\mstar & w_1 b_0^\mstar\\
          b_0 w_1^\mstar & 0
        \end{pmatrix}
      \]
    } Applying \cref{eq:DS.T1} to the complex dual pair $(\bfV, \bfV'_1)$, we see that the
    sequence
    \[
      \xymatrix@C=11em{ \fgg'_{1,X'_1}\ar[r]^<>(.5){A'_1 \mapsto A'_1 w_1}& \bfW_1 \ar[r]^<>(.5){b_1\mapsto (b_1^\mstar w_1 + w_1^\mstar b_1 ,b_1w_1^\mstar+w_1b_1^\mstar)}& \fgg \oplus \fgg'_1
      }
    \]
    is exact. The task is then reduced to show that the following
    sequence is exact:
    \begin{equation}\label{eq:GDS.T5}
      \xymatrix@C=6em{ \fgg^{\boxslash}_{X'_1} \ar[r]^<>(.5){{\tiny \begin{pmatrix}
              0 & -E^*\\
              E & 0
            \end{pmatrix}}\mapsto Ew_1}_<>(.5){\circnuma{1}} & \bfW_2
        \ar[r]^<>(.5){b_2\mapsto b_2 w_1^\mstar}_<>(.5){\circnuma{2}} &
        \Hom(\bfV'_1, \bfV'_2).}
    \end{equation}
    Note that $w_1$ is a surjection, hence $\circnuma{1}$ is an injection. We
    have
    \[
      \dim \fgg^{\boxslash}_{X'_1} = \dim\bfV'_2 \cdot \dim \Ker(X'_1)
      \]
      and
      \[
      \dim \Ker(\circnuma{2}) = \dim \bfV'_2 \cdot (\dim \bfV - \dim \Im(w_1))
                                = \dim \bfV'_2 \cdot (\dim \bfV - \dim \bfV'_1).
    \]
    Note that $\dim \Ker(X'_1) = c_{1}$, and $\dim \bfV - \dim \bfV'_1=c_{0}$. Since we are in the setting of good generalized descent (\Cref{def:GD.good}), we have $c_0=c_1$. Now the
    exactness of \cref{eq:GDS.T5} follows by dimension counting.
  \end{proof}

  % For any affine scheme $\bfX$, let $\rmm_\bfX(x)$ denote the maximal ideal of
  % $\bC[\bfX]$ corresponding to a closed point $x$ and let
  % $\Omega_\bfX(x) = \rmm_\bfX(x)/(\rmm_\bfX(x))^2$ denote the stalk of the sheaf
  % of differential at $x$. % Suppose that the underlying set of $\bfX$ is a
  % % $\bC$-manifold, let $\rT_x\bfX$ denote the tangent space of this manifold at
  % % $x$.

  % Note that $\Omega_{\ZdbX}(x)$ is a quotient of
  % $\Omega_{W}(w)/M^*(m_{\dbfpp}(\dbX)) =
  % \rT^*_w\cX/\rdd\dbM_w^*(\rT^*_{\dbX}\dbfpp)$, where $\rT^*$ and
  % $\rdd \dbM^*_w$ represent cotangent spaces and cotangent map respectively.
  % Note that \cref{eq:GDS.T1} implies
  % \[
  %   \dim \rT_w Z_{\dbX} \leq \dim_\bC \Omega_{\ZdbX}(x) \leq \dim_\bC \rT^*_w\cX
  %   /\rdd\dbM_w^*(\rT^*_{\dbX}\dbfpp) = \dim \rT_wZ_{\dbX}.
  % \]
  % Therefore all equalities in the above formula hold.  Hence $\ZdbX$ is regular
  % and reduced at $w$.



\begin{remark}
  Suppose $\sO$ is not good for generalized descent. Then the underlying set of
  $\ZX$ may not be a single $\bfK'$-orbit. Even if it is a single orbit, the
  scheme $\ZX$ may not be reduced.  \trivial[h]{ Example, for
    $(G,G') = (\rO(5),\Sp(4))$, $\cO = \bfD([3,2])$ and $\cO' = \bfD([4])$. Then
    the fiber $\ZdbX$ is non-reduced (verified using Sage (Singular package)).
  }
\end{remark}

%\subsubsection{Another scheme theoretical result}

\begin{lem}\label{lem:GDS.U}
Retain the notation in \Cref{lem:GDS.sh}. Let
\[
  U:=\fpp \setminus((\bcO\cap \fpp) \setminus \sO)  % \quad \text{ and } \quad
\]
and   $\cZ_{U,\bsOp} := \cX\times_{\dbM}(U\times \bsOp)$.
Then
\begin{enumT}
\item \label{it:GDS.U1} $U$ is a Zariski open subset of $\fpp$ such that
  $U\cap M(M'^{-1}(\bsOp)) = \sO$;
\item \label{it:GDS.U2} $\cZ_{U,\bsOp}$ is smooth and it is a single
  $\bfK\times \bfK'$-orbit.
\end{enumT}
\end{lem}
\begin{proof}
Part~\cref{it:DS.U1} is follows from \Cref{lem:GDS.set}. By \Cref{lem:GDS.sh}~\cref{it:GDS.sh.1}, the
underlying set of $\cZ_{U, \bsOp}$ is a single $\bfK\times \bfK'$-orbit whose
image under $M'$ is contained in $\sO'$ .
By generic flatness \cite[Th\'eor\`eme~6.9.1]{EGAIV2}, the morphism $\cZ_{U,\bsOp}\longrightarrow
\sO'$ is flat. To prove the scheme theoretical claim in part~\cref{it:GDS.U2},
it suffices to show that
\[
\cZ_{U,X'}:= \cX\times_{\dbM}(U\times \set{X'})
\]
 is reduced, where $X'\in \sO'$.

 Let  $w\in \cZ_{U,X'}$ be a closed point. As in the proof of
\Cref{lem:GDS.sh}, by the Jacobian criterion for
regularity,  it suffices to show that  the following sequence is  the exact:
\[
\xymatrix@C=7em{
\fkk\oplus \fkk'_{X'} \ar[r]_<>(.5){(A,A') \mapsto A'w - wA}& \cX\ar[r]^{\rdd
  M'_w}_<>(.5){b\mapsto b w^\mstar +wb^\mstar} & \fpp'.
}
\]
The proof of the exactness follows the same line as the proof of \Cref{lem:GDS.sh}
utilizing \cref{eq:GDS.T5} and the established exact sequence \cref{eq:ES.UD} in
the descent case. We leave the details to the reader.
\end{proof}
\trivial[h]{
It suffices to show
\[
\xymatrix{
\fgg\oplus \fgg'_{X'} \ar[r]& \bfW_1\oplus \bfW_2 \ar[r]^<>(.5){\rdd M'_w}& \fgg'
}
\]
is exact.
Note that the image of $\fgg\oplus \fgg'_{1,X'_1} \oplus \fgg'_2$ is in $\bfW_1$
and the image of $\bfW_1$ is in $\fgg'_1$. Therefore, the exactness still
reduces to \cref{eq:GDS.T5}.
}

% Now we have $\cZ_{U,X'}$ is smooth. By generic flatness $\cZ_{U,
%   \bsOp}\rightarrow \bsOp$ is flat since $\cZ_{U,\bsOp}$ is union of open
% $\bfK\times \bfK'$-orbits. Therefore, $\cZ_{U,\bsOp}$ is reduced.

%The following lemma is key to the proof of \cref{prop:GDS.AC}.
% Let $\sO\in \Nil_\bfK(\fpp)$ and $\CO:=\bfG\cdot \sO \in \Nil_{\bfG}(\frak g) $.
%  Put
% \[
%   \fpp_\sO:=\fpp\setminus ((\overline \CO \cap \fpp)\setminus \sO).
% \]
% It is a Zariski open subset of $\fpp$, and $\sO$ is a Zariski closed subset of it.

% \begin{lem}\label{lem:GDS.sh3}
%   Suppose $\sO'\in \Nil_{\bfK'}(\fpp')$ is the descent of $\sO$, or $\sO$ is good for generalized descent
%   and
%   $\sO' = \gDD_{\bfV,\bfV'}(\sO)\in \Nil_{\bfK'}(\fpp')$. Then
%   the  $\cX\times_{\dbM}(\fpp_\sO \times\bsOp)$   are reduced and smooth  and is a single $\bfK\times \bfK'$-orbit. Moreover,
%    \[
%    \cX\times_{\dbM}(\fpp_\sO \times\bsOp)=\cX\times_{\dbM}(\sO\times\sO')
%    \]
%    subschemes  of $\cX$.
%   \end{lem}
% \begin{proof}
% \end{proof}

% \subsection{One other upper bound}

% In this section, we record the following result, which follows easily from
% results of \cite{DKPC,DKP2}.

% \begin{prop}\label{}
%   Suppose that $(\bfG',J')$ gives a real orthogonal group. Let $\cO' = \bfD(c_1,c_2,$
%   $\cdots, c_k)\in \Nil_{\bfG'}(\fgg')$ such that
%   \begin{equation}\label{eq:ineq.c1}
%     c_{1} \geq c_{2}+2.
%   \end{equation}
%   Let $(\bfV,J)$ be a real symplectic space of dimension $\dim_\bC \bfV' + c_1-2$.
%   Then
%   \begin{equation}\label{eq:ineq.c1b}
%     \vartheta (\cO') = \bfD(c_1-1,c_1-1, c_2,\cdots, c_k) =:\cO .
%   \end{equation}
%   Further assume $\sO' = \bfD(c_{1},c_2,\cdots,c_k)\in \Nil_{\bfK'}(\fpp')$ where $c_i$'s are understood
%   as signatures. Let $\cO'$ be the complexification of $\sO'$ satisfing
%   \eqref{eq:ineq.c1}.
%   Then $M(M'^{-1}(\overline{\sO'}))\subset \overline{\cO}\cap \fpp$, and
%   $M(M'^{-1}(\overline{\sO'}))$ contains an orbit $\sO \in \Nil_{\bfK}(\fpp)$ with complexification
%   $\cO$ if and only if
%   $c_{1} - c_{2} \succeq (1,1)$.
%   % $\sign{\bfV,J} - \sign{\bfV',J'} = c_{k-1} - (1,1)$.
%   If this is the case, $\sO$ is either
%   \[
%     \begin{split}
%       \sO_1 & = \bfD(\ckcc_{1}-(0,1),c_{1}-(1,0), c_{2},\cdots,c_k) \quad \text{or}\\
%       \sO_2 & = \bfD(\ckcc_{1}-(1,0),c_{1}-(0,1), c_{2},\cdots,c_k).
%     \end{split}
%   \]
% \end{prop}

% In the context of \cref{prop:UB2}, we will thus obtain an explicit upper bound
% of the complex associated variety (resp. associated variety) of
% $\bbThetav(\pi')$ (with respect to the rational dual pair $(\bfV',\bfV)$) if
% $\pi'$ is $\cO'$-bounded (resp. $\sO'$-bounded), in view of \cref{cor:Cbound}
% and \cref{lem:LM.E}.

% The finer upper bound for the associated character will be discussed in \Cref{sec:AC}.



\subsection{Proof of \Cref{lem:indR}}\label{sec:pf.indR}

\def\Vker{\bfV_+}
We will use notations of Section \ref{secdege} and Section \ref{subsec:induced}. % We also abbreviate $P := P_{\bfEz}$, $N := N_{\bfEz}$, and
Let $\Hom_J$ denote the space of homomorphisms
commuting with the $\dotepsilon$-real from $J$,  and $\fnn_\bR$ denote the Lie algebra of $N_{\bfE_0}$. %, $J= J_{\bfVpe}$.

\def\XET{X_{E,T}}
\def\XST{X_{S,T}}

We first explicitly construct some elements in the induced orbits in $\Ind_{P_{\bfE_0}}^{G_{\bfVpe}} \sOR$.
Fix an element $\bfii\,X\in \sOR$ and a $J$-invariant complement $\Vker$ of $\Im(X)$ in the vector space $\bfV^{-}=\bfV$ so that
\[
  \bfV^-=\Vker\oplus \Im(X).
\]
Fix any $J$-invariant
  decompositions
  \[
  \bfEz = \bfL_1\oplus \bfL_0\quad\textrm{ and }\quad
  \bfEzp = \bfL'_1\oplus \bfL'_0
  \]
   such that $\dim \bfL_1 = \dim \Vker$, and
  $(\bfL_1\oplus \bfL'_1)\perp (\bfL_0\oplus \bfL'_0)$. (This is possible due to the dimension inequality in \cref{eq:dim-ine}.)

  Fix a linear isomorphism
  \[
  S\in \Hom_J(\bfL_1', \Vker),
\]
and view it as an element of $\Hom_J(\bfEzp, \bfV^-)$ via the aforementioned decompositions.
Put
\[
  \begin{split}
    \sT & := \set{T\in \Hom_J(\bfL'_0,\bfL_0)| T^* + T = 0 } \quad \text{and}\\
    \sT^\circ & := \set{T\in \sT| \text{$T$ has maximal possible rank}}
  \end{split}
\]
to be viewed as subsets of $\Hom_J(\bfEzp, \bfEz)$ as before,
where $T^*\in \Hom_J(\bfL'_0,\bfL_0)$ is specified by requiring that
  \begin{equation}\label{tstar}
   \inn{T\cdot u}{v}_{\bfV^\perp}=\inn{u}{T^*v}_{\bfV^\perp}, \quad\textrm{for all } u,v\in \bfL'_0,
  \end{equation}
and $\inn{}{}_{\bfV^\perp}$ denotes the $\epsilon$-symmetric bilinear form on
$\bfV^\perp$.

Each   $T\in \sT$
  defines a $(-\epsilon)$-symmetric bilinear form $\inn{}{}_T$ on $\bfL'_0$
  where
  \[
    \inn{v_1}{v_2}_T := -\inn{v_1}{Tv_2},\quad \textrm{for all }\, v_1,v_2\in \bfL'_0.
  \]
Put
  \begin{equation}\label{eq:stab.X1}
    \XST := \begin{pmatrix}
      0 & S^* & T\\
      & X & S\\
      & & 0
    \end{pmatrix} \in X + \fnn_\bR
  \end{equation}
  according to the decomposition $\bfVpe = \bfEz \oplus \bfV^- \oplus \bfEzp$,
  where $S^*\in \Hom_J(\bfV^-, \bfEz)$ is  similarly defined as in \eqref{tstar}.
  %\subsubsection{}

  \medskip
 Now suppose that $T\in \sT^\circ$.

  In  case~\ref{it:indR.2} of \Cref{lem:indR},  the form $\inn{}{}_T$ must be
  non-degenerate and $((\bfL'_0, \inn{}{}_T),J|_{\bfL'_0})$ becomes a $(-\epsilon,-\dotepsilon)$-space. Conversely, up to isomorphism, every $(-\epsilon,-\dotepsilon)$-space of dimension $l-c_1$ is isomorphic to $((\bfL'_0, \inn{}{}_T),J|_{\bfL'_0})$ for some $T\in \sT$.

  Let $s$ be the signature of  $((\bfL'_0, \inn{}{}_T),J|_{\bfL'_0})$ and let
  $G_T := \bfG_{\bfL'_0}^J$ denote the corresponding real group.  Then $\bfii\, \XST$
  generates an induced orbit of $\sOR$ with signed Young diagram
  $[d_1+s, \ckdd_1+\ckss, d_1, \cdots, d_k]$.\footnote{The signed Young diagram may be
    computed using the explicit description of Kostant-Sekiguchi correspondence
    in \cite[Propositions 6.2 and
    6.4]{DKP2}.}
  \trivial[h]{
    About the signatures:

    First note that our definition of the rational structure $(J,L)$ is
    essentially the same as that of \cite[Lemma~5.4]{DKP2}, where $T=L$: For real
    orthogonal and symplectic groups, they are the same. For quaternionic
    groups, use $u\mapsto u^*$ to identify the left $\bH$-space $\bH^n$ with the
    right $\bH$-space $\bH^n$.

    We identify $\fgg$ with $\bfii \fgg$ by multiplying $\bfii$.

    According to \cite[Equation~(6.7)]{SV} is given by the
    correspondence in $\slt$:
    \[\bfii E  = \begin{pmatrix}0 & \bfii \\0 & 0\end{pmatrix}
      \leftrightarrow \frac{1}{2} \begin{pmatrix}1 & \bfii \\\bfii & -1\end{pmatrix}
      = \mathop{Cayley}(\bfii E)
    \]
    under a  $(J,L)$-compatible morphism $\phi\colon
    \slt\rightarrow \fgg$.

    Therefore, the Kostant-Sekiguchi correspondence is $\cS$ in \cite{DKP2}
    (cf. \cite[equation~(52)]{DKP2}).

    For real nilpotent  orbits $\sOR$ one can define the notion of signed Young
    diagram $\ssD_\bR(\sOR)$. (For a (signed) Young diagram, we call a maximal rectangular shape
    sub-diagram consists of rows a ``block''.  )
    Note that the ``signature'' for an indecomposable space in \cite{DKP2} is the signature on
    $V/X(V)$, i.e the signature of the most right column of a block in the
    diagram; the depth $m$ equals to the ``length of a block'' $-1$.
    For $\Nil_{\bfK}(\fpp)$, degree $0, 1$ (resp. $2,3$) correspond to $+$ sign
    (resp. $-$)

    Now by \cite[Proposition 6.2, 6.4]{DKP2}, we see that the notion of signed
    Young diagram compatible with the Kostant-Sekiguchi correspondence,
    i.e. $\ssD_\bR(\sO_\bR) = \ssD(\KS(\sO_\bR))$, which agree with our
    defintion of $\ssD(\sO_\bR)$.

    Also note that, $X$ is viewed as a nilpotent element in $\bfG_{\bfV^-}^J$,
    so its signature is ``dual'' to the original one. The role of $S$ in
    \cref{eq:stab.X1} is extend a block by $1$-column on the left and by
    $1$-column on the right. It is clear that, this procedure is equivalent to
    attach two columns on the left of the original signed Young diagram.

    For the signature $s$.
    $T$ define a nilpotent element $X_T$ in $\bfL_0\oplus \bfL'_0$ where $\bfL_0$ is
    the kernel of $X_T$. Under the notation of \cite[Theorem~3.18]{DKP2},
    $m_1=2$, $F^{(1)} = \bfL'_0$, $X_T$ correspond to a hight $\dim \bfL'_0$,
    width $2$ block. Its signature of the right column is given by the form
    $\inn{v_1}{T v_2}$. Therefore, the signature of the left column is
    given by the form $-\inn{v_1}{T v_2}$.
  }
  One checks that the
  reductive quotient of $\Stab_{P_{\bfE_0}}(\bfii\,\XST)$ and $\Stab_{G_{\bfVpe}}(\bfii\,\XST)$ are both
  canonically isomorphic to $R\times G_T$, where $R$ is the reductive
  quotient of $\Stab_{G}(X)$. Hence $C_{P_{\bfE_0}}(\bfii\,\XST)\cong C_{G_{\bfVpe}}(\bfii\,\XST)$.
  \trivial[h]{
    % To
    % calculate the component group $C_P(X)$, it is reduced to consider
    % $\Stab_M(X)$.
    Since $M$ stabilizes the decomposition $\fpp := \fmm\oplus \fnn$,
    $\Stab_M(X) \subset S_{X_0}\times \GL(\bfE_0)$ where $S_0:=\Stab_{G_{\bfV}}(X_0)$
    % Let $R_0$ be the reductive
    % part of $\Stab_{G_{\bfV}}(X_0)$, then
    % $C_{G_{0,X_0}\times \GL}(X) = C_{R_0\times \GL}(X)$.
    Note that elements in
    $S_0$ preserve $\Vker$.  Let $(h, g)\in \Stab_{S_0\times \GL}(X)$, and
    $g^*\in \GL(\bfEzp)$
    denote the adjoint $g$. Then
\[
  \XET = (h,g)\cdot \XET = \begin{pmatrix}
    0 & g E^*h^{-1} & gTg^*\\
    & h\cdot X_0 &  h E g^* \\
    & & 0
  \end{pmatrix}
  = \begin{pmatrix}
    0 & E^* & T\\
    & X_0 & E\\
    & & 0
  \end{pmatrix},
\]
implies $g E^* h^{-1} = E^*$.  In particular, $g\in \GL(\bfEz)$ must stabilize
$\Im(E^*) = \bfL_1$.  Hence it suffices to assume
$g = (g_1,g_0) \in \GL(\bfL_1)\times \GL(\bfL_0)$.  Now it is easy to see that
$g_1$ % $= E^* h E^{*-1}$
is completely determined by $h$ and $g_0\in G_T$.

On the other hand, using argument in \Cref{sec:KX}, we could compute the
reductive part of $\Stab_{G}(\XET)$. It is easy to see this is the same as
$R_0\times G_T$.
}

%\subsubsection{}
\medskip

In  case~\ref{it:indR.1} of \Cref{lem:indR}, $\inn{}{}_T$ is skew symmetric, and $T$ has  rank $\dim \bfL_0-1=l-c_1-1$ since
$l-c_1$ is odd. One checks that $\bfii\, \XST$ generates an induced orbit of $\sOR$ with the signed
Young diagram prescribed in \cref{it:indR.1} of \Cref{lem:indR}.

Fix  decompositions
\[
 \bfL_0 = \bfL_2\oplus \bfL_3\quad \textrm{ and }\quad \bfL'_0 = \bfL'_2\oplus \bfL'_3
 \]
 which are dual to each other
 such that  $\Ker(T) =
\bfL'_3$ and $\inn{}{}_T|_{\bfL'_2\times \bfL'_2}$ is a
non-degenerate skew symmetric bilinear form on $\bfL'_2$. %  and $T$ is trivial
% on $\bfL'_3$.
% Then the signature of the form on $\bfL'_2$ is
% $s=(\frac{l-1}{2},\frac{l-1}{2})$ and
 Let $G_T:=\bfG_{\bfL'_2}^J$. Then
$G_T$ is a real symplectic
group. The reductive quotient of
$\Stab_{P_{\bfE_0}}(\bfii \XST)$ is canonically isomorphic to $R\times G_T\times \GL(\bfL_3)^J$
and the reductive quotient of $\Stab_{G_{\bfVpe}}(\bfii \XST)$ is canonically isomorphic to
$R\times G_T\times \bfG_{\bfL_3\oplus \bfL'_3}^J$, where $R$ is the reductive
quotient of $\Stab_{G}(\bfii X)$ and $\bfG_{\bfL_3\oplus \bfL'_3}^J\cong \rO(1,1)$. The homomorphism
\[
C_{P_{\bfE_0}}(\bfii\,\XST)\longrightarrow  C_{G_{\bfVpe}}(\bfii \XST)
\]
is therefore an injection whose image has index $2$.
\trivial[h]{
  Let $E_1 = E|_{\bfL_2\oplus \bfL_1}$, $T_1 = T|_{\bfL'_2\oplus \bfL'_1}$.
  Under the decomposition $\bfVpe = \bfL_3\oplus (\bfL_2 \oplus \bfL_1)\oplus
  \bfV\oplus (\bfL'_2\oplus \bfL_1)\oplus \bfL'_3$,
  \[
    \XET = \begin{pmatrix}
      0& 0 & 0 & 0 & 0 \\
      &0 & E_1^* & T_1 & 0\\
       &  & X & E_1 & 0\\
       & & & 0 & 0\\
      & & & & 0
    \end{pmatrix}.
  \]

  An argument similar in case~\ref{it:indR.2} yields that the reductive part of
  $\Stab_M(\XST)$ must stabilize $\bfL_i$ and so isomorphic to $R_0\times
  \Sp(\bfL'_2)\times \GL(\bfL_3)$. The reductive part of $\Stab_G(\XET)$ is
  computed by block decomposition in \Cref{sec:KX}.
  The map between component groups is induced by the natural inclusion $R_0\times
  \GL(\bfL_3)\rightarrow R_0\times \rO(\bfL_3\oplus \bfL'_3)$.
  Now it is clear that the cokernel of maps between component groups is order
  $2$.
}

%\subsubsection{}
\medskip

To finish the proof of the lemma, it suffices to show that
\begin{equation}\label{eq:indorb}
\Ind_{P_{\bfEz}}^{G_{\bfVpe}}\sOR = \set{G_{\bfVpe}\cdot \bfii
  \XST|T\in \sT^\circ}.
\end{equation}
% $\set{G_{\bfVpe}\cdot \bfii\, X_{S,T}|T\in \sT^\circ}$ exhaust the
% orbits in
% $\Ind_{P_{\bfEz}}^{G_{\bfVpe}}\sOR$,
Consider the set
\[
\fA :=
\Set{ \begin{pmatrix}
  0 & B^* & C \\
  & X & B\\
  & & 0
\end{pmatrix}\in X + \fnn_\bR|%\parbox{22em}{
\text{$X\oplus  B \in \Hom_J(\bfV^-\oplus \bfE'_0, \bfV^-)$ is surjective} \\
%and \\
%$C\oplus B \in \Hom_J(\bfE'_0, \bfE_0 \oplus \bfV^-)$ has maximal possible rank.
%}
}.
\]
% Note that the maximal possible rank of $C\oplus B$ in the above equation is
% $\dim \bfE_0 -1$ in case~\ref{it:indR.1} and $\dim \bfE_0$ in case~\ref{it:indR.2}.
Clearly $P'_{\bfEz}:=\GL_{\bfEz}\ltimes
N_{\bfEz}$ acts on $\fA$ (\emph{cf}. \cref{eq:P'E0}).
By suitable matrix manipulations, one sees that every element in $\fA$ is
conjugated to an element in $\set{X_{S,T}|T\in \sT}$ under the
$P'_{\bfEz}$-action.
Hence $P'_{\bfEz}\cdot \set{X_{S,T}|T\in \sT^\circ}$ is open dense in $\fA$.
Now \cref{eq:indorb} follows since $P_{\bfE_0}\cdot \bfii \fA$ is open dense in $\sOR+ \bfii \fnn_\bR$, \qed

\trivial[h]{
\begin{claim*}
Every element in $\fA$ is conjugate by $\GL(\bfEz)\ltimes N$
to an element of the form \eqref{eq:stab.X1}.
\end{claim*}

\begin{proof}
Let $Y\in \fA$.
Under $\GL(\bfE_0)^J$ action, we may assume $B|_{\bfL'_1}=E$ and $B(\bfL'_0)
\subset \Im(X)$.
Let $u\in \Hom(\bfE'_0,\bfV)$ and
\[n_u:=\exp\begin{pmatrix}
      0 & u^* & 0 \\
      & 0 & u\\
      & & 0
    \end{pmatrix}.
\]
Then
\[
n_u\cdot Y = \begin{pmatrix} 0 &u^*X+B^* &-u^* X u+u^* B -B^* u+C\\
  0&X &B-X u\\
  0&0&0
\end{pmatrix}.
\]
Therefore, by choosing a suitable $u\in \Hom_J(\bfL'_0,\bfV)$, we may assume $B$
is an isomorphism in $\Hom_J(\bfL'_1,\bfV_+)$.
Now consider $u = \begin{pmatrix} u_1 \\ u_0 \end{pmatrix}\in
\Hom_J(\bfL'_1,\Ker(X))\oplus \Hom_J(\bfL'_0,\Ker(X))$.
We have
  \[
    n_u\cdot Y = \begin{pmatrix}
      0 & E^* & T'\\
      & X & E \\
      &&0
    \end{pmatrix}
    \quad \text{where} \quad
    T' = \begin{pmatrix}
      B^* u_1+u_1^* B & B^*u_0\\
       u_0^* B & 0
    \end{pmatrix} +C,
  \]
under the
  decomposition $\bfE_0 =\bfL_1\oplus \bfL_0$.
Note that the paring between $\bfV_+$ and $\Ker(X_0)$ is perfect.
We see that by a suitable $n_u$ action as above, one can further assume $T\in
\Hom_J(\bfL'_0,\bfL_0)$. Now the rank condition ensures that $T$ has maximal
possible rank, i.e. $Y$ is an element of the form \cref{eq:stab.X1}.
\end{proof}
}
% Note the following nature bijection between orbits:
% \[
% \xymatrix{
% \Set{\sO|\sO \text{ is induced from } \sO_0} \ar@{<->}[r] &
% \left(\cO\cap (\sO_0+ \fnn_\bR)\right) / P.
% }
% \]

\trivial[h]{
Note that $\pi\colon G\times_P \overline{\sO+\fnn_\bR}\longrightarrow
\overline{\sO+\fnn_\bR}$ is a resolution of singularity.
If $X' \in \overline{\sO+\fnn_\bR} \setminus P\cdot \fA$,  $P\cdot X'$ has
lower dimension than $P\cdot \XET$.
Hence $G\cdot X' = \pi(G\times_P (P\cdot X'))$ has lower dimension than $G\cdot
\XET$, i.e. $G\cdot X'$ can not be in $\Ind_P^G$.
}



\begin{bibdiv}
  \begin{biblist}
% \bib{AB}{article}{
%   title={Genuine representations of the metaplectic group},
%   author={Adams, Jeffrey},
%   author = {Barbasch, Dan},
%   journal={Compositio Mathematica},
%   volume={113},
%   number={01},
%   pages={23--66},
%   year={1998},
% }

\bib{Ad83}{article}{
  author = {Adams, J.},
  title = {Discrete spectrum of the reductive dual pair $(O(p,q),Sp(2m))$ },
  journal = {Invent. Math.},
  number = {3},
 pages = {449--475},
 volume = {74},
 year = {1983}
}

%\bib{Ad07}{article}{
%  author = {Adams, J.},
%  title = {The theta correspondence over R},
%  journal = {Harmonic analysis, group representations, automorphic forms and invariant theory,  Lect. Notes Ser. Inst. Math. Sci. Natl. Univ. Singap., 12},
% pages = {1--39},
% year = {2007}
% publisher={World Sci. Publ.}
%}


\bib{ABV}{book}{
  title={The Langlands classification and irreducible characters for real reductive groups},
  author={Adams, J.},
  author={Barbasch, B.},
  author={Vogan, D. A.},
  series={Progress in Math.},
  volume={104},
  year={1991},
  publisher={Birkhauser}
}

\bib{AC}{article}{
  title={Algorithms for representation theory of
    real reductive groups},
  volume={8},
  DOI={10.1017/S1474748008000352},
  number={2},
  journal={Journal of the Institute of Mathematics of Jussieu},
  publisher={Cambridge University Press},
  author={Adams, Jeffrey}
  author={du Cloux,
    Fokko},
  year={2009},
  pages={209-259}
}

\bib{ArPro}{article}{
  author = {Arthur, J.},
  title = {On some problems suggested by the trace formula},
  journal = {Lie group representations, II (College Park, Md.), Lecture Notes in Math. 1041},
 pages = {1--49},
 year = {1984}
}


\bib{ArUni}{article}{
  author = {Arthur, J.},
  title = {Unipotent automorphic representations: conjectures},
  %booktitle = {Orbites unipotentes et repr\'esentations, II},
  journal = {Orbites unipotentes et repr\'esentations, II, Ast\'erisque},
 pages = {13--71},
 volume = {171-172},
 year = {1989}
}

\bib{AK}{article}{
  author = {Auslander, L.},
  author = {Kostant, B.},
  title = {Polarizations and unitary representations of solvable Lie groups},
  journal = {Invent. Math.},
 pages = {255--354},
 volume = {14},
 year = {1971}
}

\bib{B.Class}{article}{
  author = {Barbasch, D.},
  title = {The unitary dual for complex classical Lie groups},
  journal = {Invent. Math.},
  number = {1},
 volume = {96},
     pages = {103--176},
      year = {1989},
}

\bib{B.Uni}{article}{
  author = {Barbasch, D.},
  title = {Unipotent representations for real reductive groups},
 %booktitle = {Proceedings of ICM, Kyoto 1990},
 journal = {Proceedings of ICM (1990), Kyoto},
   % series = {Proc. Sympos. Pure Math.},
 %   volume = {68},
     pages = {769--777},
 publisher = {Springer-Verlag, The Mathematical Society of Japan},
      year = {2000},
}

\bib{B.W}{article}{
  author={Barbasch, Dan},
  author={Vogan, David},
  editor={Trombi, P. C.},
  title={Weyl Group Representations and Nilpotent Orbits},
  bookTitle={Representation Theory of Reductive Groups:
    Proceedings of the University of Utah Conference 1982},
  year={1983},
  publisher={Birkh{\"a}user Boston},
  address={Boston, MA},
  pages={21--33},
  %doi={10.1007/978-1-4684-6730-7_2},
}



\bib{B.Orbit}{article}{
  author = {Barbasch, D.},
  title = {Orbital integrals of nilpotent orbits},
 %booktitle = {The mathematical legacy of {H}arish-{C}handra ({B}altimore,{MD}, 1998)},
    journal = {The mathematical legacy of {H}arish-{C}handra, Proc. Sympos. Pure Math.},
    %series={The mathematical legacy of {H}arish-{C}handra, Proc. Sympos. Pure Math},
    volume = {68},
     pages = {97--110},
 publisher = {Amer. Math. Soc., Providence, RI},
      year = {2000},
}



\bib{B10}{article}{
  author = {Barbasch, D.},
  title = {The unitary spherical spectrum for split classical groups},
  journal = {J. Inst. Math. Jussieu},
% number = {9},
 pages = {265--356},
 volume = {9},
 year = {2010}
}



\bib{B17}{article}{
  author = {Barbasch, D.},
  title = {Unipotent representations and the dual pair correspondence},
  journal = {J. Cogdell et al. (eds.), Representation Theory, Number Theory, and Invariant Theory, In Honor of Roger Howe. Progress in Math.}
  %series ={Progress in Math.},
  volume = {323},
  pages = {47--85},
  year = {2017},
}

\bib{BVUni}{article}{
 author = {Barbasch, D.},
 author = {Vogan, D. A.},
 journal = {Annals of Math.},
 number = {1},
 pages = {41--110},
 title = {Unipotent representations of complex semisimple groups},
 volume = {121},
 year = {1985}
}

\bib{Br}{article}{
  author = {Brylinski, R.},
  title = {Dixmier algebras for classical complex nilpotent orbits via Kraft-Procesi models. I},
  journal = {The orbit method in geometry and physics (Marseille, 2000). Progress in Math.}
  volume = {213},
  pages = {49--67},
  year = {2003},
}

\bib{Carter}{book}{
   author={Carter, Roger W.},
   title={Finite groups of Lie type},
   series={Wiley Classics Library},
   %note={Conjugacy classes and complex characters;
   %Reprint of the 1985 original;
   %A Wiley-Interscience Publication},
   publisher={John Wiley \& Sons, Ltd., Chichester},
   date={1993},
   pages={xii+544},
   isbn={0-471-94109-3},
   %review={\MR{1266626}},
}
\bib{Ca89}{article}{
 author = {Casselman, W.},
 journal = {Canad. J. Math.},
 pages = {385--438},
 title = {Canonical extensions of Harish-Chandra modules to representations of $G$},
 volume = {41},
 year = {1989}
}



\bib{Cl}{article}{
  author = {Du Cloux, F.},
  journal = {Ann. Sci. \'Ecole Norm. Sup.},
  number = {3},
  pages = {257--318},
  title = {Sur les repr\'esentations diff\'erentiables des groupes de Lie alg\'ebriques},
  url = {http://eudml.org/doc/82297},
  volume = {24},
  year = {1991},
}

\bib{CM}{book}{
  title = {Nilpotent orbits in semisimple Lie algebra: an introduction},
  author = {Collingwood, D. H.},
  author = {McGovern, W. M.},
  year = {1993}
  publisher = {Van Nostrand Reinhold Co.},
}


% \bib{Dieu}{book}{
%    title={La g\'{e}om\'{e}trie des groupes classiques},
%    author={Dieudonn\'{e}, Jean},
%    year={1963},
% 	publisher={Springer},
%  }

\bib{DKPC}{article}{
title = {Nilpotent orbits and complex dual pairs},
journal = {J. Algebra},
volume = {190},
number = {2},
pages = {518 - 539},
year = {1997},
author = {Daszkiewicz, A.},
author = {Kra\'skiewicz, W.},
author = {Przebinda, T.},
}

\bib{DKP2}{article}{
  author = {Daszkiewicz, A.},
  author = {Kra\'skiewicz, W.},
  author = {Przebinda, T.},
  title = {Dual pairs and Kostant-Sekiguchi correspondence. II. Classification
	of nilpotent elements},
  journal = {Central European J. Math.},
  year = {2005},
  volume = {3},
  pages = {430--474},
}


\bib{DM}{article}{
  author = {Dixmier, J.},
  author = {Malliavin, P.},
  title = {Factorisations de fonctions et de vecteurs ind\'efiniment diff\'erentiables},
  journal = {Bull. Sci. Math. (2)},
  year = {1978},
  volume = {102},
  pages = {307--330},
}

%\bibitem[DM]{DM}
%J. Dixmier and P. Malliavin, \textit{Factorisations de fonctions et de vecteurs ind\'efiniment diff\'erentiables}, Bull. Sci. Math. (2), 102 (4),  307-330 (1978).



%\bib{Du77}{article}{
% author = {Duflo, M.},
% journal = {Annals of Math.},
% number = {1},
% pages = {107-120},
% title = {Sur la Classification des Ideaux Primitifs Dans
%   L'algebre Enveloppante d'une Algebre de Lie Semi-Simple},
% volume = {105},
% year = {1977}
%}

\bib{Du82}{article}{
 author = {Duflo, M.},
 journal = {Acta Math.},
  volume = {149},
 number = {3-4},
 pages = {153--213},
 title = {Th\'eorie de Mackey pour les groupes de Lie alg\'ebriques},
 year = {1982}
}



\bib{GZ}{article}{
author={Gomez, R.},
author={Zhu, C.-B.},
title={Local theta lifting of generalized Whittaker models associated to nilpotent orbits},
journal={Geom. Funct. Anal.},
year={2014},
volume={24},
number={3},
pages={796--853},
}

\bib{EGAIV2}{article}{
  title = {\'El\'ements de g\'eom\'etrie alg\'brique IV: \'Etude locale des
    sch\'emas et des morphismes de sch\'emas. II},
  author = {Grothendieck, A.},
  author = {Dieudonn\'e, J.},
  journal  = {Inst. Hautes \'Etudes Sci. Publ. Math.},
  volume = {24},
  year = {1965},
}


\bib{EGAIV3}{article}{
  title = {\'El\'ements de g\'eom\'etrie alg\'brique IV: \'Etude locale des
    sch\'emas et des morphismes de sch\'emas. III},
  author = {Grothendieck, A.},
  author = {Dieudonn\'e, J.},
  journal  = {Inst. Hautes \'Etudes Sci. Publ. Math.},
  volume = {28},
  year = {1966},
}


\bib{HLS}{article}{
    author = {Harris, M.},
    author = {Li, J.-S.},
    author = {Sun, B.},
     title = {Theta correspondences for close unitary groups},
 %booktitle = {Arithmetic Geometry and Automorphic Forms},
    %series = {Adv. Lect. Math. (ALM)},
    journal = {Arithmetic Geometry and Automorphic Forms, Adv. Lect. Math. (ALM)},
    volume = {19},
     pages = {265--307},
 publisher = {Int. Press, Somerville, MA},
      year = {2011},
}

\bib{HS}{book}{
 author = {Hartshorne, R.},
 title = {Algebraic Geometry},
publisher={Graduate Texts in Mathematics, 52. New York-Heidelberg-Berlin: Springer-Verlag},
year={1983},
}

\bib{He}{article}{
author={He, H.},
title={Unipotent representations and quantum induction},
journal={arXiv:math/0210372},
year = {2002},
}

\bib{He2}{article}{
author={He, H.},
title={Unitary representations and theta correspondence for type I classical groups},
journal={J. Funct. Anal.},
year = {2003},
volume = {199},
number = {1},
pages = {92--121},
}


\bib{HL}{article}{
author={Huang, J.-S.},
author={Li, J.-S.},
title={Unipotent representations attached to spherical nilpotent orbits},
journal={Amer. J. Math.},
volume={121},
number = {3},
pages={497--517},
year={1999},
}


\bib{HZ}{article}{
author={Huang, J.-S.},
author={Zhu, C.-B.},
title={On certain small representations of indefinite orthogonal groups},
journal={Represent. Theory},
volume={1},
pages={190--206},
year={1997},
}



\bib{Howe79}{article}{
  title={$\theta$-series and invariant theory},
  author={Howe, R.},
  book = {
    title={Automorphic Forms, Representations and $L$-functions},
    series={Proc. Sympos. Pure Math},
    volume={33},
    year={1979},
  },
  pages={275-285},
}

\bib{HoweRank}{article}{
author={Howe, R.},
title={On a notion of rank for unitary representations of the classical groups},
journal={Harmonic analysis and group representations, Liguori, Naples},
pages={223-331},
year={1982},
}

\bib{Howe89}{article}{
author={Howe, R.},
title={Transcending classical invariant theory},
journal={J. Amer. Math. Soc.},
volume={2},
pages={535--552},
year={1989},
}

\bib{Howe95}{article}{,
  author = {Howe, R.},
  title = {Perspectives on invariant theory: Schur duality, multiplicity-free actions and beyond},
  journal = {Piatetski-Shapiro, I. et al. (eds.), The Schur lectures (1992). Ramat-Gan: Bar-Ilan University, Isr. Math. Conf. Proc. 8,},
  year = {1995},
  pages = {1-182},
}

\bib{JLS}{article}{
author={Jiang, D.},
author={Liu, B.},
author={Savin, G.},
title={Raising nilpotent orbits in wave-front sets},
journal={Represent. Theory},
volume={20},
pages={419--450},
year={2016},
}

\bib{Ki62}{article}{
author={Kirillov, A. A.},
title={Unitary representations of nilpotent Lie groups},
journal={Uspehi Mat. Nauk},
volume={17},
issue ={4},
pages={57--110},
year={1962},
}


\bib{Ko70}{article}{
author={Kostant, B.},
title={Quantization and unitary representations},
journal={Lectures in Modern Analysis and Applications III, Lecture Notes in Math.},
volume={170},
pages={87--208},
year={1970},
}


\bib{KP}{article}{
author={Kraft, H.},
author={Procesi, C.},
title={On the geometry of conjugacy classes in classical groups},
journal={Comment. Math. Helv.},
volume={57},
pages={539--602},
year={1982},
}

\bib{KR}{article}{
author={Kudla, S. S.},
author={Rallis, S.},
title={Degenerate principal series and invariant distributions},
journal={Israel J. Math.},
volume={69},
pages={25--45},
year={1990},
}


\bib{Ku}{article}{
author={Kudla, S. S.},
title={Some extensions of the Siegel-Weil formula},
journal={In: Gan W., Kudla S., Tschinkel Y. (eds) Eisenstein Series and Applications. Progress in Mathematics, vol 258. Birkh\"auser Boston},
%volume={69},
pages={205--237},
year={2008},
}





\bib{LZ1}{article}{
author={Lee, S. T.},
author={Zhu, C.-B.},
title={Degenerate principal series and local theta correspondence II},
journal={Israel J. Math.},
volume={100},
pages={29--59},
year={1997},
}

\bib{LZ2}{article}{
author={Lee, S. T.},
author={Zhu, C.-B.},
title={Degenerate principal series of metaplectic groups and Howe correspondence},
journal = {D. Prasad at al. (eds.), Automorphic Representations and L-Functions, Tata Institute of Fundamental Research, India,},
year = {2013},
pages = {379--408},
}

\bib{Li89}{article}{
author={Li, J.-S.},
title={Singular unitary representations of classical groups},
journal={Invent. Math.},
volume={97},
number = {2},
pages={237--255},
year={1989},
}

\bib{LiuAG}{book}{
  title={Algebraic Geometry and Arithmetic Curves},
  author = {Liu, Q.},
  year = {2006},
  publisher={Oxford University Press},
}

\bib{LM}{article}{
   author = {Loke, H. Y.},
   author = {Ma, J.},
    title = {Invariants and $K$-spectrums of local theta lifts},
    journal = {Compositio Math.},
    volume = {151},
    issue = {01},
    year = {2015},
    pages ={179--206},
}

\bib{LS}{article}{
   author = {Lusztig, G.},
   author = {Spaltenstein, N.},
    title = {Induced unipotent classes},
    journal = {j. London Math. Soc.},
    volume = {19},
    year = {1979},
    pages ={41--52},
}

\bib{Lu.I}{article}{
   author={Lusztig, G.},
   title={Intersection cohomology complexes on a reductive group},
   journal={Invent. Math.},
   volume={75},
   date={1984},
   number={2},
   pages={205--272},
   issn={0020-9910},
   review={\MR{732546}},
   doi={10.1007/BF01388564},
}
	

\bib{Ma}{article}{
   author = {Mackey, G. W.},
    title = {Unitary representations of group extentions},
    journal = {Acta Math.},
    volume = {99},
    year = {1958},
    pages ={265--311},
}


\bib{Mc}{article}{
   author = {McGovern, W. M},
    title = {Cells of Harish-Chandra modules for real classical groups},
    journal = {Amer. J.  of Math.},
    volume = {120},
    issue = {01},
    year = {1998},
    pages ={211--228},
}

\bib{Mo96}{article}{
 author={M{\oe}glin, C.},
    title = {Front d'onde des repr\'esentations des groupes classiques $p$-adiques},
    journal = {Amer. J. Math.},
    volume = {118},
    issue = {06},
    year = {1996},
    pages ={1313--1346},
}

\bib{Mo17}{article}{
  author={M{\oe}glin, C.},
  title = {Paquets d'Arthur Sp\'eciaux Unipotents aux Places Archim\'ediennes et Correspondance de Howe},
  journal = {J. Cogdell et al. (eds.), Representation Theory, Number Theory, and Invariant Theory, In Honor of Roger Howe. Progress in Math.}
  %series ={Progress in Math.},
  volume = {323},
  pages = {469--502}
  year = {2017}
}


\bib{MVW}{book}{
  volume={1291},
  title={Correspondances de Howe sur un corps $p$-adique},
  author={M{\oe}glin, C.},
  author={Vign\'eras, M.-F.},
  author={Waldspurger, J.-L.},
  series={Lecture Notes in Mathematics},
  publisher={Springer}
  ISBN={978-3-540-18699-1},
  date={1987},
}

\bib{NOTYK}{article}{
   author = {Nishiyama, K.},
   author = {Ochiai, H.},
   author = {Taniguchi, K.},
   author = {Yamashita, H.},
   author = {Kato, S.},
    title = {Nilpotent orbits, associated cycles and Whittaker models for highest weight representations},
    journal = {Ast\'erisque},
    volume = {273},
    year = {2001},
   pages ={1--163},
}

\bib{NOZ}{article}{
  author = {Nishiyama, K.},
  author = {Ochiai, H.},
  author = {Zhu, C.-B.},
  journal = {Trans. Amer. Math. Soc.},
  title = {Theta lifting of nilpotent orbits for symmetric pairs},
  volume = {358},
  year = {2006},
  pages = {2713--2734},
}


\bib{NZ}{article}{
   author = {Nishiyama, K.},
   author = {Zhu, C.-B.},
    title = {Theta lifting of unitary lowest weight modules and their associated cycles},
    journal = {Duke Math. J.},
    volume = {125},
    issue = {03},
    year = {2004},
   pages ={415--465},
}



\bib{Ohta}{article}{
  author = {Ohta, T.},
  %doi = {10.2748/tmj/1178227492},
  journal = {Tohoku Math. J.},
  number = {2},
  pages = {161--211},
  publisher = {Tohoku University, Mathematical Institute},
  title = {The closures of nilpotent orbits in the classical symmetric
    pairs and their singularities},
  volume = {43},
  year = {1991}
}

\bib{Ohta2}{article}{
  author = {Ohta, T.},
  journal = {Hiroshima Math. J.},
  number = {2},
  pages = {347--360},
  title = {Induction of nilpotent orbits for real reductive groups and associated varieties of standard representations},
  volume = {29},
  year = {1999}
}

\bib{Ohta4}{article}{
  title={Nilpotent orbits of $\mathbb{Z}_4$-graded Lie algebra and geometry of
    moment maps associated to the dual pair $(\mathrm{U} (p, q), \mathrm{U} (r, s))$},
  author={Ohta, T.},
  journal={Publ. RIMS},
  volume={41},
  number={3},
  pages={723--756},
  year={2005}
}

\bib{PT}{article}{
  title={Some small unipotent representations of indefinite orthogonal groups and the theta correspondence},
  author={Paul, A.},
  author={Trapa, P.},
  journal={University of Aarhus Publ. Series},
  volume={48},
  pages={103--125},
  year={2007}
}


\bib{PV}{article}{
  title={Invariant Theory},
  author={Popov, V. L.},
  author={Vinberg, E. B.},
  book={
  title={Algebraic Geometry IV: Linear Algebraic Groups, Invariant Theory},
  series={Encyclopedia of Mathematical Sciences},
  volume={55},
  year={1994},
  publisher={Springer},}
}




%\bib{PPz}{article}{
%author={Protsak, V.} ,
%author={Przebinda, T.},
%title={On the occurrence of admissible representations in the real Howe
%    correspondence in stable range},
%journal={Manuscr. Math.},
%volume={126},
%number={2},
%pages={135--141},
%year={2008}
%}


\bib{PrzInf}{article}{
      author={Przebinda, T.},
       title={The duality correspondence of infinitesimal characters},
        date={1996},
     journal={Colloq. Math.},
      volume={70},
       pages={93--102},
}


\bib{Pz}{article}{
author={Przebinda, T.},
title={Characters, dual pairs, and unitary representations},
journal={Duke Math. J. },
volume={69},
number={3},
pages={547--592},
year={1993}
}

\bib{Ra}{article}{
author={Rallis, S.},
title={On the Howe duality conjecture},
journal={Compositio Math.},
volume={51},
pages={333--399},
year={1984}
}

\bib{Sa}{article}{
author={Sahi, S.},
title={Explicit Hilbert spaces for certain unipotent representations},
journal={Invent. Math.},
volume={110},
number = {2},
pages={409--418},
year={1992}
}

\bib{Se}{article}{
author={Sekiguchi, J.},
title={Remarks on real nilpotent orbits of a symmetric pair},
journal={J. Math. Soc. Japan},
%publisher={The Mathematical Society of Japan},
year={1987},
volume={39},
number={1},
pages={127--138},
}

\bib{SV}{article}{
  author = {Schmid, W.},
  author = {Vilonen, K.},
  journal = {Annals of Math.},
  number = {3},
  pages = {1071--1118},
  %publisher = {Princeton University, Mathematics Department, Princeton, NJ; Mathematical Sciences Publishers, Berkeley},
  title = {Characteristic cycles and wave front cycles of representations of reductive Lie groups},
  volume = {151},
year = {2000},
}

\bib{So}{article}{
author = {Sommers, E.},
title = {Lusztig's canonical quotient and generalized duality},
journal = {J. Algebra},
volume = {243},
number = {2},
pages = {790--812},
year = {2001},
}

\bib{SS}{book}{
  author = {Springer, T. A.},
  author = {Steinberg, R.},
  title = {Seminar on algebraic groups and related finite groups; Conjugate classes},
  series = {Lecture Notes in Math.}
  volume = {131}
publisher={Springer},
year={1970},
}

\bib{SZ1}{article}{
title={A general form of Gelfand-Kazhdan criterion},
author={Sun, B.},
author={Zhu, C.-B.},
journal={Manuscripta Math.},
pages = {185--197},
volume = {136},
year={2011}
}


%\bib{SZ2}{article}{
%  title={Conservation relations for local theta correspondence},
%  author={Sun, B.},
%  author={Zhu, C.-B.},
%  journal={J. Amer. Math. Soc.},
%  pages = {939--983},
%  volume = {28},
%  year={2015}
%}



\bib{Tr}{article}{
  title={Special unipotent representations and the Howe correspondence},
  author={Trapa, P.},
  year = {2004},
  journal={University of Aarhus Publication Series},
  volume = {47},
  pages= {210--230}
}

% \bib{Wa}{article}{
%    author = {Waldspurger, J.-L.},
%     title = {D\'{e}monstration d'une conjecture de dualit\'{e} de Howe dans le cas $p$-adique, $p \neq 2$ in Festschrift in honor of I. I. Piatetski-Shapiro on the occasion of his sixtieth birthday},
%   journal = {Israel Math. Conf. Proc., 2, Weizmann, Jerusalem},
%  year = {1990},
% pages = {267-324},
% }

\bib{V4}{article}{
   author={Vogan, D. A. },
   title={Irreducible characters of semisimple Lie groups. IV.
   Character-multiplicity duality},
   journal={Duke Math. J.},
   volume={49},
   date={1982},
   number={4},
   pages={943--1073},
   issn={0012-7094},
   review={\MR{683010}},
}
\bib{VoBook}{book}{
author = {Vogan, D. A. },
  title={Unitary representations of reductive Lie groups},
  year={1987},
  series = {Ann. of Math. Stud.},
 volume={118},
  publisher={Princeton University Press}
}


\bib{Vo89}{article}{
  author = {Vogan, D. A. },
  title = {Associated varieties and unipotent representations},
 %booktitle ={Harmonic analysis on reductive groups, Proc. Conf., Brunswick/ME (USA) 1989,},
  journal = {Harmonic analysis on reductive groups, Proc. Conf., Brunswick/ME
    (USA) 1989, Prog. Math.},
 volume={101},
  publisher = {Birkh\"{a}user, Boston-Basel-Berlin},
  year = {1991},
pages={315--388},
  editor = {W. Barker and P. Sally},
}

\bib{Vo98}{article}{
  author = {Vogan, D. A. },
  title = {The method of coadjoint orbits for real reductive groups},
 %booktitle ={Representation theory of Lie groups (Park City, UT, 1998)},
 journal = {Representation theory of Lie groups (Park City, UT, 1998). IAS/Park City Math. Ser.},
  volume={8},
  publisher = {Amer. Math. Soc.},
  year = {2000},
pages={179--238},
}

\bib{Vo00}{article}{
  author = {Vogan, D. A. },
  title = {Unitary representations of reductive Lie groups},
 %booktitle ={Mathematics towards the Third Millennium (Rome, 1999)},
 journal ={Mathematics towards the Third Millennium (Rome, 1999). Accademia Nazionale dei Lincei, (2000)},
  %series = {Accademia Nazionale dei Lincei, 2000},
 %volume={9},
pages={147--167},
}


\bib{Wa1}{book}{
  title={Real reductive groups I},
  author={Wallach, N. R.},
  year={1988},
  publisher={Academic Press Inc. }
}

\bib{Wa2}{book}{
  title={Real reductive groups II},
  author={Wallach, N. R.},
  year={1992},
  publisher={Academic Press Inc. }
}


\bib{Weyl}{book}{
  title={The classical groups: their invariants and representations},
  author={Weyl, H.},
  year={1947},
  publisher={Princeton University Press}
}

\bib{Ya}{article}{
  title={Degenerate principal series representations for quaternionic unitary groups},
  author={Yamana, S.},
  year = {2011},
  journal={Israel J. Math.},
  volume = {185},
  pages= {77--124}
}



% \bib{EGAIV4}{article}{
%   title = {\'El\'ements de g\'eom\'etrie alg\'brique IV 4: \'Etude locale des
%     sch\'emas et des morphismes de sch\'emas},
%   author = {Grothendieck, Alexandre},
%   author = {Dieudonn\'e, Jean},
%   journal  = {Inst. Hautes \'Etudes Sci. Publ. Math.},
%   volume = {32},
%   year = {1967},
%   pages = {5--361}
% }



\end{biblist}
\end{bibdiv}


\printindex


\end{document}


%%% Local Variables:
%%% coding: utf-8
%%% mode: latex
%%% TeX-engine: xetex
%%% ispell-local-dictionary: "en_US"
%%% End:
