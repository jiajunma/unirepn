\documentclass[counting_main.tex]{subfiles}
\begin{document}
\externaldocument{\subfix{main}}

\section{Counting representations via the translation principle}

% \subsection{Coherent family}

% Let $Q$ be the $\fhh$ root lattice of $\fgg$. Let $\cG$ be the Grothendieck
% group of finite dimensional $\fgg$-modules occur in $S(\fgg)$. Note that $\cG$
% is also an algebra under tensor product.
% % Via highest weight theory, there is a unique irreducib Via highest weight
% % theory, $Q$ is identified with the set of irreducible $\fgg$-modules occur
% % in $S(\fgg)$.
% For each finite dimensional $\fhh$-module $F$, let $\WT{F}$ denote the
% multi-set of $\fhh$-weights in $F$.
In this section, let $\fgg$ be a reductive Lie algebra with a fixed abstract
Cartan subalgebra $\hha$. Recall the definition of coherent families.

Let
\[
  \aSR \subseteq \aR\subsetneq \aQ \subsetneq \ahh^{*}
\]
be the set of simple roots, positive roots and root lattice in $\ahh^{*}$.

Let $W$ be the Weyl group of $\fgg$ generated by simple reflections
$\set{s_{\alpha}|\alpha \in \aSR}$ which acts on $\ahh^{*}$.

Via the highest weight theory, every $W$-orbit $W\cdot \mu$ in $\aQ$ corresponds
with the irreducible finite dimensional $\fgg$-representation $F_{\mu}$ with
extremal weight $\mu$ and $F_{\mu}$ occurs in $\rS(\fgg)$.


% Now the Grothendieck group $\Gfin$ of finite dimensional representation of
% $\Gc$ is identified with $\bZ[\aP/W]$. In fact $\Gfin$ is a $\bZ$-algebra
% under the tensor product and equipped with the involution $F\mapsto F^*$.

% Fix a $W$-invariant sub-lattice $\Lambda_0\subset \aX$ containing $\aQ$.

% Let $\Pi$ $\Glfin$ be the $\star$-invariant subalgebra of $\Gfin$ generated by
% irreducible representations corresponds to $\Lambda_0/W$.


For any $\lambda\in \hha^{*}$, we consider the lattice
\[
  \Lam := \lambda + Q \subset \ahh^{*}
\]
and define
\begin{equation}
  \label{eq:wlam}
  \begin{split}
    R_{[\lambda]} &:= \Set{\alpha\in \aR| \inn{\lambda}{\ckalpha}\in \bZ},\\
    W_{[\lambda]} &:=
    \set{w\in W | w\cdot \lambda  - \lambda \in \aQ}\\
    R_{\lambda} &:= \Set{\alpha\in \aR| \inn{\lambda}{\ckalpha}=0}, \AND\\
    W_{\lambda} &:= \braket{s_\alpha|\alpha\in R_{\lambda}} = \braket{w\in W|w\cdot \lambda = \lambda} \subseteq W.
  \end{split}
\end{equation}
It is known that $R_{[\lambda]}$ is a root system (see \cite{V4}*{\S 2}) and
\[
  \begin{split}
    W_{[\lambda]} &= \Stab_{W}([\lambda]) = \braket{s_\alpha|\alpha\in R_{[\lambda]}} \subseteq W\quad
    \text{and}\\
    W_{ \lambda } &=   \braket{s_\alpha|\alpha \in R_{\lambda}} \subseteq W_{[\lambda]}.\\
  \end{split}
\]
In fact $W_{\lambda}$ is a parabolic subgroup of $W_{[\lambda]}$ by Chevalley's
theorem \cite{Vg}*{Lemma~6.3.28}.

When $\lambda$ is regular, let
\[
  R^{+}_{\Lam} := \Set{\alpha\in R_{\Lam}| \inn{\ckalpha}{\lambda}>0}
\]
be the fixed positive root system in $R_{\Lam}$. \trivial[]{ There is no harm to
  assume in the very beginning that $\lambda$ is regular dominant with respect
  to the $\aSR$, i.e. $\inn{\lambda}{\ckalpha}>0$ for all $\alpha\in \aSR$. }

In the following we define the notion of coherent family based on the lattice
$\Lam$ in a quite general setting.

\begin{defn}
  Suppose that $\cK$ is an $\Rg$-module with action:
  \[
    \begin{array}{ccc}
      \Rg \times \cK & \xrightarrow{\ \ \ \otimes \ \ \ } & \cK\\
      (F,m) & \mapsto & F\otimes m.
    \end{array}
  \]
  In addition, a subgroup $\cK_{\mu}$ of $\cK$ is fixed for each $\mu \in \Lam$
  such that $\cK_{\mu} = \cK_{w\cdot \mu}$ for any $\mu\in [\lambda]$ and
  $w\in \WLam$.
  % for each $W_{[\lambda]}$-orbit
  % $\barmu := W_{\Lambda} \cdot \mu\in \Lambda/W_{\Lambda}$.

  A function $f\colon \Lam \rightarrow \cK$ is called a coherent family based on
  $\Lam$ if it satisfies $f(\mu)\in \cK_\mu$ and
  \[
    F\otimes f(\mu) = \sum_{\nu \in \WT{F}} f(\mu+\nu) \qquad \forall \mu\in \Lam, F\in \Rg.
  \]
  where $\WT{F}$ denotes the multi-set of $\fhh$-weight in $F$. Let
  $\Coh_{\Lambda}(\cK)$ be the abelian group of all coherent families based on
  $\Lam$ and taking value in $\cK$. We can define $\WLam$ action on
  $\Coh_[\lambda](\cK)$ by
  \[
    w\cdot f(\mu) = f(w^{-1}\cdot \mu) \qquad \forall \mu\in \Lam, w\in \WLam.
  \]


  Let $\Coh_{\Lam}(\cK_{\mu})$ denote the vector space of all coherent families
  on $\Lam$ taking value in $\cK_{\mu}$ at $\mu\in \Lam$. It is a representation
  of $\WLam$ under the action
  \[
    (w\cdot \Theta)(\mu) = \Theta(w^{-1}\cdot \mu), \qquad \textrm{for all
    }\ w\in W_\Lam, \ \mu\in \Lam.
  \]
\end{defn}
For any $\mu\in \Lam$, let
\[
  \ev{\mu}\colon \Coh_{\Lam}(\cK_{\mu}) \longrightarrow \cK_{\mu}
\]
be the map of evaluation at $\mu$. The purpose of this section is to understand
the $\ev{\mu}$.

In this paper, we will consider the following cases.
\begin{eg}
  Suppose $\cK=\bC$ and
  \[
    F\otimes m := \dim(F)\cdot m \quad \text{for all } F\in \cG \text{ and
    } m\in \cK.
  \]
  We let $\cK_{\mu} := \cK = \bC$ for every $\mu\in \Lam$. Then the set of
  $W$-harmonic polynomials on $\fhh$ is naturally identified with
  $\Coh_{\Lam}(\cK)$ via the restriction on $[\lambda]$ by Vogan
  \cite{VGK}*{Lemma~4.3}. \trivial{ Note that the polynomials are $W$-harmonic
    not necessary $W_{[\lambda]}$-harmonic. ($W_{[\lambda]}$-invariant
    differential operators are more than $W$-invariant differential operators.)
  }
\end{eg}


\begin{eg}\label{eg:hw}
  Fix a Cartan subalgebra $\fhh$ and the identification
  $\ihh\colon \fhh\rightarrow \ahh $ of $\fhh$ with $\ahh$. The choice of $\ihh$
  determines the positive root system in $\fhh^{*}$ by transport of structure.

  Let $\fbb$ be the Borel subalgebra generated by $\fhh$ and the negative
  $\fhh$-roots in $\fgg$ and $\fnn$ be the nilpotent radical of $\fbb$.

  Let $\Grt(\fgg,\fhh,\fnn)$ be the Grothendieck group of the category $\cO$
  with coefficients in $\bC$, i.e. the category of finitely generated
  $\cU(\fgg)$-modules with semisimple $\fhh$-action and locally finite
  $\fnn$-action. There $\Rg$ acts on $\Grt(\fgg,\fhh,\fnn)$ via the tensor
  product of $\fgg$-modules. For each $W$-orbit $W\cdot \mu\in \fhh^{*}/W$, let
  \[
    \Grt_{W\cdot \mu}(\fgg,\fhh,\fnn)
  \]
  be the subgroup spanned by the $\fgg$-modules with infinitesimal character
  $\chi_{\mu}$.

  Let
  \[
    \Coh_{[\lambda]}(\fgg,\fhh,\fnn) := \Coh_{[\lambda]}(\cK_{\mu}) \quad \text{with} \quad \cK_{\mu} := \Grt_{W\cdot \mu}(\fgg,\fhh,\fnn).
  \]
  be the coherent family of highest weight modules.


  % Verma modules gives a basis of We now review the well understood structure
  % of $\Coh_{[\lambda]}$. is well understood.
  Let $\rho := \sum_{\alpha\in \WT{\fnn}} \alpha$. For $\lambda\in \ahh^{*}$,
  let
  \[
    M(\lambda) := \cU(\fgg)\otimes_{\cU(\fbb)} \bC_{\ihh^{-1}(\lambda)-\rho}
  \]
  be the Verma module with highest/lowest weight $\ihh^{-1}(\lambda)-\rho$ and
  $L(\lambda) $ be the unique irreducible quotient of $M(\lambda)$.

  Each $w\in W$ defines a coherent family %such that
  \[
    M_w(\mu) := M(w\cdot \mu) \quad \forall \mu \in [\lambda].
    % M_w(\mu) := M(w \cdot \mu) \quad \forall \mu \in [\lambda].
  \]
  % where $w_{0}$ is the longest element in $W$.

  The map
  \[
    \begin{array}{ccc}
      \bC[W] & \longrightarrow & \Coh_{[\lambda]}(\fgg,\fhh,\fnn)  \\
      w& \mapsto &M_{w}
    \end{array}
  \]
  is $W_{[\lambda]}$-module isomorphism where $W_{[\lambda]}$ acts on $\bC[W]$
  by right translation.


  We remark that, the setup here is opposite to the usual one. But it is
  consistent with the Springer theory when we study primitive ideals. Under this
  setup, $\AVC(L_{e}(\lambda))$ is the nil-cone.

  One of the crucial property is that each irreducible module can be fitted into
  a coherent family. %in other words.
  More precisely, the evaluation map descents to yields an isomorphism
  $\bev{\mu}$ in the following diagram.
  \begin{equation}\label{eq:bev.catO}
    \begin{tikzcd}
      \Coh_{[\lambda]}(\fgg,\fhh,\fnn)\ar[r,"\Theta\mapsto \Theta(\mu)"] \ar[d]&
      \Grt_{W\cdot \mu}(\fgg,\fhh,\fnn)\\
      \left(\Coh_{[\lambda]}(\fgg,\fhh,\fnn)\right)_{W_{\mu}} \ar[ru,hook,two heads,"\bev{\mu}"']
    \end{tikzcd}
  \end{equation}

  \trivial[]{ The subjectivity is because of Verma modules form a basis of the
    category $\cO$. The LHS of $\bev{\mu}$ has dimension $\sharp {W/W_{\mu}}$,
    the RHS has dimension $\sharp W\cdot \mu$. Now the isomorphism follows by
    dimension counting. }
  % the The space $\Coh_\Lambda(\cG(\fgg,\fhh,\fnn))$ and
  % $\Coh_{\Lambda(\cG)}$defined similarly.

  % Note that the lattice $\Lambda$ is stable under the $\Wlam$ action.
\end{eg}

\begin{eg}\label{eg:Coh.HC}
  Suppose $G$ is a reductive Lie group in the Harish-Chandra class. Let
  $\Grt(G)$ be the Grothendieck group of finite length admissible $G$-modules
  and $\Grt_{W\cdot \mu}(G)$ be the subgroup of $\Grt(\fgg,K)$ generated by the
  set of irreducible $G$-modules with infinitesimal character $\chi_{\mu}$. By
  pulling back via the adjoint action $G\rightarrow \Inn(\fgg)$, we identify
  $\Rg$ with a subgroup in $\Grt(G)$. Let $\Rg$ acts on $\Grt(G)$ via tensor
  product.

  We write
  \[
    \Coh_{[\lambda]}(G) := \Coh_{[\lambda]}(\Grt_{\mu}(G))
  \]
  for the space of coherent family of $G$-modules which taking values in
  $\Grt_{\mu}(G)$ at $\mu\in [\lambda]$.

  \trivial[]{ By \cite{Vg}*{0.4.6}, we can naturally identify $Q$ with the set
    of $H^{s}$-weights consisting the characters occurs in $S(\fgg)$ where
    $H^{s}$ is a maximally split Cartan in $G$. Therefore, the set of
    irreducible $G$-submodules occur in $S(\fgg)$ is also naturally identified
    with $Q/W=\Rg$. We let $\Rg$ acts on $\Grt(G)$ by the tensor product of
    $G$-modules.

    Note that by the assumption that $G$ is in the Harish-Chandra class, each
    irreducible $\fgg$-submodule $F$ embeds in $S(\fgg)$ is automatically
    globalized to a $G$-module. The point is that the globalization is
    independent of the embedding of $F$ in $S(\fgg)$! }

\end{eg}

\begin{eg}
  Fix a $\Inn(\fgg)$-invariant closed subset $\sfS$ in the nilpotent cone of
  $\fgg$. Let $\Grt_{\sfS}(G)$ be the subgroup of $\Grt(G)$ spanned by
  $G$-modules whose complex associated varieties are contained in $\sfS$. For
  each $\mu\in \ahh^{*}$, define
  \[
    \Grt_{\mu,\sfS}(G) := \Grt_{ \mu}(G)\cap \Grt_{\sfS}(G).
  \]
  and write
  \[
    \Coh_{[\lambda],\sfS}(G):= \Coh_{[\lambda]}(\Grt_{\mu,\sfS}(G))
  \]
  which is a subspace of $\Coh_{\Lam}(G)$.

  \trivial[]{ Note that
    \[
      \AVC(\pi\otimes F) = \AVC(\pi).
    \]
    for each finite length $G$-module $\pi$ and finite dimensional $G$-module
    $F$. Therefore the $W_{[\lambda]}$-module
    \[
      \Coh_{[\lambda],\sfS}(G) = (\ev{\mu})^{-1}(\Grt_{\mu,\sfS}(G))
    \]
    for any regular $\mu\in [\lambda]$. }
\end{eg}


% \begin{eg}
%   For each infinitesimal character $\chi$ and a close $G$-invariant set
%   $\cZ\in \cN_{\fgg}$. Let $\Grt_{\,\cZ}(\fgg,K)$ be the Grothendieck group of
%   $(\fgg,K)$-module with infinitesimal character $\chi$ and complex associated
%   variety contained $\cZ$. Similarly, let $\Grt_{\chi,\cZ}()$
% \end{eg}

The following lemma shows that the diagram \cref{eq:bev.catO} still holds for
$\Coh_{[\lambda],\sfS}(G)$ and \Cref{count1} is its direct consequence.

% This is one of the first step towards the counting of the set
% \[
%   \Irr_{\mu,\sfS}(G):=\Set{\pi \in \Irr_{\mu}(G)| \text{$\AVC(\pi)\subset \sfS$} }.
% \]
% where
% \[
%   \Irr_{\mu}(G):=\Set{\pi \in \Irr(G)| \pi \text{ has infinitesimal character
% }\mu}.
% \]


\begin{lem}\label{lem:coh.count}
  For each $\mu$ and closed $\Inn(\fgg)$-invariant subset $\sfS$ in the
  nilpotent cone of $\fgg$, we have an isomorphism
  \[
    \bev{\mu}\colon \left(\Coh_{[\mu],\sfS}(G)\right)_{W_{\mu}} \longrightarrow \Grt_{\mu,\sfS}(G).
  \]
  In particular,
  \[
    \sharp(\Irr_{\mu,\sfS}(G)) = [1_{W_{\mu}}:\Coh_{[\mu],\sfS}(G)]
  \]
  % \[
  %   \dim {\barmu} = \dim (\cohm)_{W_\mu} = [\cohm, 1_{W_\mu}].
  % \]
\end{lem}
\begin{proof}
  This is a consequence of the formal properties of the translation functor,
  especially the theory of $\tau$-invariant.

  \def\Parm{\mathrm{Parm}} \def\cof{\Theta}

  {\bf The properties of the coherent family and translation principal:} (We
  refers to \cite{Vg}*{Section~7} for the proofs which also work in our
  (possibly non-linear) setting.)

  \begin{enumerate}[label=(\alph*)]
    \item \label{it:t1} The evaluation map
          \[
          \ev{\mu}\colon \Coh_{[\mu]}(G)\longrightarrow \Grt_{\mu}(G)
          \]
          is surjective for any $\mu \in [\mu]$, see \cite{Vg}*{Theorem~7.2.7}.
  \end{enumerate}
  Without of loss of generality, we may assume that $\mu\in \ahh$ is dominant
  and we fix a regular element $\lambda \in [\mu]$ so that $\mu$ is dominant
  with respect to $R^{+}_{[\lambda]}$.
  \begin{enumerate}[resume*]
    \item \label{it:t2} The evaluation map $\ev{\lambda}$ at $\lambda$ is an
          isomorphism \cite{Vg}*{Proposition~7.2.27}.
  \end{enumerate}
  For each $\pi\in \Grt_{\lambda}(G)$, let
  \[
    \Theta_{\pi}:= (\ev{\lambda})^{-1}(\pi)
  \]
  to be the unique coherent family such that $\Theta_{\pi}(\lambda) = \pi$,
  \begin{enumerate}[resume*]
    \item \label{it:t3} If $\pi\in \Irr_{\lambda}(G)$, then $\Theta_{\pi}(\mu)$
          is either zero or an irreducible $G$-module
          \cite{Vg}*{Proposition~7.3.10, Corollary~7.3.23}.
    \item \label{it:t4} For $\pi\in \Irr_{\lambda}(G)$,
          \[
          \AV(\Theta_{\pi}(\mu)) = \AV(\pi)
          \]
          whenever $\mu$ is dominant and $\Theta_{\pi}(\mu)$ non-zero.
          \trivial[]{ This because
          $\pi = \psi_{\mu}^{\lambda}(\Theta_{\pi}(\mu))$ and
          $\Theta_{\pi}(\mu) = \psi_{\lambda}^{\mu}(\pi)$. Here is the
          translation functor from $\lambda$ to $\mu$ see
          \cite{Vg}*{Definition~4.5.7}. Translation dose not increase the
          associated variety. }
    \item \label{it:t5} If $\pi$ and $\pi'$ are in $\Irr_{\lambda}(G)$ such that
          $\Theta_{\pi}(\mu) = \Theta_{\pi'}(\mu)$ is non-zero, then $\pi=\pi'$
          (see \cite{V4}*{Corollary~7.3.23}).
  \end{enumerate}
  For $\pi\in \Irr_{\lambda}(G)$, define the $\tau$-invariant of $\pi$ to be
  \begin{equation}\label{eq:taupi}
    \tau(\pi) := \Set{\alpha\in R^{+}_{[\lambda]}|
      \begin{array}{l}
        \text{$\alpha$ is simple and }\\
        s_{\alpha}\cdot \Theta_{\pi}(\lambda) = -\Theta_{\pi}(\lambda)
      \end{array}
    }
  \end{equation}
  \begin{enumerate}[resume*]
    \item
          \label{it:t6}
          $\Theta_{\pi}(\mu) =0$ if and only if
          $\tau(\gamma)\cap R_\mu \neq \emptyset$
          \cite{Vg}*{Corollary~7.3.23~(c)}.
  \end{enumerate}

  Now we start to prove the lemma. By \ref{it:t4}, we see that $\ev{\lambda}$
  induces a $\WLam$-module isomorphism
  \[
    \ev{\lambda} \colon \Coh_{[\lambda],\sfS}(G) \xrightarrow{\ \ \cong \ \ } \Grt_{\lambda,\sfS}(G).
  \]

  By \ref{it:t6}, the set %the translation principle,
  \[
    \begin{split}
      & \Set{\Theta_{\pi}(\mu)| \pi\in \Irr_{\lambda, \sfS}(G)
        \text{ s.t. } \Theta_{\pi}(\mu)\neq 0} \\
      = & \Set{\Theta_{\pi}(\mu)| \pi\in \Irr_{\lambda, \sfS}(G) \text{ s.t.
        } \tau(\pi)\cap R_{\mu}= \emptyset}.
    \end{split}
  \]
  forms a basis of $\Grt_{\mu,\sfS}(G)$. \trivial{ The set consists of distinct
    (so linearly independent) irreducible $G$-modules by \ref{it:t3} and
    \ref{it:t5}. They are spanning set by \ref{it:t1}. For the support
    condition, see \ref{it:t4}. The $\tau$-invariant condition is by
    \ref{it:t6}.
    % by \ref{it:t6} and
  } Hence
  \[
    \begin{split}
      \ker \ev{\mu} = & \Span \Set{\Theta_{\pi}| \pi\in \Irr_{\lambda, \sfS}(G) \text{
          s.t. }
        \tau(\pi)\cap R_{\mu}\neq \emptyset}\\
      \subseteq & \Span \Set{\half(\Theta_\pi - s_{\alpha}\cdot \Theta_{\pi}) | \pi\in \Irr_{\lambda, \sfS}(G) \text{
          and } \alpha \in
        \tau(\pi)\cap R_{\mu}}\\
      & \ \ \ \  \text{(by the definition of $\tau(\pi)$ in \eqref{eq:taupi}.)} \\
      \subseteq &\Span\Set{\Theta- w\cdot \Theta |\Theta\in \Coh_{[\mu],\sfS}(G)} \\
      \subseteq & \ker \ev{\mu}. \\
      &\ \ \ \ \text{(by
        $w\cdot \Theta(\mu) = \Theta(w^{-1}\cdot \mu)=\Theta_\pi(\mu)$)}
    \end{split}
  \]
  Since
  $\left(\Coh_{[\mu],\sfS}(G)\right)_{W_{\mu}} =\Coh_{[\mu],\sfS}(G)\slash \Span\set{\Theta- w\cdot \Theta |\Theta\in \Coh_{[\mu],\sfS}(G)} $,
  the lemma follows.
\end{proof}

\begin{remark}
  The above argument can be easily generalized to other situations when
  translation principal holds. For example, we define the space
  $\Coh_{\Lam,\sfS}(\fgg,\fhh,\fnn)$ of coherent families in category $\cO$
  whose associated variety are contained in $\sfS$. Then, for $\mu\in \Lam$,
  $\ev{\mu}$ also induces an isomorphism
  \[
    \left(\Coh_{[\lambda],\sfS}(\fgg,\fhh,\fnn)\right)_{W_{\mu}} \xrightarrow{\ \ \cong \ \ } \Grt_{W\cdot \mu,\sfS}(\fgg,\fhh,\fnn).
  \]
\end{remark}


\section{Review of Primitive ideals and Weyl group representations}

\subsection{Associated varieties of a primitive ideals and double cells in
  $\WLam$}
In this section, we review the notion of double cells and its relation with the
associated varieties of primitive ideals, see \cite{BV2,J.av}. We follows
closely to \cite{BV2}. We retain the notation in \Cref{eg:hw}.

Let $\Prim_{W\cdot \lambda}(\fgg)$ be the set of primitive ideals in $\cU(\fgg)$
with infinitesimal character $\lambda$. Let $\lambda \in \fhh^{*}$, each
primitive ideal is the annihilator of a highest weight module by Duflo
\cite{Du77}. In other words, the following map is surjective
\[
  \begin{array}{ccl}
    \WLam &\longrightarrow &  \Prim_{W\cdot \lambda}(\fgg)\\
    w & \mapsto & I(w\cdot \lambda) := \Ann L(w\cdot \lambda).
  \end{array}
\]



% We now recall some results about the blocks in category $\cO$.

By the translation principal, we concentrate the discussion in the regular
infinitesimal character case.

% From now on, we follows the convention in \cite{BV2}. Let $\lambda$ be a
% regular element in $\fhh^{*}$ such that
% $R^{+}_{[\lambda]}\subset - \WT{\fnn}$. \trivial{ Here $\lambda$ is regular
% anti-dominant ($\inn{\lambda}{\ckalpha}\notin \bN$ for each
% $\alpha\in \WT{\fnn}$) with respect to the root system defining highest weight
% modules, but it is dominant with respect to $R^{+}_{[\lambda]}$. }

For each $w\in W_{[\lambda]}$, define
\[
  a(w) := \abs{\WT{\fnn}} - \GKdim(L(w\lambda)).
\]
\trivial{ Suppose $\lambda$ is integral, then Under this definition,
  $a_{w_{0}} = \abs{\WT{\fnn}}$ and $a_{e} =0$. } For each $w$, one can attach a
polynomial $\wtpp_{w}$ such that
$\wtpp_{w}(\mu) = \rank(\cU(\fgg)/\Ann(L(w\mu)))$ when $\mu\in [\lambda]$ is
dominant (i.e. $-\inn{\mu}{\ckalpha}\notin \bN^{+}$ for all
$\alpha\in R^{+}_{[\lambda]}$). $\wtpp_{w}$ is called the Goldie-rank polynomial
attached to the primitive ideal $\Ann(L(w\lambda))$. Fix a dominant regular
element $\delta$ in $\fhh$ (i.e. $\inn{\delta}{\alpha}>0$ for each
$\alpha\in \WT{\fnn}$). Let
\[
  r_{w} = \sum_{y\in W_{[\lambda]}} a_{y,w} (y^{-1}\delta)^{a(w)} \in S(\fhh)
\]
where $a_{y,w}$ is determined by the equation
\[
  L(w\lambda) = \sum_{y\in W_{[\lambda]}} a_{y,w} M(w\lambda)
\]
in $\Grt(\fgg,\fhh,\fnn)$. Then $r_{w}$ is a positive multiple of $\wtpp_{w}$
\cite{J2}*{Section~1.4}.

% Let $w_{0}$ (resp. $w_{[\lambda]}$)be the longest element in $W$ (resp.
% $\Wlam$).
A partial order $\leqL$ can be define on $W_{[\lambda]}$ by the following
condition \cite{BV2}*{Proposition~2.9}
\begin{equation}\label{eq:leqL}
  \begin{split}
    w_{1} \leqL w_{2} & \Leftrightarrow
    I(w_{1}\lambda)\subseteq I(w_{2}\lambda)\\
    & \Leftrightarrow
    % [L(w_{2}^{-1}\lambda), L(w_{1}^{-1}\lambda)\otimes S(\fgg)] \neq 0.
    L(w_{2}^{-1}\lambda) \text{ is a subquotient of
    } L(w_{1}^{-1}\lambda)\otimes S(\fgg).
  \end{split}
\end{equation}

We say $w_{1} \approxL w_{2}$ if and only if $w_{1}\leqL w_{2}\leqL w_{1}$. For
$w\in W_{[\lambda]}$, we call
\[
  \CL_{w} := \Set{ w' \in W_{[\lambda]}| w\approxL w'}
\]
the left cell in $W_{[\lambda]}$ containing $w$.

In summary, we have a bijection
\[
  \begin{array}{ccc}
    W_{[\lambda]}/ \approxL &\longrightarrow & \Prim_{\lambda}(\fgg)\\
    \CL_{w} & \mapsto & \Ann L(w\lambda).
  \end{array}
\]
% here $w$ is a arbitrary element in $\LC$. Moreover, for each left cell
% $\LC_{w}$



The partial order $\leqR$ is defined by
\[
  w_{1}\leqR w_{2} \Leftrightarrow w_{1}^{-1} \leqL w_{2}^{-1}.
\]
The partial order $\leqLR$ is defined to be the minimal partial order containing
$\leqL$ and $\leqR$. The relation $\approxR$, $\approxLR$, right cell $\CR_{ w}$
and double cells $\CLR_{w}$ are defined similarly.

Since the Kazhdan-Lusztig conjecture has been proven (for the integral
infinitesimal character case by \cite{BB,BK} and reduced to the integral
infinitesimal character case by \cite{Soergel} (see \cite{H}*{Section~13.13})),
the definition of the order $\leqL$ is the same as the partial order defined by
Kazhdan-Lusztig \cite{KL} which only depends on the Coxeter group structure of
$W_{[\lambda]}$, see \cite{BV2}*{Corollary~2.3}. \trivial[]{ Note that
  $x\lneqL y$ implies $a(x)<a(y)$ and $x\approxLR y$ implies $a(x)=a(y)$. }

Note that the left cells are exactly the fibers of the map $w\mapsto \wtpp_{w}$.
Take a double cell $\CLR_{w}$ in $W_{[\lambda]}$ and a set of representatives
$\set{w_{1}, w_{2}, \cdots, w_{k}}$ of the left cells in $\CLR_{w}$.
% and decompose it into disjoint union of left-cells
% \[
%   \LRC_{w} = \bigsqcup_{i=1}^{k} \LC_{w_{i}}.
% \]
% Due to Joseph\cite{J2} and Barbasch-Vogan\cite{BV1,BV2}, we have the following
% statements:
%
Due to Barbasch-Vogan\cite{BV1,BV2} and Joseph\cite{J1,J2,J3,J.av}, the
following statements holds:
\begin{itemize}
  \item the set of Goldie rank polynomials
        $\set{\wtpp_{w_{i}}|i = 1,2,\cdots,k}$ form a basis of a special
        representation $\sigma_{w}$ of $W_{[\lambda]}$ realized in
        $S^{a(w)}(\fhh)$;
  \item the multiplicity of $\sigma_{w}$ in $S^{a(w)}(\fhh)$ is one,
  \item $a(w)$ is the minimal degree $m$ such that $\sigma_{w}$ occurs in
        $S^{m}(\fhh)$ which is the fake degree and the generic degree of the
        special representation $\sigma_{w}$. \trivial[]{ When
        $W_{[\lambda]} = W$, this is the definition of the fake degree.
        Otherwise, $\fhh = \fhh_{0}\oplus \fhh^{W_{\lambda}}$ where $\fhh_{0}$
        is the span of coroots of $W_{[\lambda]}$. Then $S(\fhh_{0})$ is embeds
        in $S(\fhh)$. }
  \item the map
        $W_{[\lambda]}/\approxLR \; \ni \CLR_{w}\mapsto \sigma_{w}\in \Irr(W_{[\lambda]})$
        yields a bijection between the set of double cells and the set
        $\Irrsp(W_{[\lambda]})$ of special representations of $W_{[\lambda]}$.
  \item Under the $W$ action, the $W_{[\lambda]}$-module
        $\sigma_{w}\subset S^{a(w)}(\fhh)$ generates an irreducible $W$-module
        $\wtsigma_{w}:=j_{W_{[\lambda]}}^{W}\sigma_{w}$. The $W$-module
        $\wtsigma_{w}$ corresponds to the a nilpotent orbit $\cO_{\wtsigma_{w}}$
        with trivial local system under the Springer correspondence. Now the
        complex associated variety
        \[
        \AVC(L(w\lambda)) = \Gad\cdot \AV(L(w\lambda)) =\bcO_{\wtsigma_{w}},
        \]
        see \cite{J.av}*{Section~2.10}.
\end{itemize}
\trivial[]{ Note that the $j$-induction is not injective in general. For
  example,
  $j_{S_{a}\times S_{b}}^{S_{a+b}} \tau_{a}\otimes \tau_{b} = \tau_{a}\cupcol \tau_{b}$
  where $\tau_{a}$, $\tau_{b}$ are partitions. }

% \subsubsection*{Clan of primitive ideals}
% Under the above notation, we say two
Following Joseph, we say two primitive ideals $I(w\lambda)$ and $I(w'\lambda)$
with $w, w'\in \WLam$ are called in the same \emph{clan} if and only if
$w\approxLR w'$ or equivalently $\sigma_{w}=\sigma_{w'}$.

Obviously, the associated varieties of two primitive ideals in the same clan has
the same associated variety. However the reverse dose not holds in the
non-integral infinitesimal character case in general.

\subsubsection*{Coherent continuation representations}
Now we recall the relationships between cells and the coherent continuation
representations.

For each $w\in W$, we define a coherent family $L_{w}$ by the condition
$L_{w}(\lambda) = L(w\cdot \lambda)$.

For each $\nu\in \fhh^{*}$, let $\cO_{[\nu]}(\fgg,\fhh,\fnn)$ be the subcategory
of the category $\cO(\fgg,\fhh,\fnn)$ consists of $\fgg$-modules whose
$\fhh$-weights are contained in $[\nu]$,
\[
  \Grt_{W\cdot\lambda,[\nu]}(\fgg,\fhh,\fnn) := \Grt_{[\nu]}(\fgg,\fhh,\fnn)\cap \Grt_{W\cdot \lambda}(\fgg,\fhh,\fnn)
\]
which is spanned by a block in the category $\cO$ if
$W\cdot \lambda \cap [\mu+\rho]\neq \emptyset$.

Consider the following subgroup of coherent continuation
\[
  \Coh_{[\lambda]}(\fgg,\fhh,\fnn; [\nu]) = \Set{\Theta\in \Coh_{[\lambda]}(\fgg,\fhh,\fnn)| \Theta(\lambda) \in \Grt_{W\cdot \lambda, [\nu]}(\fgg,\fhh,\fnn) }.
\]
We can identify $\bC[\WLam]$ with $\Coh_{\Lam}(\fgg,\fhh,\fnn,[\lambda-\rho])$
via $w \mapsto M_{w}$.

For each $w\in W_{[\lambda]}$, let
\[
  \begin{split}
    \bVR_{w}& :=\Span\Set{L_{w'}|w\leqR w'} \\
    \VR_{w}&= \bVR _{w}\left/ \sum_{w\lneqL w'} \bVR_{w'} \right.
  \end{split}
\]
By \eqref{eq:leqL}, $\bVR_{w}$ and $\VR_{w}$ are $W_{[\lambda]}$-modules under
right translation/coherent continuation action.

We define left $W_{[\lambda]}$-module $\bVL_{w}$ and $\VL_{w}$ using $\leqL$ and
$W_{[\lambda]}\times W_{[\lambda]}$-module $\bVLR_{w}$ and $\VLR_{w}$ using
$\leqLR$ similarly.

Suppose $\sigma_{1}, \sigma_{2}\in \Irr(W_{[\lambda]})$. We define
\[
  \sigma_{1}\leqLR \sigma_{2} \Leftrightarrow \exists w\in W_{[\lambda]} \text{
    such that }
  \begin{cases}
    \sigma_{1} \otimes \sigma_{1} \text{ occurs in } \VLR_{w}
    \text{ and } \\
    \sigma_{2} \otimes \sigma_{2} \text{ occurs in } \bVLR_{w}.
  \end{cases}
\]
Now $\sigma_{1}\approxLR \sigma_{2}$ if and only if there exists a
$w\in W_{[\lambda]}$ such that $\sigma_{1} \otimes \sigma_{1}$ and
$\sigma_{2} \otimes \sigma_{2}$ both occur in $\VLR_{w}$. Now $\leqLR$ is a well
defined partial order and $\approxLR$ is an equivalent relation on
$\Irr(W_{[\lambda]})$ respectively. We write
$\LRC_{\sigma}\subseteq \Irr(\Wlam)$ for the double cell containing $\sigma$.
\trivial[]{ A priori
  $\sigma_{1}\approxLR \sigma_{2}\Leftrightarrow \sigma_{1}\leqLR \sigma_{2}\leqLR \sigma_{1}$.

  But note that $\bigoplus_{w\in \Wlam/\approxLR} \VLR_{w} \cong \bC[\Wlam]$ and
  $\sigma\otimes \sigma$ has multiplicity one in $\bC[\Wlam]$ which implies the
  claim. }

A left (resp. right cell) in $\Irr(\Wlam)$ is the multiset of the irreducible
constituents in $\VL_{w}$ (resp. left cell) for some $w\in \Wlam$.

The equivalence of Barbasch-Vogan's definition and Lusztig's definition of cells
in $\Irr(\Wlam)$ is a consequence of Kazadan-Lusztig conjecture, see
\cite{BV2}*{remarks after Corollary~2.16}.

The structure of double and left cells are explicitly described in
\cite{Lu}*{Section~4}. In particular, $\sigma_{w}$ is the unique special
representation occurs in the double cell
\[
  \LRC_{w}:= \Set{\sigma| \sigma\otimes \sigma \text{ occurs in
    } \VLR_{w}} \subseteq \Irr(\Wlam).
\]
For this reason, we also write
\[
  \LRC_{\sigma}:=\LRC_{w}
\]
where $\sigma=\sigma_{w}$ is the unique special representation in $\LRC_{w}$.
The generic degree ``a''-function is constant on the double cells and order
preserving: for each $\sigma'\in \LRC_{\sigma}$, the generic degree
$a(\sigma')=a(\sigma)$; $a(\sigma')<a(\sigma'')$ if $\sigma'\lneqLR \sigma''$.

In summary, we have bijections
\[
  \Wlam/\approxLR \longleftrightarrow\Irrsp(\Wlam)\longleftrightarrow \Irr(\Wlam)/\approxLR.
\]
We write $\VLR_{\sigma}$ to be the unique double cell representation containing
$\sigma$ and $\bVLR_{\sigma}$ to be the unique upper cone representation which
is isomorphic to $\bigoplus_{\sigma\leqLR \sigma'}\sigma'\otimes \sigma'$.

Recall that, for each $\sigma\in \Irr(\WLam)$, we define
\[
  \cO_{\sigma}:= \Spr(j_{\WLam}^{W}\sigma_{0}).
\]
where $\sigma_{0}$ is the unique special representation in $\LRC_{\sigma}$.

We have the following well known fact. % from the above discussion.
\begin{lem}\label{lem:LRorbit}
  Suppose $\sigma,\sigma'\in \Irr(\Wlam)$ such that $\sigma\leqLR \sigma'$. Then
  \[
    \bcO_{\sigma} \supseteq \bcO_{\sigma'}
  \]
  and the strict inclusion holds if $\sigma\lneqLR \sigma'$.\qed
\end{lem}
\trivial[]{ Here we give a sketch of the proof. By the definition of cons. There
  exists a chain of elements,
  $w_{1}\leqL w_{2}\leqR w_{3}\cdots \leqL w_{2k} \leqR w_{2k+1} $ such that
  $\sigma \approxLR \sigma_{w_{1}}$ and $\sigma'\approxLR \sigma_{w_{2k+1}}$. Now, for
  $1\leq l\leq k$,
  \begin{itemize}
    \item $\bcO_{\sigma_{w_{2l-1}}}\supseteq \bcO_{\sigma_{w_{2l}}}$ by
          $I(w_{2l-1}\lambda)\subseteq I(w_{2l}\lambda)$ and
    \item $\bcO_{\sigma_{w_{2l}}}\supseteq \bcO_{\sigma_{w_{2l+1}}}$ since
    $L(w^{-1}_{2l+1}\lambda)$ is a subquotient of
     $L(w^{-1}_{2l}\lambda)\otimes S(\fgg)$.
  \end{itemize}
  Since $\cO_{\sigma} = \cO_{\sigma_{w_{1}}}$ and
  $\cO_{\sigma'} = \cO_{w_{2k+1}}$, the inclusion follows.
  The strict inequality is clear by consider the GK-dimension, or the $a$-value. }


  For any $\Gad$-invariant closed set $\sfS$ in the nil-cone of $\fgg$, let
  \begin{equation}\label{eq:C.S}
      \Csp_{\sfS} := \Set{\sigma \in \Irrsp(\WLam)| \Spr(j_{\WLam}^{W}\sigma)\subseteq \sfS}. \\
  \end{equation}
  As  corollary of \Cref{lem:LRorbit}, we have
\[
  \sfC_{\sfS} = \Set{\sigma\in \Irr(\Wlam)|
    \exists \sigma_{0} \in \Csp_{\sfS}
    \text{ such that } \sigma_{0} \leqLR \sigma}.
\]



When study unipotent representations, we need the following lemma by
Barbasch-Vogan \cite{BVUni}.


% Let $a(\sigma)$ be the generic degree of a Weyl group representation $\sigma$.

\begin{lem}[{\cite{BVUni}*{(5.26), Proposition~5.28}}]
  \label{lem:LC.mu}
  \label{lem:lcell.BV}
  Suppose $\mu\in \ahh^{*}$. Let
  \[
    a_{\mu} = \max\set{a(\sigma)| \sigma \in \Irr(W_{[\mu]}) \text{ and
      } [1_{W_{\mu}}: \sigma]\neq 0}.
  \]
  and
  \[
    \LC_{\mu} := \set{\sigma \in \Irr(W_{[\mu]}) | a(\sigma) = a_{\mu} \text{
        and } [1_{W_{\mu}}: \sigma]\neq 0 }.
  \]
  Then
  % \begin{itemize}
            %       \item $\Wlamck$ is a Levi subgroup of $\WLamck$, and
            %       \item
  $\LC_{\mu}$ is a left cell of $W_{[\mu]}$ given by
  \begin{equation}\label{eq:LC.mu}
    \LC_{\mu}=(J_{W_{\mu}}^{W_{[\mu]}} \sgn )\otimes \sgn
  \end{equation}
  which contains a unique special representation
  \[
    \sigma_{\mu}=(j_{W_{\mu}}^{W_{[\mu]}} \sgn )\otimes \sgn.
  \]
  Moreover, $\LC_{\mu}$ is multiplicity free, which is equivalent to
  \[
    [1_{W_{\mu}}:\sigma]=1 \quad \text{for each } \sigma\in \LC_{\mu}.
  \]

  Let
  \begin{equation}\label{eq:O.mu}
    \cO_{\mu} = \Spr(j_{W_{[\mu]}}^{W}\sigma_{\mu}).
  \end{equation}
  Then
  \[
    \bcO_{\mu} = \AV(\cI_{\mu}) \AND \LC_{\mu} = \Set{\sigma\in \sfC_{\bcO_{\mu}}| [1_{W_{\mu}}:\sigma]\neq 0}
  \]
  where $\cI_{\mu}$ is the maximal primitive ideal with infinitesimal character
  $\chi_{\mu}$. \qed
\end{lem}

\trivial{ This is essentially contained in \cite{BVUni}.

  We adapt the notation in \cite{BVUni}: two special representations
  $\sigma \LRleq \sigma'$ if and only if $\cO_{\sigma}\supseteq \cO_{\sigma'}$
  where $\cO_{\sigma}:=\Spr(\sigma)$. The generic degree of $\sigma$ is denoted
  by $a(\sigma)$. Note that the ordering of double cells/special representation
  is the same as the closure relation on special nilpotent orbits, see
  \cite{BVUni}*{Prop 3.23}.

  Note that induction maps left cone representation to a left cone
  representation \cite{BVUni}*{Prop~4.14~(a)}. Therefore
  $\Ind_{W_{\mu}}^{W_{[\mu]}}\sgn$ is a left cone representation.
  $J_{W_{\mu}}^{W_{[\mu]}}\sgn$ is a left cell (since $J$-induction preserves
  left cell \cite{BVUni}*{Prop~4.14~(b)}), it consists of the constituents in
  the induced representation with the minimal generic degree (by the definition
  of $J$-induction), it is also the set of constituents in
  $\Ind_{W_{\mu}}^{W_{[\mu]}}\sgn$ sit in the same $\approxLR$ equivalence class
  (a unique double cell $\cD$).


  Recall that tensoring with sign (or rather twisting $w_{0}$) is an order
  reversing bijection of left cells in $\WLamck$ and induces a $LR$-order
  reversing bijection on $\Irr(\Wlamck)$, see \cite{BV2}*{Prop.~2.25}. Therefore
  $\Ind_{\Wlamck}^{\WLamck} 1 = \left(\Ind_{\Wlamck}^{\WLamck} \sgn\right)\otimes \sgn$
  has a set of constituents which is maximal under the $LR$-order, in particular
  the generic degree takes maximal value on these representations.

  Hence we get the conclusion. }


\subsection{Compare blocks}
Now we compare different blocks. Without of loss of generality, we assume
$\lambda$ is in the anti-dominant cone of $\WT{\fnn}$, i.e
$\inn{\lambda}{\ckalpha}<0$ for all $\alpha\in \WT{\fnn}$.

Let $k=\sharp(W/\WLam)$ and
\[
  % \Set{r_1,\cdots, r_{k}} \Set{r|\text{the length of $r$ with respect to
  % simple roots in $-\WT{\fnn}$ is minimal in $r\Wlam$} }
  \Set{r_1,\cdots, r_{k}} := \Set{r|l(r) \text{ is minimal among elements in
    }r\WLam }
\]
% \[
%   \set{r_{i}\Wlam|i =1, 2, \cdots, k}
% \] be the list of right cosets of $W/\Wlam$.
be the set of distinguished representatives of the right cosets of $\Wlam$ where
$l(r)$ denote the length function with respect to the simple roots in
$-\WT{\fnn}$. In other words, $r_{i}$ is the unique element in the coset
$r_{i}\Wlam$ such that $r_{i}\lambda$ is anti-dominant with respect to
$\WT{\fnn}$, i.e. $R^{+}_{[r_{i}\lambda]}\subseteq -\WT{\fnn}$.
% We choose $r_{i}$ to be the unique element in the coset $r_{i}\Wlam$ such that
% $r_{i}\lambda$ is anti-dominant, i.e.
% $R^{+}_{[r_{i}\lambda]}\subseteq -\WT{\fnn}$.

% Let $S_{[\lambda]}$ be the set of simple roots in $R^{+}_{[\lambda]}$. Apply
% Soergel's theorem \cite{H}*{13.13}, we have Then
% \begin{itemize}
%   \item The map $L(w\lambda) \mapsto L(r_{i} w\lambda)$ with $w$ running over
          %      $w\in W_{[\lambda]}$ induces an equivalence of category from $\cO_{W\cdot \lambda, [\lambda]}(\fgg,\fhh,\fnn)\cap$ to $\cO_{W\cdot\lambda, [r_{i}\lambda]}$ by Soegel's theorem \cite{H}*{13.13}.
          %     \item $w\mapsto r_{i} w r_{i}^{-1}$ induces isomorphism
          %     $W_{[\lambda]}\rightarrow W_{[r_{i}\lambda]}$ and preserves the
          %     cell structures.
          %     \item The following $\Wlam$-module isomorphism
          %           \[
          %           \begin{tikzcd}
          %             & \bC[W_{}]& \\
          %           \end{tikzcd}
          %           \]
          %   \end{itemize}

Now the map $L(w\lambda) \mapsto L(r_{i} w\lambda)$ with $w$ running over
$w\in W_{[\lambda]}$ induces an equivalence of category from
$\cO_{W\cdot \lambda, [\lambda]}(\fgg,\fhh,\fnn)\cap$ to
$\cO_{W\cdot\lambda, [r_{i}\lambda]}$ by Soegel's theorem \cite{H}*{13.13}. In
particular $w\mapsto r_{i} w r_{i}^{-1}$ induces isomorphism
$W_{[\lambda]}\rightarrow W_{[r_{i}\lambda]}$ and preserves the cell structures.
In other words, the following $\Wlam$-module isomorphism
\[
  \begin{tikzcd}
    & \bC[W_{}]\ar[dl, "w\mapsto M_{w}"'] \ar[dr,"w\mapsto M_{r_{i}w}"]& \\
    \Coh_{[\lambda]}(\fgg,\fhh,\fnn;[\lambda-\rho])\ar[rr] & & \Coh_{[\lambda]}(\fgg,\fhh,\fnn;[r_{i}\lambda-\rho])
  \end{tikzcd}
\]
maps cell representations to cell representations.

\trivial{ Let
  $C = \set{x\in \fhh| \inn{x}{\alpha} >0 \ \forall \alpha\in \WT{\fnn}}$ and
  $D_{\lambda} = \set{x\in \fhh| -\inn{x}{\beta} >0 \ \forall \beta\in R^+_{[\lambda]}}$.
  $C$ and $D_{\lambda}$ are fundamental domains of $\fhh$ under $W$ and
  $W_{[\lambda]}$-actions. Clearly, $D_{w\lambda} = w D_{\lambda}$. The
  condition that $R^{+}_{[\mu]}\subset - \WT{\fnn}$ is equivalent to
  $D_{\mu}\supset C$.

  Now it is clear $D_{\lambda}$ is the union of $r_{i}^{-1} C$ when $r_{i}$
  running over the preferred coset representatives of $W/W_{[\lambda]}$. }

Recall the definition of clan of the primitive ideals. By the comparing the
definition of Goldie rank polynomials, we see that $I(r_{i}w)$ and $I(r_{j}w')$
in the same clan if and only if $w\approxLR w'$. In other word, the clan is only
depends on the $W_{[\lambda]}$-type of the double cell containing $L(w\lambda)$
where $w\in W$.

\medskip


The above discussion yields
the following.
\begin{lem}\label{lem:C.S}
  Fix a $\Gad$-invariant subset $\sfS$ in the nilpotent cone of $\fgg$.

  Then, as an $W_{[\lambda]}$-module
  \[
    \begin{split}
      \Coh_{[\lambda],\sfS}(\fgg,\fhh,\fnn) &= \bigoplus_{i=1}^{k}
      \Coh_{[\lambda], \sfS}(\fgg,\fhh,\fnn;[r_{i}\lambda-\rho])\\
      & \cong \bigoplus_{i=1}^{k} \sum_{\sigma\in \Csp_{\sfS}} \VLR_{\sigma}\\
      & \cong \bigoplus_{i=1}^{k} \bigoplus_{\sigma\in \sfC_{\sfS}} (\dim \sigma) \sigma
    \end{split}
  \]
\end{lem}

As a baby case of the counting theorem for special unipotent representation of
real reductive groups, we have the following counting theorem in the category
$\cO$.

We fix an regular element $\lambda\in [\mu]$ such that $\mu$ is dominant with
respect to $R^{+}_{[\lambda]}$. Let $S_{[\lambda]}$ be the set of simple roots
in $R^{+}_{[\lambda]}$. Let $\sfS_{\mu}$ be the subset of simple roots in
$R^{+}_{[\lambda]}$ orthogonal to $\mu$. Observe that $W_{\mu}$ is always a
parabolic subgroup attached to $\sfS_{\mu}$ in $W_{[\lambda]} = W_{[\mu]}$. Let
$\sfD_{\sfS_{\mu}}$ be the set of distinguished right coset representatives of
$W_{[\lambda]}/W_{\mu}$. \trivial[]{ $r\in \sfD_{\sfS_{\mu}}$ is the element
  with minimal lenght in $rW_{\mu}$. Recall that
  $\tau(w) = \set{\alpha\in S_{[\lambda]}|w\alpha\notin R^{+}_{[\lambda]} }$
  Note that $\tau(w)\cap R_{\mu}\neq \emptyset$ is equivalent to require that
  $w \sfS_{\mu}\subseteq R^{+}_{[\lambda]}$, i.e. $w$ is a minimal length
  element. See for example, Carter, Simple groups of Lie type, Theorem~2.5.8. }

\begin{thm}
  Let $\cO$ be an nilpotent orbit in $\fgg$ and $\mu\in \ahh^{*}$. Let
  $\Pi_{W\cdot \mu, \cO}$ be the set of irreducible highest weight modules $\pi$
  such that $\AVC(\pi) = \bcO$. Let
  \begin{equation}\label{eq:DC.O.mu}
    \begin{split}
      \Dsp_{\cO,\mu} &:= \Set{\sigma\in \Irrsp(W_{[\mu]})|\Spr(j_{W_{[\mu]}}^{W}\sigma) = \cO}\quad \text{
        and }\\
      \cD_{\cO,\mu} &= \bigcup_{\sigma\in \Dsp_{\cO,\mu}} \LRC_{\sigma}.
    \end{split}
  \end{equation}
  % $ be the set of special representations such that
  Then
  \[
    \abs{\Pi_{W\cdot\mu,\cO}} = \abs{W/W_{[\mu]}}\cdot \sum_{\sigma\in \cD_{\cO,\mu}} \left(\dim \sigma \cdot [1_{W_{\mu}}:\sigma]\right).
  \]


  Let
  \[
    \CLR_{\sigma,\mu} = \CLR_{\sigma}\cap \sfD_{\sfS_{\mu}}
  \]
  and $\CLR_{\cO,\mu} = \bigcup_{\sigma\in \Dsp_{\cO},\mu} \CLR_{\sigma,\mu}$. Then
  \[
    \Pi_{W\cdot\mu,\cO} = \Set{L(r_{i}w)|w\in \CLR_{\cO,\mu} \text{ and
      } i=1,2,\cdots,k} .
  \]
  Here $\VLR_{\sigma}$ is understood as a submodule of $\bC[\Wlam]$.
\end{thm}



For each $\mu\in \fhh^{*}$, let $\cI_{\mu}$ be the maximal primitive ideal
having infinitesimal character $\mu$. Let $\Pi_{W\cdot \mu}$ be the set of all
irreducible highest weight modules whose annihilator ideal are $\cI_{\mu}$. Then
\[
  \Pi_{W\cdot \mu} = \Pi_{W\cdot \mu, \cO_{\mu}}
\]
where $\cO_{\mu}$ is given by \eqref{eq:O.mu}.


Combine the above theorem with \Cref{lem:lcell.BV}, we have the following
counting theorem.
\begin{thm}
  Retain the notation in
  \Cref{lem:LC.mu}.
  \[ \abs{\Pi_{W\cdot \mu}} = \abs{W/W_{[\mu]}}\cdot \dim \LC_{\mu}.
  \]
  Moreover,
  \[
    \Pi_{W\cdot\mu} = \Set{L(r_{i}w)|w\in \CLR_{\sigma_{\mu}}\cap \sfD_{\sfS_{\mu}} \text{
        and } i=1,2,\cdots,k}
  \]
  \qed
\end{thm}



\subsection{A variation}
In this section, let
$(\fgg, H,\fnn)$ be a triple that
\begin{itemize}
  \item $\fgg$ is a complex reductive Lie algebra,
  \item $H$ is a Lie group such that
        $\fhh_{0}:= \Lie(H)$ is a real form of
       a Cartan subalgebra  $\fhh$ of $\fgg$,
  \item $\fnn$ is a maximal nilpotent subalgebra
        stable under the $\fhh$-action.
\end{itemize}
Let $\cO'(\fgg, H,\fnn)$ be the category of $(\fgg, H)$-module such that
$M\in \cO'(\fgg,H,\fnn)$
if and only if
\begin{itemize}
  \item $M$ is finitely generated as $\cU(\fgg)$-module,
  \item $\fnn$ acts on $M$ locally nilpotently, and
  \item $M$ decomposes in to a direct sum of finite dimension $H$-modules.
\end{itemize}
Let $\Grt(\fgg,H,\fnn)$ be the Grothendieck group of $\cO(\fgg,H,\fnn)$.

We write $H_{0}$ for the connected component of $H$ which is abelian.
Since $H_{0} = \exp(\fhh_{0})$ is central in $H$, for each $\phi\in \Irr(H)$
$\phi|_{H_{0}}$ is a multiple of character.
Hence taking the derivative yields a
well defined map
\[
\rdd \colon \Irr(H)\longrightarrow \fhh^{*}
\]
sending $\phi$ to $\dphi$.


Since $\rdd$ restricted on the lattice
\[
\tQ:=\Set{\phi\in \Irr(H)|\phi \text{
    occurs in } S(\fgg)}
\]
 is a bijection onto the root lattice $Q$ \cite{Vg}*{0.4.6}, we identify the root lattice $Q$ with the $\tQ$ in $\Irr(H)$.


Now assume $\phi\in \Irr(H)$ and let
\[
  [\phi] := \Set{\phi+\alpha| \alpha\in \tQ}
\]
and
$\cO'(\fgg,H,\fnn;[\phi])$ be the subcategory of $\cO'(\fgg,H,\fnn)$
consists of modules whose $H$ irreducible components are contained in $[\phi]$.
Define $\Coh_{[\lambda]}(\fgg,H,\fnn;[\phi])$ to be the space of coherent
families taking value in $\cO'(\fgg,H,\fnn;[\phi])$ and
$\Coh_{[\lambda]}(\fgg,H,\fnn;[\phi])$ to be its subspace whose complex
associated variety is contained in $\sfS$ for a $\Ad(\fgg)$-invariant closed subset $\sfS$ in the nilpotent cone of
$\fgg$.


We have the following lemma.
\begin{lem}
  Let $\phi\in \Irr(H)$ and fix a $\lambda\in \fhh^{*}$ such that
  $[\rdd \phi + \rho ]\cap W\cdot \lambda\neq \emptyset$.
  Then the forgetful functor
  \[
    \cF\colon \cO'(\fgg,H,\fnn)\longrightarrow \cO'(\fgg,\fhh,\fnn)
  \]
  induces a $W_{[\lambda]}$-module isomorphism
  \[
    \cF\colon \Coh_{[\lambda],\sfS}(\fgg,H,\fnn;[\phi])\longrightarrow
    \Coh_{[\lambda],\sfS}(\fgg,\fhh,\fnn;[\rdd\phi])
  \]
\end{lem}
\begin{proof}
  When $\sfS$ is the whole nilpotent cone, the isomorphism is
  given by identifying both sides with $\bC[W_{[\lambda]}]$ via Verma modules
  such that
  \[
  \wtM_{1}(\rdd \phi+\rho):=\cU(\fgg)\otimes_{\cU(\fhh\oplus\fnn),H}\phi
  \mapsto (\dim\phi)\cdot M_{1}(\rdd\phi+\rho):= \cU(\fgg)\otimes_{\cU(\fhh\oplus\fnn)}\rdd\phi.
  \]
  For $\phi'\in \Irr(H)$, $M(\phi'+\rho)$ has a unique irreducible quotient
  $L(\phi')$ by the same argument of the same argument for the highest weight module.   Now we have, $L(\phi'+\rho) = \dim(\phi')\cdot L(\rdd\phi'+\rho)$.
  \trivial{
    These claims should be also much more clear from the D-module point of view.
    The middle extension functor only see the $\cD_{\lambda}$-module structure
    and keeps the $T$-module structure automatically. Here $T$ is the maximal
    compact subgroup of $H$.
  }
  Since the associated variety only depends on the $\cU(\fgg)$-module structure,
  the rest part of the lemma follows.   {\color{red} Check!!}
\end{proof}

\trivial{
  Note that $H_{0}$ is abelian and $H = H_{0}$.
  By the assumption of Harish-Chandra class,
  $H = H_{0}\times H/H_{0}$. Here $H/H_{0}$ is a finite group maybe non-abelian.
}

The above lemma have the following immediate consequence.
\begin{cor}
  Retain the notation in \Cref{lem:C.S}. Then, for $\sigma\in \Irr(W_{[\lambda]})$
  \[
[\sigma:\Coh_{[\lambda],\sfS}(\fgg,H,\fnn)] \neq 0 \Leftrightarrow
  \sigma\in \sfC_{\sfS}.
  \]   \qed
\end{cor}



\section{Counting Harish-Chandra modules with support condition}

In this section, let $G$ be a real reductive group in the Harish-Chandra class.
Here $G$ could be a nonlinear group.
We retain the notation in \Cref{eg:Coh.HC}.
We recall the argument before \cite{Mc}*{Theorem~1}.

We fix a Cartan involution $\theta$ on $G$ and let $K = G^{\theta}$
be the maximal compact subgroup of $G$.

% \begin{thm}[Barbasch-Vogan]\label{thm:count}
%   For a complex nilpotent orbit $\cO$,
%   define
%   \[
%     S_{\cO} = \left\{\sigma \in \widehat{W_{[\mu]}}|
%       \Spr(j_{W_{[\mu]}}^{W} \sigma_{s}) = \cO
%     \right\}
%   \]
%   where $\sigma_{s}$ is the special representation in the double cell containing
%   $\sigma$.

%   Let $\Pi_{\cO,\mu}(G)$ denote the set of irreducible admissible $G$-module with
%   complex associated variety $\overline{\cO}$.
%   % Let $W_{\mu}$ be the stabilizer of $\mu$ and $W_{[\mu]}$ be the stabilizer of
%   % the lattice
%   Then
%   \[
%     \# \Pi_{\cO,\mu}(G) =
%     \sum_{\sigma\in S_{\cO}} [\sigma: \mathrm{Coh}_{[\mu]}(G)] \cdot
%     [1_{W_{\mu}}, \sigma|_{W_{\mu}}].
%   \]
%   % Here $[\sgima : \ ]$ denote the multiplicity of $\sigma$
%   % and  $W_{\mu}$ is the stabilizer of $\mu$.
% \end{thm}

\subsection{An embedding of coherent families of Harish-Chandra modules into
  that of category $\cO$}
In this section, we recall a result in \cite{Cas}. Let $\fbb = \fhh\oplus \fnn$
be a Borel subalgebra in $\fgg$ with the nilradical $\fnn$ and $\fhh$ a Cartan
subalgebra in $\fbb$. For a subalgebra $\fuu$ of $\fnn$ and $q\in \bN$, Casian
defined the localization functors $\gamma_{\fuu}^{q}$ on the category of
$\fuu$-module. By \cite{Cas}*{Proposition~4.8}, $\gamma_{\fuu}^{q}$ can be
defined as the right derived functor of the functor $\gamma_{\fuu}^{0}$ which
sends a $\fuu$-module $M$ to
\[
  \gamma_{\fuu}^{0}(M):= \Set{v\in M| \fuu^{k} v = 0 \text{ for some positive
      integer $k$}}.
\]
In particular, the $\fuu$-action on $\gamma_{\fuu}^{q}$ is locally nilpotent.

Suppose $M$ is a $\fgg$-module, we have (see \cite{Cas}*{Proposition~4.14})
\begin{equation}\label{eq:anngamma}
  \Ann M \subseteq \Ann (\gamma_{\fuu}^{q}(M)).
\end{equation}
Moreover, $\gamma_{\fuu}^{q}$ commutes with tensoring finite diemsional
representations of $\fgg$, i.e. for a finite dimensional $\fgg$-module $F$ there
is a natural isomorphism (c.f. \cite{Cas}*{Proposition~4.11})
\begin{equation}\label{eq:Fgamma}
  F\otimes \gamma_{\fuu}^{q}(M)\cong
  \gamma_{\fuu}^{q}(F\otimes M).
\end{equation}
If the $\fgg$-module have finite dimensional $\fnn$-cohomology, then
$\gamma_{\fnn}^{q}(M)$ is in the category $\cO'$. See
\cite{Cas}*{Proposition~4.9}.



Suppose $M$ is a $(\fgg,K)$-module. From the definition of $\gamma_{\fuu}^{q}$,
we can see that $\gamma_{\fuu}^{q}(M)$ is naturally a $(\fgg, K_{L})$-module
where $K_{L}$ denote the normalizer of $\fuu$ in $K$. Let $\fll$ be the
normailzer of $\fuu$ in $\fgg$. Then there is the a spectrum sequence of
$(\fll,K_{L})$-module convergent to $H^{p+q}(\fuu,M)$ (see
\cite{Cas}*{Proposition~4.4}):
\begin{equation}\label{eq:ugamma}
  H^{q}(\fuu,\gamma_{\fuu}^{p}(M)) \Rightarrow H^{p+q}(\fuu,M).
\end{equation}

For our application, we always assume $M$ is a $(\fgg,K)$-module, and take
$\fuu=\fnn$.

Let $H$ be a $\theta$-stable Cartan subgroup of $G$, $T=H^{\theta}$ be the
maximal compact subgroup of $H$ and $\fhh:=\Lie(H)_{\bC}$ is the corresponding
Cartan subalgebra in $\fgg$. We can view a finite dimensional $H$-module as a
$(\fhh,T)$-module and vice versa.

The localization functor $\gamma_{\fnn}^{q}$ is compatible with coherent
continuation.
\begin{lem}\label{lem:coh.gamma}
  Assume that each irreducible $(\fgg,K)$-module have finite dimensional
  $\fnn$-cohomology. For each $q\in \bN$, we have the following map between
  $\Wlam$-modules:
  \[
    \begin{array}{ccc}
      \gamma_{\fnn}^{q}\colon \Coh_{[\lambda]}(\fgg,K)
      &\longrightarrow
      & \Coh_{[\lambda]}(\fgg,H,\fnn) \\
      \Theta & \mapsto & \gamma_{\fnn}^{q}\circ \Theta.
    \end{array}
  \]
\end{lem}
\begin{proof}
  This is a consequence of \eqref{eq:anngamma} and \eqref{eq:Fgamma}. \trivial[]{
    \[
      \begin{split}
        F\otimes \gamma_{\fnn}^q\Theta(\mu) & =
        \gamma_{\fnn}^{q}(F\otimes \Theta(\mu))\\
        &= \gamma_{\fnn}^{q}(\sum_{\beta\in \WT{F}} \Theta(\mu+\beta))\\
        &= \sum_{\beta\in \WT{F}}\gamma_{\fnn}^{q}( \Theta(\mu+\beta))\\
      \end{split}
    \]
  }
\end{proof}

We fix a positive system of real roots $\Delta^{+}_{\bR}$ and a Borel subalgebra
$\fbb=\fhh\oplus \fnn$ such that $\Delta^{+}_{\bR}\subset \WT{\fnn}$. We let
$e^{\alpha}\in \Irr(H)$ be the $H$-character on the $\alpha$-root space.

For a finite length $(\fgg,K)$-module $M$, we view its global character
$\Theta_{G}(M)$ as a analytic function defined on the set $\Greg$ of regular
semisimple elements on $G$.


The following theorem is crucial.
\begin{thm}[\cite{Cas}*{Theorem~3.1}]\label{thm:gamma.HC}
  % Let $\bfnn$ be the maximal nilptent Lie subalgebra of $\fgg$ with spanned by
  % roots in $\Delta^{+}$.
  Let $M$ be a finite length $(\fgg,K)$-module. The following statements hold.
  \begin{enumT}
    \item The Lie algebra cohomology $H^{q}(\fnn,M)$ is finite dimensional for
    each $q\in \bN$. In particular, $\gamma_{\fnn}^{q}(M)$ is in the category
    $\cO'(\fgg,H,\fnn)$ for eah $q\in \bN$.
    \item
    % $\Ann M \subseteq \Ann (\gamma_{\fnn}^{q}M)$.
    % \item
    Let
    \[
      \Hnreg:= \Set{h\in H|
        \begin{array}{l}
          \text{$h$ is regular semisimple}\\
          \abs{e^{\alpha}(h)}<1 \text{ for each real root }
          \alpha\in \Delta^{+}_{\bR}
        \end{array}
      }
    \]
    Then
    \begin{equation}\label{eq:char}
      \begin{split}
        \Theta_{G}(M)|_{\Hnreg} &= \frac{\sum_{q\in \bN} (-1)^{q}\Theta_{H} \left(H^{q}(\fnn,M)\right)}
        {\prod_{\alpha\in \WT{\fnn}}(1- e^{\alpha})}\\
        &= \frac{\sum_{p,q\in \bN} (-1)^{p+q}\Theta_{H} \left(H^{q}(\fnn,\gamma_{\fnn}^{p}(M))\right)}
        {\prod_{\alpha\in \WT{\fnn}}(1- e^{\alpha})}\\
      \end{split}
    \end{equation}
  \end{enumT}
  \qed
\end{thm}
\begin{proof}
  The theorem is a recollection of Casian's results in loc. cit. The last
  equality in \eqref{eq:char} follows from \eqref{eq:ugamma}. The last
  expression in \eqref{eq:char} is also a finite sum, since only finite may
  terms of $\gamma_{\fnn}^{p}(M)$ are non-zero and they are in the category
  $\cO'$.
\end{proof}


Retain the notation in \Cref{thm:gamma.HC}, we write
\[
  \gamma_{\fnn}:= \sum_{q\in \bN} (-1)^{q} \gamma^{q}_{\fnn}\colon \Grt(\fgg,K) \longrightarrow \Grt(\fgg,H,\fnn)
\]

% \[
%   \gamma_{\fnn}:= \sum_{q\in \bN} (-1)^{q} \gamma^{q}_{\fnn}\colon \Coh_{[\lambda]}(\fgg,K) \longrightarrow \Coh_{[\lambda]}(\fgg,H,\fnn)
% \]

\begin{cor}[c.f. {\cite{Mc}}]\label{cor:HC.embed}
  % [\cite{Cas}*{Theorem~3.1}]
  Let $H_{1}, H_{2}, \cdots, H_{s}$ form a set of representatives of the
  conjugacy class of $\theta$-stable Cartan subgroup of $G$. Fix maximal
  nilpotent Lie subalgebra $\fnn_{i}$ for each $H_{i}$ as in
  \Cref{thm:gamma.HC}. Then
  \[
    \begin{array}{cccc}
      \gamma:=\oplus_{i} \gamma_{\fnn_{i}}: &\Grt(\fgg,K)
      &\longrightarrow & \bigoplus_{i=1}^{s} \Grt(\fgg,H_{i},\fnn_{i})\\
    \end{array}
  \]
  is an embedding of abelian groups.
\end{cor}
\begin{proof}
  Let $\Hireg$ be the set of regular semisimple elements in $H_{i}$. By the
  results of Harish-Chandra, taking the character of the elements induces an
  embedding of $\Grt(\fgg,K)$ into the space of real analytic functions on
  $\bigsqcup_{i} \Hireg$. Since $\Hnireg$ is open in $\Hireg$ and meets all the
  connected components of $\Hireg$, any real analytic function on
  $\bigsqcup_{i} \Hireg$ is determined by its restriction on
  $\bigsqcup_{i} \Hnireg$. Now \eqref{eq:char} implies that the global character
  of any $M\in \Grt(\fgg,K)$ can be computed from the image $\gamma(M)$.
  % $\Theta M$ of an element $M\in \Grt_{\chi}(\fgg,K)$ is completely determined
  % by the formal character $\mathrm{ch}(\gamma(M))$.
\end{proof}

\begin{cor}\label{cor:coh.HC}
  Retain the notation in \Cref{cor:HC.embed}.
  Let $\sfS$ be a $\Gcad$-invariant closed subset in the nilpotent cone of
  $\fgg$ and $\lambda\in \fhh^{*}$.
  Then $\gamma$ induces an embedding of $\Wlam$-module.
  \[
    \begin{array}{cccc}
      \gamma:=\oplus_{i} \gamma_{\fnn_{i}}: &\Coh_{[\lambda],\sfS}(\fgg,K)
      &\longrightarrow & \bigoplus_{i=1}^{s} \Coh_{[\lambda],\sfS}(\fgg,H_{i},\fnn_{i})\\
      &\Theta& \mapsto &\gamma\circ \Theta
    \end{array}
  \]
  In particular, $[\sigma:\Coh_{[\lambda],\sfS}(\fgg,K)]\neq 0$ only if
  $\sigma\in \sfC_{\sfS}$.
\end{cor}
\begin{proof}
  The maps is well-defined by \eqref{eq:anngamma}. It is an embedding by
  \Cref{cor:HC.embed}.
\end{proof}

\medskip

Now we get the following theorem on the upper bound of small representations.
\begin{thm}
  Let $\mu\in \fhh^{*}$. Let $\Pi_{W\cdot \mu}(G)$ be the set of irreducible
  $G$-modules annihilated by the maximal primitive ideal $\cI_{\mu}$ of
  infinitesimal character $\mu$. Let $\LC_{\mu}$ be the left cell of
  $\Irr(W_{[\mu]})$ defined in \eqref{eq:LC.mu} and $\cO_{\mu}$ be the nilpotent
  orbit defined by \eqref{eq:O.mu}. Then
  \[
    \begin{split}
      \abs{\Pi_{W\cdot \mu}(G)} &= \sum_{\sigma\in \LC_{\mu}}
      [\sigma:\Coh_{[\mu],\bcO_{\mu}}(G)]\\
      &\leq \sum_{\sigma\in \LC_{\mu}}
      [\sigma:\Coh_{[\mu]}(G)]\\
    \end{split}
  \]
\end{thm}
\begin{proof}
  The equality follows from \Cref{lem:coh.count}, \Cref{cor:coh.HC} and
  \Cref{lem:LC.mu}. The inequality is also clear since
  $\Coh_{[\mu],\bcO_{\mu}}(G)$ is a submodule of $\Coh_{[\mu]}(G)$.
\end{proof}

% Then the localization functor induces a homomorphism
% \[
%   \begin{array}{cccc}
%       \gamma_{\fnn}: &\Grt_{\chi,\cZ}(\fgg,K) &\longrightarrow & \Grt_{\chi,\cZ}(\cO_{\whH})\\
%       & M &\mapsto & \sum_{q}  (-1)^{q} \gamma^{q}_{\fnn} M
%     \end{array}
%   \]
%   Fix an infinitesimal character $\chi$, and a close $G$-invariant set
%   $\cZ\in \cN_{\fgg}$.


% \def\VHC{\sV^{\mathrm{HC}}}
% \begin{cor}
%   Fix an irreducible $(\fgg,K)$-module $\pi$ with infinitesimal character
%   $\chi_{\lambda}$. Let $\VHC(\pi)$ be the Harish-Chandra cell representation
%   containing $\pi$ and $\cD$ be the double cell in $\widehat{W_{[\lambda]}}$
%   containing the special representation $\sigma(\pi)$attached to $\Ann(\pi)$.
%   Then $[\sigma, \VHC(\pi)]\neq 0$ only if $\sigma \in \cD$. Moreover,
%   $\sigma(\pi)$ always occures in $\VHC(\pi)$
% \end{cor}
% \begin{proof}
%   The occurrence of $\sigma(\pi)$ is a result of King.

%   Note that we have an embedding
%   \[
%     \gamma \colon \Grt_{\chi}(\fgg,K)\longrightarrow \bigoplus_{i}\Grt(\fgg,\fbb,\lambda).
%   \]
%   where the left hand sides is identified with a finite copies of
%   $\bC[W_{[\lambda]}]$.

%   Since $\Ann(\pi)\subseteq \Ann (\gamma_{\fnn}^{q}(\pi))$, we conclude that
%   $[\sigma, \VHC(\pi)]\neq 0$ implies that $\sigma(\pi)\leqLR \sigma$.

%   By the Vogan duality, $\cD\otimes \sgn$ is also a Harish-Chandra cell. So we
%   have $\sigma(\pi)\otimes \sgn \leqLR \sigma\otimes \sgn$.

%   Therefore, $\sigma(\pi)\approxLR$
% \end{proof}
\begin{remark}
  Let $\lambda$ be a regular element in $[\mu]$. Assume that for each
  Harish-Chandra cell representation $\sV^{HC}$ at the infinitesimal character
  $\chi_{\lambda}$, the $W_{[\mu]}$-representations occur in $\sV^{HC}$ are all
  contained in a unique double cell. Then one can prove that the inequality in
  the above theorem is sharp (c.f. \cite{BV.W}). However, we do not know such
  kind of claim holds in a general.
\end{remark}


Another interesting consequence of \Cref{cor:coh.HC} is that we can determine
the complex associated variety attached to a Harish-Chandra cell by the
character of the cell representation.

\begin{lem}\label{lem:AV.HC}
  Let $\sC$ be an Harish-Chandra cell at a regular infinitesimal character $\lambda$ and $\sV$ be the corresponding cell
  representation.
  \trivial[]{
    I guess
    the assumption of ``regular'' is unnecessary.
  }
  Then there is a unique special representation $\sigma\in \Irrsp(W_{[\lambda]})$ such
  that $\sigma$ has minimal generic degree in $\sV$
  and every irreducible modules $\pi$ in $\sC$ has complex associated variety
  \[
    \AVC(\pi) = \Spr(\Ind_{W_{[\lambda]}}^{W}\sigma).
  \]
  Moreover, $\sigma$ is precisely the unique irreducible character
  with minimal fake degree occurring in $\sV$.
\end{lem}
\begin{proof}
  Let $\pi\in \sC$ and the primitive ideal $\Ann(\pi)$ is attached to the
  special representation $\sigma \in \Irr(W_{[\lambda]})$.
  By \Cref{cor:coh.HC}, every irreducible character $\sigma'$ occur in
  $\sV$ satisfies $\sigma \leqLR \sigma'$.
  On the other hand, $\sigma$ do occurs in $\sV$ by Barbasch-Vogan and King's
  result, see \cite{Cas}*{Remark~3.2}.
  The rest part of the lemma is clear.
\end{proof}

\subsection{Coherent continuation representation of Harish-Chandra modules}

In this section, we provides the proof of \Cref{thm:cohHC}, which is a formula of coherent continuation representation due to Barbasch-Vogan.
Note that the formula holds for non-linear groups as well as the non-integral
infinitesimal character!

\medskip

First recall the definition of regular characters \cite{Vg}*{Definition~6.6.1}.

A regular character of $G$ is a tuple a tuple $\gamma := (H,\Gamma,\bargamma)$
such that
\begin{itemize}
  \item $H$ is a $\theta$-stable Cartan subgroup of $G$,
  \item $\Gamma$ is a continuous character of $H$,
  \item if $\alpha$ is imaginary, then $\inn{\bargamma}{\ckalpha}$ is real and
        non-zero,
  \item the differential of $\Gamma$ is
        \[
        \bargamma+ \rho_{i} - 2\rho_{ic}
        \]
        where %$\rho_{i}$ is the half sum of imaginary roots $\$ such that $\inn{\bargamma}{\ckalpha}$
        \[
        \rho_{i} =\half\sum_{\substack{\alpha \text{
        imaginary}\\ \inn{\bargamma}{\ckalpha}>0}} \alpha \quad\text{and}\quad \rho_{ic} =\half\sum_{\substack{\alpha \text{
        compact imaginary}\\ \inn{\bargamma}{\ckalpha}>0}} \alpha.
        \]
\end{itemize}
We say $\gamma$ is non-singular if $\bargamma$ is regular in $\fhh^*$. The group $K$ acts on the set of regular characters of $G$ we let $[\gamma]$ to denote the $K$-conjugacy class of regular character containing $\gamma$.

Let $\cR(G)$ denote the set of regular characters of $G$ and $\cR_{\lambda}(G)$ be the subset of $\cR(G)$ consists of regular characters with infinitesimal character $\lambda$. Let $\cP(G):=\cR(G)/K$ and $\cP_{\lambda}(G):=\cR_{\lambda}(G)/K$ be the corresponding sets of $K$-conjugacy classes.
% of regular characters and $\cP_\lambda(G)$ be the subset with infinitesimal character $\lambda$. By abuse of notation, we identify $\gamma$ with its conjugacy class.

For each regular character $\gamma$, we attach a standard representation
$\pi_\gamma$ with infinitesimal character $\bargamma$ and let $\barpi_\gamma$ be
the maximal completely reducible submodule of $\pi_\gamma$
\cite{Vg}*{6.5.2,6.5.11,6.6.3}. Then $\barpi_\gamma$ and the image of
$\pi_\gamma$ in the Grothendieck group of $(\fgg,K)$-module only depends on the
$K$-conjugation class of $\gamma$. This justifies the consideration of $\cP(G)$.


Now we assume that $\lambda\in \fhh^*$ is a regular element. Then
$\barpi_\gamma$ is the unique irreducible submodule in $\pi_\gamma$.
% Let $\Pi_{\lambda}(G)$ be the set of irreducible $(\fgg,K)$-modules with
% infinitesimal character $\lambda$, then
The following map is bijective (Langlands classification)
\[
  \begin{array}{ccc}
    \cP_{\lambda}(G) & \longrightarrow & \Irr_{\lambda}(G)\\
    {[\gamma]} & \mapsto & \barpi_{\gamma}
  \end{array}
\]
and $\Set{\pi_\gamma|\gamma\in \cP_{\lambda}(G)}$ forms a basis of
$\Grt_{\lambda}(G)$. As a consequence, we have an isomorphism of vector spaces
\[
  \begin{array}{ccc}
    \bC[\cP_{\lambda}(G)] & \longrightarrow & \Coh_{[\lambda]}(G)\\
    {[\gamma]} & \mapsto & \Theta_{\gamma}
  \end{array}
\]
where $\Theta_{\gamma}$ is the unique coherent family such that
$\Theta_{\gamma}(\lambda) = \pi_{\gamma}$.
In the following, we identify the two sides implicitly.

\medskip

\def\Wa{W^{a}}
\def\WiR{W_{i\bR}}
\def\fhhiR{\fhh_{i\bR}}
\def\WR{W_{\bR}}
\def\WC{W_{\bC}}
\def\lama{\lambda^{a}}
\def\Wlama{W^a_{[\lambda]}}
For any
regular element $\lambda\in \fhh^{*}$, let $\lambda^{a}$ be the dominant element
in the abstract Cartan $\fhh^{a}$ corresponding to $\lambda$ and
\[
  i_{\lambda}\colon W(\fgg,\fhh)\longrightarrow \Wa
\]
be the identification of $W(\fgg,\fhh)$ with the abstract Weyl group $\Wa$.

From now on we fix a regular element $\lambda \in \fhh^{*}$.

Let $\Wlama:= i_{\lambda}(W_{[\lambda]})$ be the abstract integral Weyl group.
We identify $W_{[\lambda]}$ with $\Wlama$ implicitly.

In the following, we
assume $\gamma=(H,\Gamma,\bargamma)\in \cR_{\lambda}(G)$. On one hand, a element
$w$ in the real Weyl group $W(G,H)$ acts on $\gamma$ by conjugation and gives a
new regular character denoted by $w\cdot \gamma$. \trivial{ Note that
  $W(G,H) = W(K_{\bC},H_{\bC}):= N_{K_{\bC}}(H_{\bC})/K_{\bC}\cap H_{\bC}$ is a
  subgroup of $W(\fgg,\fhh)$. }

On the other hand, $W_{[\bargamma]}$ acts on $\gamma$ by cross action
$(w,\gamma)\mapsto w\times gamma$ \cite{Vg}*{8.3.1}. On define the abstract Weyl
group $\Wlama$ acts on $\cR_{\lambda}(G)$ by
\[
  w \crossa \gamma := \dot{w}^{-1}\times \gamma \text{ with
  } \dot{w}\in W_{[\lambda]}, w = i_{\bargamma}(\dot{w}),
\]
see \cite{V4}*{Definition~4.2}.

The cross action of $\Wlama$ descents to an action on $\cP_{\lambda}(G)$.
{\color{red} reference? Maybe \cite{V4}?} Let $\Wa_{[\gamma]}\subset \Wlama$ be the stabilizer of
$[\gamma]$ under cross action. Then
\[
  \Wa_{[\gamma]}:= i_{\bargamma}(W_{[\gamma]})
  \quad \text{ with }\quad
  W_{[\gamma]}:=\Set{w\in W(G,H)| w\times \gamma = w\cdot \gamma}.
\]
The $\theta$-action on $\fhh$ induces an action on $W(\fgg,\fhh)$. Then we have
the following tower of groups
\[
  W_{[\gamma]} \subseteq W(G,H) \subseteq W(\fgg,\fhh)^{\theta}
\]
and
\[
  W(\fgg,\fhh)^{\theta}=(\WC)^{\theta}\ltimes (\WiR\times \WR)
\]
where $\WC$, $\WiR$ and $\WR$ are Weyl groups of complex, compact and real
roots respectively (see \cite{V4}*{Proposition~3.12} and
\cite{AC}*{(12.1)-(12.5)}).


Define a quadratic character on $W(\fgg,\fhh)^{\theta}$ by
\[
  \begin{array}{rccc}
    \sgn_{\fhh}\colon  W(\fgg,\fhh)^{\theta} =
    & (\WC)^{\theta}\ltimes (\WiR\times \WR)
    & \longrightarrow & \Set{\pm 1}\\
    & (w_{\bC},w_{i\bR},w_{\bR}) & \mapsto & \sgn_{\WiR}(w_{i\bR})
  \end{array}
\]
where $\sgn_{\WiR}$ denote the sign character of the imaginary Weyl group. Let
$\fhhiR^{*}$ be the span of imaginary roots, then
\[
  \sgn_{\fhh}(w) = \det(w|_{\fhhiR^{*}}).
\]
Let $\sgn_{[\gamma]}:=\sgn_{\fhh}|_{W_{[\gamma]}}$ be the restriction of
$\sgn_{\fhh}$ on the cross stabilizer $W_{[\gamma]}$.

The following result is a unpublished result of Barbasch-Vogan based on results
in \cite{Vg}*{Chapter 8}, a same argument works equally well with non-linear groups
in the Harish-Chandra class.

\begin{thm}[{c.f. \cite{BV.W}*{Proposition~2.4}}]
  \label{thm:cohHC}
  Suppose $\Pi_{\lambda}(G) = \bigsqcup_{i=1}^{k} \Wlama\crossa [\gamma_{i}]$
  where $\gamma_{i}=(H_{i},\Gamma_{i},\bargamma_{i})$ are representatives of the
  $\Wlama$-orbits of $\Pi_{\lambda}(G)$. Then
  \[
    \Coh_{[\lambda]}(G) \cong \bigoplus_{i=1}^{k}
    \Ind_{W_{[\gamma_{i}]}}^{\Wlama} \sgn_{[\gamma_{i}]}.
  \]
\end{thm}
\begin{proof}[Sketch of the proof]
  To avoid the confusion, we use $t(w)$ to denote the coherent continuation
  action.
  The action of simple roots in $R^{+}_{\lambda}$ on the basis $\Theta_{\gamma}$
  is given calculated in \cite{Vg}*{Chapter 8} and summarized in
  \cite{V4}*{Definition~14.4}. The calculation reduced to the representation
  theory of $\SL(2,\bR)$.
  For non-linear groups see \cite{RT3}*{Definition~9.4} and note that
  the formula is exactly the same as that of linear groups for integral simple
  roots.
  \trivial[]{
    Let $\cT_{\lambda_{1}}^{\lambda_{2}}$ be the translation functor from
    infinitesimal character $\lambda_{1}$ to $\lambda_{2}$.
    Fix a
    By abstract non-sense, one have \cite{Vg}*{Prop~7.2.22}
    \[
      \Theta_{\pi}(\lambda) + s_{\alpha}\cdot \Theta_{\pi}(\lambda)=
      \cT_{\lambda_{0}}^{\lambda}\cT_{\lambda}^{\lambda_{0}}(\pi)=:
      \phi_{\alpha} \psi_{\alpha} (\pi)
    \]
    where $\lambda_{0}$ is an element such that $\inn{\lambda_{0}}{\alpha}=0$
    and $\inn{\lambda_{0}}{\beta}>0$ for all
    $\alpha\neq \beta \in R^{+}_{[\lambda]}$.
    By lifting to the covering group, we can assume that
    $\lambda-\lambda_{0}$ is a weight of a finite dimensional representation
    of $G$.

    Now the computation reduces to compute the RHS
    $=\phi_{\alpha} \psi_{\alpha} (\pi)$ of the above equality. (Sometimes, we
    need \cite{Vg}*{Prop~8.3.18} for the explicit computation of cross action.)
    This is computed case by case (let $t(w)$ denote the coherent continuation
    action):
    \begin{itemize}
      \item For compact imaginary roots, by Hecht-Schmid's ``A proof of
      Blattner's conjecture'', where RHS $=0$.
      \[
        t(s_{\alpha}) \gamma = - \gamma = - s_{\alpha}\cross \gamma.
      \]
      \item For non-compact imaginary roots, reduce to $\SL(2,\bR)$
      \cite{Vg}*{8.4.5,8.4.6}.
      \[
        t(s_{\alpha}) \gamma = - s_{\alpha}\cross \gamma + R
      \]
      where $R = c^{\alpha}(\gamma)$ or
      $\gamma^{\alpha}_{+}+\gamma^{\alpha}_{-}$ is a combination of
      regular characters on the Cartan subgroup $H^{\alpha}$ (which has
      higher $\bR$-rank, in fact
      $\rank_{\bR}H^{\alpha} = \rank_{\bR} H +1$).
      \item For real roots we can use \cite{Vg}*{8.3.19} which is a consquence
      of the (cohomological induction) construction of the standard
      module. The result says if $w$ acts trivial on $\ftt=\fhh^{\theta}$,
      then $t(w^{-1})\gamma = w\cross \gamma$. When $\alpha$ is a real
      root, then clearly $s_{\alpha}$ acts on $\ftt$ trivially (since
      $-\alpha(x) = \theta(\alpha)(x) = \alpha(\theta(x)) = \alpha(x) = 0
      \ \forall x\in \ftt$)
      and we have
      \[
        t(s_{\alpha}) \gamma = s_{\alpha}\cross \gamma.
      \]
      \item For complex root, use \cite{Vg}*{8.2.7} (whose proof relies on a
      long exact sequence in \cite{Vg}*{7.4.3(a)} which is also formal) we get:
      $\gamma + s_{\alpha}\cross \gamma = \phi_{\alpha} \psi_{\alpha} (\gamma)$
      (here $\gamma-n\alpha = s_{\alpha}\cross \gamma$ by the definition of
      cross action).
      In particular, we have
      \[
        t(s_{\alpha}) \gamma = s_{\alpha}\cross \gamma.
      \]
    \end{itemize}
 }

 Let
 \[
   \cP_{\lambda,r}(G):= \Set{[(H,\Gamma,\bargamma)]|
     \text{real rank of $H$ is $r$}}
 \]
 and $\cP_{\lambda,\geq r} = \bigsqcup_{l\geq r}\cP_{\lambda,l}$. Define
 \[
   \Coh_{[\lambda],\geq r}(G) :=
   \Span\Set{\Theta_{[\gamma]}|[\gamma]\in \cP_{\lambda,\geq r}}
 \]
 From the explicit formula of the coherent continuation actions on the standard
 modules, we have that, for $[\gamma]\in \cP_{\lambda,\geq r}(G)$,
 \[
   t(s_{\alpha})\; [\gamma]
   \equiv
   \begin{cases}
     - s_{\alpha}\crossa [\gamma] & \text{if $\alpha$ is imaginary,}\\
     \phantom{-} s_{\alpha}\crossa [\gamma] & \text{otherwise.}
   \end{cases}
 \]
 Now it is elementary to deduce that, as $\Wlama$-module,
 \[
   \frac{\Coh_{[\lambda],\geq r}(G)}{\Coh_{[\lambda],\geq r+1}(G)}
   \cong \bigoplus_{\Wlama \crossa [\gamma]}
   \Ind_{W_{[\gamma]}}^{\Wlama} \sgn_{[\gamma]}
 \]
 where the summation runs over the cross action orbits
 in $\cP_{\lambda,r}(G)$.
 Since $\Wlama$ is a finite group, we get the theorem by the complete
 reduciblity of $\Coh_{[\lambda]}(G)$.
\end{proof}

We remark that, when $\lambda$ is integral, the set $\cP_{\lambda}(G)$ can be enumerated using \cite{AC} (the
algorithm is implemented in atlas) for linear groups.
Under atlas' parameters, the cross action is also easy to calculate.
For the metaplectic group, the problem was solved by Renard-Trapa \cite{RT1,RT2}.



\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "counting_main"
%%% End:
