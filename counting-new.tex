% !TeX program = xelatex
\documentclass[12pt]{amsart}
%\usepackage{microtype}
%\vbadness=10000

\usepackage[margin=2.5cm,marginpar=2cm]{geometry}

\usepackage[bookmarksopen,bookmarksdepth=2,hidelinks,colorlinks=false]{hyperref}
\usepackage[nameinlink]{cleveref}

% \usepackage[color]{showkeys}
% \makeatletter
%   \SK@def\Cref#1{\SK@\SK@@ref{#1}\SK@Cref{#1}}%
% \makeatother
%% FONTS

\usepackage{amssymb}
%\usepackage{amsmath}
\usepackage{mathrsfs}
\usepackage{mathtools}
%\usepackage{amsrefs}
%\usepackage{mathbbol,mathabx}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{braket}
%\usepackage[pointedenum]{paralist}
%\usepackage{paralist}
\usepackage{amscd}

\usepackage[alphabetic]{amsrefs}

\usepackage[all,cmtip]{xy}
\usepackage{rotating}
\usepackage{leftidx}
%\usepackage{arydshln}

%\DeclareSymbolFont{bbold}{U}{bbold}{m}{n}
%\DeclareSymbolFontAlphabet{\mathbbold}{bbold}


%\usepackage[dvipdfx,rgb,table]{xcolor}
\usepackage[rgb,table]{xcolor}
%\usepackage{mathrsfs}

\setcounter{tocdepth}{1}
\setcounter{secnumdepth}{2}

%\usepackage[abbrev,shortalphabetic]{amsrefs}


\usepackage[normalem]{ulem}

% circled number
\usepackage{pifont}
\makeatletter
\newcommand*{\circnuma}[1]{%
  \ifnum#1<1 %
    \@ctrerr
  \else
    \ifnum#1>20 %
      \@ctrerr
    \else
      \mbox{\ding{\numexpr 171+(#1)\relax}}%
     \fi
  \fi
}
\makeatother

\usepackage[centertableaux]{ytableau}


% Ytableau tweak
\makeatletter
\pgfkeys{/ytableau/options,
  noframe/.default = false,
  noframe/.is choice,
  noframe/true/.code = {%
    \global\let\vrule@YT=\vrule@none@YT
    \global\let\hrule@YT=\hrule@none@YT
  },
  noframe/false/.code = {%
    \global\let\vrule@YT=\vrule@normal@YT
    \global\let\hrule@YT=\hrule@normal@YT
  },
  noframe/on/.style = {noframe/true},
  noframe/off/.style = {noframe/false},
}

\def\hrule@enon@YT{%
  \hrule width  \dimexpr \boxdim@YT + \fboxrule *2 \relax
  height 0pt
}
\def\vrule@enon@YT{%
  \vrule height \dimexpr  \boxdim@YT + \fboxrule\relax
     width \fboxrule
}

\def\enon{\omit\enon@YT}
\newcommand{\enon@YT}[2][clear]{%
  \def\thisboxcolor@YT{#1}%
  \let\hrule@YT=\hrule@enon@YT
  \let\vrule@YT=\vrule@enon@YT
  \startbox@@YT#2\endbox@YT
  \nullfont
}

\makeatother
%\ytableausetup{noframe=on,smalltableaux}
\ytableausetup{noframe=off,boxsize=1.3em}
\let\ytb=\ytableaushort

\newcommand{\tytb}[1]{{\tiny\ytb{#1}}}


%\usepackage[mathlines,pagewise]{lineno}
%\linenumbers

\usepackage{enumitem}
%% Enumitem
\newlist{enumC}{enumerate}{1} % Conditions in Lemma/Theorem/Prop
\setlist[enumC,1]{label=(\alph*),wide,ref=(\alph*)}
\crefname{enumCi}{condition}{conditions}
\Crefname{enumCi}{Condition}{Conditions}
\newlist{enumT}{enumerate}{3} % "Theorem"=conclusions in Lemma/Theorem/Prop
\setlist[enumT]{label=(\roman*),wide}
\setlist[enumT,1]{label=(\roman*),wide}
\setlist[enumT,2]{label=(\alph*),ref ={(\roman{enumTi}.\alph*)}}
\setlist[enumT,3]{label=(\arabic*), ref ={(\roman{enumTi}.\alph{enumTii}.\alph*)}}
\crefname{enumTi}{}{}
\Crefname{enumTi}{Item}{Items}
\crefname{enumTii}{}{}
\Crefname{enumTii}{Item}{Items}
\crefname{enumTiii}{}{}
\Crefname{enumTiii}{Item}{Items}
\newlist{enumPF}{enumerate}{3}
\setlist[enumPF]{label=(\alph*),wide}
\setlist[enumPF,1]{label=(\roman*),wide}
\setlist[enumPF,2]{label=(\alph*)}
\setlist[enumPF,3]{label=\arabic*).}
\newlist{enumS}{enumerate}{3} % Statement outside Lemma/Theorem/Prop
\setlist[enumS]{label=\roman*)}
\setlist[enumS,1]{label=\roman*)}
\setlist[enumS,2]{label=\alph*)}
\setlist[enumS,3]{label=\arabic*.}
\newlist{enumI}{enumerate}{3} % items
\setlist[enumI,1]{label=\roman*),leftmargin=*}
\setlist[enumI,2]{label=\alph*), leftmargin=*}
\setlist[enumI,3]{label=\arabic*), leftmargin=*}
\newlist{enumIL}{enumerate*}{1} % inline enum
\setlist*[enumIL]{label=\roman*)}
\newlist{enumR}{enumerate}{1} % remarks
\setlist[enumR]{label=\arabic*.,wide,labelwidth=!, labelindent=0pt}
\crefname{enumRi}{remark}{remarks}

\crefname{equation}{}{}
\Crefname{equation}{Equation}{Equations}
\Crefname{lem}{Lemma}{Lemma}
\Crefname{thm}{Theorem}{Theorem}

\newlist{des}{description}{1}
\setlist[des]{font=\sffamily\bfseries}

% editing macros.
\blendcolors{!80!black}
\long\def\okay#1{\ifcsname highlightokay\endcsname
{\color{red} #1}
\else
{#1}
\fi
}
\long\def\editc#1{{\color{red} #1}}
\long\def\mjj#1{{{\color{blue}#1}}}
\long\def\mjjr#1{{\color{red} (#1)}}
\long\def\mjjd#1#2{{\color{blue} #1 \sout{#2}}}
\def\mjjb{\color{blue}}
\def\mjje{\color{black}}
\def\mjjcb{\color{green!50!black}}
\def\mjjce{\color{black}}

\long\def\sun#1{{{\color{cyan}#1}}}
\long\def\sund#1#2{{\color{cyan}#1  \sout{#2}}}
\long\def\mv#1{{{\color{red} {\bf move to a proper place:} #1}}}
\long\def\delete#1{}

%\reversemarginpar
\newcommand{\lokec}[1]{\marginpar{\color{blue}\tiny #1 \mbox{--loke}}}
\newcommand{\mjjc}[1]{\marginpar{\color{green}\tiny #1 \mbox{--ma}}}

\newcommand{\trivial}[2][]{\if\relax\detokenize{#1}\relax
  {%\hfill\break
   % \begin{minipage}{\textwidth}
      \color{orange} \vspace{0em}$[$#2$]$
  %\end{minipage}
  %\break
      \color{black}
  }
  \else
\ifx#1h
\ifcsname showtrivial\endcsname
{%\hfill\break
 % \begin{minipage}{\textwidth}
    \color{orange}\vspace{0em}$[$#2$]$
%\end{minipage}
%\break
    \color{black}
}
\fi
\else {\red Wrong argument!} \fi
\fi
}

\newcommand{\byhide}[2][]{\if\relax\detokenize{#1}\relax
{\color{orange} \vspace{0em} Plan to delete:  #2}
\else
\ifx#1h\relax\fi
\fi
}



\newcommand{\Rank}{\mathrm{rk}}
\newcommand{\cqq}{\mathscr{D}}
\newcommand{\rsym}{\mathrm{sym}}
\newcommand{\rskew}{\mathrm{skew}}
\newcommand{\fraksp}{\mathfrak{sp}}
\newcommand{\frakso}{\mathfrak{so}}
\newcommand{\frakm}{\mathfrak{m}}
\newcommand{\frakp}{\mathfrak{p}}
\newcommand{\pr}{\mathrm{pr}}
\newcommand{\rhopst}{\rho'^*}
\newcommand{\Rad}{\mathrm{Rad}}
\newcommand{\Res}{\mathrm{Res}}
\newcommand{\Hol}{\mathrm{Hol}}
\newcommand{\AC}{\mathrm{AC}}
%\newcommand{\AS}{\mathrm{AS}}
\newcommand{\WF}{\mathrm{WF}}
\newcommand{\AV}{\mathrm{AV}}
\newcommand{\AVC}{\mathrm{AV}_\bC}
\newcommand{\VC}{\mathrm{V}_\bC}
\newcommand{\bfv}{\mathbf{v}}
\newcommand{\depth}{\mathrm{depth}}
\newcommand{\wtM}{\widetilde{M}}
\newcommand{\wtMone}{{\widetilde{M}^{(1,1)}}}

\newcommand{\nullpp}{N(\fpp'^*)}
\newcommand{\nullp}{N(\fpp^*)}
%\newcommand{\Aut}{\mathrm{Aut}}

\def\mstar{{\medstar}}


\newcommand{\bfone}{\mathbf{1}}
\newcommand{\piSigma}{\pi_\Sigma}
\newcommand{\piSigmap}{\pi'_\Sigma}


\newcommand{\sfVprime}{\mathsf{V}^\prime}
\newcommand{\sfVdprime}{\mathsf{V}^{\prime \prime}}
\newcommand{\gminusone}{\mathfrak{g}_{-\frac{1}{m}}}

\newcommand{\eva}{\mathrm{eva}}

\def\subset{\subseteq}


% \newcommand\iso{\xrightarrow{
%    \,\smash{\raisebox{-0.65ex}{\ensuremath{\scriptstyle\sim}}}\,}}

\def\Ueven{{U_{\rm{even}}}}
\def\Uodd{{U_{\rm{odd}}}}
\def\ttau{\tilde{\tau}}
\def\Wcp{W}
\def\Kur{{K^{\mathrm{u}}}}

\def\Im{\operatorname{Im}}

\providecommand{\bcN}{{\overline{\cN}}}



\makeatletter

\def\gen#1{\left\langle
    #1
      \right\rangle}
\makeatother

\makeatletter
\def\inn#1#2{\left\langle
      \def\ta{#1}\def\tb{#2}
      \ifx\ta\@empty{\;} \else {\ta}\fi ,
      \ifx\tb\@empty{\;} \else {\tb}\fi
      \right\rangle}
\def\binn#1#2{\left\lAngle
      \def\ta{#1}\def\tb{#2}
      \ifx\ta\@empty{\;} \else {\ta}\fi ,
      \ifx\tb\@empty{\;} \else {\tb}\fi
      \right\rAngle}
\makeatother

\makeatletter
\def\binn#1#2{\overline{\inn{#1}{#2}}}
\makeatother


\def\innwi#1#2{\inn{#1}{#2}_{W_i}}
\def\innw#1#2{\inn{#1}{#2}_{\bfW}}
\def\innv#1#2{\inn{#1}{#2}_{\bfV}}
\def\innbfv#1#2{\inn{#1}{#2}_{\bfV}}
\def\innvi#1#2{\inn{#1}{#2}_{V_i}}
\def\innvp#1#2{\inn{#1}{#2}_{\bfV'}}
\def\innp#1#2{\inn{#1}{#2}'}

% choose one of then
\def\simrightarrow{\iso}
\def\surj{\twoheadrightarrow}
%\def\simrightarrow{\xrightarrow{\sim}}

 \def\ckhha{{}^a \check\fhh}


\newcommand\iso{\xrightarrow{
   \,\smash{\raisebox{-0.65ex}{\ensuremath{\scriptstyle\sim}}}\,}}

\newcommand\riso{\xleftarrow{
   \,\smash{\raisebox{-0.65ex}{\ensuremath{\scriptstyle\sim}}}\,}}









\usepackage{xparse}
\def\usecsname#1{\csname #1\endcsname}
\def\useLetter#1{#1}
\def\usedbletter#1{#1#1}

% \def\useCSf#1{\csname f#1\endcsname}

\ExplSyntaxOn

\def\mydefcirc#1#2#3{\expandafter\def\csname
  circ#3{#1}\endcsname{{}^\circ {#2{#1}}}}
\def\mydefvec#1#2#3{\expandafter\def\csname
  vec#3{#1}\endcsname{\vec{#2{#1}}}}
\def\mydefdot#1#2#3{\expandafter\def\csname
  dot#3{#1}\endcsname{\dot{#2{#1}}}}

\def\mydefacute#1#2#3{\expandafter\def\csname a#3{#1}\endcsname{\acute{#2{#1}}}}
\def\mydefbr#1#2#3{\expandafter\def\csname br#3{#1}\endcsname{\breve{#2{#1}}}}
\def\mydefbar#1#2#3{\expandafter\def\csname bar#3{#1}\endcsname{\bar{#2{#1}}}}
\def\mydefhat#1#2#3{\expandafter\def\csname hat#3{#1}\endcsname{\hat{#2{#1}}}}
\def\mydefwh#1#2#3{\expandafter\def\csname wh#3{#1}\endcsname{\widehat{#2{#1}}}}
\def\mydeft#1#2#3{\expandafter\def\csname t#3{#1}\endcsname{\tilde{#2{#1}}}}
\def\mydefu#1#2#3{\expandafter\def\csname u#3{#1}\endcsname{\underline{#2{#1}}}}
\def\mydefr#1#2#3{\expandafter\def\csname r#3{#1}\endcsname{\mathrm{#2{#1}}}}
\def\mydefb#1#2#3{\expandafter\def\csname b#3{#1}\endcsname{\mathbb{#2{#1}}}}
\def\mydefwt#1#2#3{\expandafter\def\csname wt#3{#1}\endcsname{\widetilde{#2{#1}}}}
%\def\mydeff#1#2#3{\expandafter\def\csname f#3{#1}\endcsname{\mathfrak{#2{#1}}}}
\def\mydefbf#1#2#3{\expandafter\def\csname bf#3{#1}\endcsname{\mathbf{#2{#1}}}}
\def\mydefc#1#2#3{\expandafter\def\csname c#3{#1}\endcsname{\mathcal{#2{#1}}}}
\def\mydefsf#1#2#3{\expandafter\def\csname sf#3{#1}\endcsname{\mathsf{#2{#1}}}}
\def\mydefs#1#2#3{\expandafter\def\csname s#3{#1}\endcsname{\mathscr{#2{#1}}}}
\def\mydefcks#1#2#3{\expandafter\def\csname cks#3{#1}\endcsname{{\check{
        \csname s#2{#1}\endcsname}}}}
\def\mydefckc#1#2#3{\expandafter\def\csname ckc#3{#1}\endcsname{{\check{
      \csname c#2{#1}\endcsname}}}}
\def\mydefck#1#2#3{\expandafter\def\csname ck#3{#1}\endcsname{{\check{#2{#1}}}}}

\cs_new:Npn \mydeff #1#2#3 {\cs_new:cpn {f#3{#1}} {\mathfrak{#2{#1}}}}

\cs_new:Npn \doGreek #1
{
  \clist_map_inline:nn {alpha,beta,gamma,Gamma,delta,Delta,epsilon,varepsilon,zeta,eta,theta,vartheta,Theta,iota,kappa,lambda,Lambda,mu,nu,xi,Xi,pi,Pi,rho,sigma,varsigma,Sigma,tau,upsilon,Upsilon,phi,varphi,Phi,chi,psi,Psi,omega,Omega,tG} {#1{##1}{\usecsname}{\useLetter}}
}

\cs_new:Npn \doSymbols #1
{
  \clist_map_inline:nn {otimes,boxtimes} {#1{##1}{\usecsname}{\useLetter}}
}

\cs_new:Npn \doAtZ #1
{
  \clist_map_inline:nn {A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z} {#1{##1}{\useLetter}{\useLetter}}
}

\cs_new:Npn \doatz #1
{
  \clist_map_inline:nn {a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z} {#1{##1}{\useLetter}{\usedbletter}}
}

\cs_new:Npn \doallAtZ
{
\clist_map_inline:nn {mydefsf,mydeft,mydefu,mydefwh,mydefhat,mydefr,mydefwt,mydeff,mydefb,mydefbf,mydefc,mydefs,mydefck,mydefcks,mydefckc,mydefbar,mydefvec,mydefcirc,mydefdot,mydefbr,mydefacute} {\doAtZ{\csname ##1\endcsname}}
}

\cs_new:Npn \doallatz
{
\clist_map_inline:nn {mydefsf,mydeft,mydefu,mydefwh,mydefhat,mydefr,mydefwt,mydeff,mydefb,mydefbf,mydefc,mydefs,mydefck,mydefbar,mydefvec,mydefdot,mydefbr,mydefacute} {\doatz{\csname ##1\endcsname}}
}

\cs_new:Npn \doallGreek
{
\clist_map_inline:nn {mydefck,mydefwt,mydeft,mydefwh,mydefbar,mydefu,mydefvec,mydefcirc,mydefdot,mydefbr,mydefacute} {\doGreek{\csname ##1\endcsname}}
}

\cs_new:Npn \doallSymbols
{
\clist_map_inline:nn {mydefck,mydefwt,mydeft,mydefwh,mydefbar,mydefu,mydefvec,mydefcirc,mydefdot} {\doSymbols{\csname ##1\endcsname}}
}



\cs_new:Npn \doGroups #1
{
  \clist_map_inline:nn {GL,Sp,rO,rU,fgl,fsp,foo,fuu,fkk,fuu,ufkk,uK} {#1{##1}{\usecsname}{\useLetter}}
}

\cs_new:Npn \doallGroups
{
\clist_map_inline:nn {mydeft,mydefu,mydefwh,mydefhat,mydefwt,mydefck,mydefbar} {\doGroups{\csname ##1\endcsname}}
}


\cs_new:Npn \decsyms #1
{
\clist_map_inline:nn {#1} {\expandafter\DeclareMathOperator\csname ##1\endcsname{##1}}
}

\decsyms{Mp,id,SL,Sp,SU,SO,GO,GSO,GU,GSp,PGL,Pic,Lie,Mat,Ker,Hom,Ext,Ind,reg,res,inv,Isom,Det,Tr,Norm,Sym,Span,Stab,Spec,PGSp,PSL,tr,Ad,Br,Ch,Cent,End,Aut,Dvi,Frob,Gal,GL,Gr,DO,ur,vol,ab,Nil,Supp,rank,Sign}

\def\abs#1{\left|{#1}\right|}
\def\norm#1{{\left\|{#1}\right\|}}


% \NewDocumentCommand\inn{m m}{
% \left\langle
% \IfValueTF{#1}{#1}{000}
% ,
% \IfValueTF{#2}{#2}{000}
% \right\rangle
% }
\NewDocumentCommand\cent{o m }{
  \IfValueTF{#1}{
    \mathop{Z}_{#1}{(#2)}}
  {\mathop{Z}{(#2)}}
}


\def\fsl{\mathfrak{sl}}
\def\fsp{\mathfrak{sp}}


%\def\cent#1#2{{\mathrm{Z}_{#1}({#2})}}


\doallAtZ
\doallatz
\doallGreek
\doallGroups
\doallSymbols
\ExplSyntaxOff


% \usepackage{geometry,amsthm,graphics,tabularx,amssymb,shapepar}
% \usepackage{amscd}
% \usepackage{mathrsfs}


\usepackage{diagbox}
% Update the information and uncomment if AMS is not the copyright
% holder.
%\copyrightinfo{2006}{American Mathematical Society}
%\usepackage{nicematrix}
\usepackage{arydshln}

\usepackage{tikz}
\usetikzlibrary{matrix,arrows,positioning,cd,backgrounds}
\usetikzlibrary{decorations.pathmorphing,decorations.pathreplacing}

\usepackage{upgreek}

\usepackage{listings}
\lstset{
    basicstyle=\ttfamily\tiny,
    keywordstyle=\color{black},
    commentstyle=\color{white}, % white comments
    stringstyle=\ttfamily, % typewriter type for strings
    showstringspaces=false,
    breaklines=true,
    emph={Output},emphstyle=\color{blue},
}

\newcommand{\BA}{{\mathbb{A}}}
%\newcommand{\BB}{{\mathbb {B}}}
\newcommand{\BC}{{\mathbb {C}}}
\newcommand{\BD}{{\mathbb {D}}}
\newcommand{\BE}{{\mathbb {E}}}
\newcommand{\BF}{{\mathbb {F}}}
\newcommand{\BG}{{\mathbb {G}}}
\newcommand{\BH}{{\mathbb {H}}}
\newcommand{\BI}{{\mathbb {I}}}
\newcommand{\BJ}{{\mathbb {J}}}
\newcommand{\BK}{{\mathbb {U}}}
\newcommand{\BL}{{\mathbb {L}}}
\newcommand{\BM}{{\mathbb {M}}}
\newcommand{\BN}{{\mathbb {N}}}
\newcommand{\BO}{{\mathbb {O}}}
\newcommand{\BP}{{\mathbb {P}}}
\newcommand{\BQ}{{\mathbb {Q}}}
\newcommand{\BR}{{\mathbb {R}}}
\newcommand{\BS}{{\mathbb {S}}}
\newcommand{\BT}{{\mathbb {T}}}
\newcommand{\BU}{{\mathbb {U}}}
\newcommand{\BV}{{\mathbb {V}}}
\newcommand{\BW}{{\mathbb {W}}}
\newcommand{\BX}{{\mathbb {X}}}
\newcommand{\BY}{{\mathbb {Y}}}
\newcommand{\BZ}{{\mathbb {Z}}}
\newcommand{\Bk}{{\mathbf {k}}}

\newcommand{\CA}{{\mathcal {A}}}
\newcommand{\CB}{{\mathcal {B}}}
\newcommand{\CC}{{\mathcal {C}}}

\newcommand{\CE}{{\mathcal {E}}}
\newcommand{\CF}{{\mathcal {F}}}
\newcommand{\CG}{{\mathcal {G}}}
\newcommand{\CH}{{\mathcal {H}}}
\newcommand{\CI}{{\mathcal {I}}}
\newcommand{\CJ}{{\mathcal {J}}}
\newcommand{\CK}{{\mathcal {K}}}
\newcommand{\CL}{{\mathcal {L}}}
\newcommand{\CM}{{\mathcal {M}}}
\newcommand{\CN}{{\mathcal {N}}}
\newcommand{\CO}{{\mathcal {O}}}
\newcommand{\CP}{{\mathcal {P}}}
\newcommand{\CQ}{{\mathcal {Q}}}
\newcommand{\CR}{{\mathcal {R}}}
\newcommand{\CS}{{\mathcal {S}}}
\newcommand{\CT}{{\mathcal {T}}}
\newcommand{\CU}{{\mathcal {U}}}
\newcommand{\CV}{{\mathcal {V}}}
\newcommand{\CW}{{\mathcal {W}}}
\newcommand{\CX}{{\mathcal {X}}}
\newcommand{\CY}{{\mathcal {Y}}}
\newcommand{\CZ}{{\mathcal {Z}}}


\newcommand{\RA}{{\mathrm {A}}}
\newcommand{\RB}{{\mathrm {B}}}
\newcommand{\RC}{{\mathrm {C}}}
\newcommand{\RD}{{\mathrm {D}}}
\newcommand{\RE}{{\mathrm {E}}}
\newcommand{\RF}{{\mathrm {F}}}
\newcommand{\RG}{{\mathrm {G}}}
\newcommand{\RH}{{\mathrm {H}}}
\newcommand{\RI}{{\mathrm {I}}}
\newcommand{\RJ}{{\mathrm {J}}}
\newcommand{\RK}{{\mathrm {K}}}
\newcommand{\RL}{{\mathrm {L}}}
\newcommand{\RM}{{\mathrm {M}}}
\newcommand{\RN}{{\mathrm {N}}}
\newcommand{\RO}{{\mathrm {O}}}
\newcommand{\RP}{{\mathrm {P}}}
\newcommand{\RQ}{{\mathrm {Q}}}
%\newcommand{\RR}{{\mathrm {R}}}
\newcommand{\RS}{{\mathrm {S}}}
\newcommand{\RT}{{\mathrm {T}}}
\newcommand{\RU}{{\mathrm {U}}}
\newcommand{\RV}{{\mathrm {V}}}
\newcommand{\RW}{{\mathrm {W}}}
\newcommand{\RX}{{\mathrm {X}}}
\newcommand{\RY}{{\mathrm {Y}}}
\newcommand{\RZ}{{\mathrm {Z}}}

\DeclareMathOperator{\absNorm}{\mathfrak{N}}
\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\LAnn}{L-Ann}
\DeclareMathOperator{\RAnn}{R-Ann}
\DeclareMathOperator{\ind}{ind}
%\DeclareMathOperator{\Ind}{Ind}



\newcommand{\cod}{{\mathrm{cod}}}
\newcommand{\cont}{{\mathrm{cont}}}
\newcommand{\cl}{{\mathrm{cl}}}
\newcommand{\cusp}{{\mathrm{cusp}}}

\newcommand{\disc}{{\mathrm{disc}}}
\renewcommand{\div}{{\mathrm{div}}}



\newcommand{\Gm}{{\mathbb{G}_m}}


\def\CCL{\CC^L}
\def\CCLR{\CC^{LR}}

\newcommand{\I}{{\mathrm{I}}}

\newcommand{\Jac}{{\mathrm{Jac}}}
\newcommand{\PM}{{\mathrm{PM}}}


\newcommand{\new}{{\mathrm{new}}}
\newcommand{\NS}{{\mathrm{NS}}}
\newcommand{\N}{{\mathrm{N}}}

\newcommand{\ord}{{\mathrm{ord}}}

%\newcommand{\rank}{{\mathrm{rank}}}

\newcommand{\rk}{{\mathrm{k}}}
\newcommand{\rr}{{\mathrm{r}}}
\newcommand{\rh}{{\mathrm{h}}}

\newcommand{\Sel}{{\mathrm{Sel}}}
\newcommand{\Sim}{{\mathrm{Sim}}}

\newcommand{\wt}{\widetilde}
\newcommand{\wh}{\widehat}
\newcommand{\pp}{\frac{\partial\bar\partial}{\pi i}}
\newcommand{\pair}[1]{\langle {#1} \rangle}
\newcommand{\wpair}[1]{\left\{{#1}\right\}}
\newcommand{\intn}[1]{\left( {#1} \right)}
\newcommand{\sfrac}[2]{\left( \frac {#1}{#2}\right)}
\newcommand{\ds}{\displaystyle}
\newcommand{\ov}{\overline}
\newcommand{\incl}{\hookrightarrow}
\newcommand{\lra}{\longrightarrow}
\newcommand{\imp}{\Longrightarrow}
%\newcommand{\lto}{\longmapsto}
\newcommand{\bs}{\backslash}

\newcommand{\cover}[1]{\widetilde{#1}}

\renewcommand{\vsp}{{\vspace{0.2in}}}

\newcommand{\Norma}{\operatorname{N}}
\newcommand{\Ima}{\operatorname{Im}}
\newcommand{\con}{\textit{C}}
\newcommand{\gr}{\operatorname{gr}}
\newcommand{\ad}{\operatorname{ad}}
\newcommand{\der}{\operatorname{der}}
\newcommand{\dif}{\operatorname{d}\!}
\newcommand{\pro}{\operatorname{pro}}
\newcommand{\Ev}{\operatorname{Ev}}
% \renewcommand{\span}{\operatorname{span}} \span is an innernal command.
%\newcommand{\degree}{\operatorname{deg}}
\newcommand{\Invf}{\operatorname{Invf}}
\newcommand{\Inv}{\operatorname{Inv}}
\newcommand{\slt}{\operatorname{SL}_2(\mathbb{R})}
%\newcommand{\temp}{\operatorname{temp}}
%\newcommand{\otop}{\operatorname{top}}
\renewcommand{\small}{\operatorname{small}}
\newcommand{\HC}{\operatorname{HC}}
\newcommand{\lef}{\operatorname{left}}
\newcommand{\righ}{\operatorname{right}}
\newcommand{\Diff}{\operatorname{DO}}
\newcommand{\diag}{\operatorname{diag}}
\newcommand{\sh}{\varsigma}
\newcommand{\sch}{\operatorname{sch}}
%\newcommand{\oleft}{\operatorname{left}}
%\newcommand{\oright}{\operatorname{right}}
\newcommand{\open}{\operatorname{open}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\triv}{\operatorname{triv}}
\newcommand{\Sh}{\operatorname{Sh}}
\newcommand{\oN}{\operatorname{N}}

\newcommand{\oc}{\operatorname{c}}
\newcommand{\od}{\operatorname{d}}
\newcommand{\os}{\operatorname{s}}
\newcommand{\ol}{\operatorname{l}}
\newcommand{\oL}{\operatorname{L}}
\newcommand{\oJ}{\operatorname{J}}
\newcommand{\oH}{\operatorname{H}}
\newcommand{\oO}{\operatorname{O}}
\newcommand{\oS}{\operatorname{S}}
\newcommand{\oR}{\operatorname{R}}
\newcommand{\oT}{\operatorname{T}}
%\newcommand{\rU}{\operatorname{U}}
\newcommand{\oZ}{\operatorname{Z}}
\newcommand{\oD}{\textit{D}}
\newcommand{\oW}{\textit{W}}
\newcommand{\oE}{\operatorname{E}}
\newcommand{\oP}{\operatorname{P}}
\newcommand{\PD}{\operatorname{PD}}
\newcommand{\oU}{\operatorname{U}}

\newcommand{\g}{\mathfrak g}
\newcommand{\gC}{{\mathfrak g}_{\C}}
\renewcommand{\k}{\mathfrak k}
\newcommand{\h}{\mathfrak h}
\newcommand{\p}{\mathfrak p}
%\newcommand{\q}{\mathfrak q}
\renewcommand{\a}{\mathfrak a}
\renewcommand{\b}{\mathfrak b}
\renewcommand{\c}{\mathfrak c}
\newcommand{\n}{\mathfrak n}
\renewcommand{\u}{\mathfrak u}
%\renewcommand{\v}{\mathfrak v}
\newcommand{\e}{\mathfrak e}
\newcommand{\f}{\mathfrak f}
\renewcommand{\l}{\mathfrak l}
\renewcommand{\t}{\mathfrak t}
\newcommand{\s}{\mathfrak s}
\renewcommand{\r}{\mathfrak r}
\renewcommand{\o}{\mathfrak o}
\newcommand{\m}{\mathfrak m}
\newcommand{\z}{\mathfrak z}
%\renewcommand{\sl}{\mathfrak s \mathfrak l}
\newcommand{\gl}{\mathfrak g \mathfrak l}


\newcommand{\re}{\mathrm e}

\renewcommand{\rk}{\mathrm k}

\newcommand{\Z}{\mathbb{Z}}
\DeclareDocumentCommand{\C}{}{\mathbb{C}}
\newcommand{\R}{\mathbb R}
\newcommand{\Q}{\mathbb Q}
\renewcommand{\H}{\mathbb{H}}
%\newcommand{\N}{\mathbb{N}}
\newcommand{\K}{\mathbb{K}}
%\renewcommand{\S}{\mathbf S}
\newcommand{\M}{\mathbf{M}}
\newcommand{\A}{\mathbb{A}}
\newcommand{\B}{\mathbf{B}}
%\renewcommand{\G}{\mathbf{G}}
\newcommand{\V}{\mathbf{V}}
\newcommand{\W}{\mathbf{W}}
\newcommand{\F}{\mathbf{F}}
\newcommand{\E}{\mathbf{E}}
%\newcommand{\J}{\mathbf{J}}
\renewcommand{\H}{\mathbf{H}}
\newcommand{\X}{\mathbf{X}}
\newcommand{\Y}{\mathbf{Y}}
%\newcommand{\RR}{\mathcal R}
\newcommand{\FF}{\mathcal F}
%\newcommand{\BB}{\mathcal B}
\newcommand{\HH}{\mathcal H}
%\newcommand{\UU}{\mathcal U}
%\newcommand{\MM}{\mathcal M}
%\newcommand{\CC}{\mathcal C}
%\newcommand{\DD}{\mathcal D}
\def\eDD{\mathrm{d}^{e}}
\def\DD{\nabla}
\def\DDD{{\check\nabla}}
\def\DDc{\boldsymbol{\nabla}}
\def\gDD{\nabla^{\mathrm{gen}}}
\def\gDDc{\boldsymbol{\nabla}^{\mathrm{gen}}}
%\newcommand{\OO}{\mathcal O}
%\newcommand{\ZZ}{\mathcal Z}
\newcommand{\ve}{{\vee}}
\newcommand{\aut}{\mathcal A}
\newcommand{\ii}{\mathbf{i}}
\newcommand{\jj}{\mathbf{j}}
\newcommand{\kk}{\mathbf{k}}

\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\bp}{\bigskip}
\newcommand{\be}{\begin {equation}}
\newcommand{\ee}{\end {equation}}

\newcommand{\LRleq}{\stackrel{LR}{\leq}}

\numberwithin{equation}{section}


\def\flushl#1{\ifmmode\makebox[0pt][l]{${#1}$}\else\makebox[0pt][l]{#1}\fi}
\def\flushr#1{\ifmmode\makebox[0pt][r]{${#1}$}\else\makebox[0pt][r]{#1}\fi}
\def\flushmr#1{\makebox[0pt][r]{${#1}$}}


%\theoremstyle{Theorem}
% \newtheorem*{thmM}{Main Theorem}
% \crefformat{thmM}{main theorem}
% \Crefformat{thmM}{Main Theorem}
\newtheorem*{thm*}{Theorem}
\newtheorem{thm}{Theorem}[section]
\newtheorem{thml}[thm]{Theorem}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{obs}[thm]{Observation}
\newtheorem{lemt}[thm]{Lemma}
\newtheorem*{lem*}{Lemma}
\newtheorem{whyp}[thm]{Working Hypothesis}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{prpt}[thm]{Proposition}
\newtheorem{prpl}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
%\newtheorem*{prop*}{Proposition}
\newtheorem{claim}{Claim}
\newtheorem*{claim*}{Claim}
%\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{dfnl}[thm]{Definition}
\newtheorem*{IndH}{Induction Hypothesis}

\newtheorem*{eg*}{Example}
\newtheorem{eg}[thm]{Example}
\newtheorem{conj}[thm]{Conjecture}

\theoremstyle{remark}
\newtheorem{remark}[thm]{Remark}
\newtheorem{remarks}[thm]{Remarks}


\def\cpc{\sigma}
\def\ccJ{\epsilon\dotepsilon}
\def\ccL{c_L}

\def\wtbfK{\widetilde{\bfK}}
%\def\abfV{\acute{\bfV}}
\def\AbfV{\acute{\bfV}}
%\def\afgg{\acute{\fgg}}
%\def\abfG{\acute{\bfG}}
\def\abfV{\bfV'}
\def\afgg{\fgg'}
\def\abfG{\bfG'}

\def\half{{\tfrac{1}{2}}}
\def\ihalf{{\tfrac{\mathbf i}{2}}}
\def\slt{\fsl_2(\bC)}
\def\sltr{\fsl_2(\bR)}

% \def\Jslt{{J_{\fslt}}}
% \def\Lslt{{L_{\fslt}}}
\def\slee{{
\begin{pmatrix}
 0 & 1\\
 0 & 0
\end{pmatrix}
}}
\def\slff{{
\begin{pmatrix}
 0 & 0\\
 1 & 0
\end{pmatrix}
}}\def\slhh{{
\begin{pmatrix}
 1 & 0\\
 0 & -1
\end{pmatrix}
}}
\def\sleei{{
\begin{pmatrix}
 0 & i\\
 0 & 0
\end{pmatrix}
}}
\def\slxx{{\begin{pmatrix}
-\ihalf & \half\\
\phantom{-}\half & \ihalf
\end{pmatrix}}}
% \def\slxx{{\begin{pmatrix}
% -\sqrt{-1}/2 & 1/2\\
% 1/2 & \sqrt{-1}/2
% \end{pmatrix}}}
\def\slyy{{\begin{pmatrix}
\ihalf & \half\\
\half & -\ihalf
\end{pmatrix}}}
\def\slxxi{{\begin{pmatrix}
+\half & -\ihalf\\
-\ihalf & -\half
\end{pmatrix}}}
\def\slH{{\begin{pmatrix}
   0   & -\mathbf i\\
\mathbf i & 0
\end{pmatrix}}
}

\ExplSyntaxOn
\clist_map_inline:nn {J,L,C,X,Y,H,c,e,f,h,}{
  \expandafter\def\csname #1slt\endcsname{{\mathring{#1}}}}
\ExplSyntaxOff


\def\Mop{\fT}

\def\fggJ{\fgg_J}
\def\fggJp{\fgg'_{J'}}

\def\NilGC{\Nil_{\bfG}(\fgg)}
\def\NilGCp{\Nil_{\bfG'}(\fgg')}
\def\Nilgp{\Nil_{\fgg'_{J'}}}
\def\Nilg{\Nil_{\fgg_{J}}}
%\def\NilP'{\Nil_{\fpp'}}
\def\nNil{\Nil^{\mathrm n}}
\def\eNil{\Nil^{\mathrm e}}


\NewDocumentCommand{\NilP}{t'}{
\IfBooleanTF{#1}{\Nil_{\fpp'}}{\Nil_\fpp}
}

\def\KS{\mathsf{KS}}
\def\MM{\bfM}
\def\MMP{M}

\NewDocumentCommand{\KTW}{o g}{
  \IfValueTF{#2}{
    \left.\varsigma_{\IfValueT{#1}{#1}}\right|_{#2}}{
    \varsigma_{\IfValueT{#1}{#1}}}
}
\def\IST{\rho}
\def\tIST{\trho}

\NewDocumentCommand{\CHI}{o g}{
  \IfValueTF{#1}{
    {\chi}_{\left[#1\right]}}{
    \IfValueTF{#2}{
      {\chi}_{\left(#2\right)}}{
      {\chi}}
  }
}
\NewDocumentCommand{\PR}{g}{
  \IfValueTF{#1}{
    \mathop{\pr}_{\left(#1\right)}}{
    \mathop{\pr}}
}
\NewDocumentCommand{\XX}{g}{
  \IfValueTF{#1}{
    {\cX}_{\left(#1\right)}}{
    {\cX}}
}
\NewDocumentCommand{\PP}{g}{
  \IfValueTF{#1}{
    {\fpp}_{\left(#1\right)}}{
    {\fpp}}
}
\NewDocumentCommand{\LL}{g}{
  \IfValueTF{#1}{
    {\bfL}_{\left(#1\right)}}{
    {\bfL}}
}
\NewDocumentCommand{\ZZ}{g}{
  \IfValueTF{#1}{
    {\cZ}_{\left(#1\right)}}{
    {\cZ}}
}

\NewDocumentCommand{\WW}{g}{
  \IfValueTF{#1}{
    {\bfW}_{\left(#1\right)}}{
    {\bfW}}
}




\def\gpi{\wp}
\NewDocumentCommand\KK{g}{
\IfValueTF{#1}{K_{(#1)}}{K}}
% \NewDocumentCommand\OO{g}{
% \IfValueTF{#1}{\cO_{(#1)}}{K}}
\NewDocumentCommand\XXo{d()}{
\IfValueTF{#1}{\cX^\circ_{(#1)}}{\cX^\circ}}
\def\bfWo{\bfW^\circ}
\def\bfWoo{\bfW^{\circ \circ}}
\def\bfWg{\bfW^{\mathrm{gen}}}
\def\Xg{\cX^{\mathrm{gen}}}
\def\Xo{\cX^\circ}
\def\Xoo{\cX^{\circ \circ}}
\def\fppo{\fpp^\circ}
\def\fggo{\fgg^\circ}
\NewDocumentCommand\ZZo{g}{
\IfValueTF{#1}{\cZ^\circ_{(#1)}}{\cZ^\circ}}

% \ExplSyntaxOn
% \NewDocumentCommand{\bcO}{t' E{^_}{{}{}}}{
%   \overline{\cO\sb{\use_ii:nn#2}\IfBooleanTF{#1}{^{'\use_i:nn#2}}{^{\use_i:nn#2}}
%   }
% }
% \ExplSyntaxOff

\NewDocumentCommand{\bcO}{t'}{
  \overline{\cO\IfBooleanT{#1}{'}}}

\NewDocumentCommand{\oliftc}{g}{
\IfValueTF{#1}{\boldsymbol{\vartheta} (#1)}{\boldsymbol{\vartheta}}
}
\NewDocumentCommand{\oliftr}{g}{
\IfValueTF{#1}{\vartheta_\bR(#1)}{\vartheta_\bR}
}
\NewDocumentCommand{\olift}{g}{
\IfValueTF{#1}{\vartheta(#1)}{\vartheta}
}
% \NewDocumentCommand{\dliftv}{g}{
% \IfValueTF{#1}{\ckvartheta(#1)}{\ckvartheta}
% }
\def\dliftv{\vartheta}
\NewDocumentCommand{\tlift}{g}{
\IfValueTF{#1}{\wtvartheta(#1)}{\wtvartheta}
}

\def\slift{\cL}

\def\BB{\bB}


\def\PhiO#1{\vartheta\left(#1\right)}

\def\bbThetav{\check{\mathbbold{\Phi}}}
\def\Phiv{\check{\Phi}}
\def\Phiv{\check{\Phi}}

\DeclareDocumentCommand{\NN}{g}{
\IfValueTF{#1}{\fN(#1)}{\fN}
}
\DeclareDocumentCommand{\RR}{m m}{
\fR({#1},{#2})
}

%\DeclareMathOperator*{\sign}{Sign}

\NewDocumentCommand{\lsign}{m}{
{}^l\mathrm{Sign}(#1)
}



\NewDocumentCommand\lnn{t+ t- g}{
  \IfBooleanTF{#1}{{}^l n^+\IfValueT{#3}{(#3)}}{
    \IfBooleanTF{#2}{{}^l n^-\IfValueT{#3}{(#3)}}{}
  }
}


% % Fancy bcO, support feature \bcO'^a_{\mathrm b} = \overline{\cO'^a_{\mathrm b}}
% \makeatletter
% \def\bcO{\def\O@@{\cO}\@ifnextchar'\@Op\@Onp}
% \def\@Opnext{\@ifnextchar^\@Opsp\@Opnsp}
% \def\@Op{\afterassignment\@Opnext\let\scratch=}
% \def\@Opnsp{\def\O@@{\cO'}\@Otsb}
% \def\@Onp{\@ifnextchar^\@Onpsp\@Otsb}
% \def\@Opsp^#1{\def\O@@{\cO'^{#1}}\@Otsb}
% \def\@Onpsp^#1{\def\O@@{\cO^{#1}}\@Otsb}
% \def\@Otsb{\@ifnextchar_\@Osb{\@Ofinalnsb}}
% \def\@Osb_#1{\overline{\O@@_{#1}}}
% \def\@Ofinalnsb{\overline{\O@@}}

% Fancy \command: \command`#1 will translate to {}^{#1}\bfV, i.e. superscript on the
% lift conner.

% \def\defpcmd#1{
%   \def\nn@tmp{#1}
%   \def\nn@np@tmp{@np@#1}
%   \expandafter\let\csname\nn@np@tmp\expandafter\endcsname \csname\nn@tmp\endcsname
%   \expandafter\def\csname @pp@#1\endcsname`##1{{}^{##1}{\csname @np@#1\endcsname}}
%   \expandafter\def\csname #1\endcsname{\,\@ifnextchar`{\csname
%       @pp@#1\endcsname}{\csname @np@#1\endcsname}}
% }

% \def\defppcmd#1{
% \expandafter\NewDocumentCommand{\csname #1\endcsname}{##1 }{}
% }



% \defpcmd{bfV}
% \def\KK{\bfK}\defpcmd{KK}
% \defpcmd{bfG}
% \def\A{\!A}\defpcmd{A}
% \def\K{\!K}\defpcmd{K}
% \def\G{G}\defpcmd{G}
% \def\J{\!J}\defpcmd{J}
% \def\L{\!L}\defpcmd{L}
% \def\eps{\epsilon}\defpcmd{eps}
% \def\pp{p}\defpcmd{pp}
% \defpcmd{wtK}
% \makeatother

\def\fggR{\fgg_\bR}
\def\rmtop{{\mathrm{top}}}
\def\dimo{\dim^\circ}
\def\GKdim{\text{GK-}\dim}

\NewDocumentCommand\LW{g}{
\IfValueTF{#1}{L_{W_{#1}}}{L_{W}}}
%\def\LW#1{L_{W_{#1}}}
\def\JW#1{J_{W_{#1}}}

\def\floor#1{{\lfloor #1 \rfloor}}

\def\KSP{K}
\def\UU{\rU}
\def\UUC{\rU_\bC}
\def\tUUC{\widetilde{\rU}_\bC}
\def\OmegabfW{\Omega_{\bfW}}


\def\BB{\bB}


\def\PhiO#1{\vartheta\left(#1\right)}

\def\Phiv{\check{\Phi}}
\def\Phiv{\check{\Phi}}

\def\Phib{\bar{\Phi}}

\def\cKaod{\cK^{\mathrm{aod}}}

\DeclareMathOperator{\sspan}{span}


\def\sp{{\mathrm{sp}}}

\def\bfLz{\bfL_0}
\def\sOpe{\sO^\perp}
\def\sOpeR{\sO^\perp_\bR}
\def\sOR{\sO_\bR}

\def\ZX{\cZ_{X}}
\def\gdliftv{\vartheta}
\def\gdlift{\vartheta^{\mathrm{gen}}}
\def\bcOp{\overline{\cO'}}
\def\bsO{\overline{\sO}}
\def\bsOp{\overline{\sO'}}
\def\bfVpe{\bfV^\perp}
\def\bfEz{\bfE_0}
\def\bfVn{\bfV^-}
\def\bfEzp{\bfE'_0}

\def\totimes{\widehat{\otimes}}
\def\dotbfV{\dot{\bfV}}

\def\aod{\mathrm{aod}}
\def\unip{\mathrm{unip}}
\def\IC{\mathfrak{I}}

\def\PI#1{\Pi_{\cI_{#1}}}
\def\Piunip{\Pi^{\mathrm{unip}}}
\def\cf{\emph{cf.} }
\def\Groth{\mathrm{Groth}}
\def\Irr{\mathrm{Irr}}
\def\Irrsp{\mathrm{Irr}^{\mathrm{sp}}}

\def\edrc{\mathrm{DRC}^{\mathrm e}}
\def\drc{\mathrm{DRC}}
\def\LS{\mathrm{LS}}
\def\Unip{\mathrm{Unip}}


% Ytableau tweak
\makeatletter
\pgfkeys{/ytableau/options,
  noframe/.default = false,
  noframe/.is choice,
  noframe/true/.code = {%
    \global\let\vrule@YT=\vrule@none@YT
    \global\let\hrule@YT=\hrule@none@YT
  },
  noframe/false/.code = {%
    \global\let\vrule@YT=\vrule@normal@YT
    \global\let\hrule@YT=\hrule@normal@YT
  },
  noframe/on/.style = {noframe/true},
  noframe/off/.style = {noframe/false},
}
\makeatother


\def\wAV{\AV^{\mathrm{weak}}}
\def\ckG{\check{G}}
\def\ckGc{\check{G}_{\bC}}
\def\dBV{d_{\mathrm{BV}}}
\def\CP{\mathsf{CP}}
\def\YD{\mathsf{YD}}
\def\SYD{\mathsf{SYD}}
\def\DD{\nabla}

\def\lamck{\lambda_\ckcO}
\def\Lamck{[\lambda_\ckcO]}
\def\lamckb{\lambda_{\ckcO_{\mathrm b}}}
\def\lamckg{\lambda_{\ckcO_{\mathrm g}}}
\def\Wint#1{W_{[#1]}}
\def\CLam{\Coh_{\Lambda}}
\def\Cint#1{\Coh_{[#1]}}
\def\PP{\mathsf{PAP}}
\def\PAP{\mathsf{PAP}}
\def\BOX#1{\mathrm{Box}(#1)}
\DeclareDocumentCommand{\bigtimes}{}{\mathop{\scalebox{1.7}{$\times$}}}
\providecommand\mapsfrom{\scalebox{-1}[1]{$\mapsto$}}

\def\ihh{{i_\fhh}}

\def\Gc{G_\bC}
\def\Gcad{G_\bC^{\text{ad}}}
\def\Gad{\Inn(\fgg)}

\def\hha{{}^a\fhh}
\def\ahh{\hha}
\def\aSR{{}^a\Sigma}
\def\aRp{{}^a\Delta^+}
\def\aX{{}^aX}
\def\aQ{{}^aQ}
\def\aP{{}^aP}
\def\aR{{}^aR}
\def\aRp{{}^aR^+}
\def\asRp{{}^a \Delta^+}
\def\Gfin{\cG(\Gc)}
\def\PiGfin{\Pi_{\mathrm{fin}}( \Gc )}
\def\PiGlfin{\Pi_{\Lambda_0}( \Gc )}
\def\adGfin{\cG_{\mathrm{ad}}(\Gc)}
\def\Ggk{\cG(\fgg,K)}
\def\WT#1{\Delta(#1)}
\def\WG{W(\Gc)}
\def\ch{\mathrm{ch}\,}
\def\Wlam{W_{[\lambda]}}
\def\aLam{a_{\Lambda}}
\def\WLam{W_{\Lam}}
\def\WLamck{W_{[\lambda_{\ckcO}]}}
\def\Wlamck{W_{\lamck}}
\def\Rlam{R_{[\lambda]}}
\def\RLam{R_\Lambda}
\def\RLamp{R_\Lambda^+}
\def\Rplam{R^+(\lambda)}
\def\Glfin{\cG_{\Lambda}(\Gc)}
\def\CL{{\sC}^{\scriptscriptstyle L}}
\def\CR{{\sC}^{\scriptscriptstyle R}}
\def\CLR{{\sC}^{\scriptscriptstyle LR}}
\def\LV{{}^{\scriptscriptstyle L}\sV}
\def\LC{{}^{\scriptscriptstyle L}\sC}
\def\RC{{}^{\scriptscriptstyle R}\sC}
\def\LRC{{}^{\scriptscriptstyle LR}\sC}
\def\ckLC{{}^{\scriptscriptstyle L}\check{\sC}}

\def\LV{{}^{\scriptscriptstyle L}\sV}
\def\ckLV{{}^{\scriptscriptstyle L}\check\sV}
\def\ckLC{{}^{\scriptscriptstyle L}\check\sC}

\def\tLV{{}^{\scriptscriptstyle L}\widetilde{\sV}}
\def\tLC{{}^{\scriptscriptstyle L}\widetilde{\sC}}

\def\brsgn{\breve{\sgn}}
\def\bsgn{\overline{\sgn}}

\def\Wb{W_{\mathrm b}}
\def\Wg{W_{\mathrm g}}


\def\nbb{n_{\mathrm b}}
\def\ngg{n_{\mathrm g}}
\def\tU{\widetilde{\rU}}

\newcommand{\cross}{\times}
\newcommand{\crossa}{\times^a}

\def\bVL{{\overline{\sV}}^{\scriptscriptstyle L}}
\def\bVR{{\overline{\sV}}^{\scriptscriptstyle R}}
\def\bVLR{{\overline{\sV}}^{\scriptscriptstyle LR}}
\def\VL{{\sV}^{\scriptscriptstyle L}}
\def\VR{{\sV}^{\scriptscriptstyle R}}
\def\VLR{{\sV}^{\scriptscriptstyle LR}}

\def\Con{\sfC}
\def\bCon{\overline{\sfC}}
\def\Re{\mathrm{Re}}
\def\Im{\mathrm{Im}}
\def\AND{\quad \text{and} \quad}
\def\Coh{\mathrm{Coh}}
\def\Cohlm{\Coh_{\Lambda}(\cM)}
\def\ev#1{{\mathrm{ev}_{#1}}}

\def\ppp{\times}
\def\mmm{\slash}


\def\cuprow{{\stackrel{r}{\sqcup}}}
\def\cupcol{{\stackrel{c}{\sqcup}}}

\def\Spr{\mathrm{Springer}}
\def\Prim{\mathrm{Prim}}



\def\imathp{\imath_{\wp}}
\def\jmathp{\jmath_{\wp}}

\def\CQ{\overline{\sfA}}% Lusztig's canonical quotient
\def\CPP{\mathrm{PP}}
\def\CPPs{\mathrm{PP}_{\star}}
%\def\CPP{\mathfrak{P}}
%\def\CPPs{\mathfrak{P}_{\star}}


\def\ceil#1{\lceil #1 \rceil}
\def\symb#1#2{{\left(\substack{{#1}\\{#2}}\right)}}
\def\cboxs#1{\mbox{\scalebox{0.25}{\ytb{\ ,\vdots,\vdots,\ }}}_{#1}}

\def\hsgn{\widetilde{\mathrm{sgn}}}

\def\tPBP{\widetilde{\mathsf{PBP}}}
\def\PBPe{\mathsf{PBP}^{\mathrm{ext}}}
\def\PBPes{\mathsf{PBP}^{\mathrm{ext}}_{\star}}
\def\PBPsb{\mathsf{PBP}_{\star,b}}

\def\bev#1{\overline{\mathrm{ev}}_{#1}}

\def\Prim{\mathrm{Prim}}
% \def\leqL{\stackrel{L}{\leq}}
% \def\leqR{\stackrel{R}{\leq}}
% \def\leqLR{\stackrel{LR}{\leq}}

% \def\leqL{{\leq_L}}
% \def\leqR{{\leq_R}}
% \def\leqLR{{\leq_{LR}}}


\def\Dsp{\cD^{\text{sp}}}
\def\Csp{\sfC^{\text{sp}}}

\def\bPsi{\overline{\Psi}}

\def\lneqL{\mathrel{\mathop{\lneq}\limits_{\scriptscriptstyle L}}}
\def\lneqR{\mathrel{\mathop{\lneq}\limits_{\scriptscriptstyle R}}}
\def\lneqLR{\mathrel{\mathop{\lneq}\limits_{\scriptscriptstyle LR}}}

\def\leqL{\mathrel{\mathop{\leq}\limits_{\scriptscriptstyle L}}}
\def\leqR{\mathrel{\mathop{\leq}\limits_{\scriptscriptstyle R}}}
\def\leqLR{\mathrel{\mathop{\leq}\limits_{\scriptscriptstyle LR}}}


\def\approxL{\mathrel{\mathop{\approx}\limits_{\scriptscriptstyle L}}}
\def\approxR{\mathrel{\mathop{\approx}\limits_{\scriptscriptstyle R}}}
\def\approxLR{\mathrel{\mathop{\approx}\limits^{\scalebox{0.4}{$LR$}}}}
\def\approxLR{\approx}


\def\dphi{\rdd \phi}
\def\CPH{C(H)}
\def\whCPH{\widehat{C(H)}}

\def\Greg{G_{\text{reg}}}
\def\Hnreg{H^-_{\text{reg}}}
\def\Hireg{H_{i,\text{reg}}}
\def\Hnireg{H^-_{i,\text{reg}}}


\def\tsgn{\widetilde{\sgn}}
\def\PBP{\mathsf{PBP}}

\def\ckstar{{\check \star}}
\def\ckfgg{{\check \fgg}}

\def\Inn{\mathrm{Ad}}

\providecommand{\nsubset}{\not\subset}

\def\cuprow{{\,\stackrel{r}{\sqcup}\,}}
\def\cupcol{{\,\stackrel{c}{\sqcup}\,}}


\def\ckcOp{\ckcO'}
\def\ckcOpp{\ckcO''}



\def\ckcOb{\ckcO_{\mathrm b}}
\def\ckcOpb{\ckcO'_{\mathrm b}}
\def\cOpb{\cO'_{\mathrm b}}
\def\ckcOg{\ckcO_{\mathrm g}}

\def\nng{n_{\mathrm g}}
\def\nnb{n_{\mathrm b}}
\def\Gb{G_{\mathrm b}}
\def\Gpb{G'_{\mathrm b}}
\def\Pb{P_{\mathrm b}}
\def\Gg{G_{\mathrm g}}
\def\ckGb{\ckG_{\mathrm b}}
\def\ckGg{\ckG_{\mathrm g}}

\def\bcOb{\overline{\cO_{\mathrm b}}}
\def\bcOg{\overline{\cO_{\mathrm g}}}

\def\lamb{\lambda_{\mathrm b}}
\def\lamg{\lambda_{\mathrm g}}


\def\tPBP{\widetilde{\mathsf{PBP}}}
\def\PBPs{\mathsf{PBP}_{\star}}
\def\PBPe{\mathsf{PBP}^{\mathrm{ext}}}
\def\PBPes{\mathsf{PBP}^{\mathrm{ext}}_{\star}}
\def\PBPsb{\mathsf{PBP}_{\star,b}}




\def\PBPop#1#2#3#4{\PBP_{#1}^{#2}(#3,#4)}
\newcommand{\PBPOP}[1][]{\PBPop{\star}{#1}{\ckcO}{\wp}}
% \def\PBPdOP{\PBPop{\star}{\mathrm{d}}{\ckcO}{\wp}}
% \def\PBPrcOP{\PBPop{\star}{\mathrm{rc}}{\ckcO}{\wp}}
% \def\PBPsOP{\PBPop{\star}{\mathrm{s}}{\ckcO}{\wp}}
\def\PBPOPp{\PBPop{\star'}{}{\ckcO'}{\wp'}}
%\def\PBPOPpp{\PBPop{\star}{}{\ckcO''}{\wp''}}
\newcommand{\PBPOPpp}[1][]{\PBPop{\star}{#1}{\ckcO''}{\wp''}}

% \def\PBPdOPpp{\PBPop{\star}{\mathrm{d}}{\ckcO''}{\wp}}
% \def\PBPrcOPpp{\PBPop{\star}{\mathrm{rc}}{\ckcO''}{\wp}}
% \def\PBPsOPpp{\PBPop{\star}{\mathrm{s}}{\ckcO''}{\wp}}

\def\PBPGOP{\PBPop{G}{}{\ckcO}{\wp}}
\def\PBPGOPp{\PBPop{G'}{}{\ckcO'}{\wp'}}
\def\PBPGOPpp{\PBPop{G''}{}{\ckcO''}{\wp''}}


\def\yrow#1{\left[#1\right]_{\mathrm{row}}}
\def\ycol#1{\left[#1\right]_{\mathrm{col}}}


\def\Ass{A_{\mathrm{s}}}
\def\Ans{A_{\mathrm{ns}}}
\def\wpu{\wp_{\uparrow}}
\def\wpm{\wp_{\downarrow}}
\def\wpd{\wp} % define the done-wp to be \wp
\def\uptauu{\uptau_{\uparrow}}
\def\uptaud{\uptau} % define the done-tau to be \uptau


 \def\tnaive{\mathrm{naive}}


\def\imathwpp{\imath_{\wp'}}
\def\jmathwpp{\jmath_{\wp'}}
\def\cPpn{\cP'_\mathrm{naive}}
\def\cQpn{\cQ'_\mathrm{naive}}


\def\PPm{\wp_{\downarrow}}
\def\tauwpp{\tau'_{\wp'}}
\def\tauwppp{\tau''_{\wp''}}
\def\uptaum{\uptau_{\downarrow}}
\def\uptaupn{\uptau'_{\tnaive}}
\def\alphapn{\alpha'_{\tnaive}}
\def\imathpn{\imath'_{\tnaive}}
\def\jmathpn{\jmath'_{\tnaive}}

\def\eDD{\mathrm{d}^{e}}
\def\ckDD{{\check\DD}}
\def\DD{\nabla}
\def\DDn{\nabla_{\tnaive}}
\def\ckDDn{{\ckDD}_{\tnaive}}
\def\DDD{{\check\nabla}}
\def\DDc{\boldsymbol{\nabla}}
\def\gDD{\nabla^{\mathrm{gen}}}
\def\gDDc{\boldsymbol{\nabla}^{\mathrm{gen}}}

\newcommand{\Lam}{{[\lambda]}}

\newcommand{\Rg}{\cR(\fgg)}
\newcommand{\Grt}{\cK}
\newcommand{\nckG}{n_{\ckG}}
%\newcommand{\nb}{n_{\mathrm b}}
%\newcommand{\ng}{n_{\mathrm g}}

\usepackage{xr}
\usepackage{subfiles} % Best loaded last in the preamble



\begin{document}


\title[Special unipotent representations]{Special unipotent representations of real classical groups: counting and reduction to good parity}

\author [D. Barbasch] {Dan Barbasch}
\address{Department of Mathematics\\
  310 Malott Hall, Cornell University, Ithaca, New York 14853 }
\email{dmb14@cornell.edu}

\author [J.-J. Ma] {Jia-Jun Ma}
\address{School of Mathematical Sciences\\
  Xiamen University\\
  Xiamen, China} \email{hoxide@xmu.edu.cn}

\author [B. Sun] {Binyong Sun}
% MCM, HCMS, HLM, CEMS, UCAS,
\address{Institute for Advanced Study in Mathematics\\
 Zhejiang University\\
  Hangzhou, China} \email{sunbinyong@zju.edu.cn}
  %310058

%\address{Academy of Mathematics and Systems Science\\
  %Chinese Academy of Sciences\\
  %Beijing, 100190, China} \email{sun@math.ac.cn}

\author [C.-B. Zhu] {Chen-Bo Zhu}
\address{Department of Mathematics\\
  National University of Singapore\\
  10 Lower Kent Ridge Road, Singapore 119076} \email{matzhucb@nus.edu.sg}




\subjclass[2020]{22E46, 22E47} \keywords{Classical group, special unipotent representation, coherent continuation, Weyl group representation, cell, primitive ideal, associated variety}

% \thanks{Supported by NSFC Grant 11222101}

\begin{abstract} Let $G$ be a real reductive group in Harish-Chandra's class. We derive some consequences of theory of coherent continuation representations
 to the counting of irreducible representations of $G$ with a given infinitesimal character and a given bound in the complex associated variety. When $G$ is a real classical group (including the real metaplectic group), we investigate the set of special unipotent representations of $G$ attached to $\check \CO$, in the sense of Barbasch and Vogan. Here $\check \CO$ is a nilpotent adjoint orbit in the Langlands dual of $G$ (or the metaplectic dual of $G$ when $G$ is a real metaplectic group). We give a precise count for the number of special unipotent representations of $G$ attached to $\check \CO$. We also reduce the problem of constructing special unipotent representations attached to $\check \CO$ to the case when $\check \CO$ has good parity. The paper is the first in a series of two papers on the classification of special unipotent representations of real classical groups.
\end{abstract}




\maketitle



\tableofcontents






\section{Introduction}\label{sec:intro}

\subsection{Background and goals} In \cite{ArPro,ArUni}, Arthur introduced certain families of representations of a semisimple algebraic group over $\R$ or $\C$, in connection with his conjecture on square-integrable automorphic forms. They are the special unipotent representations in the title of this paper and are attached to a nilpotent adjoint orbit $\check \CO$ in the Langlands dual of $G$. For its definition, we will use that of Barbasch-Vogan \cite{BVUni}, which refines that of Arthur and is in the language of primitive ideals.

Apart from their clear interest for the theory of automorphic forms, special unipotent representations belong to a fundamental class of unitary representations which are associated to nilpotent coadjoint orbits in
the Kirillov philosophy (the orbit method; see \cite{Ki62,Ko70,VoBook}). These are known informally as unipotent representations, which are expected to play a central role in the unitary dual problem and therefore have been a subject of great interest. See
%{\cite{V.GL,B89}}
\cite{VoICM,VoBook,Vo89}.
%informal because we are still in search of the right definition.

In the context alluded to, a long standing problem in representation theory, known as the Arthur-Barbasch-Vogan conjecture \cite[Introduction]{ABV}, is to show that every special unipotent representation is unitary.

In a series of two papers, the authors will construct and classify special unipotent representations of real classical groups, and will prove the Arthur-Barbasch-Vogan conjecture for these groups as a consequence of the classification.

The current paper is the first in the series, which have the following two goals. The first is to give a precise count of special unipotent representations attached to $\check \CO$. The second is to reduce the problem of constructing special unipotent representations attached to $\check \CO$ to the case when $\check \CO$ has good parity.

\subsection{Approach}
We will work in the category of Cassellman-Wallach representations \cite[Chapter 11]{Wa2}. The main tool for the counting of irreducible representations in general and special unipotent representations in particular is the coherent continuation representation for this category (\cite[Chapter 7]{Vg}). This is a representation of a certain integral Weyl group, and it can be compared, through a certain embedding, with an analogous coherent continuation representation for the category of highest weight modules. The latter has been intensively studied in Kazhdan-Lusztig theory and is amenable to detailed analysis through the theory of cells and special representations (in the sense of Lusztig), as well as the theory of primitive ideals. In particular one may derive precise information on what representations of the integral Weyl group may contribute to the counting.
%enter in the coherent continuation representation.
(Cf. \cite[Section 5]{BVUni} in the context of complex semisimple groups.) In effectively carrying out the mentioned steps, we build on earlier ideas of several authors including Joseph \cite{J1,J2}, Vogan \cite{Vg}, King \cite{King}, Barbasch-Vogan \cite{BVUni}, and Casian \cite{Cas}.
%as well as Soergel \cite{Soergel}.
For the precise counting of irreducible representations, a key technical issue is a certain relationship (expected by Vogan) between cell representations in the
Casselman-Wallach setting (Harish-Chandra cells) and the highest weight module setting (double cells), which we resolve assuming a weak form of Vogan duality.
Weaving things together, we arrive at counting results of general nature on irreducible representations of $G$ with a given infinitesimal character and a given bound in the complex associated variety, which are valid for any real reductive group $G$ in Harish-Chandra's class. Together with an explicit formula of the coherent continuation representation (due to Barbasch-Vogan) and explicit branching rules of Weyl group representations, this will finally yield the counting of special unipotent representations of real classical groups, described in terms of combinatorial constructs called painted bipartitions.

\delete{Thanks to a version of the Langlands classification (\cite{Vg}), we may also calculate the coherent continuation representation explicitly (an unpublished result of Barbasch and Vogan). In the case of real classical groups, this will ultimately yield an upper bound of the count of special unipotent representations attached to $\check \CO$.

It is worthwhile to note, while the algebraic theory developed in the article yields an explicit upper bound of the count, we are unable to demonstrate the precise count using the algebraic theory alone, due to a certain technical issue on the relationship of a Harish-Chandra cell and a Lusztig double cell, which we have formerly stated as Conjecture \ref{conjcell} (due to Vogan). In the case at hand, namely for the real classical groups, we rely on the analytic theory of theta lifting (\cite{Howe79, Howe89}) to construct the right number of special unipotent representations in the case of good parity (\cite{BMSZ2}, the second paper in the series), thus arriving at the precise count. It will be clearly desirable to demonstrate the precise count, without recourse to the analytic theory.
}

We now outline our approach to the second goal. The case of type $A$ groups is relatively easy and so we focus on groups of type $B$, $C$, and $D$.
When $\check \CO$ is not necessarily of good parity, we introduce a $\check \CO$-relevant parabolic subgroup $P$, whose Levi component is of the form
 $\Gpb\times \Gg $, where $\Gpb$ is a general linear group, and $\Gg$ is of the same classical type as $G$. In their respective Langlands duals, we have nilpotent adjoint orbits
$\check \CO'_\mathrm b$ and $\check \CO_\mathrm g$ (determined by $\check \CO$). We will show that the normalized smooth parabolic induction from $P$ to $G$ yields a bijective map from a pair of special unipotent representations of $\Gpb$ (attached to $\check \CO'_\mathrm b$) and $\Gg$ (attached to $\check \CO_\mathrm g$) to special unipotent representations of $G$ (attached to $\check \CO$).
%We need two ingredients in achieving this reduction step. First by using naturality of coherent continuation representation and the technique of translating to a regular infinitesimal character, we show that the afore-mentioned map is injective. Second,
Firstly, there is a classical group $\Gb$ with the following properties:
\begin{itemize}
\item $\Gb\times \Gg $ is an endoscopy group of $G$;
\item $\Gpb$ is naturally isomorphic to the Levi component of a $\check \CO_\mathrm b$-relevant parabolic subgroup $P_\mathrm b$ of $\Gb$.
\end{itemize}
Here $\check \CO_\mathrm b$ is a nilpotent adjoint orbit
in the Langlands dual of $\Gb$
(determined by $\ckcO$).
General considerations as well as detailed information about coherent continuation representations allow us to separate bad parity and good parity, namely we may determine special unipotent representations of $G$ in terms of those of $\Gb$ and $\Gg$. The normalized smooth parabolic induction from $P_\mathrm b$ to $\Gb$ yields a bijection from special unipotent representations of $\Gpb$ (attached to $\check \CO'_\mathrm b$) to special unipotent representations of $\Gb$ (attached to $\check \CO_\mathrm b$).
On the other hand, Vogan's character theory for real reductive groups \cite{V4} implies that  irreducibility is persevered in the endoscopy setting.
This will finally imply the bijectivity of the induction map from $P$ to $G$.


\subsection{Organization}
%\vskip.25in
%Here are some words on the contents and the organization of this article.
In \Cref{sec:main}, we state our main results first on the counting of irreducible representations in our general setup, and then on the counting of special unipotent representations of real classical groups. For the latter, the more involved cases of groups of type $B$, $C$ and $D$, the main results are in \Cref{reduction} (reduction to good parity) and \Cref{countup} (counting in the case of good parity).
In \Cref{sec:HWM}, we recall some generalities on coherent continuation representations for highest weight modules. This includes a new notion of the $\tau$-invariant of a Weyl group representation, and its role in a certain duality notion of double cells (\Cref{subsec:tau-DC}). In \Cref{sec:CW}, we discuss some analogous results on coherent continuation representations of Casselman-Wallach representations. As mentioned in the introductory section, we establish a certain relationship between Harish-Chandra cells and double cells assuming a weak form of Vogan duality (\Cref{subsec:tau-HC}). In \Cref{sec:counting}, we prove the first part of our main results on the counting of irreducible representations with a given infinitesimal character and a given bound in the complex associated variety.
%(\Cref{counteq} and \Cref{countleq})
In \Cref{sec:GB}, we separate good parity and bad parity for coherent continuation representations, as a preparation for the reduction step in \Cref{sec:red}. \Cref{sec:GL} and \Cref{sec:BCD} are devoted to proof of the second part of our main results, which explicitly counts special unipotent representations, for groups of type $A$, and groups of type $B$, $C$ and $D$, respectively. In \Cref{sec:red}, we carry out the reduction step to the case of good parity and prove \Cref{reduction}. In \Cref{sec:com}, we develop combinatorics of painted bipartitions which we need for the proof of \Cref{countup} in \Cref{sec:BCD}. This includes a notion of descent for painted bipartitions, critical in matching combinatorial parameters of the current paper with special unipotent representations to be constructed in \cite{BMSZ2} by the method of theta lifting (the second paper in the series).

\section{The main results}\label{sec:main}

%In this section, we formulate the main results on special unipotent representations of real classical groups that will be proved in this article.


\subsection{Lie algebra notation}\label{secnot}

Let $\g$ be a reductive complex Lie algebra. Its universal enveloping algebra is denoted by
$\mathcal U(\g)$, and the center of $\mathcal U(\g)$ is denoted by $\CZ(\g)$. Let
 $\hha$ denote the  universal Cartan algebra of $\g$    (also called the abstract Cartan subalgbra in \cite{V4}). Let $W\subset \GL(\hha)$ denote the Weyl group.
 By the Harish-Chandra isomorphism, there is a 1-1
   correspondence between $W$-orbits of $\nu \in \hha^*$ (a superscript $*$ indicates the dual space)
and algebraic characters $\chi_\nu: \CZ(\g)\rightarrow \C$.
%In fact the correspondence is between $\mathrm{Ad}(\g)$-orbits of semisimple
%elements of $\g^*$ and algebraic characters, where $\mathrm{Ad}(\g)$ denotes the inner automorphism group of $\g$.
We say that an ideal of $\CU(\g)$ has infinitesimal character $\nu$ if it contains the kernel of $\chi_\nu$. By a result of Dixmier \cite[Section 3]{Bor}, there is a unique maximal ideal of $\CU(\g)$ that has infinitesimal  character  $\nu$. Write $I_\nu$ for this maximal ideal. (We remark that every maximal ideal of $\CU(\g)$ is primitive.)
\delete{Note that the maps
\[
  \hha^*\rightarrow \{\textrm{algebraic character of $\CZ(\g)$}\}, \quad \nu\mapsto \chi_\nu
\]
and
\[
  \hha^*\rightarrow \{\textrm{maximal ideal  of $\CU(\g)$}\}, \quad \nu\mapsto I_\nu
\]
are both surjective, and the fibers of these two maps are precisely the $W$-orbits.}

Let $\Nil(\g)$ (resp. $\Nil(\g^*)$) be the set of nilpotent elements in $[\g,\g]$ (resp. $[\g,\g]^*$). Denote $\mathrm{Ad}(\g)$ the inner automorphism group of $\g$, and put
\[
 \overline{\Nil}(\g):=\Inn(\g)\backslash \Nil(\g), \qquad \overline{\Nil}(\g^*):=\Inn(\g)\backslash \Nil(\g^*), \]
the set of $\Inn(\g)$-orbits in $\Nil(\g)$ and
$\Nil(\g^*)$ (which are finite).  The Killing form on $[\g,\g]$  yields an identification $\overline{\Nil}(\g)=\overline{\Nil}(\g^*)$.
Since $\g$ is the direct sum of its center with $[\g, \g]$, $[\g,\g]^*$ is obviously viewed as a subspace of $\g^*$.



\subsection{Counting irreducible representations}\label{subsec:countIrr}

Let $G$ be a real reductive group in Harish-Chandra's class whose complexified Lie algebra equals $\g$. Let $\mathrm{Rep}(G)$ be the category of Casselman-Wallach representations of $G$, whose Grothendieck group (with $\C$-coefficients) is denoted by $\CK(G)$.
Let $\Irr(G)$ be the set of isomorphism classes of irreducible Casselman-Wallach representations of $G$, which forms a basis of $\CK(G)$.

%Let $G$ be a real reductive group in Harish-Chandra's class (which may be

%In the rest of  this paper, % unless otherwise mentioned,
%we use the corresponding lowercase gothic letter to denote the complexified Lie algebra of a Lie group.




Let $\nu\in \hha^*$ and let $\sfS$ be an $\Ad(\g)$-stable Zariski closed subset of $\Nil(\g^*)$. Let $\Irr_{\nu,\sfS}(G)$ denote the subset of $\Irr(G)$ consisting of  representations that have infinitesimal character $\nu$ and whose complex associated variety is  contained in $\sfS$.
Our aim is to count the set $\Irr_{\nu,\sfS}(G)$.


To do this, we form the subset $\Lambda$ of $\hha^*$, which is the $\nu$-translate of the root lattice. Let $W(\Lambda)$ be the integral Weyl group of $\nu$, which equals the stabilizer of $\Lambda$ in $W$. We consider the space $\Coh_{\Lambda}(\CK(G))$ of $\CK(G)$-valued  coherent families on $\Lambda$, which is a finite-dimensional representation of $W(\Lambda)$. This is called the coherent continuation representation. See \Cref{subsec:coherent}.

Attached to $\sfS$, we will define a certain subset $\Irr_\sfS(W(\Lambda))$   of $\Irr(W(\Lambda))$  by using the Springer correspondence. See \Cref{sec:ass}.

Let $\widetilde \Sp_{2n}(\R)$ ($n\in \bN:=\{0,1,2,\dots\}$) denote  the metaplectic double cover of the symplectic
 group $\Sp_{2n}(\R)$ (it does not split for $n>0$), to be called a real metaplectic group. Recall that $G$ is is said to be linear if it has a faithful finite-dimensional representation.

 \begin{thm}\label{Mcounteq}
   % Under the notation of \Cref{lem:lcell.BV}, we have
 We have the inequality
  \begin{equation*}%\label{leq2}
  \sharp(\Irr_{\nu,\sfS}(G)) \leq  \sum_{\sigma \in \Irr_\sfS(W(\Lambda))} [1_{W_{\nu}}: \sigma]\cdot [\sigma:\Coh_{\Lambda}(\CK(G))],
\end{equation*}
 where $1_{W_{\nu}}$ denotes the trivial representation of the stabilizer ${W_{\nu}}$ of $\nu$ in $W$. The equality holds if $G$ is linear or isomorphic to a real metaplectic group.
  \end{thm}


Here and henceforth, $[\ : \ ]$ indicates the multiplicity of the first
(irreducible) representation in the second one, and $\sharp$ indicates the cardinality of a finite set.

Let $\Irr(G;I_\nu)$ denote the subset of $\Irr(G)$ consisting of  representations that are annihilated by $I_\nu$. Note that $\Irr(G;I_\nu)=
\Irr_{\nu,\overline{\CO_\nu}}(G)$, where $\overline{\CO_\nu}$ is the associated variety of the maximal ideal $I_\nu$. In this case, work of Lusztig \cite{Lu}
and Barbasch-Vogan \cite{BVUni} imply that \[ [1_{W_{\nu}}: \sigma]\leq 1\]
for all $\sigma \in \Irr_{\overline{\CO_\nu}}(W(\Lambda))$, and
the set
\[
\{\sigma\in
\Irr_{\overline{\CO_\nu}}(W(\Lambda))\mid [1_{W_{\nu}}: \sigma]\neq 0\}
\]
can be explicitly described by the Lusztig left cell $\LC_{\nu}$ (see \eqref{ll} for its definition).  Therefore \Cref{Mcounteq} has the following consequence.


 \begin{cor}\label{Mcountleq}
   % Under the notation of \Cref{lem:lcell.BV}, we have
We have the inequality
  \begin{equation*}%\label{boundc}
    \sharp(\Irr(G;I_\nu)) \leq \sum_{\sigma \in \LC_{\nu}}   [\sigma:\Coh_{\Lambda}(\CK(G))],
  \end{equation*}
     and the equality holds if $G$ is linear or isomorphic to a real metaplectic group.
\end{cor}

\begin{remark} The equalities in \Cref{Mcounteq} and \Cref{Mcountleq} will be proved more generally for any $G$ satisfying a weak form of Vogan duality. For this,  following \cite{FJMN} we will introduce a new technical tool, namely a notion of $\tau$-invariant for a representation of $W(\Lambda)$, and show that a special irreducible representation of $W(\Lambda)$ is determined by its $\tau$-invariant. See \Cref{subsec:tau-DC} and \Cref{subsec:tau-HC}.
\end{remark}

 \subsection{Special unipotent representations of real classical groups}
 \label{sec:defunip}

% We are particularly interested in counting special unipotent representations of real classical groups.





Suppose that $\star$ is one of the 10 labels, $G$ is a classical Lie group of type $\star$, and $\check \g$ is its complex dual Lie algebra, as in the following table ($n,p,q\in \bN$).
\[
  \begin{aligned}
    &\textrm{Label $\star$}&& \textrm{Classical Lie Group $G$} && \textrm{Complex Dual Lie Algebra }\check \g\\
    & A^\R&&\GL_n(\R) &&\g\l_n(\C)\\
    & A^\bH&&\GL_{\frac{n}{2}}(\bH)\ \,  (n \textrm{ even}) && \g\l_{n}(\C)\\
    & A &&\oU(p,q) &&\g\l_{p+q}(\C)\\
    &\widetilde{A}&&\widetilde \oU(p,q) &&\g\l_{p+q}(\C)\\
    & B &&\SO(p,q)\ \, (p+q\, \textrm{ odd}) && \s\p_{p+q-1}(\C)\\
    &D&&\SO(p,q)\  \, (p+q\, \textrm{ even}) &&\o_{p+q}(\C)\\
    &C&&\Sp_{2n}(\R)&& \o_{2n+1}(\C)\\
    &\widetilde{C}&&\widetilde \Sp_{2n}(\R) &&\s\p_{2n}(\C)\\
    &D^*&& \oO^*(2n) &&\o_{2n}(\C)\\
    &C^* && \Sp(p/2,q/2)  \ \, (p,q\, \textrm{ even}) &&\o_{p+q+1}(\C)
  \end{aligned}
\]

 In this table  $\tU(p,q)$ is
 the double cover of $\rU(p,q)$ defined by a square root of the
 determinant character.
 %Suppose that $\g$ is the complexified Lie algebra  of the classical Lie group $G$ in the second column.
 In the last column, $\check \g$ is the
 complex Lie algebra which is the Langlands dual of  the complexified Lie algebra $\g$ of $G$, except for the case of $\wtC$. In this exceptional case,  $\check \g=\s\p_{2n}(\C)$, to be called the
 ``\textit{metaplectic}'' Langlands dual of $\g=\s\p_{2n}(\C).$

 Let $\check \hha$ denote the abstract Cartan algebra of $\check \g$. In all
 cases we identify  $\hha^*$ with $\check \hha$ in the standard way,  except for $\wtC$ where the identification  is via the half of the trace form on the
 Lie algebra $\g=\s\p_{2n}(\C)$.

\delete{
 Let $\star$ be one of the 10 symbols
 \[
  \textrm{ $A^\R$, $A^\bH$, $A$, $\widetilde A$, $B$, $D$, $C$, $\wtC$, $D^*$, $C^*$. }
 \]
 Suppose that $G$ is a classical Lie group of type $\star$, namely $G$
 respectively equals one of the following Lie groups:
 \[
   \begin{array}{c}
     \GL_n(\R),  \  \GL_{\frac{n}{2}}(\bH)\ (n \textrm{ is even}),\  \oU(p,q),\  \widetilde \oU(p,q), \smallskip\\
     \SO(p,q)\ (p+q\, \textrm{ is odd}),  \  \SO(p,q)\  (p+q\, \textrm{ is even}),  \  \Sp_{2n}(\R),  \   \widetilde \Sp_{2n}(\R), \ \smallskip\\
    \oO^*(2n), \  \Sp(\frac{p}{2},\frac{q}{2})  \ (p,q\, \textrm{ are even})\qquad (n, p, q\in \BN:=\{0,1,2,\cdots\}).
   \end{array}
 \]
 Here $\wtSp_{2n}(\R)$ denotes the metaplectic double cover of the symplectic
 group $\Sp_{2n}(\R)$ that does not split unless $n=0$, and $\tU(p,q)$ is the double cover of $\rU(p,q)$ defined by a square root of the determinant character.
Suppose that $\g$ equals the complexified Lie algebra of $G$ for the rest of this section.

Let
$\check \g$ denote the complex Lie algebra
\[
   \begin{array}{c}
     \g\l_n(\C),  \  \g\l_{n}(\C),\  \g\l_{p+q}(\C), \  \g\l_{p+q}(\C),\smallskip\\
     \s\p_{p+q-1}(\C),  \  \o_{p+q}(\C),\
     \o_{2n+1}(\C),  \ \s\p_{2n}(\C), \ \smallskip\\   \o_{2n}(\C), \ \textrm{or } \   \o_{p+q+1}(\C),
   \end{array}
 \]
 respectively.

 If $\star\neq \wtC$, then $\check \g$ is  the Langlands dual of $\g$ so that the dual space $\hha^*$ is identified with the universal Cartan algebra $\ckhha$ of $\check \g$.
 If  $\star=\wtC$, then $\check \g=\g$, to be  called the metaplectic Langlands dual of $\g$.  In this case, $\hha=\ckhha$, and  $\hha^*$ is identified with  $\hha$ by  using the half of the trace form on the Lie algebra $\g=\s\p_{2n}(\C)$. Thus in all cases we have the identification $\hha^*=\ckhha$.
 }





% Define the Langlands dual $\ckG$ of $G$ to be respectively the complex group
% \[
%   \begin{array}{c}
%     \GL_n(\C),  \  \GL_{2n}(\C),\  \GL_{p+q}(\C), \  \GL_{p+q}(\C),\smallskip\\
%     \Sp_{p+q-1}(\C)\ (p+q\, \textrm{ is odd}),  \  \SO_{p+q}(\C)\  (p+q\, \textrm{ is even}),\smallskip\\
 %    \SO_{2n+1}(\C),  \ \Sp_{2n}(\C), \  \SO_{2n}(\C), \ \textrm{or } \   \SO_{2p+2q+1}(\C).
%   \end{array}
% \]
 % Write $\check \g$ for the Lie algebra of $\ckG$, and
 Let $\check \CO\in \overline{\mathrm{Nil}}(\check \g)$ be a nilpotent $\Inn(\check \g)$-orbit. Write $\mathbf d_{\check \CO}$ for the Young diagram attached to  $\check \CO$. It determines the nilpotent orbit $\check \CO$, unless $\check \g=\o_{4k}(\C)$ ($k\in \bN^+:=\{1,2,3, \dots\}$) and all the row lengths are even.
When there is no confusion, we will not distinguish between $\check \CO$ and  $\mathbf d_{\check \CO}$.

Let $\{\check e,\check h,\check f\}$ be an $\fsl_{2}$-triple in $\check \g$ representing $\ckcO$, namely $\check e\in \check \CO$. The element $\check h/2$ is semisimple, and its
  $\Inn(\check \g)$-orbit is uniquely determined by $\ckcO.$ Using the identification
 \be\label{sse}
   \Inn(\check \g)\backslash  \{\textrm{semisimple element in $\check \g$}\}=W\backslash \ckhha=W\backslash \hha^*,
 \ee
we pick an element $\lambda_{\check \CO}\in \hha^*$ that represents the same element in  $ W\backslash \hha^*$  as $\check h/2$.
As in \cite[Section 5]{BVUni}, $\lambda_{\check \CO}$ determines an infinitesimal character (namely an algebraic character of $\CZ(\g)$), also called the
 infinitesimal character associated to $\ckcO$. Write $I_{\check \CO}:=I_{\star, \check \CO}:=I_{\lambda_{\check
    \CO}}$ for the  maximal ideal of $\CU(\g)$, only dependent on
$\check \CO$. (The subscript $\star$ is one of the labels in the table.)

\delete{
Let $\lambda_{\ckcO}^\circ \in \check \g$ be half of the neutral element in any
 $\fsl_{2}$ triple attached to $\ckcO$, as in \cite[Section 5]{BVUni}. It is a semisimple element and is uniquely determined up to conjugation by $\Inn(\check \g)$.
Using the identification
 \be\label{sse}
   \Inn(\check \g)\backslash  \{\textrm{semisimple element in $\check \g$}\}=W\backslash \ckhha=W\backslash \hha^*,
 \ee
we pick an arbitrary element $\lambda_{\check \CO}\in \hha^*$ that represents the same element in  $ W\backslash \hha^*$  as $\lambda_{\check \CO}^\circ$.}
%By abuse of notation, we still use $\lambda_{\check \CO}$ to denote this element of $\hha^*$.



%Write $I_{\check \CO}:=I_{\star, \check \CO}:=I_{\lambda_{\check \CO}}$, which is a maximal ideal of $\CU(\g)$ that is independent of the choices of $\lambda_{\ckcO}^\circ$ and $\lambda_{\check \CO}$.

 Let $\CO:=d_{\mathrm{BV}}(\check \CO)\in \overline{\Nil}(\g^*)$ denote the Barbasch-Vogan dual of $\check \CO$, namely the  unique Zariski open $\Ad(\g)$-orbit in the associated variety of $I_{\check \CO}$. See \cite[Appendix]{BVUni} and \cite[Section 1]{BMSZ1}. (This duality notion is an analog of a certain duality notion defined earlier by Spaltenstein in \cite{Spa}.)
 Note that a primitive ideal of $\CU(\g)$ equals the maximal ideal $I_{\check \CO}$ if and only if it has infinitesimal character  $\lambda_{\check \CO}$ and its associated variety  equals the Zariski closure of $\CO$ in $\g^*$.

 % (the maximal ideal of $\mathcal U(\g)$ with infinitesimal character $\lambda_{\check \CO}$, namely  containing the kernel of $\chi_\lambda$).

%We remark that in the metaplectic case, namely when $\star=\wtC$ and $G=\widetilde \Sp_{2n}(\R)$,  $\hha$ is identified with $\hha^*$ by using the half of the trace form on the Lie algebra $\s\p_{2n}(\C)$, and hence \eqref{sse} still holds.

 %By using Harish-Chandra isomorphism, we view $\lambda_{\check \CO}$ as a character $\lambda_{\check \CO}: \mathcal Z(\g)\rightarrow \C$.


Following Barbasch-Vogan \cite{BVUni}, define the set of the special unipotent representations of $G$
 attached to $\ckcO$ by
\[
 %\begin{equation}\label{eq:defuni}
   \begin{split}
     \Unip_{\ckcO}(G):=&  \Unip_{\star, \ckcO}(G) \\
     :=& \begin{cases}
       % \{\pi\in \Irr(G)\mid \pi \textrm{ is annihilated by $ I_{\check \CO}$ or $I'_{\check \CO}$}\}, & \text{if } \star \in \set{D, D^\C, D^*};\\
       \{\pi\in \Irr(G)\mid \pi \textrm{ is genuine  and annihilated by } I_{\check \CO}\}, & \text{if } \star\in \{\widetilde A, \widetilde C\};\\
       \{\pi\in \Irr(G)\mid \pi \textrm{ is annihilated by } I_{\check \CO}\}, & otherwise.\\
     \end{cases}
   \end{split}
% \end{equation}
\]
 Here ``genuine" means that the central subgroup $\{\pm 1\}$ of $G$, which is the kernel of the covering homomorphism $\widetilde \oU(p,q)\rightarrow  \oU(p,q)$ or $\widetilde \Sp_{2n}(\R)\rightarrow \Sp_{2n}(\R)$, acts on $\pi$ through the nontrivial character.
 % of $G$ representation $\pi$ of $\widetilde \oU(p,q)$ or $\widetilde \Sp_{2n}(\R)$ does not descend to $\oU(p,q)$ or $\Sp_{2n}(\R)$, respectively.

The main goal of this paper and the second paper in the series \cite{BMSZ2} is to count the set $\Unip_{\check \CO}(G)$ and to construct all the representations in $\Unip_{\check \CO}(G)$.

We define a notion of good parity and bad parity which will be used throughout the article and will play an important role in the classification of special unipotent representations (for unitary groups and for groups of type $B$, $C$ and $D$).
Note that if $\star\in \{A^\R, A^\bH, C, \wtC, D^*\}$, then $n$ equals the rank of $\g$. In all other cases, we also let $n$ denote the rank of $\g$.
We call an integer to have the good parity (depends on $\star$ and $n$) if it has the same parity as
\begin{equation}\label{parity}
  \begin{cases}
    n, &  \text{if $\star \in \{A^\R, A^\BH,  A\}$}; \\
    1+ n, &  \text{if $\star = \wtA$}; \\
   1, & \text{if } \star \in \set{C,C^{*},D,D^{*}};\\
 \text{0}, & \text{if } \star \in \set{B,\wtC}.\\
  \end{cases}
\end{equation}
Otherwise we call the integer to have bad parity.
%(An invariant formulation is through $\lambda_{\check \CO}$.)

%In view of \Cref{cor:bound}, we will explicitly determine both $\LC_\lambda$ and $\Coh_{\Lam}(\CK(G))$ (for $\lambda =\lambda_{\ckcO}$) and will express the sum $\sum_{\sigma\in \LC_\lambda} [\sigma: \Coh_{\Lam}(\CK(G))]$ as the count of certain combinatorial constructs. These combinatorial constructs provide the key linkage with the authors' second paper \cite{BMSZ2}, whose main goal is to construct all the representations in $\Unip_{\check \CO}(G)$.

\subsection{General linear groups}\label{sec:GLRH}


All special unipotent representations of $\GL_n(\bR)$ and $\GL_{\frac{n}{2}}(\bH)$  are obtained via normalized smooth parabolic induction from quadratic characters (see \cite{V.GL}*{Page 450}).
We will review their classifications in the framework of this article.


  For a Young diagram $\imath$, write
 \[
   \mathbf r_1(\imath)\geq \mathbf r_2(\imath)\geq \mathbf r_3(\imath)\geq \cdots
 \]
 for its row lengths, and similarly, write
 \[
   \mathbf c_1(\imath)\geq \mathbf c_2(\imath)\geq \mathbf c_3(\imath)\geq \cdots
 \]
 for its column lengths. Denote by
 $\abs{\imath}:=\sum_{i=1}^\infty \mathbf r_i(\imath)$ the total size of
 $\imath$.

For any Young diagram $\imath$, we introduce the set $\mathrm{Box}(\imath)$ of
boxes of $\imath$ %as the following subset of $\bN^+\times \bN^+$:
as follows:
\begin{equation}\label{eq:BOX}
  \mathrm{Box}(\imath):=\Set{(i,j)\in\bN^+\times \bN^+| j\leq \bfrr_i(\imath)}.
\end{equation}
A subset of $\bN^+\times \bN^+$ of the form \eqref{eq:BOX} is also said to constitute the Young diagram $\imath$.

% We will also call a subset of $\bN^+\times \bN^+$ of the form \eqref{eq:BOX} a
% Young diagram.

% We say that a Young diagram $\imath'$ is contained in $\imath$ (and write
% $\imath'\subset \imath$) if
% \[
%   \mathbf r_i(\imath')\leq \mathbf r_i(\imath)\qquad \textrm{for all
% } i=1,2, 3, \cdots.
% \]
% When this is the case, $\mathrm{Box}(\imath')$ is viewed as a subset of
% $\mathrm{Box}(\imath)$ concentrating on the upper-left corner. We say that a
% subset of $\mathrm{Box}(\imath)$ is a Young subdiagram if it equals
% $\mathrm{Box}(\imath')$ for a Young diagram $\imath'\subset \imath$. In this
% case, we call $\imath'$ the Young diagram corresponding to this Young
% subdiagram.

\renewcommand{\CP}{\mathcal{P}} We also introduce five symbols $\bullet$, $s$,
$r$, $c$ and $d$, and make the following definitions.
\begin{defn}
 A painting on a Young diagram $\imath$ is an assignment
  \[
    \mathcal P: \mathrm{Box}(\imath) \rightarrow \{\bullet, s, r, c, d \}
  \]
  with the following properties:
  \begin{itemize}
  \item the set of boxes of $\imath$ painted with symbols in $S$ constitutes a Young diagram, when
          $S=\{\bullet\}, \{\bullet, s \}, \{\bullet, s, r\}$ or
          $\{\bullet, s, r, c \} $;
   % \item $\mathcal P^{-1}(S)$ is the set of boxes of a Young diagram when           $S=\{\bullet\}, \{\bullet, s \}, \{\bullet, s, r\}$ or           $\{\bullet, s, r, c \} $;
    \item every row of $\imath$ has at most one box
          painted with $s$, and has at most one box painted with $r$;
   %\item when $S=\{s\}$ or $ \{r\}$, every row of $\imath$ has at most one box in $\CP^{-1}(S)$;
    \item every column of $\imath$ has at most one
          box painted with $c$, and has at most one box painted with $d$.
   %\item when $S=\{c\}$ or $ \{d \}$, every column of $\imath$ has at most one box in $\CP^{-1}(S)$.
  \end{itemize}
A painted Young diagram is a pair $(\imath, \CP)$ consisting of a Young diagram $\imath$ and a painting $\CP$ on $\imath$.
\end{defn}

\delete{
\begin{remark} The first requirement of a painting means that the symbols $\bullet$, $s$,
$r$, $c$ and $d$ should be painted in the order as indicated and all the painted boxes constitute a valid Young diagram throughout the process; The second (resp. third) requirement means that every row (resp. column) has at most one box painted with $s$ or $r$ (resp. $c$ or $d$).
\end{remark}
}


\begin{eg}
  The following represents a painted Young diagram.
   \[ \ytb{\bullet\bullet\bullet\bullet r,\bullet r d , sr,dd}
  \]
\end{eg}

\begin{defn}\label{defpbp0}
  Suppose that $\star\in \{A^\R, A^\bH\}$. A painting $\CP$ on a Young diagram $\imath$ has type $\star$ if
  \begin{itemize}
    \item the symbols of $\CP$ are in
          \[
          \left\{
          \begin{array}{ll}
            \{\bullet, c, d\}, &\hbox{if $\star=A^\R$}; \smallskip\\
            \{\bullet\}, &\hbox{if $\star=A^\bH$},                    \end{array}
        \right.
          \]
    \item every column of $\imath$ has an even number of boxes painted with $\bullet$.
    %       \item $\CP^{-1}(\bullet)$ has even number of boxes in every column of $\imath$.
          \end{itemize}
  Denote by $\PAP_\star(\imath)$ the set of paintings on $\imath^{t}$ that has type $\star$, where $\imath^{t}$
  is the transpose of $\imath$.
   \end{defn}

%Note that in the definition of $\PAP_\star(\imath^{t})$, we have incorporated the transpose map in order to reconcile with the Barbasch-Vogan duality.

The middle letter $\mathrm A$ in $\PAP$ refers to the common $A$ in $\{A^\R, A^\bH\}$.

It is easy to check that if $\star=A^\R$, then
  \[
    \sharp(\PAP_\star(\check \CO))=\prod_{i\in \bN^+} (1+\textrm{the
      number of rows of length $i$ in $\check \CO$}),
  \]
  and if $\star=A^\bH$, then
  \[
    \sharp(\PAP_\star(\check \CO))= \left\{
      \begin{array}{ll}
        1, &\hbox{if all row lengths of $\check \CO$ are even}; \smallskip\\
        0, &\hbox{otherwise}.  \end{array}
    \right.
  \]
Here and henceforth $\sharp$ indicates the cardinality of a finite set.



% We assume that $G  = \GL_{n}(\bC), \GL_{n}(\bR), \GL_{\half n}(\bH)$ and $\star = A,A^{\bC}, A^{\bH}$ respectively.

%



% We list some easy facts below:
% \[
%   \begin{split}
%     W &= \sfS_{n} \\
%     W_{[\lamck]} & = \sfS_{\abs{\ckcO_{e}}}\times \sfS_{\abs{\ckcO_{o}}} \\
%     W_{\lamck} & = \prod_{i\in \bN^{+}}\sfS_{\bfcc_{i}(\ckcO_{e})}\times \prod_{i\in \bN^{+}}\sfS_{\bfcc_{i}(\ckcO_{o})}\\\
%     \tau_{\lamck} & := (j_{W_{\lamck}}^{W_{[\lamck]}}\sgn )\otimes \sgn =  \ckcO_{e}^{t}\boxtimes \ckcO_{o}^{t}\\
%     \LC_{\lamck} & = \LRC_{\lamck}= \set{\tau_{\lamck}}, \AND \\
%     \wttau_{\lamck} & = j_{W_{[\lamck]}}^{W}\tau_{\lamck} = \Spr^{-1}(\cO).
%   \end{split}
% \]


% Now let $\ckcO\in \Nil(\ckGc)$ and decompose
% \[
%   \ckcO = \ckcO_{e} \cuprow \ckcO_{o}
% \]
% where $\ckcO_e$ and $\ckcO_o$ are partitions consist of even and odd rows
% respectively.

% Every irreducible representation in $\Irr(W)$ is special. For the
% infinitesimal character $\lamck$,
% \[

% \]

% In all the cases, let $\DDD$ denote the dual descent of Young diagrams.
% Suppose $\ckcO$ is a Young diagram, it delete the longest row in $\ckcO$


% Let $\YD$ be the set of Young diagrams viewed as a finite multiset of positive
% integers. The set of nilpotent orbits in $\GL_n(\bC)$ is identified with Young
% diagram of $n$ boxes.


% Let $n_e = \abs{\ckcO_e}, n_o =
% \abs{\ckcO_o}$. % and $\lambda_\ckcO = \half \ckhh$.
% By the formula of $a$-function, one can easily see that The cell in
% $W(\lamck)$ consists of the unique representation
% $J_{W_{\lamck}}^{\Wint{\lamck}} (1)$. Now the $W$-cell
% $(J_{W_{\lamck}}^{W_{[\lamck]}} \sgn)\otimes \sgn$ consists a single
% representation
% \[
%   \tau_{\ckcO} = \ckcO_{e}^{t}\boxtimes \ckcO_{o}^{t}.
% \]
% The representation $j_{W_{\lamck}}^{S_{n}} \tau_{\ckcO}$ corresponds to the
% orbit $\cO= \ckcO^t $ under the Springer correspondence.

%In this subsection, we assume that  $\star=A^\R$ so that $G = \GL_{n}(\bR)$.

%We define the set of painted partitions of type $A$ as the following:
%\begin{equation*}%\label{eq:PP.AR}
%  \PP_{A}(\ckcO) = \Set{\uptau:=(\tau, \cP)|
%    \begin{array}{l}
%      \text{$\tau = \ckcO^{t}$}\\
%      \text{$\Im(\cP)\subseteq \set{\bullet,c,d}$}\\
%      \text{$\#\set{i|\cP(i,j)=\bullet}$ is even for all $j\in \bN^{+}$}
%    \end{array}
%  }.
%\end{equation*}


If $\star=A^\R$, for every
$\CP\in \PP_{\star}(\ckcO)$ we attach a representation $\pi_\CP$ of $G$ as in what follows. Let $P_\CP$ be  the standard parabolic subgroup of $G$
with Levi component
$$
\GL_{\bfrr_1(\ckcO)}(\R)\times \GL_{\bfrr_2(\ckcO)}(\R)\times\dots \times \GL_{\bfrr_k(\ckcO)}(\R),
$$
where $k$ is the number of nonempty rows of $\check \CO$.
On each factor $\GL_{\bfrr_j(\ckcO)}(\R)$, put the trivial character or the sign character  according to whether the $j$-th column
of $\CP$ ends in $\bullet,c$ or $d$. This yields a character of $P_\CP$ and let  $\pi_\CP$ be the resulting normalized induced representation of $G$.


Similarly, if  $\star=A^\bH$, for every
$\CP\in \PP_{\star}(\ckcO)$ we attach a representation $\pi_\CP$ of $G$ as in  what follows. Let $P_\CP$ be  the standard parabolic subgroup of $G$
with Levi component
$$
\GL_{\bfrr_1(\ckcO)/2}(\bH)\times \GL_{\bfrr_2(\ckcO)/2}(\bH)\times\dots \times \GL_{\bfrr_k(\ckcO)/2}(\bH),
$$
where $k$ is the number of nonempty rows of $\check \CO$.
Put the trivial character on each factor $\GL_{\bfrr_j(\ckcO)/2}(\bH)$. This yields a character of $P_\CP$ and let  $\pi_\CP$ be the resulting normalized induced representation of $G$.

\trivial[h]{
For $A^\bH$ let $P$ be the analogous real parabolic subgroup with Levi
component
$$
M(\imath)=GL_{r_1}(\bH)\times GL_{r_2}(\bH)\times\dots \times G_{r_\ell}(\R),\quad r_\ell>0, r_{\ell+1}=0.
$$
and take the induced module from $Triv$ on each factor. Let
$\pi_\uptau$ be the induced module.


\begin{equation}\label{eq:u.GLR}
  \pi_\uptau :=
  \bigtimes_{j} \underbrace{1_j \times \cdots \times 1_j}_{c_j\text{-terms}}\times
  \underbrace{\sgn_j \times \cdots \times {\sgn_j} }_{d_j\text{-terms}},
\end{equation}
where
\begin{itemize}
  \item $j$ runs over all nonzero row lengths in $\ckcO$,
  \item $1_j$ and $\sgn_j$ respectively denote the trivial and nontrivial quadratic characters on $\GL_j(\bR)$,
  \item $d_j$ is the number of columns of length $j$ ending with the symbol
        ``$d$'' in the painting $\uptau$,
  \item $c_j$ is the number of columns of length $j$ ending with the symbol
        ``$\bullet$'' or ``$c$'' in the painting $\uptau$, and
  \item ``$\times$'' denotes the normalized smooth parabolic induction.
\end{itemize}


If $\star=A^\bH$, for every
$\uptau\in \PP_{\star}(\ckcO)$ we attach the representation
\begin{equation}\label{eq:u.GLR}
  \pi_\uptau :=
 1_{\bfrr_1(\ckcO)}\times 1_{\bfrr_2(\ckcO)} \times \cdots
   \times  1_{\bfrr_k(\ckcO)},
\end{equation}
where
\begin{itemize}
  \item$k$ is the number of nonempty rows of $\ckcO$
\item $1_j$ denotes the trivial representation of $\GL_{\frac{j}{2}}(\bH)$ for every $j\in 2\bN^+$, and
  \item ``$\times$'' denotes the normalized smooth parabolic induction.
\end{itemize}
}

Then in both cases $\pi_\CP$ is irreducible and belongs to $\Unip_{\ckcO}(G)$ (see  \cite[Theorem 3.8]{V.GL} and \cite[Example~27.5]{ABV}).
We summarize the classifications by the following theorem.

\begin{thm}%(\cf \cite[Example 27.5]{ABV} and  \cite[Theorem 3.8]{V.GL})
 \label{thm:mainR00}
Suppose that  $\star\in \{A^\R, A^\bH\}$. Then the map
  \[
    \begin{array}{ccc}
      \PP_{\star}(\ckcO) & \rightarrow & \Unip_{\ckcO}(G),\\
      \CP & \mapsto & \pi_\CP
    \end{array}
  \]
  is bijective. \qed
\end{thm}

\subsection{Unitary groups}
%In this subsection, we  Then $\ckG = \GL_{2n}(\bC)$.

Similar to \Cref{defpbp0}, we make the following definition.

\begin{defn}\label{defpbp1}
  Suppose that $\star\in \{A, \widetilde A\}$. A  painting $\CP$ on a Young diagram $\imath$ has type $\star$ if
  \begin{itemize}
    \item the symbols of $\CP$ are in $\{\bullet, s, r\}$, and
                    \item every row of $\imath$ has an even number of boxes painted with $\bullet$.
  \end{itemize}
  Denote by $\PAP_\star(\imath)$ the set of
 paintings on $\imath^{t}$ that has type $\star$, where $\imath^{t}$
  is the transpose of $\imath$.
   \end{defn}


Now suppose that $\imath$ is a Young diagram and $\CP$ is a painting on $\imath$
that has type $A$ or $\widetilde A$. Define the signature of $\CP$ to be the pair
\begin{equation}\label{eq:signature}
    (p_\CP, q_\cP): = \left (\frac{\sharp(\cP^{-1}(\bullet))}{2}+\sharp(\cP^{-1}(r)),\,
    \frac{ \sharp(\cP^{-1}(\bullet))}{2}+\sharp(\cP^{-1}(s))\right).
\end{equation}
\trivial[h]{ The first equation is the true definition of signature. The second
  one is an easy consequence of the definition of $\AC_\cP$. }

\begin{eg}
  Suppose
  that \[ \check \CO=\ytb{\ \ \ \ \ , \ \ \ , \ , \ , \ }\quad \textrm{and}\quad \CP=\ytb{\bullet\bullet\bullet\bullet r,\bullet\bullet , sr,s,r}\in \mathrm{PAP}_{A}(\check \CO) .
  \]
  Then $(p_\CP, q_\cP)=(6,5)$.

\end{eg}

% Given two Young diagrams $\imath$ and $\jmath$, write $\imath\cuprow \jmath$ for
% the Young diagram whose multiset of nonzero row lengths equals the union of
% those of $\imath$ and $\jmath$. Also write $2\imath =\imath\cuprow \imath$.



Given two Young diagrams $\imath$ and $\jmath$, write $\imath\cuprow \jmath$ for
the Young diagram whose multiset of nonzero row lengths equals the union of
those of $\imath$ and $\jmath$. Also write $2\imath =\imath\cuprow \imath$.
Similarly, we write $\imath\cupcol \jmath$ for
the Young diagram whose multiset of nonzero column lengths equals the union of
those of $\imath$ and $\jmath$.



For unitary groups, we have the following counting result.
\begin{thm}\label{thmu1}
  Suppose that $\star\in \{A, \widetilde A\}$. If there is a Young diagram decomposition
  \be\label{deccou}
    \ckcO=\ckcOg \cuprow 2\ckcOpb
  \ee
 such that all nonzero row lengths of   $\ckcOg$ have good parity and all nonzero row lengths of $\ckcOpb$ have bad parity,   then
  \[
    \sharp(\Unip_{\ckcO}(G))= \sharp \set{\CP\in \mathrm{PAP}_\star(\ckcOg)|(p_\CP+\abs{\ckcOpb}, q_\CP+\abs{\ckcOpb})=(p,q)}.
  \]
 Otherwise $\sharp(\Unip_{\check \CO}(G))=0$.

\end{thm}


In particular, when $\star=\widetilde A$ and $p+q$ is odd, the set $\Unip_{\check \CO}(\widetilde \oU(p,q))$ is empty.


Suppose that $\star\in \{A, \widetilde A\}$ so that $G=\oU(p,q)$ or $\widetilde \oU(p,q)$. By Theorem \ref{thmu1},
the set $\Unip_{\ckcO}(G)$ is empty unless there is a decomposition as in \eqref{deccou} such that
\be\label{decupq}
  p,q \geq \abs{\ckcOb'}.
\ee
Assume this holds, and define two groups
$G'_{\mathrm b}:=\GL_{\abs{\check \CO'_{\mathrm b}}}(\C)$ and
\[
  G_{\mathrm g} =
  \begin{cases}
    \rU(p-\abs{\check \CO'_{\mathrm b}},q-\abs{\check \CO'_{\mathrm b}}),  & \text{if }\star = A;\\
    \tU(p-\abs{\check \CO'_{\mathrm b}},q-\abs{\check \CO'_{\mathrm b}}),  & \text{if }\star = \wtA.
\end{cases}
\]
Then up to conjugation there is a unique parabolic subgroup $P$ of $G$ whose Levi quotient (namely its quotient by the unipotent radical) is naturally isomorphic to   $G'_{\mathrm b}\times G_{\mathrm g}$.
  Note that $\ckcO_{\mathrm g}$ has good parity with respect to $\star$ and $\abs{\ckcO_{\mathrm g}}$.

  Let $\pi_{\check \CO'_{\mathrm b}}$ denote the
unique element in $\Unip_{\check \CO'_{\mathrm b}}(G'_{\mathrm b})$ (see Section \ref{complex} for a review on complex classical groups). Then for
every $\pi_\mathrm g\in \Unip_{\ckcO_{\mathrm g}}(\Gg)$, the normalized smooth parabolic
induced representation (from $P$ to $G$) $\pi_{\ckcOpb}  \ltimes \pi_\mathrm g$ is irreducible by
\cite{Mat96}*{Theorem~3.2.2} and is an element of $\Unip_{\ckcO}(G)$ (\cf
\cite{MR.U}*{Theorem~5.3}).



\begin{thm}\label{thmu2}
 With the assumptions in \eqref{deccou} and \eqref{decupq}, and notation as above, the parabolic induction map
  \begin{equation}
  \label{bij00}
    \begin{array}{rcl}
      \mathrm{Unip}_{\check{\CO}_\mathrm g}(G_\mathrm g)&\longrightarrow &\mathrm{Unip}_{\ckcO}(G),\\
      \pi_{\mathrm g}& \mapsto &  \pi_{\ckcOpb} \ltimes \pi_\mathrm g  \\
    \end{array}
  \end{equation}
  is bijective.
\end{thm}


See Section \ref{secunit} for additional results on special unipotent representations of unitary groups.


\subsection{Orthogonal and symplectic groups: relevant parabolic subgroups}
\label{secrgp0}
In this subsection and the next two subsections,  we assume that
$\star\in \set{ B, C, \wtC,C^*,D, D^*}$.
Then there are Young diagram decompositions
\be\label{decdo}
 \mathbf d_\ckcO=\mathbf d_\mathrm b\cuprow \mathbf d_\mathrm g\quad\textrm{and}\quad \mathbf d_\mathrm b=2 \mathbf d_\mathrm b'
\ee
 such that $\mathbf d_\mathrm b$ has bad parity in the sense that all its nonzero row
lengths have bad parity, and $\mathbf d_\mathrm g$ has good parity in the sense that all its
nonzero row lengths have good parity.
Put
\be\label{nb000}
  n_\mathrm b:=\abs{\mathbf d_\mathrm b'}. %\quad\textrm{and}\quad n_\mathrm g:=n-n_\mathrm b.
\ee

Write $V$ for the standard module of $ \g$, which is either a complex symmetric bilinear space or a complex symplectic space. Recall that  $\CO\subset \g^*$ is the Barbasch-Vogan dual of $\check \CO$. We say that a parabolic subalgebra
 $\p$ of $\g$ is $\check \CO$-relevant if the following conditions are satisfied:
\begin{itemize}
\item
it is the stabilizer of a totally isotropic subspace $V'_{\mathrm b}$ of $V$ of dimension $n_\mathrm b$;
\item
the orbit $\CO$ equals the induction from $\p$ to $\g$ of an orbit in $\overline{\Nil}(\l^*)$, where $\l$ is the Levi quotient of $\p$.
%\item
%if $\star\in\{D,D^*\}$ and $\check \CO$ has bad parity, then
%the number of positive entries in $\lambda_{\check \CO}$ has the same parity as $ \frac{l}{2}$.
%Here we have used the identifications
%\[
 %   \hha=\b/[\b,\b]=\prod_{i=1}^l \gl(V_i/V_{i-1}) =\C^l
%\]
%so that $\lambda_{\check \CO}\in (\frac{1}{2}, \frac{1}{2}, \dots, \frac{1}{2})+\Z^l\subset \C^l=\hha^*$,
%where $0=V_0\subset V_1\subset \cdots V_{l-1} \subset V_l$ is a full flag in $V_l$, and $\b$ is the Borel subalgebra of $\g$ stabilizing this flag.
\end{itemize}
Note that the first condition implies the second one, except for the case when $\star\in \{D, D^*\}$ and $\mathbf d_{\check \CO}$  is nonempty and has bad parity. In all cases,   up to conjugation by $\Ad(\g)$ there exists a unique  parabolic subalgebra of $\g$ that is $\check \CO$-relevant.

We say that a parabolic subgroup of $G$ is $\check \CO$-relevant if its complexified Lie algebra is. If such a parabolic subgroup exists, it is unique up to conjugation by $G$. In this case, the orbit $\check \CO$ is said to be $G$-relevant.


If $\star=D^*$ and  $\mathbf d_{\check \CO}$  is nonempty and has bad parity, then there are precisely two orbits in $\overline \Nil(\check \g)$ that has the same Young diagram as that of $\check \CO$. Between these two orbits, exactly one is $G$-relevant. Excluding this special case, $\check \CO$ is $G$-relevant if and only if
\be\label{existgl}
  \textrm{either $\star\in \{B,D, C^*\}$ and $p,q\geq n_\mathrm b,\quad $ or  $\quad \star\in \{C, \wtC, D^*\}$}.
\ee

%On the other hand, if \eqref{existgl} holds, then up to conjugation there exists a unique $\check \CO$-relevant parabolic subgroup of $G$, except when $\star=D^*$ and $\check \CO$ is incompatible.

When \eqref{existgl} holds,  we put  \be\label{gg00}
  \Gg :=
  \begin{cases}
    \SO(p-n_\mathrm b,q-n_\mathrm b), & \textrm{if $\star\in \set{B,D}$};\\
  %  \SO_{n-2l}(\bC) &\textrm{if $\star\in \set{B^{\bC},D^{\bC}}$},\\
    \rO^{*}(2n-2n_\mathrm b), &\textrm{if $\star = D^{*}$};\\
    \Sp_{2n-2n_\mathrm b}(\bR), &\textrm{if $\star = C$};\\
    \wtSp_{2n-2n_\mathrm b}(\bR), &\textrm{if $\star = \wtC$};\\
  %  \Sp_{2n-2l}(\bC) &\textrm{if $\star \in \set{C^{\bC},\wtC^{\bC}}$},\\
    \Sp(\frac{p-n_\mathrm b}{2},\frac{q-n_\mathrm b}{2}), &\textrm{if $\star = C^{*}$}.\\
  \end{cases}
\ee
Then the Levi quotient of  every $\check \CO$-relevant parabolic subgroup  of $G$ is naturally isomorphic to   $\Gpb\times \Gg $ (or   $(\Gpb\times \Gg)/\{\pm 1\} $ when $\star=\wtC$), where
\begin{equation}\label{Gpb}
  \Gpb := \begin{cases}
    \GL_{n_\mathrm b}(\bR), & \text{if } \star \in \set{B,C,D}; \\
       \widetilde{ \GL}_{n_\mathrm b}(\bR), & \text{if } \star =\wtC; \\
    \GL_{\frac{n_\mathrm b}{2}}(\bH), & \text{if } \star \in \set{C^{*},D^{*}}. \\
  \end{cases}
\end{equation}
Here $ \widetilde{ \GL}_{n_\mathrm b}(\bR)$ is the double cover of $ \GL_{n_\mathrm b}(\bR)$ that fits the following Cartesian diagram of Lie groups:
\begin{equation}\label{wgll}
\begin{CD}
 \widetilde{ \GL}_{n_\mathrm b}(\bR)@>>>  \GL_{n_\mathrm b}(\bR)\\
  @VVV @VV g\mapsto \textrm{ sign of $\det(g)$} V\\
  \{\pm 1, \pm \sqrt{-1}\} @> x\mapsto x^2 >> \{\pm 1\}. \\
\end{CD}
\end{equation}

Unless otherwise mentioned, we will use the corresponding lower case Gothic letter to denote the complexified Lie algebra of a Lie group. For example, $\g'_\mathrm b$ is the complexified Lie algebra of $\Gpb$. Let $\check \g'_\mathrm b$ denote the Langlands dual of $\g'_\mathrm b$, and let $\check \CO'_\mathrm b\in \overline{\Nil}(\check \g'_\mathrm b)$ denote the nilpotent orbit with Young diagram $\mathbf d'_\mathrm b$. Likewise let $\check \g_\mathrm g$ denote the Langlands dual (or the metaplectic Langlands dual when $\star=\wtC$) of $\g_\mathrm g$, and let $\check \CO_\mathrm g\in \overline{\Nil}(\check \g_\mathrm g)$ denote the (unique) nilpotent orbit with Young diagram $\mathbf d_\mathrm g$.

%Note that $\check \g_\mathrm g$ is the Langlands dual (or the metaplectic Langlands dual when $\star=\wtC$) of $\g_\mathrm g$.

 \subsection{Orthogonal and symplectic groups: reduction to good parity}
\label{secrgp0}
Define
 \[
      \Unip_{\ckcOpb}(\widetilde{ \GL}_{n_\mathrm b}(\bR)):=
       \{\pi\in \Irr(\widetilde{ \GL}_{n_\mathrm b}(\bR))\mid \pi \textrm{ is genuine  and annihilated by } I_{\ckcOpb}:= I_{A^\R, \ckcOpb}\}.
       \]
        Here and as before, ``genuine" means that the central subgroup $\{\pm 1\}$ acts through the nontrivial character.  Then we have a bijective map
 \[
    \Unip_{\ckcOpb}(\GL_{n_\mathrm b}(\bR))\rightarrow  \Unip_{\ckcOpb}(\widetilde{ \GL}_{n_\mathrm b}(\bR)), \quad \pi\mapsto \pi\otimes \tilde \chi_{n_\mathrm b},
 \]
 where $\tilde \chi_{n_\mathrm b}$ is the character given by the left vertical arrow of \eqref{wgll}.

\begin{thm}\label{reduction}
 If  $G$ has a $\check \CO$-relevant parabolic subgroup $P$, then the normalized smooth parabolic induction from $P$ to $G$ yields
   a bijection
   \[
 % \begin{equation}\label{eq:IND}
    \begin{array}{rccc}
 &\Unip_{\ckcO'_{\mathrm b}}( G'_{\mathrm b}) \times   \Unip_{\ckcO_{\mathrm g}}( G_{\mathrm g})  &         \longrightarrow &\Unip_{\ckcO }(G), \\
                &   (\pi',\pi_\mathrm g) & \mapsto & \pi'\ltimes \pi_\mathrm g.
    \end{array}
 % \end{equation}
 \]
  Otherwise,
  \[
    \Unip_{\ckcO}(G)=\emptyset.
  \]
\end{thm}


By \Cref{reduction}, we have the more specific results on counting as follows.
\begin{enumerate}[label=(\alph*)]
  \item Assume that $\star\in \{B,D\}$ so that $G=\SO(p,q)$. Then
        \[
        \sharp(\Unip_{\check \CO}(G))=
        \begin{cases}
          \sharp(\Unip_{\check \CO_{\mathrm g}}(G_{\mathrm g}))\times \sharp(\Unip_{\check \CO'_{\mathrm b}}(\GL_{n_\mathrm b}(\R)) ), &\hbox{if $p,q\geq n_\mathrm b$}; \smallskip\\
          0, &\hbox{otherwise.}
        \end{cases}
        \]
  \item Assume that $\star=C^*$ so that $G=\Sp(\frac{p}{2},\frac{q}{2})$. Then
        \[
        \sharp(\Unip_{\check \CO}(G))=
        \begin{cases}
          \sharp(\Unip_{\check \CO_{\mathrm g}}(G_{\mathrm g} )), &\hbox{if $p,q\geq n_\mathrm b$}; \smallskip\\
          0, &\hbox{otherwise.}
        \end{cases}
        \]

  \item Assume that $\star\in \{C,\widetilde C\}$ so that $G=\Sp_{2n}(\R)$ or
        $\widetilde \Sp_{2n}(\R)$. Then
        \[
        \sharp(\Unip_{\check \CO}(G))= \sharp(\Unip_{\check \CO_{\mathrm g}}(G_{\mathrm g}))\times \sharp(\Unip_{\check \CO'_{\mathrm b}}(\GL_{n_\mathrm b}(\R)) ). \]
  \item Assume that $\star =D^*$ so that $G=\oO^*(2n)$. Then
        \[
          \sharp(\Unip_{\check \CO}(G))=
          \begin{cases}
          0,&\quad \textrm{if $\check \CO$  is not $G$-relevant;}\\
          \sharp(\Unip_{\check \CO_{\mathrm g}}(G_{\mathrm g})),&\quad \textrm{otherwise}.
          \end{cases}
        \]
\end{enumerate}


 \subsection{Orthogonal and symplectic groups: the case of good parity}\label{secorgp0}
 We now assume that $\check \CO$ has good parity, namely
 $\check \CO=\check \CO_{\mathrm g}$. By Theorem \ref{reduction}, the counting
 problem in general is reduced to this case.



 \delete{
   \begin{defn}
     A $\star$-pair is a pair $(i,i+1)$ of consecutive positive integers such
     that
     \[
       \left\{
         \begin{array}{ll}
           i\textrm{ is odd}, \quad &\textrm{if $\star\in\{C, \widetilde{C}, C^*, C^\C, \widetilde C^\C\}$};  \\
           i \textrm{ is even}, \quad &\textrm{if $\star\in\{B, D, D^*, B^\C, D^\C\}$}. \\
         \end{array}
       \right.
     \]
     A $\star$-pair $(i,i+1)$ is said to be primitive in $\check \CO$ if
     $\mathbf r_i(\check \CO)-\mathbf r_{i+1}(\check \CO)$ is positive and even.
     Denote $\mathrm{PP}_\star(\check \CO)$ the set of all $\star$-pairs that
     are primitive in $\check \CO$.
   \end{defn}
 }



\begin{defn}\label{defn:PP}
  A $\star$-pair is a pair $(i,i+1)$ of consecutive positive integers such that
  \[
    \left\{
      \begin{array}{ll}
        i\textrm{ is odd}, \quad &\textrm{if $\star\in\{C, \widetilde{C}, C^*\}$};  \\
        i \textrm{ is even}, \quad &\textrm{if $\star\in\{B, D, D^*\}$}. \\
      \end{array}
    \right.
  \]
  A $\star$-pair $(i,i+1)$ is said to be
  \begin{itemize}
    \item vacant in $\check \CO$, if
          $\mathbf r_i(\check \CO)=\mathbf r_{i+1}(\check \CO)=0$;
    \item balanced in $\check \CO$, if
          $\mathbf r_i(\check \CO)=\mathbf r_{i+1}(\check \CO)>0$;
    \item tailed in $\check \CO$, if
          $\mathbf r_i(\check \CO)-\mathbf r_{i+1}(\check \CO)$ is positive and
          odd;
    \item primitive in $\check \CO$, if
          $\mathbf r_i(\check \CO)-\mathbf r_{i+1}(\check \CO)$ is positive and
          even.
  \end{itemize}
  Denote $\CPP_\star(\check \CO)$ the set of all $\star$-pairs that are
  primitive in $\check \CO$.
\end{defn}

%We continue with the counting problem of $\Unip_{\check \CO}(G)$, when $\check \CO$ has $\star$-good parity.

\begin{remark} When $\star\neq \wtC$, %\[\bar{\mathrm A}(\ckcO):=
the power set of $\CPP_\star(\check \CO)$ gives another description of Lusztig's canonical
  quotient attached to $\ckcO$. The set $\CPP_{\star}(\ckcO)$ appears implicitly in
\cite{So}*{Section~5}.
\end{remark}


We attach to $\check \CO$ a pair of Young diagrams
\be\label{ijo}
  (\imath_{\check \CO}, \jmath_{\check \CO}):=(\imath_\star(\check \CO), \jmath_\star(\check \CO)),
\ee
as follows.

\medskip

\noindent {\bf The case when $\star=B$.} In this case,
\[
  \mathbf c_{1}(\jmath_{\check \CO})=\frac{\mathbf r_1(\check \CO)}{2},
\]
and for all $i\geq 1$,
\[
  \left (\mathbf c_{i}(\imath_{\check \CO}), \mathbf c_{i+1}(\jmath_{\check \CO})\right )= \left (\frac{\mathbf r_{2i}(\check \CO)}{2}, \frac{\mathbf r_{2i+1}(\check \CO)}{2}\right ).
\]

\medskip

\noindent {\bf The case when $\star=\widetilde C$.} In
this case, for all $i\geq 1$,
\[
  (\mathbf c_{i}(\imath_{\check \CO}), \mathbf c_{i}(\jmath_{\check \CO}))= \left (\frac{\mathbf r_{2i-1}(\check \CO)}{2}, \frac{\mathbf r_{2i}(\check \CO)}{2}\right).
\]

\medskip

\noindent {\bf The case when $\star=\{ C,C^*\}$.} In this case, for all
$i\geq 1$,
\[
  (\mathbf c_{i}(\jmath_{\check \CO}), \mathbf c_{i}(\imath_{\check \CO}))= \left\{
    \begin{array}{ll}
      (0,  0), &\hbox{if $(2i-1, 2i)$ is vacant  in $\check \CO$};\smallskip\\
      (\frac{\mathbf r_{2i-1}(\check \CO)-1}{2},  0), & \hbox{if $(2i-1, 2i)$ is tailed in $\check \CO$};\smallskip\\
      (\frac{\mathbf r_{2i-1}(\check \CO)-1}{2},  \frac{\mathbf r_{2i}(\check \CO)+1}{2}), &\hbox{otherwise}.\\
    \end{array}
  \right.
\]
\medskip

\noindent {\bf The case when $\star\in \{D,D^*\}$.} In this case,
\[
  \mathbf c_{1}(\imath_{\check \CO})= \left\{
    \begin{array}{ll}
      0,  &\hbox{if $\mathbf r_1(\check \CO)=0$}; \smallskip\\
      \frac{\mathbf r_1(\check \CO)+1}{2},   &\hbox{if $\mathbf r_1(\check \CO)>0$},\\
    \end{array}
  \right.
\]
and for all $i\geq 1$,
\[
  (\mathbf c_{i}(\jmath_{\check \CO}), \mathbf c_{i+1}(\imath_{\check \CO}))= \left\{
    \begin{array}{ll}
      (0,  0), &\hbox{if $(2i, 2i+1)$ is vacant in $\check \CO$};\smallskip\\
      \left  (\frac{\mathbf r_{2i}(\check \CO)-1}{2},  0\right ), & \hbox{if $(2i, 2i+1)$ is tailed in $\check \CO$};\smallskip\\
      \left  (\frac{\mathbf r_{2i}(\check \CO)-1}{2},  \frac{\mathbf r_{2i+1}(\check \CO)+1}{2}\right ), &\hbox{otherwise}.\\
    \end{array}
  \right.
\]




\begin{eg} Suppose that $\star=C$, and $\check \CO$ is the following Young
  diagram which has good parity.
  \begin{equation*}%\label{eq:sp-nsp.C}
    \tytb{\ \ \ \ \  , \ \ \  , \ \ \ , \ \ \  , \ \ \ , \  ,\  }
  \end{equation*}
  Then
  \[
    \CPP_\star(\check \CO)=\{(1,2), (5,6)\}
  \]
  and
  \[
    (\imath_{\check \CO}, \jmath_{\check \CO})= \tytb{\ \ \ ,\ \ } \times \tytb{\ \ \ , \ }.
  \]


\end{eg}



\delete{
  \begin{eg} Suppose that $\star=C$, and $\check \CO$ is the following Young
    diagram which has $\star$-good parity.
    \begin{equation*}%\label{eq:sp-nsp.C}
      \tytb{\ \ \ \ \  , \ \ \  , \ \ \ , \ \ \  , \ \ \ , \  ,\  }
    \end{equation*}
    Then
    \[
      \mathrm{PP}_\star(\check \CO)=\{(1,2), (5,6)\}.
    \]
    and $(\imath_\star(\check \CO, \wp), \jmath_\star(\check \CO,
    \wp))$ %\in \mathrm{BP}_\star(\check \CO)$
    has the following form.

    \begin{equation*}%\label{eq:sp-nsp.C}
      \begin{array}{rclcrcl}
        \wp=\emptyset & : & \tytb{\ \ \ ,\ \  } \times \tytb{\ \ \ , \  }  & \qquad \quad &  \wp=\{(1,2)\}& : & \tytb{\ \ \  , \ \ , \   } \times \tytb{\ \ \  } \medskip \medskip \medskip \\
        \wp=\{(5,6)\} & : & \tytb{\ \ \ ,\ \ \ } \times \tytb{\ \ , \   }  & \qquad \quad &  \wp=\{(1,2), (5,6)\}  & : & \tytb{\ \ \  , \ \ \ ,  \ } \times \tytb{\ \   } \\
      \end{array}
    \end{equation*}

\end{eg}
}

Here and henceforth, when no confusion is possible, we write
$\alpha\times \beta$ for a pair $(\alpha, \beta)$. We will also write
$\alpha\times \beta\times \gamma$ for a triple $(\alpha, \beta, \gamma)$.


We introduce two more symbols $B^+$ and $B^-$, and make the following
definition.
\begin{defn} \label{def:pbp1}
  A painted bipartition is a triple
  $\uptau=(\imath, \CP)\times (\jmath, \cQ)\times \alpha$, where $(\imath, \CP)$
  and $ (\jmath, \mathcal Q)$ are painted Young diagrams, and
  $\alpha\in \{B^+,B^-, C,D,\widetilde {C}, C^*, D^*\}$, subject to the
  following conditions:
  \begin{itemize}
          \delete{\item $(\imath, \jmath)\in \mathrm{BP}_\alpha$ if
          $\alpha\notin\{B^+,B^-\}$, and $(\imath, \jmath)\in \mathrm{BP}_{B}$
          if $\alpha\in\{B^+,B^-\}$;}
 \item $\CP$ and $\mathcal Q$ have the identical set of boxes painted with $\bullet$;
    %\item $\CP^{-1}(\bullet)=\mathcal Q^{-1}(\bullet)$;
    \item the symbols of $\CP$ are in
          \[
          \left\{
          \begin{array}{ll}
            \{\bullet, c\}, &\hbox{if $\alpha=B^+$ or $B^-$}; \smallskip\\
            \{\bullet,  r, c,d\}, &\hbox{if $\alpha=C$}; \smallskip\\
            \{\bullet, s, r, c,d\}, &\hbox{if $\alpha=D$}; \smallskip\\
            \{\bullet, s, c\}, &\hbox{if $\alpha=\widetilde{ C}$}; \smallskip \\
            \{\bullet\}, &\hbox{if $\alpha=C^*$}; \smallskip \\
            \{\bullet, s\}, &\hbox{if $\alpha=D^*$},\\
          \end{array}
          \right.
          \]
    \item the symbols of $\mathcal Q$ are in           \[
          \left\{
          \begin{array}{ll}
            \{\bullet, s, r, d\}, &\hbox{if $\alpha=B^+$ or $B^-$}; \smallskip\\
            \{\bullet, s\}, &\hbox{if $\alpha=C$}; \smallskip\\
            \{\bullet\}, &\hbox{if $\alpha=D$}; \smallskip\\
            \{\bullet, r, d\}, &\hbox{if $\alpha=\widetilde{ C}$}; \smallskip\\
            \{\bullet, s,r\}, &\hbox{if $\alpha=C^*$}; \smallskip \\
            \{\bullet, r\}, &\hbox{if $\alpha=D^*$}.
          \end{array}
          \right.
          \]

  \end{itemize}
\end{defn}

% \begin{remark}
%   The set of painted bipartition counts the multiplicities of an irreducible
%   representation of $W_{r_{\fgg}}$ occurs in the coherent continuation
%   representation at the infinitesimal character of the trivial representation.
%   For the relationship between painted bipartitions and the coherent
%   continuation representations of Harish-Chandra modules, see \cite{Mc}.
% \end{remark}

For any painted bipartition $\uptau$ as in Definition \ref{def:pbp1}, we write
\[
  \imath_\uptau:=\imath,\ \cP_\uptau:=\cP,\ \jmath_\uptau:=\jmath,\ \cQ_\tau:=\cQ,\ \alpha_\uptau:=\alpha,\ \abs{\uptau}:=\abs{\imath}+\abs{\jmath},
\]
and
\[
  \star_\uptau:= \left\{
    \begin{array}{ll}
      B, &\hbox{if $\alpha=B^+$ or $B^-$}; \smallskip\\
      \alpha, & \hbox{otherwise}.           \end{array}
  \right.
\]
% Its leading column is then defined to be the first column of $(\jmath, \CQ)$
% when $\star_\tau\in \{B, C,C^*\}$, and the first column of $(\imath, \CP)$
% when $\star_\tau\in \{\widetilde C, D, D^*\}$.

We further define a pair $\Sign(\uptau):=(p_{\uptau}, q_{\uptau})$ of natural numbers given by the
following recipe:
\begin{itemize}
  \item If $\star_\uptau\in \{B, D, C^*\}$, then $(p_\uptau, q_\uptau)$ is given by
        counting the various symbols appearing in $(\imath, \CP)$,
        $(\jmath, \cQ)$ and $\{\alpha\}$ :
        \begin{equation}\label{ptqt}
          \left\{
            \begin{array}{l}
              p_\uptau :=( \# \bullet)+ 2 (\# r) +(\# c )+ (\# d) + (\# B^+);\smallskip\\
              q_\uptau :=( \# \bullet)+ 2 (\# s) + (\# c) + (\# d) + (\# B^-).\\
            \end{array}
          \right.
        \end{equation}
        Here
        \[
        \#\bullet:=\#(\cP^{-1}(\bullet))+\#(\cQ^{-1}(\bullet))
        %\qquad (\textrm{$\#$        indicates the cardinality of a finite set}),
        \]
        and the other terms are similarly defined.
  \item If $\star_\uptau\in \{C, \widetilde C, D^*\}$, then
        $p_\uptau:=q_\uptau:=\abs{\uptau}$.
\end{itemize}
\smallskip

We also define a classical group
\begin{equation*}%\label{def:Gt}
  G_\uptau:=
  \begin{cases}
    \SO(p_\uptau, q_\uptau), &\hbox{if $\star_\uptau=B$ or $D$}; \smallskip\\
    \Sp_{2\abs{\uptau}}(\R), &\hbox{if $\star_\uptau=C$}; \smallskip\\
    \widetilde{\Sp}_{2\abs{\uptau}}(\R), &\hbox{if $\star_\uptau=\widetilde{ C}$}; \smallskip \\
    \Sp(\frac{p_\uptau}{2}, \frac{q_\uptau}{2}), &\hbox{if $\star_\uptau=C^*$}; \smallskip \\
    \oO^*(2\abs{\uptau}), &\hbox{if $\star_\uptau=D^*$}.\\
  \end{cases}
\end{equation*}


Define
\begin{equation}\label{defpbp2222}
  \PBP_\star(\check \CO) :=\set{ \uptau\textrm{ is a painted
      bipartition} \mid \star_\uptau = \star, \text{ and
    } (\imath_\uptau,\jmath_\uptau) = (\imath_{\check \CO}, \jmath_{\check \CO})},
\end{equation}
and
\begin{equation*} %\label{defpbp3}
    \PBP_{G}(\ckcO) :=\set{\uptau\in \PBP_{\star}(\ckcO)| G_{\uptau} = G}.
\end{equation*}
Here ``$G_{\uptau} = G$" amounts to saying that $(p_\uptau, q_\uptau)=(p,q)$ if $\star\in \{B, D, C^*\}$.
\delete{
  \[
    \begin{array}{rl}
      \mathrm{PBP}_\star(\check \CO):=\{ &
                                           \tau\textrm{ is a painted bipartition}  \mid    \star_\tau = \star,
                                           \text{ and } \\  & (\imath_\tau,\jmath_\tau) = (\imath_{\check \CO}, \jmath_{\check \CO})\}.
    \end{array}
  \]
}


\begin{eg} Suppose that $\star=B$ and
  \[
    \check \CO =\tytb{\ \ \ \ \ \ , \ \ \ \ \ \ , \ \ , \ \ , \ \ }.
  \]
  Then
  \[
    \uptau:= \tytb{\bullet \bullet ,\bullet , c } \times \tytb{\bullet \bullet d ,\bullet , d }\times B^+\in \mathrm{PBP}_{\star}(\check \CO),
  \]
  and
  \[
    G_\uptau=\SO(10,9).
  \]
\end{eg}


We now state our final result on the counting of special unipotent representations.


\begin{thm}\label{countup}
  Assume that $\star\in \{B, C,D,\widetilde {C}, C^*, D^*\}$, and $\check \CO$ has good parity. Then
 \[
   \sharp(\Unip_{\check \CO}(G)) =
    \left\{
    \begin{array}{ll}
       \sharp (\PBP_{G}(\ckcO)),  & \hbox{if $\star\in \{C^*,D^*\}$}; \smallskip\\
       2^{\sharp(\CPPs(\check \CO))} \cdot \sharp (\PBP_{G}(\ckcO)),  &\hbox{if $\star\in \{B, C,D,\widetilde {C}\}$}.
    \end{array}
  \right.
  \]
\end{thm}

In \cite{BMSZ2}, the authors will construct all representations in
$\Unip_{\check \CO}(G)$ by the method of theta lifting,
when $\check \CO$ has good parity. See \cite[Theorem 4.1]{BMSZ2}.

\begin{eg} Suppose that $\star=C$, $G=\Sp_4(\R)$,  and
  \[
    \check \CO =\tytb{\ \ \ , \  , \ }.
  \]
  Then $\mathrm{PP}_\star(\check \CO)=\{(1,2)\}$, and the set $\PBP_{G}(\ckcO)$ has $4$ elements in total:
  \[
\tytb{\bullet} \times \tytb{\bullet }\times C, \ \ \  \tytb{r} \times \tytb{s}\times C , \ \ \  \tytb{c} \times \tytb{s}\times C , \ \ \  \tytb{d} \times \tytb{s}\times C.
  \]
 Thus there are precisely $8$ special unipotent representations of $G$ attached to $\check \CO$.
\end{eg}

\trivial[h]{
\begin{thm}\label{countup}
  Assume that $\star\in \{B, C,D,\widetilde {C}, C^*, D^*\}$, and $\check \CO$ has $\star$-good parity. Then
  \[
    \sharp(\Unip_{\ckcO}(G))\leq 2^{\sharp(\CPP_\star(\check \CO))} \cdot \sharp (\PBP_{\mathrm g}(\ckcO)).
  \]
\end{thm}

In \cite{BMSZ2}, the authors have constructed $2^{\sharp(\CPP_\star(\check \CO))} \cdot \sharp (\PBP_{\mathrm g}(\ckcO))$ number of representations in
$\Unip_{\check \CO}(G)$, when $\check \CO$ has $\star$-good parity. See \cite[Theorem 4.1]{BMSZ2}. Thus the equality holds in \Cref{countup}.

\medskip}

%\begin{remark}

\subsection{The case of complex classical groups}\label{complex}
Special unipotent representations of complex classical groups are all  well-understood and known to be unitarizable (\cite{BVUni}, \cite{B89}). We briefly review their counting and constructions in what follows. As the methods of this paper and \cite{BMSZ2} work for complex classical groups as well, we will present the results in the complex case parallel to those of this paper and \cite{BMSZ2}. For this subsection, we introduce five more labels $A^\C, B^\C,D^\C, C^\C$, and $\widetilde C^\C$, and let $\star$ be one of them. Let $G$ be a complex classical group of type $\star$, namely
\[
G=\GL_n(\C),\quad \SO_{2n+1}(\C),\quad \SO_{2n}(\C),\quad \Sp_{2n}(\C), \quad \textrm{or}\quad \Sp_{2n}(\C)\qquad (n\in \BN),
\]
respectively.
Let $\g_0$ denote the Lie algebra of $G$, which is  a complex Lie algebra.
The Langlands dual (or metaplectic Langlands dual when $\star=\widetilde C^\C$) $\check \g_0$ of $\g_0$ is respectively defined to be
\[
\g\l_n(\C),\quad \s\p_{2n}(\C), \quad \o_{2n}(\C), \quad \o_{2n+1}(\C), \quad \textrm{or}\quad  \s\p_{2n}(\C).
\]
 Let $\check \CO\in \overline{\Nil}(\check \g_0)$. As in the real case we have a maximal ideal $I_{\check \CO}:=I_{\star, \check \CO}$ of $\CU(\g_0)$.

 Write $\overline \g_0$ for the complex Lie algebra equipped with a conjugate linear isomorphism $\bar{\phantom a} :\g_0\rightarrow \overline{\g_0}$. The latter induces a  conjugate linear isomorphism $\bar{\phantom a} :\CU(\g_0)\rightarrow \CU( \overline{\g_0})$. Note that $\g_0\times \overline{\g_0}$ equals the complexified Lie algebra $\g$ of $G$.  Define the set of special unipotent representations of $G$
 attached to $\ckcO$ by
 \[
     \Unip_{\ckcO}(G):=  \Unip_{\star, \ckcO}(G)
     :=
       \{\pi\in \Irr(G)\mid \pi \textrm{ is annihilated by } I_{\check \CO}\otimes \CU(\overline{\g_0}) + \CU(\g_0)\otimes \overline{I_{\check \CO}}\, \}.
       \]

 If $\star=A^\C$ so that $G=\GL_n(\C)$, then $\Unip_{\ckcO}(G)$ is a singleton whose unique element is given by the normalized smooth parabolic induction
 $\Ind_{P}^{G} 1_P$, where $P$ is the standard parabolic subgroup whose Levi component equals
 \[
 \GL_{\mathbf r_1(\check \CO)}(\C)\times \GL_{\mathbf r_2(\check \CO)}(\C)\times \dots \times \GL_{\mathbf r_{\mathbf c_1(\check \CO)}(\check \CO)}(\C),
 \]
 and $1_P$ denotes the trivial representation of $P$.
 %See \cite{V.GL}.

Now suppose that $\star\in \{B^\C,D^\C, C^\C, \widetilde C^\C\}$. Write
\[
 \mathbf d_\ckcO=\mathbf d_\mathrm b\cuprow \mathbf d_\mathrm g\quad\textrm{and}\quad \mathbf d_\mathrm b=2 \mathbf d_\mathrm b'
\]
as in \eqref{decdo}, and put $n_\mathrm b:=\abs{\mathbf d_\mathrm b'}$ as before. %\quad\textrm{and}\quad n_\mathrm g:=n-n_\mathrm b.
Let $\p_0$ be a parabolic subalgebra of $\g_0$ that is $\check \CO$-relevant (defined in \Cref{secrgp0}). Let $P$ be the parabolic subgroup of $G$ with Lie algebra $\p_0$. Then the Levi quotient of $P$  is naturally isomorphic to $\Gpb\times \Gg$, where $\Gpb=\GL_{n_\mathrm b}(\C)$ and
\[
  \Gg :=
  \begin{cases}
    \SO_{2n-2n_\mathrm b+1}(\C), & \textrm{if $\star=B^\C$};\\
    \SO_{2n-2n_\mathrm b}(\C), & \textrm{if $\star=D^\C$};\\
    \Sp_{2n-2n_\mathrm b}(\C), &\textrm{if $\star \in\{ C^\C, \widetilde C^\C \}$}.
      \end{cases}
\]

Define the set $\CPP_\star(\ckcOg)$ as in the real case. Then by the work of
Barbasch-Vogan (\cite[Corollary 5.29]{BVUni}, integral case) and Moeglin-Renard
(\cite[Theorem~6.12 and Theorem~10.1]{MR.C}, general case), we have that
   \[
    \sharp(\Unip_{\check \CO}(G))=\sharp(\Unip_{\ckcOg}(\Gg))=2^{\sharp(\CPP_\star(\ckcOg))}.
  \]
   As in the real case, every representation in $\Unip_{\check \CO}(G)$ is
   obtained through irreducible parabolic induction from $P$ to $G$ via those of
   $ \Unip_{\ckcO'_{\mathrm b}}( G'_{\mathrm b})\times \Unip_{\ckcO_{\mathrm g}}( G_{\mathrm g}) $
   (\cf Theorem \ref{reduction}), and every representation in
   $\Unip_{\ckcOg}(\Gg)$ is obtained via iterated theta lifting (see
   \cite[Theorem 3.5.1]{B17}, \cite{Mo17} and \cite{BMSZ2}). The method of \cite{BMSZ2} also shows that all representations in $\Unip_{\ckcO}( G)$ are unitarizable.



\section{Generalities on coherent families of highest weight modules}\label{sec:HWM}


%\section{Generalities on coherent continuation representations}

%Most of the results of this section and the next one are known to experts.% and we will thus be brief.

We retain the notation of Section \ref{secnot}.
Write \[
\Delta^+\subset \Delta\subset \hha^*\quad \textrm{and}\quad \check \Delta^+\subset \check \Delta\subset \hha
\]
for the positive root system, the root system, the positive coroot system, and the coroot system, respectively, for the reductive complex Lie algebra $\g$.
Write $Q_\g$ and $ Q^\g$ for the root lattice and weight group of $\g$, respectively. More precisely, $Q_\g$ is the subgroup of $\hha^*$   spanned by $\Delta$, and
\[
Q^\g:=\{\nu\in \hha^*\mid \langle \nu, \check \alpha\rangle \in \Z\ \textrm{ for all }\check \alpha\in \check \Delta\}.
\]


\subsection{Coherent continuation representations}\label{subsec:coherent}

 Throughout this article we take $\C$ as the coefficient ring to define  Grothendieck groups. When no confusion is possible, for every object $O$ in an abelian category, we  still use the same symbol to indicate the Grothendieck group element represented by the object $O$.




 Let $\Lambda\subset \hha^*$ be a $Q$-coset, where $Q$ is a $W$-stable subgroup of $Q^\g$ containing $Q_\g$ (which is determined by $\Lambda$).
The stabilizer of $\Lambda$ in $W$ is denoted by $W_\Lambda$. Let $\mathrm{Rep}(\g, Q)$ denote the category of all finite-dimensional
representations of $\g$ whose weights
%(which are obviously defined
(viewed
as elements of $Q^\g\subset \hha^*$) are contained in $Q$. Write $\mathcal R(\g, Q)$ for the Grothendieck group of this category, which is
 a commutative $\bC$-algebra under the tensor
product of representations.

 Given  a $\mathcal R(\g, Q)$-module $\CK$, a  $\Lambda$-family in $\CK$ is a family
   $\{\CK_\nu\}_{\nu\in \Lambda}$ of subspaces of $\CK$ such that
\begin{itemize}
\item
  $\CK_{w \nu}=\CK_\nu\ $  for all $w\in W_\Lambda$ and $\nu\in \Lambda$;
  \item  for all representations $F$ in  $\mathrm{Rep}(\g, Q)$ and all $\nu\in \Lambda$,
  \[
   F\cdot \CK_\nu\subset \sum_{\mu\in \hha^* \textrm{ is a weight of $F$} } \CK_{\nu+\mu}.
  \]
 \end{itemize}
%For example $\{\CK\}_{\nu\in \Lambda}$ is a  $\Lambda$-family in $\CK$, to be called the full $\Lambda$-family.


\begin{defn}\label{defcoh00}
  Let $\CK$ be  a $\mathcal R(\g, Q)$-module  with a $\Lambda$-family $\{\CK_\nu\}_{\nu\in \Lambda}$ in it.
  A $\CK$-valued coherent family on
  $\Lambda$ is a map
  \[
    \Psi: \Lambda\rightarrow \CK%, \qquad \lambda\mapsto \Phi_\lambda
  \]
  satisfying the following two conditions:
  \begin{itemize}
    \item for all $\nu\in \Lambda$, $\Psi(\nu)\in \CK_\nu$;
    \item for all representations $F$ in $\mathrm{Rep}(\g, Q)$
          and all $\nu\in \Lambda$,
          \[
          F \cdot (\Psi(\nu)) = \sum_{\mu} \Psi(\nu+\mu),
          \]
          where $\mu$ runs over all weights of $F$, counted with multiplicities.%  and $F$ is viewed as an element of $\mathcal R(\g)$.
  \end{itemize}
\end{defn}


In the notation of \Cref{defcoh00}, let $\Coh_{\Lambda}(\CK)$ denote the
vector space of all $\mathcal K$-valued coherent families on $\Lambda$. It is a
representation of $W_{\Lambda}$ under the action
\[
  (w \cdot \Psi)(\nu) = \Psi(w^{-1} \nu), \qquad \textrm{for all
  }\ w\in W_\Lambda, \ \Psi\in \Coh_{\Lambda}(\CK), \   \nu\in \Lambda.
\]
This is called a coherent continuation representation. When specifying a coherent continuation representation $\Coh_{\Lambda}(\CK)$, we will often explicitly describe $\CK$ as a Grothendieck group, while the $\mathcal R(\g, Q)$-module structure and the $\Lambda$-family  $\{\CK_\nu\}_{\nu\in \Lambda}$ are the ones which are clear from the context (which are often specified by the infinitesimal characters).

The assignment $\Coh_{\Lambda}(\CK)$ is functorial in $\CK$ in the following sense: suppose that $\CK'$ is another  $\mathcal R(\g, Q)$-module  with a $\Lambda$-family $\{\CK'_\nu\}_{\nu\in \Lambda}$ in it, and $\eta: \CK\rightarrow \CK'$ is a $\mathcal R(\g, Q)$-homomorphism such that $\eta(\CK_\nu)\subset \CK'_\nu$ for all $\nu\in \Lambda$, then
\begin{equation}\label{eq:eta}
 \eta_*: \Coh_{\Lambda}(\CK)\rightarrow \Coh_{\Lambda}(\CK'), \quad \Psi\mapsto \eta\circ \Psi
\end{equation}
is a well-defined $W_\Lambda$-equivariant linear map.


\newcommand{\Rep}{\mathrm{Rep}}




\subsection{Coherent continuation representations for highest weight modules}



Let $\b$ be a  Borel subalgebra of $\g$, and let $\Rep(\g,\b)$ denote the category of finitely generated $\g$-modules that are unions of finite-dimensional $\b$-submodules.
For each $\nu\in \hha^*$, let  $\Rep_\nu(\g,\b)$ denote the  full subcategory of $\Rep(\g,\b)$ consisting of modules that have generalized infinitesimal character $\nu$ (by definition, a $\g$-module has generalized infinitesimal character $\nu$ if every vector in it is annihilated by $(\ker(\chi_\nu))^k$ for some $k\in \BN^+$).
Write $\CK(\g,\b)$ for the Grothendieck group of $\Rep(\g,\b)$, and similarly define the Grothendieck groups $\CK_{\nu}(\g,\b)$.
The  Grothendieck group $\CK(\g,\b)$ is a $\mathcal R(\g,Q)$-module under the tensor products. Using the $\Lambda$-family   $\{\CK_\nu(\g,\b)\}_{\nu\in \Lambda}$, we form the coherent continuation representation $\Coh_{\Lambda}( \CK(\g,\b))$.

 %With these extra structures, $\CK(\g,\b)$ is  a basal $\mathcal R(\g, Q)$-module  with $\Lambda$-family.

%Likewise $\CK_\sfS(\g,\b)$ is also a basal $\mathcal R(\g, Q)$-module  with $\Lambda$-family.




Write $\rho\in \hha^*$ for the half sum of positive roots.
For each $\nu\in \hha^*$, define the Verma module
\[
  \mathrm M(\nu):=\mathrm M(\g,\b,\nu):=\CU(\g)\otimes_{\CU(\b)} \C_{\nu-\rho},
\]
where  $\C_{\nu-\rho}$ is the one-dimensional $\hha$-module corresponding to the character $\nu-\rho\in \hha^*$, and every $\hha$-module is viewed an a $\b$-module via the canonical map $\b\rightarrow \hha$. Write
$\oL(\lambda):=\oL(\g,\b,\lambda)$ for the unique irreducible quotient of $ \mathrm M(\lambda)$.

Recall that an element $\nu\in \hha^*$ is said to be dominant if
\be\label{dominant}
    \la \nu, \check \alpha\ra\notin -\bN^+ \qquad\textrm{for all $\check \alpha\in \check \Delta^+$},
  \ee
  and is said to be regular if
  \[
    \la \nu, \check \alpha\ra\neq 0 \qquad\textrm{for all $\check \alpha\in \check \Delta$}.
  \]



For every $w\in W$, define a map
\[
\begin{array}{rcl}
  \Psi_{w}: \Lambda&\rightarrow  &\CK(\g,\b), \\
   \nu&\mapsto& \mathrm M(w \nu).
   \end{array}
\]
Then $\Psi_w\in \Coh_{\Lambda}( \CK(\g,\b))$, and
\be\label{basis}
\textrm{ $\{\Psi_w\}_{w\in W}$ is a basis of $\Coh_{\Lambda}( \CK(\g,\b))$. }
\ee
There is a unique element $\overline \Psi_w\in \Coh_{\Lambda}( \CK(\g,\b))$ such that
\be\label{psibarw}
  \overline \Psi_w(\nu)=\oL(w \nu)\quad \textrm{for all regular dominant element $\nu\in \Lambda$}.
\ee
Then $\{\overline \Psi_w\mid w\in W\}$ is also a
basis of the coherent continuation representation $\Coh_{\Lambda}( \CK(\g,\b))$.
See \cite[Section 7.10]{H}.

Let $W$ act on  $\CK(\g,\b)$ as $\mathcal R(\g, Q)$-module automorphisms by
\[
  w\cdot (\mathrm M(\nu))=\mathrm M(w  \nu)\quad \textrm{for all }\nu\in \hha^*.
\]
By the functority \eqref{eq:eta},  this yields an action of $W$ on
$\Coh_{\Lambda}( \CK(\g,\b))$ as
automorphisms of $W_\Lambda$-representations. Note that
the resulting action of $W\times W_\Lambda$ on $\Coh_{\Lambda}( \CK(\g,\b))$ is explicitly given by
 \begin{equation}\label{eq:exp}
   (w_1, w_2)\cdot  \Psi_{w}=\Psi_{w_1 w w_2^{-1}}\quad\textrm{for all $w_1\in W$, $w_2\in W_\Lambda$,  $w\in W$.}
 \end{equation}


Let $\Lambda^\g\subset \hha^*$ denote the $Q^\g$-coset containing $\Lambda$, and let  $\Lambda_\g\subset \Lambda$ be a $Q_\g$-coset.
Put
\[
  \Delta(\Lambda):=\{\alpha\in \Delta\mid \la \check \alpha, \nu\ra\in \Z \textrm{ for some (and all) }\nu\in \Lambda\}.
\]
Here and henceforth,  $\check \alpha\in \hha$ denotes the coroot corresponding to $\alpha$.
This is a root system with the corresponding coroots
\[
  \check \Delta(\Lambda):=\{\check \alpha\in \check \Delta \mid \la \check \alpha, \nu\ra\in \Z \textrm{ for some (and all) }\nu\in \Lambda\}.
\]
Let $W(\Lambda)\subset W$ denote the Weyl group of the root system $\Delta(\Lambda)$, to be called the integral Weyl group (attached to $\Lambda$).  Then
\[
  W(\Lambda_\g)=W(\Lambda)=W(\Lambda^\g)=W_{\Lambda_\g}\subset W_{\Lambda}\subset  W_{\Lambda^\g}.
\]
\trivial[h]{
This is because $\inn{\Delta(\fgg)}{Q^\fgg}\in \bZ$.
}


To understand the coherent continuation representation $\Coh_{\Lambda}( \CK(\g,\b))$,
it suffices to consider the case when $\Lambda=\Lambda^\fgg$ by the following lemma.
%only depends on $\Lambda^\g$ by the following lemma.
\begin{lem}\label{restco0}
The restriction map
\[
  \Coh_{\Lambda^\g}( \CK(\g,\b))\rightarrow \Coh_{\Lambda}( \CK(\g,\b))
\]
is a $W\times W_\Lambda$-equivariant  linear isomorphism,
and the restriction map
\[
 \Coh_{\Lambda}( \CK(\g,\b))\rightarrow \Coh_{\Lambda_\g}( \CK(\g,\b))
\]
is a $W\times W(\Lambda)$-equivariant  linear isomorphism.
\end{lem}
\begin{proof}
  This follows from \eqref{basis}.
\end{proof}


\subsection{Jantzen matrix}

Define the Jantzen matrix $\{a_{\Lambda}(w_1, w_2)\}_{w_1, w_2\in W}$, where $a_{\Lambda}(w_1, w_2)\in \Z$ is specified by
the following equation in $\Coh_{\Lambda}(\cK(\fgg,\fbb))$:
\[
  \overline{\Psi}_{w_1}=\sum_{w_2\in W}  a_{\Lambda}(w_1, w_2)\Psi_{w_2},
\]
for each  $w_1\in W$ .

\trivial[h]{
Suppose $\nu$ be a dominant weight in $\Lambda$, then
\[
\overline L(w_1\cdot \nu)=\sum_{w_2\in W}  a_{\Lambda}(w_1, w_2) \cdot
M(w_2\cdot \nu) \qquad (\textrm{as elements of $\CK(\g,\b)$}), \quad w_1\in W.
\]
This is different from the common convention where $\nu$ is assumed to be anti-dominant.
Let $w_0$ be the longest element in $W(\Lambda)$.
Now assume $\mu:=w_0 \cdot \nu$ which is an anti-dominant weight in $\Lambda$ and
\[
\overline L(w_1\cdot \mu)=\sum_{w_2\in W}  a'_{\Lambda}(w_1, w_2) \cdot
M(w_2\cdot \mu) \qquad (\textrm{as elements of $\CK(\g,\b)$}), \quad w_1\in W.
\]
Therefore, the relation between $a_\Lambda$ and $a'_\Lambda$ is
\[
a_\Lambda(w_1,w_2) = a'_\Lambda(w_1w_0,w_2w_0)
\]
In Joseph's paper W-module structure, he use anti-dominant weight.
In Joseph's paper of Goldie Rank II, he use dominant weight.
%
%Note that $a'_\Lambda$ has the following properties:
%\begin{enumerate}
%    \item $a'_\Lambda(w_1,w_2) = a'_\Lambda(w_1^{-1}, w_2^{-1})$ for $w_1,w_2\in W(\Lambda)$ see \cite[Lemma~5.2]{J2}.
%    This is equivalent to
%    \[
%    a_{\Lambda}(w_1,w_2) = a_{\Lambda}(w_0w_1^{-1}w_0^{-1}, w_0w_2^{-1}w_0^{-1}).
%    \]
%    (We use $w_0^2=1$)
%   \item $a'_{\Lambda'}(w'_1,w'_2) = a'_{\Lambda}(w^{-1}w'_1w, w^{-1}w'_2 w')$
%   where $\Lambda' = w\Lambda$, $w'_1,w'_2\in W(\Lambda')$, see \cite[Proof of Theorem~5.4]{J2}.
%   As a consequence ($w'_i = w w_i w^{-1}$  for $w_i\in W(\Lambda)$)
%   \[
%     a'_{\Lambda}(w w_1,w w_2) = a'_{\Lambda}(w_1, w_2)
%   \]
%
%    We remark that this is a consequence of Joseph's paper on Dixmier's problem:
%    \[
%        [X(-\mu, -\lambda): \overline X (-w\mu,-\lambda)] = [M(\mu): L(w\mu)]
%    \]
%    where $\mu,\lambda$ are dominant regular.
%    Note that $X(-\mu,-\lambda)=X(-\mu',-\lambda')$ and
%    $\barX(-\mu,-\lambda)=\barX(-\mu',-\lambda')$ iff $(\mu,\lambda) = w(\mu,\lambda)$.
% \end{enumerate}
}

\begin{lem}[Bernstein-Gelfand-Gelfand]\label{lem33}
 Let $w_1, w_2\in W$. If $w_1 W(\Lambda)\neq w_2 W(\Lambda)$, then $a_{\Lambda}(w_1, w_2)=0$.
\end{lem}
\begin{proof}
This is a consequence of the theorem of Bernstein-Gelfand-Gelfand on the composition factors of a Verma module.
See \cite[Corollary 5.2]{H}.
\end{proof}

\trivial[h]{\begin{proof}

For each $Q_\g$-coset  $\Lambda'\subset \hha^*$,
 let $\mathrm{Rep}_{\Lambda'}(\g, \b)$ denote the full subcategory of $\mathrm{Rep}(\g, \b)$ consisting of the modules whose weights are contained in $\Lambda'-\rho$.
 Write $\CK_{ \Lambda'}(\g, \b)$ for the Grothendieck group of this subcategory. Then
 \[
   \CK(\g, \b)=\bigoplus_{\Lambda'\in Q_\g\backslash \hha^*} \CK_{ \Lambda'}(\g, \b)
 \]
 and
 \begin{equation}\label{decLam00}
 \Coh_{\Lambda}( \CK(\g,\b))=\bigoplus_{w\in W/W(\Lambda)}\Coh_{\Lambda,w}(\CK(\g, \b) ),
\end{equation}
where
 \[
   \Coh_{\Lambda,w}( \CK(\g,\b)):=\{\Psi\in \Coh_{\Lambda}( \CK(\g,\b))\mid \Psi(\lambda)\in \CK_{w\lambda+Q_\g}(\g, \b)\ \textrm{for all } \lambda\in \Lambda\},
 \]
 which is a $W(w\cdot \Lambda)\times W(\Lambda)$-subrepresentation of  $\Coh_{\Lambda}( \CK(\g,\b))$. This implies the lemma by noting that $\Psi_{w_1}, \overline{\Psi}_{w_1}\in  \Coh_{\Lambda}( \CK(\g,\b))$ for all $w_1\in w  W(\Lambda)$. \end{proof}
}

\def\D{D}
Put
\[
  \Delta^+(\Lambda):=\Delta(\Lambda)\cap \Delta^+
\]
and  % If W(\Lambda) is a parabolic, it is the set of distinguished right coset representatives.
% in general, I don't known the name of this set.
%\begin{equation} \label{wprime}
%  W'(\Lambda):=\{w\in W\mid  w\cdot (\Delta^+(\Lambda) )= \Delta^+(w\cdot \Lambda)\}.
%S\end{equation}
\begin{equation} \label{wprime}
  \D(\Lambda):=\Set{w\in W\mid  w (\Delta^+(\Lambda) )\subset \Delta^+}.
\end{equation}
Then the group multiplication yields a bijective map
\[
  \D(\Lambda)\times W(\Lambda)\rightarrow W.
\]

%The following lemma is a direct consequence of a theorem of Soergel (\cite[Section 2.5, Theorem 11]{Soergel}).
%\begin{lem} \label{wprime0}
%For all  $w'\in W'(\Lambda)$ and $w_1, w_2\in W(\Lambda)$,  $$a_{\Lambda}(w'w_1, w'w_2)= a_{\Lambda}(w_1, w_2).$$
%Moreover, the matrix   $\{a_{\Lambda}(w_1, w_2)\}_{w_1, w_2\in W(\Lambda)}$ only depends on the set of simple reflections in the Weyl group $W(\Lambda)$.  More precisely, suppose that $(\g', \Lambda',  W(\Lambda'))$ is a triple as $(\g, \Lambda, W(\Lambda))$, and $\eta: W(\Lambda)\rightarrow W(\Lambda')$ is a group isomorphism that restricts to a bijection between the sets of  simple reflections, then $$a_{\Lambda}(w_1, w_2)=a_{\Lambda'}(\eta(w_1), \eta(w_2))$$ for all $w_1, w_2\in W(\Lambda)$.
%\qed
%\end{lem}

\begin{lem}[Joseph] \label{wprime0}
For all  $w'\in \D(\Lambda)$ and $w_1, w_2\in W(\Lambda)$,
\begin{equation}\label{eq:a1}
a_{\Lambda}(w'w_1, w'w_2)= a_{\Lambda}(w_1, w_2),
\end{equation}
and
\begin{equation}\label{eq:a2}
    a_{\Lambda}(w_1,w_2) = a_{\Lambda}(w_1^{-1}, w_2^{-1}).
\end{equation}
\end{lem}
\begin{proof}
  The equations are  proved by relating highest weight modules with principal series representations of complex semisimple groups.
  See \cite[Theorem~4.12 and Theorem~5.4]{J79D} and \cite[Corollary~3.3]{J79W} for  \eqref{eq:a1} and \eqref{eq:a2} respectively.
\end{proof}

\begin{remark}\label{soergel}
The equation \cref{eq:a1} is also a direct consequence of a theorem of Soergel
(see \cite[Section 2.5, Theorem 11]{Soergel}).
 The matrix   $\set{a_{\Lambda}(w_1, w_2)}_{w_1, w_2\in W(\Lambda)}$ only depends on the set of simple reflections in the Weyl group $W(\Lambda)$.
More precisely, suppose that $(\g', \Lambda',  W(\Lambda'))$ is a triple as
$(\g, \Lambda, W(\Lambda))$, and $\eta: W(\Lambda)\rightarrow W(\Lambda')$ is a group
isomorphism that restricts to a bijection between the sets of  simple reflections, then
\[
a_{\Lambda}(w_1, w_2)=a_{\Lambda'}(\eta(w_1), \eta(w_2))
\]
for all $w_1, w_2\in W(\Lambda)$.
\end{remark}


Recall that a polynomial function on $\hha^*$ or $\hha$ is said to be $W(\Lambda)$-harmonic if it is  annihilated by all the $W(\Lambda)$-invariant constant coefficient differential operators without constant term.
% Write $\CH_\Lambda(\hha^*)$ for the space of the $W(\Lambda)$-harmonic polynomial functions, which is naturally a representation of $W(\Lambda)$.


For every $w\in W$, define a polynomial function $\tilde p_{\Lambda, w}$ on $\hha\times \hha^*$ by
\be\label{polynomial0000}
  \tilde p_{\Lambda, w}(x,\nu):= \sum_{w_1\in W} a_{\Lambda}(w, w_1)\cdot  \la x, w_1 \nu\ra^{m_{\Lambda, w}},\quad  \textrm{for all }  \ x\in \hha, \nu\in \hha^*,
\ee
where $m_{\Lambda, w}$ is the smallest non-negative integer (which always exists) that makes the right-hand side of \eqref{polynomial0000} a nonzero polynomial function.

\begin{lem}[Joseph \cite{J.hw}*{\S~5.1}] \label{leftcell00}
%[{Joseph \cite{J.hw}*{\S 5.1~(*)}}]
Let $w\in W$. There is a $W(w\Lambda)$-harmonic polynomial function $p'_{\Lambda, w}$ on $\hha$ and a  $W(\Lambda)$-harmonic polynomial function $p_{\Lambda, w}$ on $\hha^*$ such that
\[
  \tilde  p_{\Lambda,  w}(x,\nu)= p'_{\Lambda,w}(x)\cdot  p_{\Lambda,w}(\nu), \quad\textrm{for all }  x\in \h,  \ \nu\in \h^*.
\]
The two harmonic polynomial functions are nonzero, of degree $m_{\Lambda,w}$ and are uniquely determined up to scalar multiplication.
\end{lem}
\begin{proof}
  This follows from \cite[Lemma~2.3~(i), Lemma~2.5]{J2} and \cite[Theorem~2.6~(b)]{BV2}.
\end{proof}

\trivial[h]{
\begin{proof}
  By \cite[Lemma~2.5]{J2},
  for each $x$ such that
  $\inn{x}{\alpha}>0$ for each $\alpha\in \Delta^+$, $\tpp_{\Lambda,w}(x,\mu)$ is a positive multiple of the Bernstein degree
  polynomial (called Vogan polynomial $e(\rL(w\cdot \mu))$ by Joseph) .
  The claim is given in \cite[Theorem~2.6~(b)]{BV2}, and here is a proof.
    Each $x$ gives a norm on the weight space.
    Let $e_x(L)$ be the leading coefficient of the  Hilbert polynomial, i.e the smooth of
    \[
    F_{x,L}(n) = \sum_{\inn{x}{\mu}\leq n} \dim(L_\mu)
    \]
    where $L_\mu$ denote the $\mu$ weight space of $L$.

   Joseph use $x =\ckrho $.
   But clearly there are constant $A>0$ and $B>0$,
   depends on $x$ but in-depends of $L$,   such that
   $A e_{\ckrho}(L) \leq e_{x}(L) \leq B e_{\ckrho}(L)$.

  Let $\ckrho\in \ahh$ such that $\inn{\ckrho}{\alpha}=1$
  for all $\alpha\in \Delta^+$.
  % and   $\rho\in \ahh$ such that $\inn{\rho}{\ckalpha}=1$
  % for all $\alpha\in \Delta^+$.
  Then $\tpp_{\Lambda,w}(\ckrho,\rho)\neq 0$ and
 \[
    \tpp_{\Lambda,w}(\ckrho,\nu) =
    p'_{\Lambda,w}(x)\cdot  p_{\Lambda,w}(\nu)
 \]
 with
  \[
    p_{\Lambda,w}(\nu) := \tpp_{\Lambda,w}(\ckrho,\nu)
   \AND p'_{\Lambda,w}(x) := \frac{\tpp_{\Lambda,w}(x,\rho)
   }{\tpp_{\Lambda,w}(\ckrho,\rho)}.
  \]
  Now $p_{\Lambda,w}(\nu)$ and  $p'_{\Lambda,w}(x)$ are
  $W(\Lambda)$-harmonic and $W(w\Lambda)$-harmonic polynomial
  respectively by the minimality of $m_{\Lambda,w}$ thanks to
  \cite[Lemma~2.3~(i)]{J2}.
  %Now $p_{\Lambda,w}(\nu)$ is a $W(\Lambda)$-harmonic polynomial of degree $m_{\Lambda,w}$ by
  %\cite[Lemma~2.3~(i)]{J2}.
  %, $p'_{\Lambda,w}(x)$ is $W(w\cdot \Lambda)$-harmonic with \Cref{wprime0}.
  \trivial[]{
    In fact, if we identify $\ahh$ and $\ahh^*$ so that $W$-acts by orthogonal linear maps.
   Write $w = w' w_1$ with $w'\in \D(\Lambda)$.
   Then, with the input from \Cref{wprime0},
   \[
   p'_{\Lambda,w}(x) \propto p_{\Lambda,w_1^{-1}}(w'^{-1} \cdot x).
   \]
  }
\end{proof}
}
%See \cite{King} and \cite[Section 5.1]{J.hw}.


%\subsection{Basal representations and cells}\label{seccell00}
\subsection{Left, right, and double cells}\label{seccell}

We define a basal vector space to be a complex vector space $V$ equipped with a basis $\mathcal D\subset V$, and call elements of $\mathcal D$ the basal elements in $V$. A subspace of a basal space $V$ is called a basal subspace if it is spanned by a set of basal elements of $V$. Every basal subspace is obviously a basal space.

As an example, if $\CK$ is the Grothendieck group of an abelian category in which all objects have finite length, then $\CK$ is a basal vector space with the irreducible objects as the basal elements.

%In particular, $\CK(G)$ is a basal vector space.




\begin{defn}
Let $E$ be a  finite group. A basal representation of $E$ is basal vector space carrying a representation of $E$. A basal subrepresentation of a basal representation $V$ is a subrepresentation of $V$ that is simultaneously a basal subspace.
\end{defn}




Let $V$ be a basal representation of a finite group $E$, with basal elements
$\mathcal D\subset V$. For each subset $\mathcal C\subset \mathcal D$, write $\la \CC\ra$ for
the smallest basal subrepresentation of $V$ containing $\CC$. For each
$\phi\in \mathcal D$, write $\la \phi\ra:=\la \{\phi\}\ra$ for simplicity. We define an equivalence relation $\approx$ on $\mathcal D$  by
\[
  \phi_1 \approx \phi_2 \quad \textrm{ if and only if
  } \quad \la \phi_1 \ra =\la \phi_2 \ra \qquad (\phi_1, \phi_2\in \mathcal D).
\]
An equivalence class of the relation $\approx$ on the set $\mathcal D$ is called a cell in $V$.

We say that a subset $\CC$ of $\mathcal D$ is \emph{order closed} if
%for every $\phi\in \mathcal D$, we have that $\phi\in \CC$ whenever $\la \phi\ra\subset \la \phi'\ra $ for some $\phi'\in \CC$. This is equivalent to saying that
$\braket{\CC}$ is spanned by $\CC$. In general, write $\overline \CC:=\braket{\CC}\cap \cD$, which is  the smallest order closed subset of $\mathcal D$ containing $\CC$.

When $\CC$ is a cell in $V$, define the cell representation attached to $\CC$ by
\[
V(\CC):=\la \overline \CC \ra/ \la \overline \CC\setminus \CC\ra.
\]
Note that the set $ \overline \CC\setminus \CC$ is order closed,
and $\{\phi+ \la \overline \CC\setminus \CC\ra\}_{ \phi\in \CC}$ is a basis of $V(\CC)$.


We view $\Coh_{\Lambda}( \CK(\g,\b))$ as a basal representation of $W\times W_\Lambda$ with the basal elements
 $\{\overline \Psi_{w}\mid w\in W\}$.
Write
\begin{equation}\label{eq:LRO}
\Coh^{LR}_{\Lambda}( \CK(\g,\b)):=\Coh_{\Lambda}( \CK(\g,\b)),
%(\cong \Ind_{W(\Lambda)}^W \bC[W(\Lambda)]),
\end{equation}
 to be viewed as a basal representation of $W\times W(\Lambda)$.
Likewise, write
\[
\Coh^{L}_{\Lambda}( \CK(\g,\b)):=\Coh_{\Lambda}( \CK(\g,\b)),
\]
 to be viewed as a basal representation of $W$, and write
 \[
 \Coh^{R}_{\Lambda}( \CK(\g,\b)):=\Coh_{\Lambda}( \CK(\g,\b)),
 \]
  to be viewed as a basal representation of $W(\Lambda)$ (as a subgroup of $W_\Lambda$).

Cells in $\Coh^{L}_{\Lambda}( \CK(\g,\b))$, $\Coh^{R}_{\Lambda}( \CK(\g,\b))$,
and $\Coh^{LR}_{\Lambda}( \CK(\g,\b))$ are respectively called
\emph{left, right, and double cells} in  $\Coh_{\Lambda}( \CK(\g,\b))$.
%We say that two basal elements of $\Coh_{\Lambda}( \CK(\g,\b))$
%lie in the same brick if they lie in a common left cell as well as a common right cell.
%This defines an equivalence relation whose equivalence class is called a \emph{brick} in $\Coh_{\Lambda}( \CK(\g,\b))$.
It is clear that every left (right) cell is contained in a double cell.
% and every brick is the intersection of a left and a right cell.

For every set $\CC$ of basal elements in $\Coh_{\Lambda}( \CK(\g,\b))$,
write $\la \CC\ra_L$ for the smallest basal subrepresentation
of $\Coh^L_{\Lambda}( \CK(\g,\b))$ containing $\CC$.
Similarly define $\la \CC\ra_R$ and $\la \CC\ra_{LR}$.



\subsection{Left cells and classification of primitive ideals}\label{sec:primitive}
Let $\Ann(M)\subset \mathcal U(\g)$ denote the
annihilator ideal of a $\mathcal U(\g)$-molude $M$.
By Duflo \cite[Theorem~1]{Du77}, each primitive ideal in the universal
enveloping algebra $\cU(\fgg)$ has the form %$\Ann(\rL(\nu))$ for a $\nu\in \ahh$.
$\Ann \bPsi_w(\nu)$ for a $w\in W$ and a dominant $\nu\in \ahh^*$.


%The notion of left cell gives a classification of primitive ideals at regular infinitesimal character.
For each $w\in W$, let $p_{\Lambda,w}$  be the $W(\Lambda)$-harmonic polynomial function as in \Cref{leftcell00}.

\begin{lem}\label{leftp}
Let  $w_1, w_2\in  W$.
%\begin{enumerate}[label=(\alph*),wide]
%\item
The following conditions are equivalent.
\begin{enumerate}[label=(\roman*),wide=0pt]
\item The basal elements $\overline \Psi_{w_1}$ and $\overline \Psi_{w_2}$ lie in a common left cell.
\item For some regular dominant $\nu\in \Lambda$, $\Ann \bPsi_{w_1}(\nu)  = \Ann \bPsi_{w_1}(\nu)$.
\item For every regular dominant $\nu\in \Lambda$, $\Ann \bPsi_{w_1}(\nu)  = \Ann \bPsi_{w_1}(\nu)$.
\item The equality $\C\cdot p_{\Lambda, w_1}=\C\cdot p_{\Lambda, w_2}$ holds.
\end{enumerate}
%\item
%Moreover,
%the basal elements $\overline \Psi_{w_1}$ and $\overline \Psi_{w_2}$ lie in a common right cell if and only if
%\[
%w_1 W(\Lambda) = w_2W(\Lambda) \AND \C\cdot p'_{\Lambda, w_1}=\C\cdot p'_{\Lambda, w_2}.
%\]
%
%The basal elements $\overline \Psi_{w_1}$ and $\overline \Psi_{w_2}$ lay in a common double cell if and only if
%\[
%\sigma_{\Lambda, w_1}=\sigma_{\Lambda, w_2}.
%\]

%\item The basal elements $\overline \Psi_{w_1}$ and $\overline \Psi_{w_2}$ lie in a common brick if and only if
%\[
%w_1 W(\Lambda) = w_2W(\Lambda) \AND
%\C\cdot \tilde p_{\Lambda, w_1}=\C \cdot \tilde p_{\Lambda, w_2}.
%\]
%\end{enumerate}
\end{lem}
\begin{proof}
The equivalence of (i) and (ii) is the equivalence of $(a)$ and $(b)$
in \cite{BV2}*{Proposition~2.9}.\trivial[h]{ The theorem is conjectured by Joseph in \cite{J79W}*{Conjecture 5.7.C}
which is the main theorem of Vogan's paper on the ordering of primitive ideals. }
The equivalence of (ii) and (iii) follows from the translation principle,
see~ \cite[Lemma~2.7]{V1}.
The equivalence of (ii) and (iv) is \cite[Theorem~5.1 and 5.5]{J2} when
$w_1 W(\Lambda) = w_2 W(\Lambda)$. The general case can be deduced by relating the problem to the setting of complex semisimple groups using  \cite[Theorem~4.12]{J79D} and \cite[Proposition~3.7]{Du77}.
\trivial[h]{
Pick a regular dominant element $\lambda\in \Lambda$.
For any $w'\in \D(\Lambda)$ and $w_1\in W(\Lambda)$,
$\C p_{\Lambda, w'w_1} = \C p_{\Lambda,w_1}$ is clear from \eqref{eq:a1}.
So it suffice to show that,
\[
J(w_1\lambda) = J(w'w_1\lambda).
\]

Here is the proof:
Recall that $\check{}$ is the involutive anti-automorphism on $\rU(\fgg)$ which sends $\fgg\in X$ to $-X$.
$X\mapsto {}^tX$ is the involutive anti-automorphism such that ${}^tX_\alpha = X_{-\alpha}$.
Let $\fkk = (X,-{}^tX) \in \fgg\times \fgg$
The standard module, denoted by $L(\lambda,\nu)$, is the space of $\fkk$-finite vectors in $(M(-\lambda)\otimes M(-\nu))^*$.
Then $V(\lambda,\nu)$ is the unique subquotient of $L(\lambda,\nu)$ generated by
the $\fkk$-type with external weight $\lambda-\nu$
(This $\fkk$-type is multiplicity one).

%Moreover, if $-\lambda$ or $-\nu$ is dominant, then $V(\lambda,\nu)$ is the unique subrepresentation of $L(\lambda,\nu)$.
By \cite{J79D}*{Theorem~4.12}, if $\nu$ and $\lambda$ regular dominant,
$\mu-\lambda\in Q^\fgg$ and $w\in W(\nu)$, then
\[
\begin{split}
\Ann(V(-w\lambda,-\nu)) & =
\check{J}(w\lambda) \otimes \rU(\fgg) + \rU(\fgg) \otimes \check{J}(w^{-1} \nu)\\
& =: \LAnn(V(-w\lambda,-\nu))\otimes \rU(\fgg) + \rU(\fgg) \otimes\LAnn(V(-w\lambda,-\nu)).
\end{split}
\]
\cite[Proposition~3.7]{Du77} says, $V(\lambda,\nu) = V(\lambda',\nu')$ if and only if
there is $w\in W$ such that $(\lambda,\nu) = (w\lambda',w\nu')$.

Since $w'\cdot \lambda$ is also dominant,
\[
\check{J}(w_1\lambda) =
\LAnn(V(-w_1\lambda, -\lambda) =
\LAnn(V(-w' w_1\lambda, -w'\lambda)
= \check{J}(w'w_1\lambda)
\]
This proves the claim.
}
%This follows by \Cref{lem33}, \Cref{wprime0}, \cite[Theorems 5.4 and 5.5]{J2} and ?\cite[Proposition 2.9]{j}.


\trivial[h]{
By \cite[Proposition~2.9 (d) and  Definition~2.10]{BV2},
the notion of a left and a right cell are symmetric.
More precisely, each right cell has the form
\[
\Set{\bPsi_{w'w_1}| w_1\in W(\Lambda),  \bPsi_{w_1^{-1}}\in \cC^L}
\]
where $\cC^L$ is a left cell and $w'\in \D(\Lambda)$.
Now the claim follows from \eqref{eq:a2}.

About the ordering on the integral Weyl group.
Fix a regular dominant weight $\lambda \in \Lambda$, let $\nu= w_0 \lambda$
where $w_0$ is longest element in $W(\Lambda)$.

In BV's definition,
\begin{itemize}[label={$\Leftrightarrow$}]
\item $w_1\leqL w_2$
\item $w_2 w_0 \leqL w_1 w_0$ (by Kazhdan-Lusztig)
\item $J(w_2 w_0 \nu)\subset J(w_1 w_0\nu)$
\item $J(w_2 \lambda)\subset J(w_1 \lambda)$
\item $w_0 w_2 \leqL w_0 w_1 $ (by Kazhdan-Lusztig)
\item $L(w_1^{-1} w_0^{-1} \nu)$ is a subquotient of  $L(w_2^{-1} w_0^{-1} \nu)\otimes F$
\item $L(w_1^{-1} \lambda)$ is a subquotient of  $L(w_2^{-1} \lambda)\otimes F$
\end{itemize}
So in our notation, we can define
\begin{itemize}[label={$\Leftrightarrow$}]
\item $w_2^{-1}\leqR w_1^{-1}$
\item $w_1\leqL w_2$
\item $J(w_2 \lambda)\subset J(w_1 \lambda)$
\item $L(w_1^{-1} \lambda)$ is a subquotient of  $L(w_2^{-1} \lambda)\otimes F$
\end{itemize}
In particular,
Barbasch-Vogan's left relation is defined by
\[
w'w_2\leqL w'w_1 \Leftrightarrow \bPsi_{w_2}\subset \braket{\bPsi_{w_1}}_L.
\]
for $w'\in \D(\Lambda)$ and $w_1,w_2\in W(\Lambda)$.
Barbasch-Vogan's  right relation is define by
\[
w'w_2\leqR w'w_1 \Leftrightarrow \bPsi_{w_1}\subset \braket{\bPsi_{w_2}}_R.
\]
for $w'\in \D(\Lambda)$ and $w_1,w_2\in W(\Lambda)$.
}
%\item This is clear from (a) and (b).
%\end{enumerate}
\end{proof}

Using \Cref{leftp}, we  obviously attach a %$W(\Lambda)$-harmonic
polynomial function   $p_{\CC^L}$  on $\hha^*$ to every left cell $\CC^L$ in $\Coh_{\Lambda}( \CK(\g,\b))$,
%$W$-harmonic polynomial function $ p'_{\CC^R}$ on $\hha$ to every right cell $\CC^R$ in $\Coh_{\Lambda}( \CK(\g,\b))$.
%, and a polynomial function $\tilde p_\CB$ on $\hha\times \hha^*$ to every brick $\CB$ in  $\Coh_{\Lambda}( \CK(\g,\b))$.
which is uniquely determined up to scalar multiplication.






\trivial[h]{
\begin{lem}
 For every simple reflection $s\in W(\Lambda)$, either $s\cdot  \overline \Psi_w=- \overline \Psi_w$ or $s\cdot  \overline \Psi_w$ is a nonnegative integral linear combination of basal elements in $\Coh_{\Lambda}( \CK(\g,\b))$.
 \end{lem}
\begin{proof}
This is proved in the setting of Harish-Chandra modules in \cite[Corollary 7.3.9]{Vg}. The same proof works here for highest weight modules.

\end{proof}

}
\begin{lem}\label{lem:tauinv}
For every $w\in W$ and every simple reflection $s\in W(\Lambda)$, the following statements are equivalent.
%\begin{eqnarray*}
%&&
%s\cdot  \overline \Psi_w=- \overline \Psi_w\\
%&\Longleftrightarrow & s\cdot p_{\Lambda,w}=-p_{\Lambda, w}\\
%  &  \Longleftrightarrow &  w(\alpha)\in -\Delta^+(\Lambda),
%  \end{eqnarray*}
\begin{enumerate}[label=(\roman*),wide=0pt]
\item $s\cdot p_{\Lambda,w}=-p_{\Lambda, w}$.
\item $s\cdot  \overline \Psi_w=- \overline \Psi_w$.
%\item $\bPsi_w(\nu) = 0$ for each dominant weight $\nu\in \Lambda$ such that $s \nu = \nu$;
\trivial[h]{ this is equivalent to $\inn{\ckalpha}{\nu}=0$}
\item
%$ w(\alpha_s)\in \Delta^+(\Lambda)$, where $\alpha_s\in \Delta^+(\Lambda)$ is the simple root corresponding to $s$.
$ w(\alpha_s)\in \Delta^+$, where $\alpha_s\in \Delta^+(\Lambda)$ is the simple root corresponding to $s$.
\end{enumerate}
\end{lem}
\begin{proof}
The equivalence between (i) and (ii) is due to the fact that
$p_{\Lambda,w}$ is essentially the Bernstein degree polynomial, see \cite[Theorem~4.10]{J2} and \cite{VGK}*{p85}.
The equivalence between (ii) and (iii) is due to Jantzen, see \cite{BV2}*{Proposition~2.20}. %\cite[Theorem~7.9]{H}.
\end{proof}

\trivial[h]{
The equivalence between (iii) and (iv) is due to Jantzen \cite[Theorem~7.9]{H}.

The assertion that (i) implies (iii) is due to the fact that $p_{\Lambda,w}$ is essentially the Bernstein degree polynomial \cite[Theorem~4.10]{J2}.
The rest of assertions on (i), (ii) and (iii) are formal properties of the coherent family,
see \cite{VGK}*{p84-85}.
Since we use dominant weight instead of anti-dominant weights as Barabash-Vogan.
In BV's setting, $L_w(\lambda)=0$ for all $\lambda$ anti-dominant ($L_w$ is the coherent family such that irreducible on regular anti-dominant weights) and $\inn{\ckalpha}{\lambda}=0$ if and only if $s$ in the left descent set of $w$
$\Leftrightarrow$ $w(\alpha)\in -\Delta^+(\Lambda)\Leftrightarrow l(ws)<l(w)$.

Note the the length function has the property $l(w) = l(w^{-1})$ and $l(w_0 w ) = l(w w_0) = l(w_0)-l(w)$.
Now our setting $\nu  = w_0 \lambda$,
$l(ws)>l(w)\Leftrightarrow l(ww_0\, s^{w_0}) = l(wsw_0) < l(ww_0) \Leftrightarrow$
$s^{w_0}$ is in the left descent set of $w w_0$.
Now $s^{w_0}(\lambda) = \lambda$ $\Leftrightarrow$ $s\nu = \nu$
$\Leftrightarrow$
$0=L_{w w_0}(\lambda)=\bPsi_w(\nu)$.
}

%\begin{proof}
%\cite[Corollary 7.3.9]{Vg}.
%\end{proof}

For every basal element $ \Psi=\overline{\Psi}_w$ ($w\in W$) in $\Coh_{\Lambda}( \CK(\g,\b))$, define the Borho-Jantzen-Duflo $\tau$-invariant of $\Psi$ to be the set of simple reflections
satisfying the equivalent conditions in \Cref{lem:tauinv}:
\[
 \tau_\Psi:= \tau_{\Lambda, w}:=\{s\in W(\Lambda) \textrm{ is a simple reflection }\mid   s\cdot p_{\Lambda,w}=-p_{\Lambda, w}\}.
\]
This only depends on the left cell containing $\Psi$,
and thus the $\tau$-invariant $\tau_{\CC^L}$
is obviously defined for each left cell $\CC^L$
in $\Coh_{\Lambda}( \CK(\g,\b))$.
%Consequently, the $\tau$-invariant is well defined for each primitive ideal
%by \Cref{leftp}. See \cite{Vtau}*{after Theorem~2.4}.

For each $\mu\in \hha^*$, write $W_\mu$ for the stabilizer of $\mu$ in $W$. The following is a reformulation of Jantzen's
result on the translation to wall, see \cite{H}*{Theorem~7.9} and
also \cite[Theorem~7.3.22]{Vg}.
\begin{lem}[Jantzen]\label{prop:Jantzen}
Let $w\in W$ and let  $\nu\in \Lambda$ be a dominant element. Then
\[
\overline \Psi_w(\nu)=
\left\{
   \begin{array}{ll}
    \oL(w\nu),\quad & \text{if $\tau_{\Lambda, w}\cap W_{\nu} = \emptyset$;} \\
    %\textrm{if there is no element of  $\tau_{\Lambda, w}$ that fixes $\nu$};\\
       0, \quad &\textrm{otherwise}.
   \end{array}
\right.
\]
              %      If $\overline \Psi_w(\nu)\neq 0$, then the associated variety of   $\mathrm J(w\cdot \nu)$ equals the Zariski closure $\overline \CO_{\Lambda, w}\subset \g^*$ of $\CO_{\Lambda, w}$.
\end{lem}
\trivial[h]{
This is in fact also an formal consequence of the definition of $\tau$-invariant in terms of
Bernstein degree polynomial. What we really need is the fact that,
the translation to wall is either zero or irreducible, see the proof of
\cite[Theorem~7.3.22]{Vg}.
}

\Cref{prop:Jantzen} and the translation principle (see \cite{V1}*{Lemma~2.7})
imply the following classification of primitive ideals at a general infinitesimal character.
%For every $\lambda\in \hha^*$, let $\mathrm J(\lambda)$ denote the annihilator ideal of $\oL(\lambda)$.

\begin{prop}[Joseph]\label{primitivei}
Let $\nu\in \Lambda$ be a dominant element. Then the map
\[
\begin{array}{rcl}
  \set{w\in W | \tau_{\Lambda, w}\cap W_\nu = \emptyset} & \rightarrow &
 \set{\textrm{primitive ideal of $\CU(\g)$ of infinitesimal character $\nu$}}\\
 w & \mapsto & \Ann( \oL(w \nu))
\end{array}
\]
is surjective. Furthermore for all $w_1, w_2$ in the domain of this map,
\[
  \Ann(\oL(w_1\nu))=\Ann(\oL(w_2\nu))\quad \textrm{if and only if}\quad \C\cdot p_{\Lambda, w_1}=\C\cdot p_{\Lambda, w_2}.
\]
\end{prop}


For every left cell $\CC^L$ in $\Coh_\Lambda(\cK(\fgg,\fbb))$
and every dominant element $\nu\in \Lambda$,
we define
\begin{equation}\label{eq:ICC}
I_{\nu,\CC^{L}} := \Ann(\Psi(\nu))
\end{equation}
where $\Psi\in \CC^L$.
Note that this definition is independent of the choice of $\Psi$, and $I_{\nu,\CC^L}$
is a primitive ideal if $\tau_{\CC^L}\cap W_\nu = \emptyset$ and
is $\cU(\fgg)$ otherwise.

By \Cref{primitivei}, for every dominant element $\nu\in \Lambda$, we have an obvious bijection
\begin{equation}\label{eq:primitive}
\begin{split}
 & \quad \set{\CC^L | \CC^L \textrm{ is a left cell in $\Coh_{\Lambda}( \CK(\g,\b))$ such that }
 \tau_{\CC^L} \cap W_\nu = \emptyset }\\
 \xrightarrow{\CC^L\mapsto I_{\nu, \CC^L}} & \quad \{\textrm{primitive ideal of $\CU(\g)$ of infinitesimal character $\nu$}\}.
 \end{split}
 \end{equation}
For every primitive ideal $I$ of infinitesimal character $\nu$, write $\CC^L_{\nu, I}$ %\mjj{$\CC^L_{\Lambda, I}$?}
for the left cell that corresponds to it under this bijection. In particular when $\nu \in \Lambda$ is regular dominant, for each basal element $\Psi$ in $\Coh_\Lambda(\cK(\fgg,\fbb))$,
the left cell corresponding to the primitive ideal $\Ann \Psi(\nu)$ is just the left cell containing  $\Psi$.

\begin{lem}\label{primitiveii}
Let $\nu\in \Lambda$ be a dominant element. Then for all primitive ideals $I_1$ and $I_2$ of $\CU(\g)$ of infinitesimal character $\nu$,
\[
  I_1\subset I_2\quad \textrm{if and only if}\quad \la \CC^L_{\nu, I_1}\ra_L\supseteq \la \CC^L_{\nu, I_2}\ra_L.
\]
\end{lem}
\begin{proof}
  This follows from \Cref{primitivei} and \cite{BV2}*{Proposition~2.9}.
\end{proof}






\subsection{Double cells and special representations}
\label{sec:DCell}


For every $\sigma\in \Irr(W)$, its fake degree is defined to be
 \begin{equation}\label{eq:fdeg}
 a(\sigma):=\min\{k\in \BN\,|\, \sigma \textrm{ occurs in the $k$-th symmetric power $\oS^k(\hha)$}\}.
 \end{equation}
This is well-defined since every  $\sigma\in \Irr(W)$ occurs in
the symmetric algebra $\oS(\hha)$.
The representation $\sigma$ is said to be \emph{univalent} if it occurs in $\oS^{a(\sigma)}(\hha_{\mathrm s})$ with multiplicity one, where $\hha_{\mathrm s}:=\Span(\check \Delta)$ denotes the span of the coroots.

Recall Lusztig's notion of a special representation of a Weyl group  %(\cite[Definition~11.3.8]{Carter}).
(\cite{Lsp}).
An irreducible representation of $W$ is said to be Springer if it corresponds to
the trivial local system on a nilpotent orbit in $\g^*$ via the Springer correspondence.
Note that every special irreducible representation is Springer, and every Springer representation is univalent \cite{BM}.



We have a decomposition
\[
  \hha=(\Delta(\Lambda))^\perp\oplus \Span( \check \Delta(\Lambda))
  \]
where
\[
(\Delta(\Lambda))^\perp:=\{x\in \hha\mid \la x , \alpha \ra=0\textrm{ for all $\alpha\in \Delta(\Lambda)$}\}.
\]
 For every univalent irreducible representation $\sigma_0$ of $W(\Lambda)$, whenever it is convenient, we view it as a subrepresentation of  $\oS^{a(\sigma_0)}(\hha)$ via the inclusions
\[
\sigma_0=  \C\otimes \sigma_0\subset \oS^0((\Delta(\Lambda))^\perp)\otimes \oS^{a(\sigma_0)}(\Span( \check \Delta(\Lambda)))\subset  \oS^{a(\sigma_0)}(\hha)
\]
By the work of Macdonald, Lusztig, and Spaltenstein (\cite[Chapter 11]{Carter}), the $W$-sub-representation of $\oS^{a(\sigma_0)}(\hha)$ generated by $\sigma_0$
is irreducible and univalent, with the same fake degree as that of $\sigma_0$.  This irreducible representation of $W$ is called the $j$-induction of $\sigma_0$, to be denoted by $j_{W(\Lambda)}^W(\sigma_0)$.



If  $\sigma_0$ is special, then the $j$-induction $j_{W(\Lambda)}^W \sigma_0$
is Springer.
%\trivial[h]{It is worth to note that all Springer representations (correspondes to trivial local system)
%of $W$ is univalent, this is a result of Borho-MacPherson,
%Representations des groupes de Weyl et homologie d'intersection pour les varietes nilpotentes.}
Write $\CO_{\sigma_0}\in \overline \Nil(\g^*)$ for the nilpotent orbit corresponding to
$j_{W(\Lambda)}^W \sigma_0$ .
Then
\[
  \dim \CO_{\sigma_0}=2\cdot (\sharp (\Delta^+) - a(\sigma_0)).
\]
See \cite{Ho}*{Theorem~3}.


Suppose that $\CC$ is a double cell in $\Coh_{\Lambda}( \CK(\g,\b))$.
Put $m_\CC:=m_{\Lambda, w}$, where $w\in W$ is an element such that $\overline \Psi_{w}\in \CC$. Note that
$m_\CC$ is independent of the choice of $w$ (see \cite{BV2}*{Corollary~2.15 and 2.16}).\trivial[h]{ The claim is much more elementary than
\Cref{leftp}. It is a formal consequence of the definition of coherent family using translation functor that
all elements in the same right cell has the same GK-dimension,
now $m_\CC$ is nothing but the codimension of Associated Variety in $\fnn$.
The claim translates to left cell by the symmetry of left and right cell.
The claim for double cell follows form the claim of left and right cell.
}
For every $\Psi=\sum_{w\in W} a_{w} \Psi_{w}\in \la \CC\ra_{LR}$, define a polynomial function $\tilde p_\Psi$ on $\hha\times \hha^*$ by
\begin{equation}\label{polynomial00}
  \tilde p_{\Psi}(x,\nu):= \sum_{w\in W} a_{w}\cdot  \la x, w \nu\ra^{m_{\CC}},\quad  \textrm{for all }  \ x\in \hha, \nu\in \hha^*.
\end{equation}

%Let $\ckdelta$ be a fixed element in $\ahh$ such that $\inn{\ckdelta}{\alpha}\neq 0$ for all $\alpha \in \Delta^+$.
%Let $p_{\Psi}(\nu) := \tpp_{\Psi}(\ckdelta,\nu)$ for every $\nu\in \ahh^*$.

Then the linear map
\begin{equation}\label{lara}
    \braket{\CC}_{LR}\rightarrow \oS(\hha^*)\otimes \oS(\hha), \quad \Psi\mapsto \tilde p_{\Psi}\quad (\oS\textrm{ indicates the symmetric algebra})
\end{equation}
is $W\times W(\Lambda)$-equivariant  % In fact, section~3.5 and 3.6
and descends to a linear map
\begin{equation}\label{lara2}
 \Coh^{LR}_{\Lambda}( \CK(\g,\b))( \CC) \rightarrow \oS(\hha^*)\otimes \oS(\hha).
    %, \quad \Psi\mapsto \tilde p_{\Psi}
\end{equation}
See  \cite{J2}*{\S~3} and \cite[Corollary 2.15]{BV2}.

%Define a $W(\Lambda)$-equivalent map
%\begin{equation}
%\label{eq:Bernstein degree}
%\sE \colon \Coh^{LR}_{\Lambda}( \CK(\g,\b))( \CC) \rightarrow \oS(\hha),
%\quad \Psi\mapsto  p_{\Psi}
%\end{equation}

\trivial[h]{
For every left cell $\CC^L$ contained in $\CC$,
the cell representation  $\Coh^{L}_{\Lambda}( \CK(\g,\b))( \CC^L)$
is naturally identified with a subspace of $\Coh^{LR}_{\Lambda}( \CK(\g,\b))( \CC)$
and thus \eqref{lara3} restricts to a  $W$-equivariant linear map
\begin{equation}\label{lara3}
    \Coh^{L}_{\Lambda}( \CK(\g,\b))( \CC^L) \rightarrow \oS(\hha^*)\otimes \oS(\hha).%, \quad \Psi\mapsto \tilde p_{\Psi}
\end{equation}
Similarly, for every right cell $\CC^R$ contained in $\CC$, \eqref{lara2} restricts to a  $W(\Lambda)$-equivariant linear map
\begin{equation}\label{lara4}
    \Coh^{R}_{\Lambda}( \CK(\g,\b))( \CC^R) \rightarrow \oS(\hha^*)\otimes \oS(\hha).%, \quad \Psi\mapsto \tilde p_{\Psi}
\end{equation}
}

We define a preorder $\leqLR$ on $\Irr(W(\Lambda))$ by
$
  \sigma_1\leqLR \sigma_2$ if and only if there exist double cells $\CC_1$ and $\CC_2$ in $\Coh_{\Lambda}(\CK( \g, \b))$ such that $\la \CC_1\ra_{LR}\supseteq \la \CC_2\ra_{LR}$, and $\sigma_i$ occurs in  $\Coh^{LR}_{ \Lambda}(\CK( \g, \b))(\CC_i)$ ($i=1,2$).
This preorder only depends on $W(\Lambda)$ as a Coxeter group (see \cite{BV2}*{Proposition~2.28}). Define an equivalence relation $\approxLR$ on
$\Irr(W(\Lambda))$ by
\[
  \sigma_1\approxLR \sigma_2\quad \textrm{if and only if}\quad
  \sigma_1\leqLR \sigma_2\textrm{ and } \sigma_2\leqLR \sigma_1.
\]
%We say that two irreducible representation of $W(\Lambda)$ lie in a common double cell
%if there is a double cell $\CC$ in $\Coh_{\Lambda}( \CK(\g,\b))$
%such that both of the representations occur in $\Coh^{LR}_{\Lambda}( \CK(\g,\b))( \CC)$.
An equivalence class of this equivalence relation  is called a double cell in
$\Irr(W(\Lambda))$. Note that this definition of double cell in $\Irr(W(\Lambda))$ coincides with that of Lusztig in \cite{Lcell} (also \cite{Carter}*{Section~13.2}).

%\begin{remark}
%Thanks to Soergel's theorem (see \Cref{soergel}), Kazhdan-Lusztig conjecture holds for arbitary
%infinitesimal character and the notions of left, right and double cells only depend on the set of simple reflections in the Weyl group $W(\Lambda)$.
%\end{remark}


Let  $\Irr^{\mathrm{sp}}(W(\Lambda))$ denote the subset of $\Irr(W(\Lambda))$ consisting of the special
irreducible representations. Recall the definition of $p_{\CC^L}$ after \Cref{leftp}.

We recollect some results due to Barbasch-Vogan, Lusztig and Joseph in the following proposition. See  \cite{BV2}*{Section 2}.


\begin{prop}\label{cell00}\label{dcrep} Let $\CC$ be a double cell in $\Coh_{\Lambda}( \CK(\g,\b))$.
\begin{enumerate}[label=(\alph*),wide=0pt]
\item
 There is a unique $\sigma_\CC \in \Irr^{\mathrm{sp}}(W(\Lambda))$
% with fake degree $m_\CC$
 such that  the image of \eqref{lara2} equals
 $\left(j_{W(\Lambda)}^W\sigma_\CC\right)\otimes \sigma_\CC$.
Moreover, $a(\sigma_\CC) = m_\CC$ and for every $\sigma'\in \Irr(W(\Lambda))$ that occurs
in $\braket{\CC}_{LR}$, either $\sigma'=\sigma_\CC$ or $a(\sigma')>m_\CC$.
%$\sigma_\CC$ is the
%unique irreducible character of $W(\Lambda)$-module occurs in
% $\braket{\CC}_{LR}$ with minimal fake degree.
%Moreover,  $\left(j_{W(\Lambda)}^W\sigma_\CC\right)\otimes \sigma_\CC$ is the
%unique irreducible character of $W\times W(\Lambda)$-module occurs in
% $\braket{\CC}_{LR}$ with minimal fake degree.
% Moreover, $\left(j_{W(\Lambda)}^W\sigma_\CC\right)\otimes \sigma_\CC$  occurs in
% $\Coh^{LR}_{\Lambda}( \CK(\g,\b))( \CC)$ with multiplicity one.
% {Q: is $j_{W(\Lambda)}^W\sigma_\CC $ multipicity one in $\Ind_{W(\Lambda)}^W\sigma_\CC $}
% , and
%\[
%\{\tilde p_{\CB}\}_{\CB\textrm{ is a brick contained in $\CC$}}
%\]
% is a basis of $\left(j_{W(\Lambda)}^W\sigma_\CC\right)\otimes \sigma_\CC$.
%\item
%For every  left cell $\CC^L$ contained in $\CC$, the image of \eqref{lara3} equals
%$\left(j_{W(\Lambda)}^W\sigma_\CC\right)\otimes  p_{\CC^L}$.
%Moreover, for every $\sigma'\in \Irr(W)$ that occurs
%in $\braket{\CC^L}_{L}$, either $\sigma'=j_{W(\Lambda)}^W\sigma_\CC$ or $a(\sigma')>m_\CC$.
%, and
%$j_{W(\Lambda)}^W\sigma_\CC$ occurs in $\Coh^{L}_{\Lambda}( \CK(\g,\b))( \CC^L)$
%with multiplicity one.
%, and
%\[
%\{\tilde p_{\CB} \}_{\CB\textrm{ is a brick contained in $\CC^L$}}
%\]
% is a basis of the image of  \eqref{lara3}.
%\item
%For every  right cell $\CC^R$ contained in $\CC$, the image of \eqref{lara4} equals $p'_{\CC^R}\otimes \sigma_\CC$.
%Moreover, for every $\sigma'\in \Irr(W(\Lambda))$ that occurs
%in $\braket{\CC^R}_{R}$, either $\sigma'=\sigma_\CC$ or $a(\sigma')>m_\CC$.
%, and $\sigma_\CC$ occurs in $\Coh^{R}_{\Lambda}( \CK(\g,\b))( \CC^R)$ with multiplicity one.
%and
%\begin{equation}\label{eq:pbasis}
%    \set{\tilde p_{\CB} }_{\CB\textrm{ is a brick contained in %$\CC^R$}}
%\end{equation}
% is a basis of the image of  \eqref{lara4}.
 \item The representation
$\sigma_\CC$ is the unique
element of $\Irr^{\mathrm{sp}}(W(\Lambda))$
that occurs in $\Coh^{LR}_{\Lambda}( \CK(\g,\b))( \CC)$. Moreover, the map
\[
  \{\textrm{double cell in $ \Coh_{\Lambda}( \CK(\g,\b))$}\}\rightarrow \Irr^{\mathrm{sp}}(W(\Lambda)), \quad \CC\mapsto \sigma_\CC
\]
is bijective.
\item
As a representation of $W\times W(\Lambda)$,
\[
 \Coh^{LR}_{\Lambda}( \CK(\g,\b))( \CC)\cong \bigoplus_{
 \substack{\sigma\in \Irr(W(\Lambda)),\\
 \sigma\approx \sigma_\CC}}
% \textrm{$\sigma$ lies in the same double cell with $\sigma_\CC$}}}
  \left(\Ind_{W(\Lambda)}^W\sigma\right)\otimes \sigma.
\]
\end{enumerate}
\end{prop}
%\begin{proof}
% \begin{enumerate}[label=(\alph*),wide]
%The set \eqref{eq:pbasis} is a basis of $\sigma_\CC$ by \cite{J2}*{Theorem~5.5}.
%Parts (a) is in \cite{BV2}*{Corollary~2.15}. % and Corollary~2.16}.
%Part (b) is clear by (a).
%Since all Weyl group representations are self-dual,
%part (c) follows from \cite{BV2}*{Corollary~2.11} and \eqref{eq:exp}.
%\[
%\Coh^{LR}_{\Lambda}( \CK(\g,\b))\cong \Ind_{W(\Lambda)}^W \bC[W(\Lambda)]
%\]
%as $W\times W(\Lambda)$-module.
%\end{proof}


%In fact, the notion of left, right and double cells on $W(\Lambda)$ only depends on the Weyl group

From now on, we let $\sigma_\CC$ denote the unique special irreducible representation attached to a double cell $\CC$ as in \Cref{cell00}.
We also define the Goldie rank representation of a primitive ideal $I$ of infinititemal character $\nu$,  where $\nu \in \Lambda$ is dominant, to be
\begin{equation}\label{grrj}
\sigma_{\nu, I}:=\sigma_{\CC^{LR}_{\nu,I} }\in \Irr^{\mathrm{sp}}(W(\Lambda)).
\end{equation}
Here $\CC^{LR}_{\nu,I}$ is the double cell containing the left cell $\CC^L_{\nu, I}$.

\begin{lem}[\cite{J2}*{Theorem~5.5}]\label{dcrep33}
Let $\CC$ be a double cell in $\Coh_{\Lambda}( \CK(\g,\b))$. Then the family
\[
\{p_{\CC^L}\}_{\CC^L\textrm{ is a left cell contained in }\CC}
\]
is linearly independent in $\mathrm S^{m_\CC}(\hha)$ and spans a $W(\Lambda)$-subrepresentation that is isomorphic to $\sigma_\CC$.
\end{lem}



\begin{lem}[{\cite{BV2}*{Proposition~2.25}}]\label{lrd}
For all $\sigma_1, \sigma_2\in \Irr{(W(\Lambda))}$,
$\sigma_1\leqLR \sigma_2$ if and only if  $\sigma_2\otimes \sgn\leqLR \sigma_1\otimes \sgn$.
\end{lem}


\subsection{Associated varieties}\label{sec:ass}

For every primitive ideal $I$ of $\CU(\g)$, denote by
$\AV (I)$ its associated variety.

Recall the Goldie rank representation $\sigma_{\nu, I}$ attached to a primitive ideal $I$ in \eqref{grrj}.
The following result is due to Joseph.
\begin{prop}[\cite{J.av}*{Proposition~2.10}]\label{assv}
Let $\nu\in \Lambda$ be a dominant element and let $I$ be a primitive ideal of $\CU(\g)$  of infinitesimal character $\nu$.   Then the associated variety $\AV (I)$ equals the Zariski closure
$\overline{\CO_{\sigma_{\nu,I}}}$ of $\CO_{\sigma_{\nu,I}}$ in
$\g^*$.
\end{prop}
%\begin{proof}
%  This is \cite{J.av}*{Proposition~2.10} and \cite{}
%\end{proof}
\trivial[h]{
The dimension of  $\CO_{\sigma_{\nu,I}}$ is $2(\dim \fnn - a(\sigma_{\nu,I}))$, this is clear by Joseph's construction of the Springer correspondence.
This is \cite{J.av}*{3.11} and \cite{J.hw}*{Proposition~4.7}.
}




Let $\sfS\subset \mathrm{Nil}(\g^*)$ be an $\Inn(\g)$-stable Zariski closed subset.
Let  $\Rep_\sfS(\g,\b)$ denote the full   subcategory of $\Rep(\g,\b)$ of the modules  $M$ such that the  associated variety of $\Ann(M)$  is contained in $\sfS$.
We obviously have the coherent continuation representation  $\Coh_{\Lambda}(\CK_\sfS(\g,\b))$, where $\CK_\sfS(\g,\b)$ denote the Grothendieck group of $\Rep_\sfS(\g,\b)$.


For every $w\in W$, put $\CO_{\Lambda, w}:=\CO_{\sigma_\CC}$, where
                    $\CC$ is the double cell  in $\Coh_{\Lambda}( \CK(\g,\b))$ containing $\overline \Psi_w$.%, and $\sigma_\CC$ is the representation as in Proposition \ref{cell00}.



\begin{lem}\label{basalassv}
Let $w\in W$. The coherent family $\overline \Psi_w$ belongs to
$\Coh_{\Lambda}(\CK_\sfS(\g,\b))$ if and only if  $\CO_{\Lambda, w}\subset \sfS$.
\end{lem}
\begin{proof}
This follows from \Cref{prop:Jantzen}, \Cref{primitivei}, \Cref{assv} and
\cite{Vg}*{Proposition~7.3.11} (for the translation outside the dominant cone).
% the ``only if$\,$" part is obvious.
%The ``if'' part follows form \cite{}
%The ``if$\,$" part may  be proved by  using \cite{Vg}*{Part (b) of Proposition~7.2.22}
%(which is formulated and proved for the case of Harish-Chandra module
%but is obviously generalized to  the case of highest weight modules).
\end{proof}



\begin{lem}\label{assv33}
Let $w_1, w_2\in W$. If $\la \overline \Psi_{w_1}\ra_L\supsetneq \la \overline \Psi_{w_2}\ra_L$, then $\overline{\CO_{\Lambda, w_1}}\supsetneq \overline{\CO_{\Lambda, w_2}}$.

\end{lem}
\begin{proof}
Pick a  regular dominant element $\nu\in \Lambda$.
Put $I_i:=\Ann(\overline{\Psi}_{w_i}(\nu))$ ($i=1,2$).
\Cref{primitiveii} implies that  $I_1\subsetneq I_2$ and hence
\[
  \AV(I_1)\supsetneq \AV(I_2).
\]
On the other hand, \Cref{assv} implies that  $\AV(I_i)=\overline{\CO_{\Lambda, w_i}}$ ($i=1,2$). Hence the lemma follows.
\end{proof}



\begin{lem}\label{basals}
The space $\Coh_{\Lambda}(\CK_\sfS(\g,\b))$ is a
$W\times W_\Lambda$-submodule
%$W\times W_\Lambda$-subrepresentation
of $\Coh_{\Lambda}(\CK(\g,\b))$ spanned by the basal elements
\be\label{spanb}
 \{\overline \Psi_{w}\mid w\in W,  \CO_{\Lambda, w}\subset \sfS\}.
\ee
\end{lem}
\begin{proof}
\Cref{basalassv}  implies that  $\Coh_{\Lambda}(\CK_\sfS(\g,\b))$
is spanned by  the set \eqref{spanb}.
The space $\Coh_{\Lambda}(\CK_\sfS(\g,\b))$ is  clearly $W_\Lambda$-stable,
and \Cref{assv33} implies that it is also $W$-stable.
This proves the proposition.
\end{proof}

Define
\[
  \Irr_\sfS^{\mathrm{sp}}(W(\Lambda)):= \Set{\sigma_0\in \Irr^{\mathrm{sp}}(W(\Lambda))| \cO_{\sigma_0}\subset \sfS}
\]
and
\[
\Irr_\sfS(W(\Lambda))
  := \Set{\sigma\in \Irr(W(\Lambda))|
  \text{there is a $\sigma_0\in \Irr_\sfS^{\mathrm{sp}}(W(\Lambda))$ such that $\sigma\approx \sigma_0$}
  %\begin{array}{l}
  %\text{there is a $\sigma_s\in \Irr_\sfS^{\mathrm{sp}}(W(\Lambda))$}\\
  %\text{such that $\sigma_0$ and $\sigma_s$ lies in the same double cell.}
  %\end{array}
  }.
\]
\trivial[h]{
\begin{eqnarray*}%\label{sfc01}
&& \Irr_\sfS(W(\Lambda))\\
  &:=& \Set{\sigma_0\in \Irr(W(\Lambda))| \sigma_0 \textrm{ lies in the same double cell with an element of } \Irr_\sfS^{\mathrm{sp}}(W(\Lambda))}.
\end{eqnarray*}
}

By \Cref{basals}, $\Coh_{\Lambda}(\CK_\sfS(\g,\b))$ is a basal subrepresentation of  $\Coh^{LR}_{\Lambda}(\CK(\g,\b))$.

\begin{prop}\label{cohbbs}
As a representation of $W\times W(\Lambda)$, % we have
\[
  \Coh_{\Lambda}( \CK_{\sfS}(\g,\b))\cong \bigoplus_{\sigma\in \Irr_\sfS(W(\Lambda))} \left(\Ind_{W(\Lambda)}^W \sigma\right)\otimes \sigma.
\]
%Here $\Ind$ indicates the induced representation.
\end{prop}

\begin{proof}
Write $\mathcal D_0$ for the set of basal elements in $ \Coh_{\Lambda}(\CK_\sfS(\g,\b))$.
Then it is elementary to see that we may
 choose a filtration
\[
  \mathcal D_0\supset \mathcal D_1\supset \cdots \supset \mathcal D_k=\emptyset \qquad (k\in \BN)
\]
such that
\begin{itemize}
\item  $\braket{\cD_i}_{LR}$ is spanned by $\cD_i$ ($i=0, 1,2, \cdots ,k$),
\item $\cC_i:=\cD_i\setminus \cD_{i+1}$ is a double cell in $\Coh_{\Lambda}(\CK(\g,\b))$ for all $i=0,1, \dots, k-1$, and
\item
for all $i_1, i_2\in \{0,1, \dots, k-1\}$,
$\braket{\CC_{i_1}}_{LR} \subset \braket{ \CC_{i_2}}_{LR}$ implies that $i_1\geq i_2$.
\end{itemize}
%Then it is elementary to see that  $\la \cD_i\ra_{LR}$ is spanned by $\mathcal D_i$ ($i=0, 1,2, \cdots ,k$).
%Let $\sigma_i\in \Irr^{\mathrm{sp}}(W(\Lambda))$ denote the unique special representation such that $(w\cdot \sigma_i)\otimes \sigma_i$ occurs in $\Coh_{\Lambda, w}( \CK_{\sfS}(\g,\b))(\CC_i)$.

Then \Cref{cell00} and  \Cref{basalassv} imply that
\[
\{\sigma_{\CC_0}, \sigma_{\CC_1}, \dots, \sigma_{\CC_{k-1}}\}= \Irr_\sfS^{\mathrm{sp}}(W(\Lambda)).
\]
Thus we have that
\begin{eqnarray*}
   &&\Coh_{\Lambda}(\CK_\sfS(\g,\b))
\\
   &\cong & \bigoplus_{i=0}^{k-1}  \la \mathcal D_i\ra_{LR}/\la \mathcal D_{i+1}\ra_{LR}\\
    &\cong & \bigoplus_{i=0}^{k-1}  \Coh_{\Lambda}(\CK(\g,\b))(\mathcal C_i)\\
    &\cong &\bigoplus_{\sigma\in \Irr_\sfS(W(\Lambda))} \left(\Ind_{W(\Lambda)}^W\sigma\right)\otimes \sigma\qquad(\textrm{by \Cref{dcrep}~(c)}).
\end{eqnarray*}
\end{proof}


%{\color{red} Some words on the motivation of the following paragraphs? }

Let $\nu\in \Lambda$ be a dominant element. Recall that for a primitive ideal $I$ of infinitesimal character $\nu$, we have the corresponding left cell $\CC^L_{\nu, I}$ (\Cref{sec:primitive}). In the rest of the section, we focus on left cells which come from maximal primitive ideals.

% For every $\nu\in \hha^*$,
 Write $\CO_\nu\in \overline{\mathrm{Nil}}(\g^*)$ for the nilpotent orbit
 whose Zariski closure $\overline{\CO_{\nu}}\subset \g^*$ equals
 the associated variety of the maximal ideal $I_\nu$.

Recall the $J$-induction defined in \cite{Lcell}*{\S~11} (see also \cite{Lu}*{(4.1.7)}).
\begin{prop}[Barbasch-Vogan]\label{leftcnu}
As $W$-representations,
%\trivial[]{$W_\nu$ is a parabolic subgroup of $W(\Lambda)$, }
\[
  \Coh^L_{\Lambda}( \CK(\g,\b))(\CC^L_{ \nu, I_\nu})\cong \Ind_{W(\Lambda)}^W \left(\left(J_{W_{\nu}}^{W(\Lambda)} \sgn \right)\otimes \sgn\right)
  \]
and as $W(\Lambda)$-representations,
\begin{equation}\label{leftc3}
  \left(\left(J_{W_{\nu}}^{W(\Lambda)} \sgn \right)\otimes \sgn\right) \cong \bigoplus_{\sigma\in \Irr_{\overline{\CO_{\nu}}}(W(\Lambda)), \, [1_{W_\nu} :\sigma]\neq 0 }  \sigma.
\end{equation}
% Moreover,
% $\sigma_{\CC^{LR}_{ \nu, I_\nu}}\cong \left(j_{W_{\nu}}^{W(\Lambda)} \sgn \right)\otimes \sgn$,
%and it is  the unique special irreducible representation of $W(\Lambda)$ that  occurs in \eqref{leftc3}.
%Here $ \CC^{LR}_{ \nu, I_\nu}$ denote the double cell containing $\CC^{L}_{ \nu, I_\nu}$.
Moreover,
%the Goldie rank representation (see \eqref{grrj})
\[
\sigma_{\nu,I_\nu} \cong \left(j_{W_{\nu}}^{W(\Lambda)} \sgn \right)\otimes \sgn ,
\]
and $\sigma_{\nu,I_\nu}$ is the unique special irreducible representation of $W(\Lambda)$ that occurs in \eqref{leftc3}.
\end{prop}
\begin{proof}
    In view of \Cref{dcrep}~(b) and \Cref{assv33}, this follows by the same proof of \cite{BVUni}*{5.30}.
\end{proof}


The isomorphism \eqref{leftc3} and explicit formulas of the $J$-induction (see \cite{Lu}*{\S4.4-4.13}) imply that
\be\label{mulone}
 [1_{W_\nu} :\sigma]\leq 1
 \ee
for all $\nu\in \Lambda$ and all $ \sigma\in \Irr_{\overline{\CO_\nu}}(W(\Lambda))$.
 %\trivial[]{
%By \cite{BV2}*{Proposition~2.25 and 3.15}, \eqref{leftc3} is a left cell with respect to $W(\Lambda)$.
%}
We call the set
\begin{equation} \label{ll}
\LC_{\nu}:=\left\{\sigma\in \Irr(W(\Lambda))\mid \sigma \textrm{ occurs in } \left(J_{W_{\nu}}^{W(\Lambda)} \sgn \right)\otimes \sgn\right \}.
\end{equation}
the \emph{Lusztig left cell} attached to $\nu\in \Lambda$. % to be the set


\begin{lem}\label{leftcnu2}
Let $\nu\in \Lambda$ be a dominant element and let $I$ be a primitive ideal of $\CU(\g)$ of infinitesimal character $\nu$.    Then $I=I_\nu$ if and only if $\sigma_{\nu, I}\cong \left(j_{W_{\nu}}^{W(\Lambda)} \sgn \right)\otimes \sgn$.




\end{lem}
\begin{proof}
The ``only if$\,$" part  follows from \Cref{leftcnu}.
For the proof of the ``if'' part, note that $I \subseteq I_\nu$.
%we suppose that
Then $\sigma_{\nu, I}\cong \sigma_{\nu, I_\nu}$
implies that $I$ and $I_\nu$ have the same associated variety by \Cref{assv}.
Thus $I=I_\nu$ by the maximality of $I_\nu$ and the proof is complete.
\end{proof}


%In the notation of the last subsection, we have that $a(\sigma_\CC)=m_\CC$.

% Note that $\h_{\mathrm s}=\h/\c=\h/\h^W$, where $\h^W$ denotes the $W$-fixed vectors in $\h$.



%Let $\sigma_{\Lambda, w}$ denote the $W(\Lambda)$-subrepresentation of $\CH_\Lambda(\hha^*)$ generated by $ q_{\Lambda,w}$, which is a special irreducible representation  of $W(\Lambda)$ with fake degree $m_{\Lambda, w}$.
%Then $p_{\Lambda,w}(x)$ generates an irreducible $W(w\cdot\Lambda)$-subrepresentation of $\CH_{w\cdot\Lambda}(\hha)$ that is isomorphic to $w\cdot \sigma_{\Lambda, w}$,



%In particular, $\sigma_{\Lambda, w}$ is univalent and the
% the $j$-induction $j_{W(\Lambda)}^W \sigma_{\Lambda, w}$ is the $W$-subrepresentation of $ \oS^{m_{\Lambda, w}}(\hha)$ generated by $q_{\Lambda,w}$.
%Moreover, the representation $j_{W(\Lambda)}^W \sigma_{\Lambda, w}$ is Springer in the sense that it corresponds to the trivial local system on a nilpotent orbit in $\g^*$, via the Springer correspondence. Write $\CO_{\Lambda, w}\in \overline \Nil(\g^*)$ for this  nilpotent orbit.



\subsection{$\tau$-invariants and duals of double cells}\label{subsec:tau-DC}

Let $\Pi(\Lambda)$ denote the set of simple reflections in $W(\Lambda)$.
For each subset $S\subset \Pi(\Lambda)$, define an element
\[
e_S :=\frac{1}{\sharp(W_{\Pi(\Lambda)\setminus S})\cdot \sharp(W_S)}\sum_{g\in W_{\Pi(\Lambda)\setminus S}}\sum_{h\in W_{S}} \sgn(h) \,  gh
\]
in the group algebra $\bC[W(\Lambda)]$, where $W_S$ and $W_{\Pi(\Lambda)\setminus S}$ are the subgroups of $W(\Lambda)$ generated by $S$ and $\Pi(\Lambda)\setminus S$ respectively.

Following \cite{FJMN}, for every finite-dimensional representation $\sigma$ of $W(\Lambda)$,  %$\sigma\in \Irrsp{(W(\Lambda))}$,
define its $\tau$-invariant to be the set
\[
  \tau_\sigma:=\left\{S\subset \Pi(\Lambda)\mid
  %\textrm{the operator $\sum_{g\in W_{S'},h\in W_{S}} \sgn(h) \cdot gh: \sigma\rightarrow \sigma$ is nonzero}
   \text{the $e_S$ action on $\sigma$ is nonzero}
  \right\}.
\]
%where $S':=\Pi(\Lambda)\setminus S$, and $W_S$ and $W_{S'}$ are the subgroups of $W(\Lambda)$ generated by $S$ and $S'$ respectively.


 For every double cell $\CC$ in $\Coh_\Lambda(\CK(\g,\b))$, we define its $\tau$-invariant
to be the set
\[
  \tau_{\CC}:=\{\tau_\Psi\mid \Psi\in \CC\}.
\]
Recall that we have a representation $\sigma_\CC\in \Irrsp{(W(\Lambda))}$ attached to $\CC$.

\begin{lem}\label{eqtau0}
For every  double cell $\CC$ in $\Coh_\Lambda(\CK(\g,\b))$, $\tau_\CC=\tau_{\sigma_{\CC}}$.
\end{lem}
\begin{proof}
  Let $M$ denote the cell representation $\Coh^{LR}_{\Lambda}( \CK(\g,\b))(\CC)$ to be viewed as a
  $W(\Lambda)$-representation. By \cite{FJMN}*{Theorem~2.10}, we know that
  $\tau_{\CC}=\tau_M$. Since $\sigma_\CC$ occurs in $M$, we have that
  \[
  \tau_{\sigma_{\CC}}\subset \tau_M =  \tau_{\CC}.
  \]
 % By the quotient map $\sE\colon M \rightarrow \sigma_{\CCLR}$ and $\tau_{\CCLR}=\tau_M$ (see \cite{FJMN}*{Theorem~2.10}),
 % we see that $\tau_{\sigma_{\CCLR}}\subset \tau_M =  \tau_{\CCLR}$.

  Now it remains to show that $\tau_{\CC} \subset \tau_{\sigma_{\CC}}$.
  Let $\Psi\in \CC$ and put  $S:=\tau_\Psi$.
  Write
  \[
    e_S=Q(S')\cdot R(S),
  \]
  where $S':=\Pi(\Lambda)\setminus S$,
\[
R(S):=
\frac{1}{ \sharp(W_S)}\sum_{h\in W_{S}} \sgn(h)\,h
\]
  and
\[
Q(S'):=
\frac{1}{ \sharp(W_{S'})}\sum_{g\in W_{S'}} g.
\]

For each $\Phi\in \CC$, write $[\Phi]\in M$ for the class represented by $\Phi$.
Then
\[
  R(S)\cdot [\Psi]=[\Psi],
\]
and
 \cite{FJMN}*{Proof of Proposition~2.6}
 implies that
 \[
  Q(S')\cdot [\Psi]=[\Psi]+\sum_{\Psi'\in \CC, \tau_{\Psi'}\not\subset S} c_{\Psi'} [\Psi'],
 \]
 where $c_{\Psi'}\in \C$. Thus
 \be\label{es123}
  e_S\cdot [\Psi]=[\Psi]+\sum_{\Psi'\in \CC, \tau_{\Psi'}\not\subset S} c_{\Psi'} [\Psi'].
  \ee

 Through \Cref{cell00}, we view $\sigma_\CC$ as a subspace of $\oS^{m_\CC}(\hha)$. The same proposition also implies that there is a $W(\Lambda)$-homomorphism
 \[
 \phi: M\rightarrow \sigma_{\CC}
 \]
 such that $\phi([\Phi])$ is a nonzero scalar multiple of $p_{\CC^L_{\Phi}}$ for all $\Phi\in \CC$, where $\CC^L_{\Phi}$ is the left cell containing $\Phi$. Applying $\phi$ to the quality \eqref{es123}, we obtain that
 \[
 e_S\cdot p_{\CC^L_\Psi}=p_{\CC^L_\Psi}+\sum_{\Psi'\in \CC, \tau_{\Psi'}\not\subset S} c'_{\Psi'} p_{\CC^L_{\Psi'}},
 \]
 where $c'_{\Psi'}\in \C$.
 This is nonzero by \Cref{leftp} and \Cref{dcrep33}, and by noting that  $\CC_{\Psi}^L \neq \CC_{\Psi'}^L$ for all $\Psi'\in \CC$ with $\tau_{\Psi'}\not\subset S$.
  Therefore $S\in \tau_{\sigma_{\CC}}$ and the proof is complete.
 \end{proof}

\begin{prop}\label{eqtau1}
Let $\sigma_1, \sigma_2\in \Irrsp{(W(\Lambda))}$. If $\tau_{\sigma_1}=\tau_{\sigma_2}$, then $\sigma_1=\sigma_2$.
\end{prop}
\begin{proof}
\def\SignSig{\rm{SignSig}}
    Clearly it suffices to consider the case when the root system  $\Delta(\Lambda)$ is
    irreducible. The lemma follows from \Cref{eqtau0} and the results of \cite{FJMN} (Theorem 2.12 for classical groups and the discussion in \S~6 for exceptional groups).

    \trivial[h]{
    Suppose $W(\Lambda)$ is exceptional, the claim is verified by computer see \cite{FJMN}*{\S~6}.
    Now assume $W(\Lambda)$ is classical.
    Recall the sign-signature  of a representation $M$ of $W(\Lambda)$ defined in \cite{FJMN}*{\S~1} to be the set
    \[
    \SignSig(\sigma) := \set{S\subset \Pi(\Lambda)| \text{the $R_S$ action on $\sigma$ is non-zero}}
    \]
    where $R_S := \sum_{h\in W_S}\sgn(h) h$ is an element in the group algebra $\bC[W(\Lambda)]$.
    By \cite{FJMN}*{Proposition~2.8} and a similar proof of \Cref{eqtau0},
    we have
    \[
      \SignSig(\sigma_{\CCLR}) = \SignSig(M) = \set{A| \text{there is $X\in \tau_{\CCLR}$ such that $A\subset X$}}
    \]
    for any double cell $\CCLR$.
    In particular, $\SignSig(\sigma_{\CCLR})$ is determined by $\tau_{\CCLR}$
    Now the lemma follows from \cite{FJMN}*{Theorem~2.12}
    }
\end{proof}

Let $(\check \g, \check \b, \check \Lambda)$ be a triple with the same property as the triple $(\g,\b, \Lambda)$. Let $\check W$ denote the Weyl group of $\check \g$. As before we have the basal space  $\Coh_{\check \Lambda}(\CK(\check \g,\check \b))$ carrying a representation of $\check W\times \check W(\check \Lambda)$, where  $\check W(\check \Lambda)\subseteq\check W$ is the integral Weyl group attached to $\check \Lambda$.

Suppose we are given an identification $W(\Lambda)=\check W(\check \Lambda)$ of Coxeter groups, namely a group isomorphism that sends simple reflections to simple reflections. We say that two subsets $\tau_1$ and $\tau_2$ of the power set of
$\Pi(\Lambda)$ are dual to each other if
\[
\tau_2=\{\Pi(\Lambda)\setminus S\mid S\in \tau_1\}.
\]

\begin{prop}\label{duald} We are given an identification $W(\Lambda)=\check W(\check \Lambda)$ of Coxeter groups.
  For every double cell $\CC$ in $\Coh_\Lambda(\CK(\g,\b))$, there is a unique double cell $\check \CC$ in $\Coh_{\check \Lambda}(\CK(\check \g,\check \b))$ whose $\tau$-invariant is dual to that of $\CC$. Moreover, the map
  \begin{eqnarray*}
  &&\{\sigma\in \Irr(W(\Lambda))\mid \sigma\textrm{ occurs in $\Coh^{LR}_{ \Lambda}(\CK( \g, \b))(\CC)$}\}\\
  &\xrightarrow{\sigma\mapsto \sigma\otimes \sgn} &
   \{\check \sigma\in \Irr(\check W(\check \Lambda))\mid \check \sigma\textrm{ occurs in $\Coh^{LR}_{\check \Lambda}(\CK(\check \g,\check \b))(\check \CC)$}\}
   \end{eqnarray*}
  is well-defined and bijective.
\end{prop}
\begin{proof}
\def\ckCCLR{{\check{\CC}^{LR}}}
\def\ckbPsi{\check{\bPsi}}
\def\ckfbb{{\check\fbb}}
%In the following proof, we add $\check{\ }$ to denote the symbols with respect to $(\ckfgg,\ckfbb,\ckLambda)$.
Let $\sC:=\set{w\in W(\Lambda)| \bPsi_{w}\in \CC}$.
Then $\sC$ is a double cell of $W(\Lambda)$ in the sense of Kazhdan-Lusztig (\cite{KL}). By \cite{BV2}*{Corollary~2.23},
  $\CC$ has the form
 \[
 \set{\bPsi_{w'w}|w'\in \D(\Lambda), w\in \sC}
 \qquad
(\textrm{see \cref{wprime} for the definition of $\D(\Lambda)$}).
\]
Let $w_0$ be the element in $W(\Lambda)$ such that $w_0 (\Delta^+(\Lambda)) \cap \Delta^+(\Lambda) = \emptyset$. Similar to $\D(\Lambda)$, we have a subgroup $\D(\ckLambda)$ of $\ckW$.


By \cite{BV2}*{Corollary~2.24},
\[
\ckcC:=\set{\ckbPsi_{w' w_0 w}|w'\in D(\ckLambda),  w\in \sC}
\]
is a double cell in $\Coh_{\ckLambda}(\CK(\ckfgg, \ckfbb,\ckLambda))$, where $\ckbPsi_{w' w_0 w}$ is a basal element defined as in \eqref{psibarw}.
By \Cref{lem:tauinv}, we have that
\[
\tau_{\bPsi_{w'w}} = \tau_{\bPsi_{w}}= \Pi(\Lambda)\setminus \tau_{\ckbPsi_{w_0 w }}
= \Pi(\Lambda)\setminus \tau_{\ckbPsi_{w'' w_0 w }}
\]
for each $w'\in \D(\Lambda)$, $w''\in \D(\ckLambda)$ and  $w\in W(\Lambda)$.
This implies that $\tau_\CC$  is dual to $\tau_{\ckcC}$.

The uniqueness of $\ckCCLR$ follows from \Cref{eqtau1} and the bijection between double cells and special representations in
\Cref{cell00}~(b).  See also \cite{FJMN}*{\S~6}.

The assertion on the operation of tensoring with $\sgn$ is in  \cite{BV2}*{Proposition~2.25}. \end{proof}

%\[
%\tau_\CCLR = \set{\tau_{\bPsi_w}|w\in C} = \set{\Pi(\Lambda) \setminus \tau_{\ckbPsi_{w w_0}}| w\in C}
%=\tau_{\ckCCLR}
%\]


The double cell $\check\CC$ in \Cref{duald} will be referred as the dual (in $\Coh_{\check \Lambda}(\CK(\check \g,\check \b))$) of $\CC$.




\section{Generalities on coherent families of Casselman-Wallach representations}\label{sec:CW}



%\subsection{Coherent continuation representations for real reductive groups}

%Let $G$ be a real reductive group in Harish-Chandra's class (which may be
%linear or non-linear). Suppose that $\g$ is the complexified Lie algebra of $G$. In the rest of  this paper, unless otherwise mentioned, we use the corresponding lowercase gothic letter to denote the complexified Lie algebra of a Lie group. Let $\Rep(G)$ denote the category of Casselman-Wallach representations of $G$, and write $\CK(G)$ for the Grothedieck group of this category.
%For every $\nu\in \hha^*$, write $\mathrm{Rep}_\nu(G)$ for the category of Casselman-Wallach representations of $G$ of generalized infinitesimal character $\nu$. , and write   $\CK_{\nu}(G)$ for its  Grothedieck group.
%
%
%For every Casselman-Wallach representation $\pi$ of $G$, its complex associated variety,
%which is denoted by $\AV_\C(\pi)$, is defined to be the associated variety of $\Ann(\pi)\subset \CU(\g)$.
% Recall that $\sfS$ is a $\Ad(\g)$-stable Zariski closed subset of $\Nil(\g^*)$. Let $\mathrm{Rep}_\sfS(G)$ denote the
%category of Casselman-Wallach representations of $G$ whose complex associated
%variety is contained in $\sfS$. Write
% $\CK_{\sfS}(G)$ for the Grothendieck group of this category.
%
%
%For every $\lambda\in\hha^*$, write $\Rep_\lambda(G)$ for the category of Casselman-Wallach representations of $G$ of generalized infinitesimal $\lambda$.
%Write $\Rep_{\lambda, \sfS}(G)$ for the full subcategory of $\Rep_\lambda(G)$ consisting of the representations that are also $\Rep_\sfS(G)$.
%Denote by $\CK_\lambda(G)$ and  $\CK_{\lambda, \sfS}(G)$ for the Grothedieck groups of  $\Rep_{\lambda}(G)$ and $\Rep_{\lambda, \sfS}(G)$ respectively.

Let $G$ be a real reductive group in Harish-Chandra's class (which may be
linear or non-linear). Suppose that $\fgg$ is the complexified Lie algebra of $G$.
%In the rest of  this paper, % unless otherwise mentioned,
%we use the corresponding lowercase gothic letter to denote the complexified Lie algebra of a Lie group.
Let $\Rep(G)$ denote the category of Casselman-Wallach representations of $G$.

The complex associated variety of a representation $\pi$ in $\Rep(G)$,
denoted by $\AV_\C(\pi)$, is defined to be the associated variety of $\Ann(\pi)\subset \CU(\g)$.
Let $\sfS$ be  an $\Ad(\g)$-stable Zariski closed subset   of $\Nil(\g^*)$. Let $\Rep_\sfS(G)$ denote the
category of Casselman-Wallach representations of $G$ whose complex associated
variety is contained in $\sfS$.


For every $\mu\in \hha^*$,
respectively let $\Rep_\mu(G)$ and $\Rep_{\mu,\sfS}$ denote the full subcategories of  $\Rep(G)$ and $\Rep_{\sfS}(G)$ consisting
of the Casselman-Wallach representations of generalized infinitesimal character $\mu$.
Denote by $\CK(G)$, $\CK_\mu(G)$ and  $\CK_{\mu, \sfS}(G)$ for the Grothedieck groups of
$\Rep(G)$, $\Rep_{\mu}(G)$ and $\Rep_{\mu, \sfS}(G)$ respectively.
The set of irreducible objects in $\Rep_{\mu}(G)$ and $\Rep_{\mu, \sfS}(G)$ will be denoted by $\Irr_{\mu}(G)$ and $\Irr_{\mu, \sfS}(G)$, respectively.

 % The main purpose of this section is to establish the counting formulas for certain irreducible representations (in \Cref{counteq} and \Cref{countleq}).

\subsection{The parameter set for coherent continuation representations}\label{extcoh}

Suppose that we are given a connected reductive complex Lie group $G_\C$ together with a Lie group homomorphism $\iota: G\rightarrow G_\C$ such that its differential $\mathrm d \iota: \Lie(G)\rightarrow \Lie(G_\C)$ has the following two properties:
\begin{itemize}
  \item the kernel of $\mathrm d \iota$ is contained in the center of the Lie algebra $ \Lie(G)$ of $G$;
  \item the image of  $\mathrm d \iota$ is a real form  of the Lie algebra $ \Lie(G_\C)$.
\end{itemize}
The  analytic weight lattice of $ G_\C$ is identified with a subgroup of $\hha^*$ via $\mathrm d\iota$. We write $Q_\iota\subset \hha^*$ for this subgroup.

When $G_\C=\mathrm{Ad}(\g)$ and $\iota$ is the adjoint representation, $Q_\iota$ equals the root lattice $Q_\g$. In general $Q_\iota$ is $W$-stable and $Q_\g\subseteq Q_\iota \subseteq Q^\g$.
In the rest of this section we assume that $Q=Q_\iota$. Recall that $\Lambda\subset \hha^*$ is a $Q$-coset.


%Write $[\lambda]_\iota:=\lambda+Q_\iota\subset \hha^*$, and denote by $W_{[\lambda]_\iota}$ its stabilizer in $W$. Then $W_{[\lambda]_\iota}\supseteq W_\Lam$.

The algebra $\mathcal R(\g, Q)$ is obviously identified with  the Grothendieck group of the category of holomorphic finite-dimensional representations of $G_\C$.  Thus $\CK(G)$ is naturally a $\mathcal R(\g, Q)$-module by using tensor product and the homomorphism $\iota$. As before, we form the coherent continuation representation $\Coh_\Lambda(\CK(G))$ of $W_\Lambda$.


%It is a commutative $\C$-algebra under the tensor product of the finite-dimensional representations.  Generalizing Definition \ref{defcoh}, we make the following definition.




 Suppose that $H$ is a  Cartan subgroup of $G$. Write $\t$ for the complexified Lie algebra of the unique maximal compact subgroup of $H$. As before, denote by $\Delta_\h\subset \h^*$ the root system of $\g$. A root $\alpha\in \Delta_\h$ is called imaginary if $\check \alpha\in \t$. An imaginary root $\alpha\in \Delta_\h$ is said to be compact if the root spaces $\g_\alpha$ and $\g_{-\alpha}$ are contained in  the  complexified Lie algebra of a common compact subgroup of $G$.

Note that every Casselman-Wallach representation of $H$ is finite dimensional. Since $G$ is in the Harish-Chandra's class,
 for every $\Gamma\in \Irr(H)$,
there is a unique element $\mathrm d \Gamma\in \h^*$ such that the differential of $\Gamma$ is isomorphic to a direct sum of  one-dimensional representations of $\h$ attached to $\mathrm d  \Gamma$.

For every Borel subalgebra $\b$ of $\g$ containing $\h$, write
\be\label{xib00}
  \xi_\b: \hha\rightarrow \h
\ee
for the linear isomorphism attached to $\b$, whose transpose inverse is still denoted by $ \xi_\b: \hha^*\rightarrow \h^*$. Write
\[
  W(\hha^*, \h^*):=\{ \xi_\b: \hha^*\rightarrow \h^*\mid \textrm{$\b$ is a Borel subalgebra of $\g$ containing $\h$}\}.
  \]

Recall that $ \Delta^+\subset \hha^*$ denotes the set of positive roots. For every element $\xi\in  W(\hha^*, \h^*)$,  put
\be\label{deltawb}
  \delta(\xi):=\frac{1}{2}\cdot \sum_{\alpha \textrm{ is an imaginary root in $\xi \Delta^+$ }} \alpha- \sum_{\beta \textrm{ is a compact imaginary root in $\xi \Delta^+$ }}\beta \in \h^*.
\ee

%Denote by $Q_\h\subset \h^*$ the root lattice of $\g$. For every $\nu\in \h^*$, put $[\nu]:=\nu+Q_\h$.

Write $\sP_{\Lambda}(G)$ for the set of all triples $\upgamma=(H, \xi, \Gamma)$ where $H$ is a Cartan subgroup of $G$, $\xi\in  W(\hha^*, \h^*)$, and
\[
\Gamma:   \Lambda\rightarrow \Irr(H), \quad \nu\mapsto \Gamma_\nu
\]
 is a map
with the following properties:
\begin{itemize}
  \item $\Gamma_{\nu+\beta}=\Gamma_\nu\otimes \xi(\beta)$ for all $\beta\in Q$ and $\nu\in \Lambda$;
  \item $\mathrm d\Gamma_\nu = \xi(\nu)+\delta(\xi)$ for all $\nu\in  \Lambda$.
  \end{itemize}
Here $\xi(\beta)$ is naturally viewed as a character of $H$ by using the homomorphism $\iota: H\rightarrow H_\C$, and $H_\C$ is the Cartan subgroup of $G_\C$ containing $\iota(H)$.


\def\olgamma{\overline\gamma}
\def\olPsi{\overline\Psi}
\def\olrX{\overline\rX}

The group $G$ obviously acts on $\sP_{\Lambda}(G)$,
and we define the set of parameters  for $\Coh_{\Lambda}(\CK(G))$
to be
\begin{equation}\label{eq:Pram}
  \cP_{\Lambda}(G) := G\backslash  \sP_{\Lambda}(G).
\end{equation}



For each $\gamma \in\cP_{\Lambda}(G)$ that is represented by $\upgamma=(H, \xi, \Gamma)$, by \cite{Vg}*{Theorem~8.2.1}, we  have two $\CK(G)$-valued coherent families  $\Psi_{\gamma}$ and $\olPsi_{\gamma}$ on $\Lambda$  such that
\begin{equation}\label{eq:psigamma}
  \Psi_{\gamma}(\nu)=\rX{((\Gamma_\nu,\xi(\nu))}
  \AND
  \olPsi_{\gamma}(\nu)=\olrX{(\Gamma_\nu,\xi(\nu))}
\end{equation}
for all  regular dominant element $\nu\in \Lambda$.
Here $\rX{((\Gamma_\nu,\xi(\nu))}$ is the standard representation defined in \cite{Vg}*{Notational Convention~6.6.3}
  and  $\olrX(\Gamma_\nu,\xi(\nu)))$ is its unique irreducible subrepresentation (see \cite{Vg}*{Theorem 6.5.12}).
  %See \cite{Vg}*{Theorem~6.5.10 and Theorem 7.2.10}.
  \trivial[h]{ For the uniqueSee the discussion before Corollary~6.5.13. Note that $\gamma$ is nonsingular, so $\nu$ is nonsingular.  Hence $R_\delta(\nu)$ is trivial and $R_\delta^\perp(\nu)$ is $\hat R_\delta^(\nu)$ act simply transitive on $A(\gamma)$.}

By Langlands classification,
$\set{\olPsi_{\gamma}}_{\gamma\in \cP_{\Lambda}(G)}$ is a basis of
$\Coh_{\Lambda}(\cK(G))$   (see \cite{Vg}*{Theorem~6.6.14}), and we view $\Coh_\Lambda(\cK(G))$ as a basal representation of $W_\Lambda$ with this basis. %implies that.  % \cite{Vg}*{??? cc}.
The family  $\set{\Psi_{\gamma}}_{\gamma\in \cP_{\Lambda}(G)}$ is also a basis of $\Coh_{\Lambda}(\cK(G))$ (\cite{Vg}*{Proposition~6.6.7}).




The coherent continuation representation  $\Coh_{\Lambda}(\CK(G))$ is independent of $Q$ in the sense of the following lemma.
\begin{lem}%(\cf \cite[Lemma 7.2.6]{Vg})
Let $\Lambda_\g$ be a $Q_\g$ coset in $\Lambda$.  Form the coherent continuation representation $\Coh_{\Lambda_\g}(\CK(G))$ by using the adjoint representation $G\rightarrow \Ad(\g)$. Then the restriction yields a linear isomorphism
\[
  \Coh_{\Lambda}(\CK(G))\xrightarrow{\sim} \Coh_{\Lambda_\g}(\CK(G)).
\]
\end{lem}
\begin{proof}
Note that the restriction yields a bijective map
\[
   \cP_{\Lambda}(G)\rightarrow  \cP_{\Lambda_\g}(G).
\]
This implies the lemma. %Pick a regular element $\lambda\in \Lam$. Extending Lemma \ref{lem21} (with the same proof), we know that
%the evaluation map   (at $\lambda$)
%  \[
%   \mathrm{ev}_{\lambda , \sfS}: \Coh_{[\lambda]_\iota}(\CK_\sfS(G))\rightarrow \CK_{\lambda,\sfS}(G)
%\]
%is also bijective. This clearly implies the lemma.
\end{proof}


We have the cross action of $W_{\Lambda}$ on the set $ \sP_{\Lambda}(G)$ (see \cite{V4}*{Definition~4.2}):
% (see \cite[Definition 8.3.1]{Vg}):
\[
  w\cross(H, \xi, \Gamma)=\left(H, \xi w^{-1}, (\nu\mapsto \Gamma_\nu\otimes (\xi w^{-1}\nu+\delta(\xi w^{-1})-\xi \nu-\delta(\xi)) )\right).
\]
This commutes with the action of $G$ and thus descends to an action
\[
 W_{\Lambda}\times   \cP_{\Lambda}(G)\rightarrow \cP_{\Lambda}(G), \quad (w, \gamma)\mapsto w\cross \gamma.
 \]


Since $G$ is in Harish-Chandra's class, the real Weyl group
\[
W_H:=\textrm{(the normalize of $H$ in $G$)}/H
\]
 is identified with a subgroup of the Weyl group $W_\h$ of $\g$ with respect to $\h$.
Write $\t_{\mathrm{im}}$ for the subspace of $\t$ spanned by the set $\{\check \alpha\mid \alpha \textrm{ is an imaginary root in $\Delta_\h$}\}$. Then $W_H$ stabilizers $\t_{\mathrm{im}}$, and we define a character
\[
  \mathrm{sgn}_\mathrm{im}: W_H\rightarrow \C^\times, \quad w\mapsto \textrm{(the determinant of the map $w: \t_{\mathrm{im}}\rightarrow \t_{\mathrm{im}}$)}.
\]
This is a quadratic character.

Let $\gamma\in \cP_{\Lambda}(G)$. Write $W_{\gamma}$ for the stabilizer of $\gamma$ in $W_{\Lambda}$ under the cross action.
Pick an element $\upgamma=(H, \xi, \Gamma)\in   \sP_{\Lambda}(G)$ that represents $\gamma$.
It is clear that $\xi w \xi^{-1}\in W_H$ for all $w\in W_{\gamma}$. We define a quadratic character
\[
  \mathrm{sgn}_{\gamma}: W_{\gamma}\rightarrow \C^\times, \qquad w\mapsto \mathrm{sgn}_\mathrm{im}(\xi w \xi^{-1}).
\]
This is independent of the choice of $\upgamma$.


The coherent continuation representation may be computed by using the basis  $\set{\Psi_{\gamma}}_{\gamma\in \cP_{\Lambda}(G)}$ (see \cite[Section 14]{V4}).
The following result is due to Barbasch-Vogan, in a suitably modified form from \cite{BV.W}*{Proposition~2.4}. As its proof follows the same line as that of \cite{BV.W}*{Proposition~2.4}, we will be contented to state the precise result.

%based on the results of \cite{Vg}*{Chapter 8}.

\begin{thm}[{\cf \cite{BV.W}*{Proposition~2.4}}]
  \label{thm:cohHC}
As a representation of $W_{\Lambda}$,
  \[
    \Coh_{\Lambda}(\CK(G)) \cong \bigoplus_{\gamma}
    \Ind_{W_{\gamma}}^{W_{\Lambda}}  \mathrm{sgn}_{\gamma},
  \]
  % \[
  %   \Coh_{[\lambda]}(\CK(G)) \cong \bigoplus_{H} \bigoplus_{\overline \gamma\in \overline \Irr_\Lam(H)}
  %   \Ind_{W_{\overline \gamma}}^{W_\Lam}  \mathrm{sgn}_{\overline \gamma},
  % \]
  where $\gamma$ runs over a representative set of the $W_{\Lambda}$-orbits
  in $\cP_{\Lambda}(G)$ under the cross action.
\end{thm}



\subsection{Some properties of the coherent continuation representation $\Coh_{\Lambda}(\CK(G))$}




For every $\nu\in \Lambda$, by evaluating at $\nu$ we get a linear map
\[
    \ev{\nu} \colon  \Coh_{\Lambda}(\CK(G)) \rightarrow \Grt_{\nu}(G).
\]

We first present a number of lemmas concerning $\ev{\nu}$, %, basic properties of the coherent continuation representation.
%We present a number of lemmas,  all of
which may be found in (or easily deduced from) \cite{Vg,V4}.


 \begin{lem}\label{lem21}
Let  $\nu\in \Lambda$. The map  $\ev{\nu}$ is surjective, and it is bijective when $\nu$ is regular.
\end{lem}
\begin{proof}
The surjectivity is due to Schmid and Zuckerman, see  \cite{Vg}*{Theorem~7.2.7}.
The injectivity (for $\nu$ regular)  is due to Schmid, see \cite{Vg}*{Proposition~7.2.23}.
\end{proof}



\begin{lem}\label{annlc}
Let $\Psi$ be a basal element in $\Coh_\Lambda(\CK(G))$. Then there is a unique left cell $\CC^L_\Psi$ in  $\Coh_\Lambda(\CK(\g,\b))$ such that $ \Ann(\Psi(\nu))=I_{\nu, \CC^L_\Psi}$ for every dominant element $\nu\in \Lambda$.
\end{lem}
\begin{proof}
Since a coherent family restricted to the dominant cone can be constructed via the translation functor,
 the proposition follows from \cite{V1}*{Lemma~2.7 and Lemma~2.8}.
\end{proof}


For every  basal element $\Psi\in \Coh_\Lambda(\CK(G))$, define its $\tau$-invariant to be
 $\tau_\Psi:=\tau_{\CC^L_\Psi}$,  where $\CC^L_\Psi$ is as in \Cref{annlc}.
For every simple reflection $s$ in $W(\Lambda)$, $s\in \tau_\Psi$ if and only if
$s\cdot \Psi=-\Psi$ (see \cite{Vtau}*{Theorem~2.4} and \cite{Vg}*{Proposition~7.3.7}).


\begin{lem}\label{lemirr} (\cite{V4}*{Corollary~7.3.23})
Let $\nu\in \Lambda$ be a dominant element.
Then for every  basal element $\Psi\in \Coh_\Lambda(\cK(G))$,  $ \Psi(\nu)$ is
\[
\left\{
\begin{array}{ll}
irreducible,\quad & \text{if $\tau_{\Psi}\cap W_\nu = \emptyset$;}\\
%\textrm{if there is no element of   $ \tau_{\bar\gamma}$  that fixes $\nu$};\\
0, \quad &\textrm{otherwise}.
\end{array}
\right.
\]
Moreover, for every basal element $\Phi \in \Coh_\Lambda(\cK(G))$, if  $\Phi (\nu)=\Psi(\nu)\neq 0$, then $\Phi =\Psi$.
%      If $\overline \Psi_w(\nu)\neq 0$, then the associated variety of   $\mathrm J(w\cdot \nu)$ equals the Zariski closure $\overline \CO_{\Lambda, w}\subset \g^*$ of $\CO_{\Lambda, w}$.
\end{lem}

Let $\CC^{LR}$ be a double cell in $\Coh_\Lambda(\CK(\fgg,\b))$. Define
$\Coh_{\Lambda, \CC^{LR}}(\CK(G))$ to be the basal subspace of $\Coh_\Lambda(\CK(G))$ spanned by all the basal elements $\Psi$ such that $\CC^L_\Psi\subseteq \la \CC^{LR}\ra_{LR}$.
Recall that $\la \CC^{LR}\ra_{LR}$ denotes the smallest basal subrepresentation of $\Coh^{LR}_\Lambda(\CK(\fgg,\b))$ containing $\CC^{LR}$.

\begin{lem}\label{annl2} For every double cell $\CC^{LR}$ in $\Coh_\Lambda(\CK(\fgg,\b))$, the
space $ \Coh_{\Lambda, \CC^{LR}}(\CK(G))$ is a basal $W(\Lambda)$-subrepresentation of $\Coh_{\Lambda}(\CK(G))$.
\end{lem}
\begin{proof}
By passing to a suitable covering group, we  assume without loss of generallity that the derived group of $G_\C$ is simply connected.

Let $\Psi$ be a basal element in $\Coh_{\Lambda, \CC^{LR}}(\CK(G))$, and let $\alpha$ be a simple root in $\Delta(\Lambda)$. We need to show that $s_\alpha\cdot \Psi\in \Coh_{\Lambda, \CC^{LR}}(\CK(G))$, where $s_\alpha\in W(\Lambda)$ is the simple reflection associated to $\alpha$.

Our assumption of simply connectedness implies that there is a regular dominant element $\mu\in \Lambda$ such that $\la \mu, \check \alpha \ra \in 2\Z$. Put
\[
\nu:=  \mu - \frac{ \inn{\mu}{\ckalpha}}{2} \, \alpha\in \Lambda,
\]
which is a dominant element such that $W_\nu=\{1, s_\alpha\}$.

If $\Psi(\nu)=0$, then $s_\alpha\cdot \Psi=-\Psi\in \Coh_{\Lambda, \CC^{LR}}(\CK(G))$.
Now we assume that $\Psi(\nu)\neq 0$. Then $\Psi(\nu)$ is irreducible.


Let $F$ denote the irreducible representation of $G$ with extremal weight  $\half \inn{\mu}{\ckalpha}\alpha$ that occurs in the symmetric power $\oS(\g)$.
Then there are two nonzero $G$-homomorphisms
\[
\Psi(\mu)\xrightarrow{\iota_1} \Psi(\nu)\otimes F\xrightarrow{\iota_2}  \Psi(\mu)
\]
such that $\iota_2\circ \iota_1=0$.
Moreover,
$\Psi(\mu)$  occurs
in the composition series of $\Psi(\nu)\otimes F$ with multiplicity two, and
\be\label{sap2}
 ( s_\alpha\cdot \Psi)(\mu)=\mathrm{Pr}_\mu(\Psi(\nu)\otimes F)-\Psi(\mu)\in \CK(G),
\ee
where $\mathrm{Pr}_\mu$ denotes the projection map
\be\label{prinf}
 \mathrm{Pr}_\mu: \CK(G)=\bigoplus_{\lambda\in W\backslash \hha^*} \CK_\lambda(G)\rightarrow \CK_\mu(G).
\ee
See \cite{Vg}*{Theorem~7.3.16 and Corollary ~7.3.18}.


By \eqref{sap2}, we know that $s_\alpha\cdot \Psi$ is a positive integral linear  combination of basal elements of  $\Coh_{\Lambda}(\CK(G))$.
Let $\Psi'$ be a basal element that occurs in the  positive integral combination. Then
\[
  \Ann(\Psi'(\mu)) \supseteq \Ann((\Psi(\nu)\otimes F)).
\]

Pick an element $w\in W$ such that  $\Ann(\Psi(\mu)) =\Ann(\bPsi_w(\mu))$, where $\bPsi_w$ is defined as in \eqref{psibarw}.
The  translation principle \cite{V1}*{Lemma~2.7} implies that
$\Ann(\Psi(\nu)) = \Ann(\overline \Psi_w(\nu))$. In particular, $\bPsi_w(\nu)$ is nonzero and hence irreducible.

As in the group case,  $\bPsi_w(\mu)$ occurs as a subrepresentation of $\Psi(\nu)\otimes F$ (and also as a quotient representation), and occurs in
the composition series of $\bPsi_w(\nu)\otimes F$ with multiplicity two. Moreover,
\be\label{sap3}
 ( s_\alpha\cdot \bPsi_w)(\mu)=\mathrm{Pr}_\mu(\bPsi_w(\nu)\otimes F)-\bPsi_w(\mu)\in \CK(\g,\b),
\ee
where $\mathrm{Pr}_\mu$ denotes  the projection map analogous to \eqref{prinf}.

We have an ideal  $I\subset \CU(\g)$ that is a finite product of primitive ideals of $\CU(\g)$ with infinitesimal character distinct from $\mu$,
and a sequence $w_1, w_2, \cdots, w_{k-1}, w_k=w$ in $W$ ($k\in \BN^+$) such that
\[
\Ann(\bPsi_w(\nu)\otimes F)\supseteq \Ann (\bPsi_{w}(\mu))\cdot \Ann (\bPsi_{w_1}(\mu))\cdot \Ann (\bPsi_{w_2})(\mu)\cdot \dots \cdot  \Ann( \bPsi_{w_k}(\mu)) \cdot I,
\]
and
\[
  ( s_\alpha\cdot \bPsi_w)= \bPsi_{w_1}+\bPsi_{w_1} \cdots+ \bPsi_{w_k}\in \CK(\g,\b).
\]

Then
\[
  \Ann(\Psi'(\mu))\supseteq \Ann (\bPsi_{w}(\mu))\cdot \Ann (\bPsi_{w_1}(\mu))\cdot \Ann (\bPsi_{w_2}(\mu))\cdot \dots \cdot  \Ann (\bPsi_{w_k}(\mu))\cdot I.
\]
Since the primitive ideal $\Ann(\Psi'(\mu))$ is prime,
%and $w=w_i$ for some $i\in\{1,2,\dots, k\}$,
this  implies that $\Ann(\Psi'(\mu))\supseteq \Ann(\bPsi_{w_i}(\mu))$
for some $i\in \{1,2, \dots,k\}$. Hence $\CC^L_{\Psi'} \subset \la \bPsi_{w_i}\ra_L$ by \Cref{primitiveii}.
On the other hand, $\bPsi_{w_i}$ is in $\braket{\bPsi_w}_{R}$.
We conclude that $\Psi'\in \Coh_{\Lambda, \CC^{LR}}(\CK(G))$. The proof is complete.
\end{proof}


\subsection{The coherent continuation representation $\Coh_\Lambda(\CK(\fgg,H, \b'))$}


  Let $H$ be a Cartan subgroup of $G$. Let $\b'$ be a Borel subalgebra of $\g$ containing the complexified Lie algebra $\h$ of $H$.  Recall that a $(\g, H)$-module is defined to be a $\g$-module $V$ together with a locally-finite representation of $H$ on it such that
     \begin{itemize}
     \item
        $h\cdot (X\cdot (h^{-1}\cdot u))=(\Ad_h(X))\cdot u$, for all $h\in H, X\in \CU(\g), u\in V$ ($\Ad$ stands for the Adjoint representation);
        \item the differential of the representation of $H$ and the restriction of the representation of $\g$ yields the same representation of $\h$ on $V$.
     \end{itemize}


Let $\Rep(\g,H,\b')$ denote the category of finitely generated $(\g, H)$-modules that  are unions of finite-dimensional $\b'$-submodules.
As before, we form the Grothendieck group  $\CK(\g,H, \b')$, and the coherent continuation representation $\Coh_{\Lambda}(\CK(\g,H, \b'))$ of $W(\Lambda)$.



Write $\sP_{\Lambda}(\g, H, \b')$ for the set of all pairs $(w, \Gamma)$ where $w\in W$, and
\[
\Gamma:   \Lambda\rightarrow \Irr(H), \quad \nu\mapsto \Gamma_\nu
\]
is a map
 such that
\begin{itemize}
  \item $\Gamma_{\nu+\beta}=\Gamma_\nu\otimes \xi_{\b'}(\beta)$ for all $\beta\in Q$ and $\nu\in \Lambda$;
  \item $\mathrm d  \Gamma_\nu= \xi_{\b'}(w\nu-\rho)$ for all $\nu\in  \Lambda$.
  \end{itemize}
Here  $\xi_{\b'}$ is defined in \cref{xib00},  $\xi_{\b'}(\beta)$ is viewed as a character of $H$ by  pulling-back through
the homomorphism $\iota: H\rightarrow H_\C$,
and $H_\C$ is the Cartan subgroup of $G_\C$ containing $\iota(H)$.
%\xi_{\b'}

\def\olgamma{\overline\gamma}
\def\olPsi{\overline\Psi}
\def\olrX{\overline\rX}



For each $\sigma\in \Irr(H)$, put
\[
  \mathrm M(\sigma):=\CU(\g)\otimes_{\CU(\b')} \sigma,
\]
which is a module in $\Rep(\g,H,\b')$, where the $\CU(\g)$-action is given by the left multiplication, and the $H$-action is given by
\[
 h\cdot (X\otimes u):=\Ad_h(X)\otimes h \cdot u, \qquad h\in H, \, X\in \CU(\g),\, u\in \sigma.
\]
As before, the $(\g,H)$-module $\mathrm M(\sigma)$ has a unique irreducible quotient, to be denoted by $\mathrm L(\sigma)$.



For each $(w, \Gamma)\in\sP_{\Lambda}(\g,H,\b')$,  we  have two $\CK(\g,H,\b')$-valued coherent families  $\Psi_{w,\Gamma}$ and $\olPsi_{w, \Gamma}$ on $\Lambda$  such that
\begin{equation}\label{eq:psigamma}
  \Psi_{w,\Gamma}(\nu)=\mathrm M(\Gamma_\nu) \quad\textrm{for all $\nu\in \Lambda$},
  \end{equation}
  and
  \begin{equation}
  \olPsi_{w,\Gamma}(\nu)=\mathrm L(\Gamma_\nu) \quad\textrm{for all regular dominant element $\nu\in \Lambda$}.
\end{equation}
As before, both
$\{ \Psi_{w,\Gamma}\}_{(w,\Gamma)\in\sP_{\Lambda}(\g,H,\b')}$ and $\{ \olPsi_{w,\Gamma}\}_{(w,\Gamma)\in\sP_{\Lambda}(\g,H,\b')}$ are bases of $\Coh_{\Lambda}(\CK(\g,H, \b'))$. We view $\Coh_{\Lambda}(\CK(\g,H, \b'))$ as a basal representation of $W(\Lambda)$ by using the second basis.

The analog of \Cref{annlc}  for   $\Coh_\Lambda(\CK(\g, H, \b'))$ still holds (with the same proof), and we define similarly the left cell $\CC^L_\Psi$ in  $\Coh_\Lambda(\CK(\g,\b))$ for every basal element $\Psi\in \Coh_\Lambda(\CK(\g, H, \b'))$.


Let $\CC^{LR}$ be a double cell in $\Coh_\Lambda(\CK(\fgg,\b))$ as before. Define
$\Coh_{\Lambda, \CC^{LR}}(\CK(\g,H,\b'))$ to be the basal subspace of $\Coh_\Lambda(\CK(\g,H,\b'))$ spanned by all the basal elements $\Psi$ such that $\CC^L_\Psi\subseteq \la \CC^{LR}\ra_{LR}$.
By the same argument as that of \Cref{annl2}, the space $ \Coh_{\Lambda, \CC^{LR}}(\CK(\g,H,\b'))$ is a basal $W(\Lambda)$-subrepresentation of $\Coh_{\Lambda}(\CK(\g,H,\b'))$.






 \begin{lem}\label{lem0022}
The representation $\Coh_{\Lambda, \CC^{LR}}(\CK(\g,H, \b'))$ of $W(\Lambda)$ is isomorphic to a subrepresentation of $(\la \CC^{LR}\ra_{LR})^k$, for some $k\in \BN$.
     \end{lem}
\begin{proof}

%Write $H_\C$ for the Cartan subgroup of $G_\C$ containing $\iota(H)$. Using $\b$,
%the lattice $Q$ is identified  with the lattice of holomorphic characters on $H_\C$.

%By pulling-back through the homomorphism $H\rightarrow H_\C$, we also view $Q$ as a set of characters on $H$.
%The tensor product $\beta\otimes \gamma\in \Irr(H)$ is defined for every $\beta\in Q$ and $\gamma\in \Irr(H)$.
%This yields a free action of $Q$ on the set $\Irr(H)$.
Let $Q$ act on the set $\Irr(H)$ by
\[
   \beta\cdot \sigma=\sigma\otimes \xi_{\b'}(\beta), \qquad\beta\in Q, \ \sigma\in \Irr(H),
\]
where $\xi_{\b'}(\beta)$ is as in \eqref{xib00}.
For each $Q$-orbit $\Omega \subset \Irr(H)$, let $\Rep_{\Omega}(\g,H,\b')$ be the full subcategory of $\Rep(\g,H,\b')$
whose objects are modules $V$ such that every irreducible subquotient of $V|_H$ (viewed as a representation of $H$) belongs to $\Omega$.
Write $\CK_{\Omega}(\g,H,\b')$ for the  Grothendieck group of the category $\Rep_{\Omega}(\g,H,\b')$. Then $\Coh_{\Lambda}(\CK_{\Omega}(\g,H,\b'))$ is a basal $W(\Lambda)$-representation.
%Then  we have a decomposition
%\[
%\CK_\sfS(\g,H,\b)=\bigoplus_{\Gamma\in Q\backslash \Irr(H)} \CK_{\sfS,\Gamma}(\g,H,\b)
%\]
%as $\mathcal R(\g,Q)$-modules, and as $W_\Lambda$-modules
As $W(\Lambda)$-representations,
\[
\Coh_{\Lambda, \CC^{LR}}(\CK(\g,H, \b'))=\bigoplus_{i=1}^k
\Coh_{\Lambda, \CC^{LR}}(\CK_{\Omega_i}(\g,H,\b')),
%\Coh_{\Lambda, \CC^{LR}, \Omega_i}(\g,H, \b'),
\]
where $\Omega_1, \Omega_2, \cdots, \Omega _k$ ($k\in \bN$) are  certain
$Q$-orbits in $\Irr(H)$, and
\[
\Coh_{\Lambda, \CC^{LR}}(\CK_{\Omega_i}(\g,H,\b')):=\Coh_{\Lambda}(\CK_{\Omega_i}(\g,H,\b'))\cap
\Coh_{\Lambda, \CC^{LR}}(\CK(\g,H, \b')).
\]




Define a linear isomorphism
\[
  T_{\b, \b'}: \CK(\g,\b)\rightarrow \CK(\g,\b')
  \]
  such that $T_{\b,\b'}(\mathrm M(\g,\b,\nu))= \rM(\g,\b',\nu)$ for all $\nu\in \hha^*$.
The map  $ T_{\b, \b'}$ is $W$-equivariant and induces an isomorphism
\[
  \Coh_{\Lambda}(\CK(\g,\b))\rightarrow \Coh_{\Lambda}(\CK(\g,\b')).
\]
By using this isomorphism we  assume without loss of generality that $\b = \b'$.

Denote by $\cF$ the forgetful functor from
$\Rep(\g,H,\b')$ to $\Rep(\g,\b')$.
Since $\Psi\mapsto \cF\circ \Psi$ gives an injective $W(\Lambda)$-homomorphism
from $\Coh_{\Lambda, \CC^{LR}}(\CK_{\Omega_i}(\g,H,\b'))$
to $\braket{\CC^{LR}}_{LR}$,  the lemma follows.
%$\Coh_{\Lambda, \CC^{LR}}(\CK(\g, \b'))$, the lemma follows.
%The lemma now follows from the fact that $\Coh_{\Lambda, \CC^{LR}}(\CK(\g, \b'))$
%is naturally isomorphic to $\braket{\CC^{LR}}_{LR}$.
%since cell structure on
%$W(\Lambda)$ is independent of the choice of the Borel subalgebra $\b'$.
\end{proof}


%
%\begin{lemma}
%Let $\CC$ be an Harish-Chandra cell,
%\end{lemma}
%
%\begin{cor}
%Let $\CCLR$ be the double cell containing $\CC^L_\Psi$ for any $\Psi \in \CC$.
%    $\Set{\Ann(\Psi(\nu))| \Psi\in  \CC} = \Set{\Ann(\bPsi_w(\nu))| \bPsi_w\in \CCLR}$.
%\end{cor}
%
%

\subsection{An embedding of  coherent continuation representations}
As before $\CC^{LR}$ is a double cell in $\Coh_\Lambda \CK(\fgg,\b)$. The purpose of this subsection is to prove the following proposition.


\trivial[h]{
There are two possibilities:
%\begin{enumerate}[label={$\bullet$}]
%\item
%Suppose
If $\Psi(\nu)$ is zero, then $s_\alpha(\Psi) = -\Psi \in \Coh_{\Lambda, \CC^{LR}}(\CK(G))$
(see \cite{Vg}*{ Propositoin~7.3.7}).
%\item
Otherwise $\Psi(\nu)$ is nonzero.
Let $F$ be the irreducible representation of $G$ occurring in $S(\fgg)$ with extermal weight
$\lambda-\nu$.
Then there is a natural chain complex of non-zero maps
\[
\Psi(\lambda)\xrightarrow{\iota}  {\Pr}_{\lambda}(\Psi(\nu)\otimes F)\rightarrow  \Psi(\lambda)
\]
and $(s_\alpha\cdot \Psi)(\lambda)$ is the image of ${\Pr}_{\lambda}(\Psi(\nu)\otimes F)/\Im(\iota)$ in
$\CK(G)$ (see \cite{Vg}*{Theorem~7.3.16}).
In particular,  we can write $s\cdot \Psi = \sum_{i}n_i \Psi_i$,
where $n_i$ are some positive integers and $\Psi_i$ runs over the set of basal elements such that $\Psi_i(\nu)$ occurs as an irreducible subquotient in $\Psi(\nu)\otimes F$.
A similar statement holds for $\bPsi_w$ (with the same proof), namely $s_\alpha \cdot \bPsi_w = \sum_j m_j\bPsi_{w_j}$,
where $m_j$ are positive integers and  $\bPsi_{w_j}$ runs over basal elements such that  $\bPsi_{w_j}(\nu)$ occurs as a subquotient in $\bPsi_w(\nu)\otimes F$.
Now
\[
\Ann(\Psi_i(\lambda)) \supset \Ann((\Psi(\nu)\otimes F))
= \Ann((\bPsi_w(\nu)\otimes F))
\supset \Ann(\bPsi_{w_{j_1}}(\lambda)) \Ann(\bPsi_{w_{j_2}}(\lambda))\cdots \Ann(\bPsi_{w_{j_k}}(\lambda))\prod_{l} I_l.
\]
Here $I_l$
are some primitive ideals with infinitesimal character different from $\lambda$
and $w_{j_1},w_{j_2}, \cdots, w_{j_k}$ is a sequence of elements in $\set{w_j}$.
Since $\Ann(\Psi_i(\lambda))$ is a prime ideal with infinitesimal character $\lambda$, we conclude that
$\Ann(\Psi_i(\lambda)) \supset \Ann(\bPsi_{w_{j_k}}(\lambda))$ for some $k$.
By definition of cone representation, $\bPsi_{w_j} \in \braket{\CC^{LR}}$.
Hence $\Psi_i\in \Coh_{\Lambda, \CC^{LR}}(\CK(G))$.

The lemma is proved.
}





\begin{prop}\label{lem0033}
The representation $ \Coh_{\Lambda, \CC^{LR}}(\CK(G))$  of $W(\Lambda)$ is isomorphic to a subrepresentation of $(\la \CC^{LR}\ra_{LR})^k$, for some $k\in \BN$.
\end{prop}

%\subsection{A result of Casian}
% Similar to the subspace $\Grt_{\lambda, \sfS}(G)\subset \Grt(G)$ ($\lambda\in \hha^*$),
% we define the subspace
% \[
% \Grt_{\lambda, \sfS}(\g,H,\b)\subset \Grt(\fgg,H,\b)
% \]
% in the obvious way.
Let $\set{H_1, H_2, \cdots, H_r}$ ($r\in \bN^+$) be a set of representatives of the
conjugacy classes of Cartan subgroups of $G$. For each $i=1,2,\cdots, r$,
fix a Borel subalgebra $\b_i$ of $\g$ that contains the complexified Lie algebra of $H_i$.
%Without lost of generality, we assume $H_1$ is a maximally split Cartan subgroup.

 \begin{lem}\label{cor:HC.embed}
  % [\cite{Cas}*{Theorem~3.1}]
 There is an injective $\mathcal R(\g, Q)$-module homomorphism
 \[
\gamma_{G}: \Grt(G)\rightarrow  \bigoplus_{i=1}^{r} \Grt(\fgg,H_{i},\b_{i})
 \]
 such that
 \be\label{gammag}
   \gamma_{G}(\CK_I(G))\subset  \bigoplus_{i=1}^{r} \Grt_{I}(\fgg,H_{i},\b_{i})
 \ee
 for every ideal $I$ of $\CU(\g)$.
% that is a finite product of primitive ideals of $\CU(\g)$.
 Here $\CK_I(G)$ is the Grothedieck group of $\Rep_I(G)$,  $\Rep_I(G)$ is the full subcategory of $\Rep(G)$ consisting of the representations that are annihilated by  $I$, and $\Grt_{I}(\fgg,H_{i},\b_{i})$ is the similarly defined subspace of $\Grt(\fgg,H_{i},\b_{i})$.
 \end{lem}
\begin{proof}
This follows from the work of Casian (\cite{Cas}).
%See also {\cite{Mc}}.
Since the proposition is not explicitly stated in \cite{Cas},
we briefly recall the argument of Casian for the convenience of the reader.



 Let $\n_i$ denote the nilpotent radical of $[\g,\g]\cap \b_i$ ($i=1,2, \cdots,r$).
 For every $q\in \Z$, let $\gamma_{\n_i}^q$ denote the $q$-th right derived functor of the following left exact functor from the category of $\g$-modules to itself:
 \[
   V\rightarrow \{u\in V\,|\, \n_i^k \cdot u=0\textrm{ for some $k\in \bN^+$}\}.
 \]

Fix a Cartan involution $\theta$ of $G$ and write $K$ for its fixed point group (which is a maximal compact subgroup of $G$).  Without loss of generality we assume that all $H_i$'s are $\theta$-stable.

For every Casselman-Wallach representation $V$ of $G$, write $V_{[K]}$ for the space of $K$-finite vectors in $V$, which is a $(\g,K)$-module of finite length. Then   $\gamma_{\n_i}^q(V_{[K]})$ is naturally a representation in $\Rep(\g, H_i, \b_i)$ (\cite[Corollary 4.9]{Cas}).

We define a linear map
 \[
\gamma_{G}: \Grt(G)\rightarrow  \bigoplus_{i=1}^{r} \Grt(\fgg,H_{i},\b_{i})
 \]
 given by
 \[
   \gamma_{G}(V)= \left\{\sum_{q\in \Z} (-1)^{q} \gamma^{q}_{\n_i}(V_{[K]})\right\}_{i=1,2, \cdots, r}
 \]
for every Casselman-Wallach representation $V$ of $G$. A form of the Osborne conjecture
%The Osborne conjecture
(see \cite[Theorem 3.1]{Cas}) and \cite[Corollary 4.9]{Cas}) implies that the map $\gamma_{G}$ is well-defined and injective.

Proposition~4.11 of \cite{Cas} implies that the functor $\gamma_{\n_i}^q$ commutes with tensor product with finite-dimensional representations. Thus $\gamma_{G}$ is a $\mathcal R(\g, Q)$-homomorphism. Finally, \cite[Corollary 4.15]{Cas} implies that $\gamma_{G}$ satisfies the property in \eqref{gammag}.
\end{proof}


\begin{proof}[Proof of \Cref{lem0033}]
\Cref{cor:HC.embed} implies that the representation $\Coh_{\Lambda,\CCLR}(\CK(G))$
of $W(\Lambda)$ is isomorphic to a subrepresentation of
$\bigoplus_{i=1}^r \Coh_{\Lambda,\CCLR}(\CK(\g,H_i,\b_i))$.
Together with  \Cref{lem0022}, this implies \Cref{lem0033}.
\end{proof}


%We record the following lemma in \cite{Cas}.
%\begin{lem}
%Let $H_1$ be a maximally split Cartan subgroup of $G$ and
%$\fbb_1$ be a Borel subalgebra of $\fgg$ that contains the complexified
%Lie algebra of $H_1$.
%Let
%\[
%\gamma_{\fnn_i}(V) = \sum_{q\in \Z} (-1)^{q} \gamma^{q}_{\n_i}(V_{[K]})
%\]
%
%Suppose $M$ is an irreducible Casselman-Wallach representation of $G$.
%Then $\gamma_{\fnn_1}(\pi)$ is the image of a $(\fgg, H_1,\fbb_1)$-module
%$\hat M$ such that  $\Ann(M) = \Ann(\hat M)$.
%\end{lem}
%\begin{proof}
% One can take $\hat M$ to be the Jacquet-Casselman module of $M$.
% See \cite{Cas}*{p~506}.
%\end{proof}

\subsection{Harish-Chandra cells and double cells}\label{subsec:tau-HC}

We now discuss the consequences of \Cref{lem0033}.
View $\Coh_{\Lambda}(\CK(G))$ as a basal representation of $W(\Lambda)$ and let $\CC$ be a cell in it, to be called a Harish-Chandra cell.


\begin{lem}
Suppose $\cC$ is a Harisch-Chandra cell. Then
there is a unique double cell $\CCLR$
such that $\CCL_{\Psi}\subset \CCLR$ for every basal element $\Psi$ in $\cC$.
\end{lem}
\begin{proof}
 pass
\end{proof}

Define the $\tau$-invariant of $\CC$ to be the set
\[
  \tau_\CC:=\{\tau_\Psi\mid \Psi\in \CC\}.
\]


Clearly $\tau_{\CC}$ is a prior a subset of $\tau_{\CCLR}$ where $\CCLR$ is the
double cell in $\CohLamO)$.


For every  basal element $\Psi\in \Coh_\Lambda(\CK(G))$,
 put
$\sigma_{\Psi}:= \sigma_{\CCLR_\Psi}$,
where $\CCLR_\Psi$ is the  double cell in $\Coh_\Lambda(\CK(\fgg,\b))$
containing $\CCL_\Psi$, and  $\CCL_\Psi$ is the left cell in Proposition \ref{annlc}.


{\bf Working Hypothesis:}




%For each basal element $\Psi$ in $\Coh_\Lambda(\cK(G))$, we let $\cO_\Psi$ denote the nilpotent orbit attached
%to $\Psi$ in \Cref{asshc00}.

 \begin{prop}\label{hcass22}
Among all irreducible representations of $W(\Lambda)$ that occur in
$\braket{\CC}$, there is a unique one,
to be denote by $\sigma_\CC$, that has minimal fake degree.
Moreover, $\tau_\CC=\tau_{\sigma_\CC}$, and   $\sigma_\CC = \sigma_{\Psi}$ for all  $\Psi\in  \CC$.
%and each dominant element $\nu\in \Lambda$ such that  $\Psi(\nu)\neq 0$,
%$\sigma_{\nu, \Ann(\Psi(\nu))}\cong \sigma_\CC$.
\end{prop}
\begin{proof}

By \cite{V4}*{Theorem~14.10} (see also \cite{King} and \cite{Cas}*{Theorem~3.4}), there is a $W(\Lambda)$-equivariant linear map
 \be\label{ch000}
   \mathrm{ch}: \Coh_\Lambda(\CK(G))(\CC)\rightarrow \mathrm S(\hha)
 \ee
with the following properties:
\begin{itemize}
    \item for every  $\Psi\in \CC$, the image of the class of $\Psi$ under the map \eqref{ch000} equals $p_{\CC^L_\Psi}$ up to a nonzero scalar multiplication;
    \item the image of $\eqref{ch000}$ is a special irreducible representation of $W(\Lambda)$, to be denoted by $\sigma_\CC$.
\end{itemize}

Let $\CC^{LR}$ be the double cell in $\Coh_\Lambda(\CK(\g,\b))$ corresponding to  $\sigma_\CC$ as in \Cref{cell00}. Then \Cref{dcrep33} implies that
\[
  \CC^{LR}= \bigcup_{\Psi\in \CC} \CC^L_\Psi.
\]
Consequently, $\sigma_\CC = \sigma_{\Psi}$ for every basal element $\Psi\in  \CC$.

By \Cref{eqtau0}, we have  that
\[
 \tau_\CC=\{\tau_{\CC_\Psi^L}\mid \Psi\in \CC\}=\tau_{\CC^{LR}}=\tau_{\sigma_\CC}.
\]

Finally, \Cref{lem0033} implies that $\braket{\CC}$ is isomorphic to
a subrepresentation of $(\braket{\CC^{LR}}_{LR})^k$ ($k\in \BN^+$), and \Cref{cell00} implies that $\sigma_\CC$ is the unique  irreducible representation of $W(\Lambda)$ with minimal fake degree that occurs in $(\braket{\CC^{LR}}_{LR})^k$.
Therefore $\sigma_\CC$ is also the  unique  irreducible representation of $W(\Lambda)$ with minimal fake degree that occurs in $\braket{\CC}$. This finishes the proof of the proposition.
\end{proof}



Let $\sigma_\CC$ be as in \Cref{hcass22}, to be called the special irreducible representation attached to $\CC$.
The following conjecture is widely anticipated, although to our knowledge no proof has appeared in the literature. See \cite[page 1055]{V4}.

\begin{conj}\label{conjcell}
%View  $\Coh_{\Lambda}(\CK(G))$ as a basal representation of $W(\Lambda)$. For  each cell $\CC $ in $\Coh_{\Lambda}(\CK(G))$,
The set
\[
 \{ \sigma\in \Irr(W(\Lambda))\mid \sigma\textrm{ occurs in the cell representation $\Coh_{\Lambda}( \CK(G))(\CC)$}\}
\]
is contained in the  double cell in $\Irr(W(\Lambda))$ containing $\sigma_\CC$.
\end{conj}


%\begin{remark}
%We call a double cell in  $\Irr(W_\Lambda)$ a Lusztig double cell. We also call a cell in  $\Coh_{\Lambda}( \CK(G))$ a Harish-Chandra cell, and the associated cell representation a Harish-Chandra cell representation.
%\end{remark}


The conjecture holds for unitary group by \cite{Bo}*{Theorem~5}. We note McGovern's observation (\cite[Page 213]{Mc}) which amounts to the  assertion in \Cref{conjcell} for linear groups. It appears to us that the argument is inadequate as presented. In what follows we will give a proof assuming a weak form of Vogan duality, which therefore works for linear groups and the real metaplectic group.

\trivial[h]{
\begin{remark}
We note McGovern's observation (\cite[Page 213]{Mc}) which amounts to the assertion in \Cref{conjcell}. It appears to us that the argument is inadequate as presented.
\end{remark}


McGovern claimed the conjecture for linear group and it appears to us that the argument is
inadequate as presented.
In the appendix we will give a proof using Vogan duality which works for the conjecture for linear group and the mateplectic group.
}

We consider a $5$-tuple $(G,G_\C, \iota: G\rightarrow G_\C, \Lambda, \CC)$, where the conditions required of the $4$-tuple $(G,G_\C, \iota: G\rightarrow G_\C, \Lambda)$ are specified in \Cref{extcoh}, and $\CC$ is a Harish-Chandra cell in $\Coh_{\Lambda}(\CK(G))$.

Let $(\check G,\check G_\C, \check \iota: \check G\rightarrow \check G_\C, \check \Lambda, \check \CC)$ be another $5$-tuple that has the same properties as the $5$-tuple $(G,G_\C, \iota: G\rightarrow G_\C, \Lambda, \CC)$.
Thus $\check \CC$ is a Harish-Chandra cell in $\Coh_{\check \Lambda}(\CK(\check G))$, considered as a basal representation of $\check W(\check \Lambda)$. Here $\check W$ is the Weyl group of the complexified Lie algebra of $\check G$, and $\check W(\check \Lambda)\subseteq \check W$ is the integral Weyl group attached to $\check \Lambda$.

We say  that $(\check G,\check G_\C, \check \iota: \check G\rightarrow \check G_\C, \check \Lambda, \check \CC)$ is a weak Vogan dual of $(G,G_\C, \iota: G\rightarrow G_\C, \Lambda, \CC)$ if there is given an identification  $W(\Lambda)=\check W(\check \Lambda)$ of Coxeter groups such that
    \[
    \Coh_{\check \Lambda}(\CK(\check G))(\check \cC) \cong (\Coh_{ \Lambda}(\CK( G))(\CC))\otimes \sgn
    \]
  as representations of $W(\Lambda)=\check W(\check \Lambda)$.
  \begin{lem}\label{lem:taudual}
  Suppose that $(\check G,\check G_\C, \check \iota: \check G\rightarrow \check G_\C, \check \Lambda, \check \CC)$ is a weak Vogan dual of $(G,G_\C, \iota: G\rightarrow G_\C, \Lambda, \CC)$. Then the $\tau$-invariants $\tau_{\check \CC}$ and $\tau_\CC$ are dual to each other.
  \end{lem}
\begin{proof}
  Write $M:=\Coh_\Lambda(\CK(G))(\CC)$, to be viewed as a representation of $W(\Lambda)$. Likewise write $\check M:=\Coh_{\check \Lambda}(\CK(\check G))(\check \CC)$, to be viewed as a representation of $\check W(\check \Lambda)$.
  Then by \cite{FJMN}*{Theorem~2.10},
  \[
  \tau_M=\tau_\CC,\quad\quad \tau_{\check M}=\tau_{\check \CC}.
  \]
 and $\tau_M$ is dual to  $\tau_{\check M}$. Therefore the lemma follows.
\end{proof}
\trivial[h]{
We say  that $(\check G,\check G_\C, \check \iota: \check G\rightarrow \check G_\C, \check \Lambda, \check \CC)$ is a Vogan dual of $(G,G_\C, \iota: G\rightarrow G_\C, \Lambda, \CC)$ if there is given an identification  $W(\Lambda)=\check W(\check \Lambda)$ of Coxeter groups and a bijection
\[
\CC\rightarrow \check \CC, \ \Psi\mapsto \check \Psi
\]
with the following properties:
\begin{itemize}
    \item as representations of $W(\Lambda)=\check W(\check \Lambda)$,
    \[
    \Coh_{\check \Lambda}(\CK(\check G))(\check \cC) \cong (\Coh_{ \Lambda}(\CK( G))(\CC))\otimes \sgn, \quad(\textrm{$\sgn$ denotes the sign character});
    \]
    \item for every $\Psi\in \CC$,
  \[
    \tau_{\check \Psi}=\Pi(\Lambda)\setminus \tau_\Psi.
      \]
\end{itemize}
}
\begin{prop}\label{DualHC}
  If the $5$-tuple $(G,G_\C, \iota: G\rightarrow G_\C, \Lambda, \CC)$ has a weak Vogan dual, then \[
 \{ \sigma\in \Irr(W(\Lambda))\mid \sigma\textrm{ occurs in the cell representation $\Coh_{\Lambda}( \CK(G))(\CC)$}\}
\]
is contained in the  double cell in $\Irr(W(\Lambda))$ containing $\sigma_\CC$.
  %\[
 %\{ \sigma\in \Irr(W(\Lambda))\mid \sigma\textrm{ occurs in the cell representation $\Coh_{\Lambda}( %\CK(G))(\CC)$}\}
%\]
%is contained in the  double cell in $\Irr(W(\Lambda))$ containing $\sigma_\CC$.
\end{prop}

\begin{proof}
Let  $(\check G,\check G_\C, \check \iota: \check G\rightarrow \check G_\C, \check \Lambda, \check \CC)$ be a weak Vogan dual of $(G,G_\C, \iota: G\rightarrow G_\C, \Lambda, \CC)$.
Similar to $\sigma_\CC$, we have a special representation $\sigma_{\check \CC}\in \Irrsp{(\check W(\check \Lambda))}$ associated to the Harish-Chandra cell $\check \CC$.



 Suppose that  $\sigma\in \Irr(W(\Lambda))$ occurs in the cell representation $\Coh_{\Lambda}( \CK(G))(\CC)$. Then \Cref{lem0033} implies that
 \[
 \sigma_\CC\leqLR  \sigma.
 \]
Since $\sigma\otimes \sgn$ occurs in the cell representation  $\Coh_{\check \Lambda}(\CK(\check G))(\check \cC)$, \Cref{lem0033} also implies that
\[
\sigma_{\check \CC}\leqLR  \sigma\otimes\sgn.
 \]
 Then \Cref{lrd} implies that
\[
\sigma\leqLR  \sigma_{\check \CC} \otimes\sgn.
 \]

 Since $\tau_{\check \CC}$ is dual to $\tau_{\CC}$ by \Cref{lem:taudual}, \Cref{hcass22} implies that $\tau_{\sigma_{\check \CC}}$ is dual to $\tau_{\sigma_{\CC}}$. Then \Cref{eqtau0} and \Cref{duald} imply that
 \[
   \sigma_{\check \CC}\otimes \sgn \approxLR \sigma_\CC.
 \]

 Finally we conclude that $\sigma_\CC\approxLR \sigma$ and the proposition is proved.
\end{proof}



 Since  weak Vogan duals exist for linear groups (\cite{V4}*{Corollary~14.9}) and  the real metaplectic group (\cite{RT2}*{Theorem~5.2}), we obtain the following corollary.


\begin{cor}\label{HCLU}
 Suppose that $G$ has a faithful finite-dimensional representation, or $G$ is isomorphic to the metaplectic group $\widetilde{\Sp}_{2n}(\R)$ ($n\in \BN$), then
 \[
 \{ \sigma\in \Irr(W(\Lambda))\mid \sigma\textrm{ occurs in the cell representation $\Coh_{\Lambda}( \CK(G))(\CC)$}\}
\]
is contained in the  double cell in $\Irr(W(\Lambda))$ containing $\sigma_\CC$.
\end{cor}
\trivial[h]{
\begin{proof}
Thanks to \Cref{DualHC}, the corollary follows from the existence of dual Harish-Chandra cell.
For linear groups, the Kazhdan-Lusztig conjecture (see \cite{V4}*{Theorem 12.17}) and the dual Harish-Chandra
cell exits by \cite{V4}*{Corollary~14.9}. The claims about the duality of $\tau$-invariants follows from the construction of dual Harish-Chandra cell \cite{V4}*{Theorem~11.1} and the explicit formula of $\tau$-invariants (see \cite{V4}*{Definition~12.2}.

The metaplectic group case is dealt by Renard-Trapa, (see\cite{RT2}*{Theorem~5.2},
the claims on the $\tau$-invariant follows the linear group case together with Adams-Barbasch's result (see \cite{RT2}*{Theorem~2.7~(3)}).
\cite{RT2}
\end{proof}
}
\trivial[h]{
\begin{proof}
 Suppose that  $\sigma\in \Irr(W(\Lambda))$ occurs in the cell representation $\Coh_{\Lambda}( \CK(G))(\CC)$.
 Let $\CC_\sigma^{LR}$ denote the  double cell in $\Coh_{\Lambda}( \CK(\g,\b))$ such that $\sigma$ occurs in the cell representation $\Coh^{LR}_{\Lambda}( \CK(\g,\b))(\CC_\sigma^{LR})$.
 \Cref{lem0033} implies that
 \[
 \la \CC_\sigma^{LR}\ra_{LR}\subseteq \la \CC^{LR}\ra_{LR}.
 \]

Let  $(\check G,\check G_\C, \check \iota: \check G\rightarrow \check G_\C, \check \Lambda, \check \CC)$ be a Vogan dual of $(G,G_\C, \iota: G\rightarrow G_\C, \Lambda, \CC)$. Fix a Borel subalgebra $\check \b$ of the complexified Lie algebra $\check \g$ of $\check G$.
Similar to $\sigma_\CC$, we have a special representation $\sigma_{\check \CC}\in \Irrsp{(\check W(\check \Lambda))}$ associated to the Harish-Chandra cell $\check \CC$.
Let $\check \CC^{LR}$ denote the double cell  in $\Coh_{\check \Lambda}( \CK(\check \g,\check \b))$ such that $\sigma_{\check \CC}$ occurs in the cell representation $\Coh^{LR}_{\check \Lambda}( \CK(\check \g,\check \b))(\check \CC^{LR})$.

\Cref{lem412} implies that $\tau_{\check \CC^{LR}}$ and $\tau_{\check \CC^{LR}}$ are dual to each other, in other words, $\check \CC^{LR}$ and $ \CC^{LR}$ are dual to each other.

Put $\check \sigma:=\sigma\otimes \sgn$. Then $\check \sigma$ occurs in the cell representation  $\Coh_{\check \Lambda}(\CK(\check G))(\check \cC)$.  \Cref{lem0033} also implies that
\[
 \la \CC_{\check \sigma}^{LR}\ra_{LR}\subseteq \la \check \CC^{LR}\ra_{LR}.
 \]





\end{proof}
}

\trivial[h]{
It suffices to consider the integral case.

Let $\cC$ be a fixed Harisch-Chandra cell.
Then we can build a W-graph and the cell representation is given by the W-graph.

Recall that $[\sigma:V(\cC)]\neq 0$ implies $\sigma_\cC \leqLR \sigma$.

By \cite{FJMN},
% The cell representation $V(\cC)$ has $\tau$
$\tau(\cC) = \set{\tau(v)|v\in \cC}$,
$\cktau(\cC) = \set{\Pi - \tau(v)|v\in \cC)}$,
\[
\max\tau(\cC) = \set{\text{maximal element in $\tau(\cC)$ under inclusion}},
\]
and
its sign-signature
\[
\sgn(\cC) = \set{A| A\subset T, T\in  \max\tau(\cC)}
= \set{A\subseteq \Delta^+| [\sgn_{W_A}:V(\cC)]\neq \emptyset}
= \sgn(V(\cC)) \supset \sgn(\sigma_{\cC}) .
\]

$\cC\leadsto \cC^{LR}$ where $\CCLR$ is a double cell of highest weight module.
\[
\tau(\CC) = \set{\tau(\Ann(v))| v\in \CC} =  \tau(\CCLR).
\]
\[
\tau(\ckcC)  = \cktau(\cC) = \cktau(\CCLR) =   \tau({(\cC^{LR})}^{\vee}).
\]



\[
V(\cC) = V(\ckcC) \otimes \sgn \
V(\CCLR) = V({\CCLR}^\vee) \otimes \sgn
\]
apply the

For a special representation $\sigma\in \Irr(W)$,
let $d(\sigma) = \text{the special representation in the cell of $\sigma\otimes \sgn$}$.
When $W$ is of classical type, $d(\sigma) = \sigma\otimes \sgn$.

Let $\CCLR$ be the double cell contains the Left cell/primitive ideal for
any $v\in \cC$. (The double cell is independ of the choice of $v\in \cC$).
We remark that the $\tau(\cC)$ is exactly the set $\tau(\CCLR)$

Let $\sigma_\cC$ be the special representation attached to $\cC$.
We have the map
\[
\cC \mapsto \tau(\cC) \mapsto \max\tau(\cC) \stackrel{1-1}{\mapsto} \sgn(V(\cC)) = \sgn(\sigma_\cC)
\]
This implies that the $\cC$ or the clan of the primitive ideals appeared in $\cC$
determine the sign signature of $\sigma_\cC$.

Same argument applies to $\ckcC$. So $\sgn(V(\cC)) = \sgn(\sigma_\ckcC)$.
On the other hand, the ``Vogan duality'' dose holds for highest weight modules.
So
$\sgn(\sigma_\ckcC) = \sgn(V(\ckcC) = \sgn(\cktau(\cC)) = \sgn(d(\sigma_\cC))$



Now the cell representation $V(\ckcC) = V(\cC)\otimes \sgn$ and
$V(\CCLR) = V({\CCLR}^\vee) \otimes \sgn$.

We have  $[\sigma: V(\cC)]\neq 0$ implies
\[
\sigma_{\CCLR} = \sigma_\cC \leqLR \sigma
\]
Apply the same argument to $\ckcC$,
\[
 \sigma_{{\CCLR}^\vee} = \sigma_{\ckcC}\leqLR \sigma\otimes \sgn.
\]

But
\[
\sigma_{\CCLR}\otimes \sgn \approxLR \sigma_{{\CCLR}^\vee}
\]

}

\section{Counting irreducible representations}\label{sec:counting}
%with a bounded complex associated variety} %\label{sec12}

%For each basal element $\Psi$ in $\Coh_\Lambda(\cK(G))$,

%we let $\cO_\Psi$ denote the nilpotent orbit attached
%to $\Psi$ in \Cref{asshc00}.

The purpose of this section is to prove two counting results on irreducible representations, valid for any $G$ satisfying a weak form of Vogan duality. When $G$ is linear or isomorphic to a real metaplectic group, the results appear as \Cref{Mcounteq} and \Cref{Mcountleq} in \Cref{subsec:countIrr}.

For every  basal element $\Psi\in \Coh_\Lambda(\CK(G))$, let $\cO_\Psi:=\cO_{\sigma_{\Psi}}\in \overline \Nil(\g^*)$ be the nilpotent orbit corresponding to $j_{W(\Lambda)}^{W}\sigma_\Psi$.
By the translation principle~\cite{V1}*{Lemma~2.7}, we have that
 \[
 \Ann(\Psi(\nu)) = \overline{\CO_{\Psi}}\qquad (\textrm{the Zariski closure of $\CO_\Psi$})
 \]
 for all dominant $\nu\in \Lambda$ such that   $\Psi(\nu))\neq 0$.
By the translation outside the dominant cone as in \cite{Vg}*{Proposition~7.3.11}, we have that
\[
\Psi\in\Coh_\Lambda( \cK_{\overline{\CO_{\Psi}}}(G)).
\]





%For each basal element $\Psi$ in $\Coh_\Lambda(\cK(G))$, we let $\cO_\Psi$ denote the nilpotent orbit attached
%to $\Psi$ in \Cref{asshc00}.

\trivial[h]{
\begin{prop}\label{asshc00}
Let  $\Psi\in \Coh_\Lambda(\cK(G))$ be a basal element.  %$\bar \gamma \in \cP_\Lambda(G)$.
Then there is a unique $\Inn(G)$-nilpotent orbit $\cO_\Psi$ in $\Nil(\fgg^*)$ such that
\begin{enumerate}[label=(\alph*),wide]
\item
 for all  dominant element $\nu\in \Lambda$ such that $\Psi(\nu)\neq 0$,
 the associated variety of $\Ann(\Psi(\nu))$ equals its Zariski closure $\overline{\cO_\Psi}$;
\item
for all $\lambda\in \Lambda$, $\Psi(\lambda)\in \CK_{\overline{\CO_{\Psi}}}(G)$.
\end{enumerate}
\end{prop}
\begin{proof}
  This follows directly from the translation principle, see
\cite[Lemma~2.7]{V1} and \cite[Lemma~4.3]{J2}.
\trivial[h]{\cite[Lemma~4.3]{J2} says tensoring finite dimensional representation keep the associated variety:
$\AV(M) = \AV(M\otimes E)$ where $E$ is finite dimensional.  }
\end{proof}
}

Recall that $\sfS$ is an $\Inn(\g)$-stable Zariski closed subset of $\mathrm{Nil}(\g^*)$.

\begin{lem}\label{prop:ev00000}
  For all $\nu\in \Lambda$, the map
  \[
   \mathrm{ev}_\nu:  \Coh_{\Lambda}(\CK_\sfS(G))\rightarrow \CK_{\nu, \sfS}(G), \quad \Psi\mapsto \Psi(\nu)
  \]
  descends to a linear isomorphism
  \[
     \Coh_{\Lambda}(\CK_\sfS(G))_{W_{\nu}} \xrightarrow{\sim}\CK_{\nu, \sfS}(G).
  \]
  Here the subscript group indicates the coinvariant space. \end{lem}
\begin{proof}
  \def\BS{\cB_{\cS}} Without loss of generality we assume that $\nu$ is
  dominant. Put
  \[
    \CB:=\set{\Psi | \text{$\Psi$ is basal and $\cO_\Psi\subseteq \sfS$}},
  \]
  %\[
  %  \CB:=\{\Psi_{\bar \gamma}\mid \bar \gamma\in \cP_\Lambda(G), \CO_{\bar \gamma}\subseteq \sfS \},
  %\]
  which is a basis of  $\Coh_{\Lambda}(\CK_\sfS(G))$ by \Cref{annlc}. %\Cref{asshc00}.

  % By \Cref{sur111}, there is a surjective evaluation map
  % \[
  %   \ev{\nu, \sfS} \, :\, \Coh_{[\lambda]}(\CK_\sfS(G)) \longrightarrow \Grt_{\nu, \sfS}(G).
  % \]
  % This map is $W_\lambda$-invariant.
  We have that
  \begin{eqnarray*}
    \ker (\ev{\nu})& = & \Span \Set{\Psi\in \CB \mid
                                        \Psi(\nu)= 0 }\\ %\quad (\textrm{by \Cref{lem21}}) \\
    &=& \Span \Set{\Psi - s\cdot\Psi \mid
                                        \Psi\in  \CB,
                                           s  \text{ is a simple reflection in $W_\nu$}
                                        } \\
                                        & &\quad (\textrm{by \Cref{lemirr}})\\
                          & \subseteq &\Span\Set{\Psi- w\cdot \Psi | \Psi\in  \Coh_{\Lambda}(\CK), \, w\in W_{\nu}} \\
                          &  \subseteq &  \ker (\ev{\nu}). %\hspace{5em} \text{(by $(\Phi-w\cdot \Phi)(\nu) = \Phi(\nu)-\Phi(w^{-1}\cdot \nu) = 0$)}\\
  \end{eqnarray*}
Therefore
  \[
    \ker (\ev{\nu})=\Span\Set{\Psi- w \cdot\Psi \mid \Phi\in \Coh_{\Lambda}(\CK), \, w\in W_\nu}.
  \]
Together with \Cref{lem21}, this implies the lemma.
\end{proof}



For every $\nu\in \hha^*$, let $\Irr_{\nu,\sfS}(G)$ denote the set of isomorphism classes of irreducible representations in $\Rep_{\nu, \sfS}(G)$.


\begin{prop}[Vogan]\label{count1}
 For every $\nu\in \Lambda$,
  \[
    \sharp(\Irr_{\nu,\sfS}(G)) = [1_{W_{\nu}}:\Coh_{\Lambda}(\CK_\sfS(G))].
  \]

  % \[
  %   \dim {\barmu} = \dim (\cohm)_{W_\lambda} = [\cohm, 1_{W_\lambda}].
  % \]
\end{prop}
\begin{proof}
Since $ \sharp(\Irr_{\nu,\sfS}(G))=\dim \CK_{\nu, \sfS}(G)$, this is implied by \Cref{prop:ev00000}.
\end{proof}



%For every Casselman-Wallach representation $\pi$ of $G$, its complex associated variety,
%which is denoted by $\AV_\C(\pi)$, is defined to be the associated variety of $\Ann(\pi)\subset \CU(\g)$.
% Recall that $\sfS$ is a $\Ad(\g)$-stable Zariski closed subset of $\Nil(\g^*)$. Let $\mathrm{Rep}_\sfS(G)$ denote the
%category of Casselman-Wallach representations of $G$ whose complex associated
%variety is contained in $\sfS$. Write
% $\CK_{\sfS}(G)$ for the Grothendieck group of this category.


%\begin{prop}\label{hcass22}
%View  $\Coh_{\Lambda}(\CK(G))$ as a basal representation of $W(\Lambda)$ and let $\CC$ be a cell in it. Then among all irreducible representations of $W(\Lambda)$ that occur in
%$\Coh_{\Lambda}(\CK(G))(\CC)$, there is a unique one, to be denote by $\sigma_\CC$, that has minimal fake degree. Moreover, for each $\overline \Psi_{\gamma}\in  \CC$ ($\gamma\in \cP_\Lambda(G)$) and each dominant element $\nu\in \Lambda$ such that  $\overline{\Psi}_{\gamma}(\nu)\neq 0$, $\sigma_{\nu, \mathrm{Ann}(\overline{\Psi}_{\gamma}(\nu))}\cong \sigma_\CC$.
%\end{prop}
%\begin{proof}
%Take $\gamma$
%\end{proof}


%For every cell $\CC$ in the basal representation $\Coh_{\Lambda}(\CK(G))$ of $W(\Lambda)$, let $\sigma_\CC\in \Irr^{\mathrm{sp}}(W(\Lambda))$ be as in Proposition \ref{hcass22}.
%For every $\overline{\Psi}_{\gamma}\in \CC$, put $\CO_{\gamma}:=\CO_{\sigma_\CC}\in  \overline{\Nil}(\g^*)$.


%\begin{proof}
%Take a basal element $\Psi\in \CC$, then $\braket{\CC} = \braket{\Psi}$.
%Let $\nu\in \Lambda$ be a dominant element such that $\Psi(\nu)\neq 0$.
%The annihilator ideal $\Ann(\Psi(\nu))$ determines a left cell
%$\CCL:=\CC^L_{\nu, \Ann(\Psi(\nu))}$
%in $\Coh_\Lambda(\CK(\fgg,\fbb))$ by \cref{eq:primitive}.
%Let  $\CCLR$ be the double cell  containing $\CCL$.
%
%By \Cref{cor:HC.embed}, $\braket{\CC}$ is isomorphic to
%a subrepresentation of $\braket{\CC^{LR}}^k$.
%Therefore every representation occurs in $\braket{\CC}$ has fake degree
%greater or equal to $a(\sigma_{\CCLR})$, and if $\sigma'\in \Irr(W_\Lambda)$ occurs in $\braket{\CC}$ and has fake degree $a(\sigma_{\CCLR})$ then $\sigma'=\sigma_{\CCLR}$
%by \Cref{cell00}.
%
%By \cite{V4}*{Theorem~14.10} (see also \cite{King} and \cite{Cas}*{Theorem~3.4}),
%$\sigma_{\CCLR}$ does occur in
%the cell representation $\Coh_\Lambda(\CK(G))(\CC)$ and the proposition is proved.
%\end{proof}

\begin{prop}\label{hcass222}
Let $\Psi$ be a basal element of $\Coh_\Lambda(\CK(G))$, and let  $\nu\in \Lambda$ be a dominant element. Then $\Psi(\nu)\in \Irr_{\nu, \overline{\CO_\nu}}(G)$ if and only if $\sigma_\Psi\cong \left( j_{W_\nu}^{W(\Lambda)} \sgn\right)\otimes \sgn $ and there is no element of   $ \tau_\Psi$  that fixes $\nu$.
%Here $\CC$ is the cell containing  $\overline \Psi_{\gamma}$ in the basal  representation  $\Coh_{\Lambda}(\CK(G))$ of $W(\Lambda)$.
\end{prop}

\begin{proof}
First suppose that $\sigma_\CC\cong \left( j_{W_\nu}^{W(\Lambda)} \sgn\right)\otimes \sgn$ and there is no element of   $ \tau_\Psi$  that fixes $\nu$.
Then \Cref{lemirr} implies that $\Psi(\nu)\in \Irr(G)$ and \Cref{hcass22}  implies that
\[
\sigma_{\nu, \mathrm{Ann}(\Psi(\nu))}\cong  \left( j_{W_\nu}^{W(\Lambda)} \sgn\right)\otimes \sgn.
\]
Thus $ \mathrm{Ann}(\Psi(\nu))=I_\nu$ by \Cref{leftcnu2}, and hence $ \Psi(\nu)\in \Irr_{\nu, \overline{\CO_\nu}}(G)$.

Now we suppose that $\Psi(\nu)\in \Irr_{\nu, \overline{\CO_\nu}}(G)$. \Cref{lemirr} implies that there is no element of   $ \tau_\Psi$  that fixes $\nu$.
As $ \mathrm{Ann}(\Psi(\nu))=I_\nu$, \Cref{leftcnu2} and  \Cref{hcass22} imply that $\sigma_\CC\cong \left( j_{W_\nu}^{W(\Lambda)} \sgn\right)\otimes \sgn$. This completes the proof of the proposition.
\end{proof}






\begin{prop}\label{count2}
For all $\sigma\in \Irr(W(\Lambda))\setminus \Irr_\sfS(W(\Lambda))$,  %$\CO_\sigma\nsubset \sfS$.
  \[
    [\sigma:\Coh_{\Lambda}(\CK_\sfS(G))]=0.
  \]

\end{prop}
\begin{proof}
This is implied by \Cref{lem0033}
%\Cref{lem0022}
and \Cref{cohbbs}.
\end{proof}


\Cref{count1} and \Cref{count2} imply that  for every $\nu\in \Lambda$,
\begin{equation}\label{leq002}
  \sharp(\Irr_{\nu,\sfS}(G)) = \sum_{\sigma \in \Irr_\sfS(W(\Lambda))} [1_{W_{\nu}}: \sigma]\cdot [\sigma:\Coh_{\Lambda}(\CK_\sfS(G))].
  \end{equation}
  % \[
  %   \dim {\barmu} = \dim (\cohm)_{W_\lambda} = [\cohm, 1_{W_\lambda}].
  % \]

%Recall the notion of a Harish-Chandra cell representation in $\Coh_{\Lam}(\CK(G))$ (which is a subquotient of $\Coh_{\Lam}(\CK(G))$). See \cite{V4}*{Section 14} or Section \ref{seccell}.

%Also recall the notion of Lusztig double cells in $ \Irr(W_{[\lambda]}$ (see Section \ref{seccell}).
% For every Harish-Chandra cell $C$  in $\Coh_{\Lam}(\CK(G))$, write $\CV(C)$ for the  Harish-Chandra cell representation attached to $C$, which is a subquotient representation of $\Coh_{\Lam}(\CK(G))$.

 \begin{thm}\label{counteq}
   % Under the notation of \Cref{lem:lcell.BV}, we have
  For all $\nu\in \Lambda$,
  \begin{equation*}%\label{leq2}
  \sharp(\Irr_{\nu,\sfS}(G)) \leq  \sum_{\sigma \in \Irr_\sfS(W(\Lambda))} [1_{W_{\nu}}: \sigma]\cdot [\sigma:\Coh_{\Lambda}(\CK(G))],
\end{equation*}
  and the equality holds if \Cref{conjcell} holds for $G$.
  %Then for all $\nu\in \Lambda$,
  %\begin{equation*}%\label{boundc}
  %  \sharp(\Irr_{\nu,\sfS}(G)) = \sum_{\sigma \in \Irr_\sfS(W(\Lambda))} [1_{W_\nu}: \sigma]\cdot %[\sigma:\Coh_{\Lambda}(\CK(G))].
  %\end{equation*}
    \end{thm}

\begin{proof} The first assertion is immediate from \eqref{leq002}.
As a  representation of $W(\Lambda)$,
\[
  \Coh_{\Lambda}(\CK(G))\\
   \cong \bigoplus_{\CC \textrm{ is a cell in $\Coh_{\Lambda}(\CK(G))$}} \Coh_{\Lambda}(\CK(G))(\CC).
\]
%and
%\Cref{asshc00}
\Cref{hcass22} implies that
 \[
   \Coh_{\Lambda}(\CK_\sfS(G))\cong  \bigoplus_{\CC \textrm{ is a cell in $\Coh_{\Lambda}(\CK(G))$, $\sigma_\CC\in \Irr^{\mathrm{sp}}_\sfS(W(\Lambda))$}} \Coh_{\Lambda}(\CK(G))(\CC),
 \]
 where $\sigma_\CC$ is as in \Cref{hcass22}. Under the assumption that \Cref{conjcell} holds for $G$,
\begin{equation*}%\label{eqsigma}
[ \sigma: \Coh_{\Lambda}(\CK_\sfS(G))]=[\sigma:\Coh_{\Lambda}(\CK(G))]\quad \textrm{ for all  $\sigma\in \Irr_\sfS(W(\Lambda))$.}
\end{equation*}
Together with \eqref{leq002}, this implies the second assertion.
\end{proof}

% the equality always holds. Combining Theorem \ref{count1}, Theorem
% \ref{count2} and \eqref{leq1}, we conclude that
% \begin{equation}\label{leq2}
%   \sharp(\Irr_{\lambda,\sfS}(G)) \leq \sum_{\sigma\in \Irr(W_\Lam), \CO_\sigma\subset \sfS} [1_{W_{\lambda}}: \sigma]\cdot [\sigma: \Coh_{\Lam}(G)].
% \end{equation}

 Recall that $\CO_\nu $ is the nilpotent orbit
 whose Zariski closure $\overline{\CO_{\nu}}\subset \g^*$ equals
 the associated variety of the maximal ideal $I_\nu$. Recall also the Lusztig left cell
$\LC_{\nu}$ from \eqref{ll}.




 \begin{cor}\label{countleq}
   % Under the notation of \Cref{lem:lcell.BV}, we have
   For  all $\nu\in \Lambda$,
  \begin{equation*}%\label{boundc}
    \sharp(\Irr_{\nu,\overline{\CO_{\nu}}}(G)) \leq \sum_{\sigma \in \LC_{\nu}}   [\sigma:\Coh_{\Lambda}(\CK(G))],
  \end{equation*}
     and the equality holds if  \Cref{conjcell} holds for $G$.
    \end{cor}
  \begin{proof}
 In view of \eqref{mulone}, \Cref{leftcnu} and \Cref{hcass222}, this follows from \Cref{counteq}.  \end{proof}


\section{Separating good parity and bad parity for coherent continuation  representations}\label{sec:GB}

%Let $\star$, $G$, $\check G$, $\g$, $\check \g$, $\check \CO$, $\lambda_{\check \CO}$, $I_{\check \CO}$ and be as in

We continue the notation of the last section. We further assume that $G$ is a classical Lie group as in Sections \ref{sec:defunip}-\ref{secorgp0},
\be\label{gc}
  G_\C :=
  \begin{cases}
   \GL_{n}(\C), & \textrm{if $\star\in \{A^\R, A^\bH\}$};\\
     \GL_{p+q}(\C), & \textrm{if $\star\in \{A, \widetilde A\}$};\\
    \SO_{p+q}(\C), & \textrm{if $\star\in \set{B,D}$};\\
  %  \SO_{n-2l}(\bC) &\textrm{if $\star\in \set{B^{\bC},D^{\bC}}$},\\
    \SO_{2n}(\C), &\textrm{if $\star = D^{*}$};\\
    \Sp_{2n}(\C), &\textrm{if $\star \in \{C, \wtC\}$};\\
    %  \Sp_{2n-2l}(\bC) &\textrm{if $\star \in \set{C^{\bC},\wtC^{\bC}}$},\\
    \Sp_{p+q}(\C), &\textrm{if $\star = C^{*}$},\\
  \end{cases}
\ee
%If $\star=\wtC$, then $G_\C=\check G$, otherwise $G_\C$ and $\check G$
and $\iota: G\rightarrow G_\C$ is the usual complexification homomorphism.

In the rest of the paper we will freely use  the notation of Sections \ref{sec:defunip}-\ref{secorgp0}.

%Let
%\begin{equation}\label{KpG}
%\CK'(G)=\begin{cases} \textrm{the Grothendieck group of the category of %genuine Casselman-Wallach }\\
%\textrm{representations of $G$}, & \textrm{if $\star\in \{\widetilde A, %\widetilde C\}$};\\
%\CK(G), &\textrm{otherwise}.\\
%\end{cases}
%\end{equation}

If $\star\in \{\widetilde A, \widetilde C\}$, we let $\CK'(G)$ denote the Grothendieck group of the category of genuine Casselman-Wallach representations of $G$. Otherwise, put $\CK'(G):=\CK(G)$. Similar notations such as $\cP'_\Lambda(G)$, $\CK'_{\nu}(G)$ and $\Irr'_{\nu}(G)$
%$ \CK'_{\sfS}(G)$, $\CK'_{\nu,\sfS}(G)$
will be used without further explanation.

\delete{As an obvious variant of \Cref{counteq} and \Cref{countleq} for $\nu=\lambda_{\check \CO}$, we have  that
 \begin{equation}\label{boundc22}
     \sharp(\Unip_{\check \CO}(G)) =\sum_{\sigma\in \LC_{\lambda_{\check \CO}}} [\sigma: \Coh_{\Lambda}(\CK_{\overline{\CO}}'(G))]  = \sum_{\sigma\in \LC_{\lambda_{\check \CO}}} [\sigma: \Coh_{\Lambda}(\CK'(G))].
   \end{equation}
   (The second equality holds because of \Cref{HCLU}.)
   %and the equality holds if the analogous condition for a Harish-Chandra cell in $\Coh_{\Lam}(\CK'(G))$ holds.
Recall that $\CO:=\dBV(\check \CO)$ and $\overline{\CO}$ denotes its Zariski closure.}

\subsection{Standard representations of  classical groups}

Define a partition
\[
\{\{A^\R\}, \{A^\bH\}, \{A, \wtA\}, \{B,D\}, \{C, \wtC\}, \{C^*\},\{D^*\} \}
\]
of the set of the symbols. Let $[\star]$ denote the equivalence class containing $\star$ of the corresponding equivalence relation.


We define a $[\star]$-space to be a   finite dimensional complex vector space $V$ equipped with a $[\star]$-structure that is defined as in what follows.

\noindent {\bf The case when $\star\in \set{A^\R, A^\BH}$.} In this case, a $[\star]$-structure on $V$ is a conjugate linear automorphism $\mathbf j: V\rightarrow V$ such
that
\[
  \mathbf j^2= \begin{cases}
  1,  &  \text{if $\star=A^\R$};\\
  -1,    &  \text{if $\star=A^\bH$}.
    \end{cases}
\]


\noindent {\bf The case when $\star\in \set{A, \wtA}$.} In this case, a $[\star]$-structure on $V$ is a non-degenerate Hermitian form
$\la\,,\,\ra: V\times V\rightarrow \C$ (which is by convention linear on the first variable and conjugate linear on the second variable).


\noindent {\bf The case when $\star\in \set{C, \wtC, C^*}$.} In this case, a $[\star]$-structure on $V$ is a symplectic form
$\la\,,\,\ra: V\times V\rightarrow \C$ together will a conjugate linear automorphism $\mathbf j: V\rightarrow V$ such
that
\[
  \mathbf j^2= \begin{cases}
  1,  &  \text{if $\star\in\{C, \wtC\}$};\\
  -1,    &  \text{if $\star=C^*$},
    \end{cases}
\]
 and for all $u,v\in V$,
 \[
   \la \mathbf j(u), \mathbf j(v)\ra =\textrm{the complex conjugate of  $\la u, v\ra$}.
 \]



\noindent {\bf The case when $\star\in \set{B,D, D^*}$.} In this case, a $[\star]$-structure on $V$ is a triple $(\la\,,\,\ra, \mathbf j, \omega)$ where
 $ \la\,,\,\ra: V\times V\rightarrow \C $ is a non-degenerate symmetric bilinear form,  $\mathbf j: V\rightarrow V$ is a conjugate linear automorphism, and $\omega\in \wedge^{\dim V} V$ (to be called the orientation), subject to the following conditions: %{\color{red} separate the type B and D}
 \begin{itemize}
 \item
 \[
  \mathbf j^2= \begin{cases}
  1,  &  \text{if $\star\in\{B,D\}$};\\
  -1,    &  \text{if $\star=D^*$};
    \end{cases}
\]
\item for all $u,v\in V$,
 \[
   \la \mathbf j(u), \mathbf j(v)\ra =\textrm{the complex conjugate of  $\la u, v\ra$};
 \]
 \item
$
 \la \omega, \omega\ra=1,$
where $\la\,,\,\ra: \wedge^{\dim V} V\times \wedge^{\dim V} V\rightarrow \C$ is the symmetric bilinear form given by
\be\label{laraw}
  \la u_1\wedge u_2\wedge \dots \wedge u_{\dim V}, v_1\wedge v_2\wedge \dots \wedge v_{\dim V} \ra=\det \left( [\la u_i, v_j \ra]_{i,j=1,2, \dots, \dim V}\right);
\ee
 \item
if $\star=D^*$, then
\be\label{dstaro}
 \omega=\sqrt{-1} u_1\wedge \mathbf j(u_1)\wedge \sqrt{-1} u_2\wedge \mathbf j(u_2)\wedge \dots \wedge \sqrt{-1} u_{\frac{\dim V}{2}} \wedge \mathbf j(u_{\frac{\dim V}{2}}),
 \ee
 for some  vectors $u_1, u_2, \dots, u_{\frac{\dim V}{2}}\in V$;
 \item
if $\star\in \{B,D\}$ and $\dim V=0$, then $\omega=1$ (as an element of $\wedge^{\dim V} V=\C$).
 \end{itemize}

We remark that when  $\star=D^*$,  the existence of $\mathbf j$ implies that $\dim V$ is even, and up to a positive scalar multiplication
the vector
 \be\label{topw}
 \sqrt{-1} u_1\wedge \mathbf j(u_1)\wedge \sqrt{-1} u_2\wedge \mathbf j(u_2)\wedge \dots \wedge \sqrt{-1} u_{\frac{\dim V}{2}} \wedge \mathbf j(u_{\frac{\dim V}{2}})
 \ee
 is independent of the choice of  $u_1, u_2, \dots, u_{\frac{\dim V}{2}}\in V$ that makes \eqref{topw} a nonzero vector.


Suppose that $V$ is a $[\star]$-space, with a $[\star]$-structure as above. Whenever it is defined, write $\mathbf j_V:=\mathbf j$, $\la\,,\,\ra_V:=\la\,,\,\ra$, and $\omega_V:=\omega$.

Isomorphisms of $[\star]$-spaces are obviously defined. Given two $[\star]$-spaces $V_1$ and $V_2$, the product $V_1\times V_2$ is obviously a $[\star]$-space. We remark that when $[\star]=\{B,D\}$ and both $\dim V_1$ and $\dim V_2$ are odd, the switching map $V_1\times V_2\rightarrow V_2\times V_1$ does not preserve the orientation.
% and  $V_1\times V_2$
% and $V_2\times V_1$ are not canonically isomorphic to each other as $[\star]$-spaces (although they are isomorphic to each other).





 We define $\mathsf G(V)$ to be the subgroup of $\GL(V)$ fixing the $[\star]$-structure, which is a real classical group.  Let $\mathsf G_\C(V)$ denote the Zariski closure of $\mathsf G(V)$ in $\GL(V)$.
Put
\[
  \mathsf G_\star(V):=\begin{cases}
   \textrm{the $\det^{\frac{1}{2}}$-double cover of $\mathsf G(V)$},  &  \text{if $\star=\wtA$};\\
 \textrm{the metaplectic double cover of $\mathsf G(V)$},  &  \text{if $\star=\wtC$};\\
  \mathsf G(V),    &  \text{otherwise.}
    \end{cases}
\]
Note that  $\mathsf G_\star(V)$ may be a special orthogonal group of type $D$ even when $\star=B$, and vice versa.


Now we assume that $G$ is identified with $\mathsf G_\star(V)$.  We call $V$ the standard representation of $G$.
Recall than $n$ is the rank of $\g$ in all cases. Take a  flag
\be\label{flaga}
\{ 0\}= V_0 \subset V_1\subset \dots \subset  V_{n}
\ee
in $V$ such that
\begin{itemize}
 \item
$\dim V_i=i$ for all $i=1,2, \dots, n$.

\item
if $\star\notin \{A^\R, A^\bH, A, \wtA\}$, then $
  V_{n}
$ is totaly isotropic (with respect to the bilinear form $\la\,,\,\ra_V: V\times V\rightarrow \C$);

\item
if $\star\in \{D, D^*\}$, then $V_n$ is $\omega_V$-compatible    in the sense that
\[
  \omega_V= u_1\wedge u_2\wedge \dots \wedge u_{2n}%\wedge u_n^* \wedge \dots \wedge u_{2}\wedge u_1
\]
for some elements $u_1, u_2, \dots, u_{2n}\in V_{2n}$ such that $u_1, u_2, \cdots, u_n\in V_n$ and
\[
\la u_i, u_{j}\ra=\begin{cases}
   1, &\quad \textrm{if $i+j=2n+1$};\\
   0,&  \quad \textrm{if $i+j\neq 2n+1$},\\
  \end{cases}
\]
for all $i,j=1,2, \cdots, 2n$.
% where
%\[
%  V_{j}:=V_{ 2n-j}^\perp:=\{u\in V\mid \la u,v\ra=0\textrm{ for all }v\in V_{2n-j}\}
%  \]
 % for all $ j=n+1, n+2, \dots, 2n$.

\end{itemize}
The flag \eqref{flaga} is unique up to the conjugation by $G_\C$. We remark that in the case when $\star=D^*$  and $n$ is even,  the condition \eqref{dstaro} ensures that there exists a
$\mathbf j_V$-stable totally isotropic subspace of $V$ of dimension $n$ that is $\omega_V$-compatible.

The stabilizer of the flag  \eqref{flaga} in $\g$ is a Borel subalgebra of $\g$. Using this Borel subgroup, we get an identification
\be\label{idabs}
   \hha= \prod_{i=1}^{n} \g\l(V_i/  V_{i-1})=\C^n.
\ee
This identification is independent of the choice of the flag \eqref{flaga}.
As in  \Cref{extcoh}, we assume that $Q=Q_\iota$ (the analytic weight lattice). Note that
\be\label{weightl}
  Q=\Z^n\subset \C^n=(\C^n)^*=\hha^*,
\ee
and the positive roots are
\[
 \Delta^+= \begin{cases}
    \{e_i-e_j\mid 1\leq i<j\leq n\}, &  \text{if $\star \in \{A^\R, A^\BH,  A, \wtA\}$}; \\
   \{e_i\pm e_j\mid 1\leq i<j\leq n\}, &  \text{if $\star \in \{D, D^*\}$}; \\
   \{e_i\pm e_j\mid 1\leq i<j\leq n\} \cup \{e_i\mid 1\leq i\leq n\}, &  \text{if $\star =B$}; \\
   \{e_i\pm e_j\mid 1\leq i<j\leq n\} \cup \{2 e_i\mid 1\leq i\leq n\}, &  \text{if $\star\in \{C, \wtC, C^*\}$}. \\
  \end{cases}
\]
Here $e_1, e_2, \dots, e_n$ is the standard basis of $\C^n$. The Weyl group
\begin{equation}\label{def:Weyl}
    W= \begin{cases}
    \sfS_n, &  \text{if $\star \in \{A^\R, A^\BH,  A, \wtA\}$}; \\
    \sfW_n, &  \text{if $\star\in \{B, C, \wtC, C^*\}$}; \\
      \sfW_n' , &  \text{if $\star \in \{D, D^*\}$}, \\
  \end{cases}
\end{equation}
where $\sfS_n\subset \GL_n(\Z)$ is the group of the permutation matrices, $\sfW_n\subset \GL_n(\Z)$ is the subgroup generated by $\sfS_n$ and all the diagonal matrices with diagonal entries $\pm 1$, and $\sfW'_n\subset \GL_n(\Z)$ is the subgroup generated by $\sfS_n$ and all the diagonal matrices with  determinant $1$ and diagonal entries $\pm 1$.




\subsection{Good parity and bad parity in the Langlands dual}

Recall that an integer has  good parity (depends on $\star$ and $n=\rank \check \g$) if it has the same parity as
\[
  \begin{cases}
    n, &  \text{if $\star \in \{A^\R, A^\BH,  A\}$}; \\
    1+ n, &  \text{if $\star = \wtA$}; \\
   1, & \text{if } \star \in \set{C,C^{*},D,D^{*}};\\
 \text{0}, & \text{if } \star \in \set{B,\wtC}.\\
  \end{cases}
\]
Otherwise it has bad parity.


%Recall the  nilpotent $\Ad(\check \g)$-orbit $\ckcO\subset \mathrm{Nil}(\check \g)$.

Let $\check V$ denote the standard representation of $\check \g$ so that $\check \g$ is identified with a Lie subalgebra of $\g\l(\check V)$.
When $\star\in \{A^\R, A^\bH, A, \wtA\}$,  $\g=\g\l(\check V)$. When $\star\in \{B, \wtC\}$,
the space $\check V$ is equipped with a $\check \g$-invariant symplectic form $\la\,,\,\ra_{\check V}: \check V\times \check V\rightarrow \C$.  When $\star\in \{C, C^*, D, D^*\}$, the space $\check V$ is equipped with a $\check \g$-invariant non-degenerate symmetric bilinear form $\la\,,\,\ra_{\check V}: \check V\times \check V\rightarrow \C$ together with an element $\omega_{\check V}\in \wedge^{\dim \check V} \check V$ with $\la \omega_{\check V}, \omega_{\check V}\ra_{\check V}=1$ (see \eqref{laraw}).

As in \eqref{idabs} we also have that $\check \hha=\C^{n}$. Thus   we have an identification
  $ \check \hha=\hha^*$
that identifies $\check \g$ as the Langlands dual (or the metaplectic Langlands dual) of $\g$.

Recall the semisimple element  $\lambda^\circ_{\check \CO}\in \check \g$ which is uniquely determined by $\check \CO$ up to $\Ad(\check \g)$-conjugation. We have a Lie algebra homomorphism
\[
  \eta: \s\l_2(\C)\rightarrow \check \g
\]
such that
\begin{equation}\label{sl2}
\eta\left(\left[
\begin{array}{cc}
0&1\\
0&0
\end{array}
\right]\right)\in \check \CO\quad \textrm{and}\quad
\eta\left(\left[
\begin{array}{cc}
1&0\\
0&-1
\end{array}
\right]\right)=2\lambda_{\check \CO}^\circ.
\end{equation}

We view $\check V$ as
an $\s\l_2(\C)$-module via
$\eta$.
Put
\[
 \check V_{\mathrm b}:=\textrm{sum of  irreducible $\s\l_2(\C)$-submodules of $\check V$ with bad parity dimension.}
 \]
 Define $ \check V_{\mathrm g}$ similarly by using the good parity  so that
 \be\label{dgb}
 \check V= \check V_{\mathrm b}\times \check V_{\mathrm g}.
 \ee



 Write $\check \g_\mathrm b$ for the Lie subalgebra of $\check \g$ consisting the elements that annihilate $\check V_{\mathrm g}$ and stabilize $\check V_{\mathrm b}$.
 Define $\check \g_\mathrm g$ similarly so that $\check \g_\mathrm b\times \check \g_\mathrm g$ is the stabilizer of the decomposition \eqref{dgb} in $\check \g$.
  We have natural isomorphisms
\[
  (\check \g_\mathrm b,\check \g_\mathrm g)\cong
  \begin{cases}
   (\g\l_{\nnb}(\bC),\g\l_{\nng}(\C)), &\quad  \text{if } \star \in \set{A^\R, A^\BH, A, \wtA}; \\
    (\s\p_{2\nnb}(\bC),\s\p_{2\nng}(\C)), &\quad  \text{if } \star \in \set{B,\wtC}; \\
    (\o_{2\nnb}(\bC),\o_{2\nng+1}(\bC)), & \quad  \text{if } \star \in \set{C,C^{*}}; \\
    (\o_{2\nnb}(\bC),\o_{2\nng}(\bC)), &\quad \text{if } \star \in \set{D,D^{*}},\\
  \end{cases}
\]
 where  $n_{\mathrm b}$ and $n_\mathrm g$ are ranks of $\check \g_\mathrm b$ and $\check \g_\mathrm g$ respectively so that $n_{\mathrm b}+n_{\mathrm g}=n$.
Note that when $\star\in \{B, C,\wtC, C^*, D, D^*\}$, $n_\mathrm b$ agrees with the one defined in \eqref{nb000}.

When $\star\in \{B, C,\wtC, C^*, D, D^*\}$,  \eqref{dgb} is an orthogonal decomposition, and the form $\la\,,\,\ra_{\check V}$ on $\check V$ restricts to bilinear forms on $\check V_{\mathrm b}$ and $\check V_{\mathrm g}$, to be respectively denoted by $\la\,,\,\ra_{\check V_\mathrm b}$ and $\la\,,\,\ra_{\check V_\mathrm b}$.
 When $\star\in \{C, C^*, D, D^*\}$, we equip on  $\check V_{\mathrm b}$  an element $\omega_{\check V_\mathrm b}\in \wedge^{\dim \check V_\mathrm b} \check V_\mathrm b$
 and equip on $\check V_{\mathrm g}$ an element $\omega_{\check V_\mathrm g}\in \wedge^{\dim \check V_\mathrm g} \check V_\mathrm g$ such that
 \be\label{omega12}
   \la \omega_{\check V_\mathrm b}, \omega_{\check V_\mathrm b}\ra_{\check V_\mathrm b}=\la \omega_{\check V_\mathrm g}, \omega_{\check V_\mathrm g}\ra_{\check V_\mathrm g}=1\quad \textrm{and}\quad  \omega_{\check V_\mathrm b}\wedge  \omega_{\check V_\mathrm g}= \omega_{\check V}.
 \ee
Then  as in \eqref{idabs},   in all cases  we have identifications
   \[
   \check \hha_\mathrm b=\C^{n_\mathrm b},  \quad \check \hha_\mathrm g=\C^{n_\mathrm g}\quad  \textrm{and}\quad \check \hha= \check \hha_\mathrm b\times \check \hha_\mathrm g=\C^{n},
   \]
   where $ \check \hha_\mathrm b$ and $ \check \hha_\mathrm g$ are the abstract Cartan algebras of $\check \g_\mathrm b$ and $\check \g_\mathrm g$, respectively.





 The homomorphism $\eta$ obviously induces Lie algebra homomorphisms
\[
  \eta_\mathrm g: \s\l_2(\C)\rightarrow \check \g_\mathrm g\quad \textrm{and}\quad  \eta_\mathrm b: \s\l_2(\C)\rightarrow \check \g_\mathrm b.
  \]
  By using these two homomorphisms, we obtain $\check \CO_\mathrm g\in \overline{\Nil}(\check \g_\mathrm g)$,  $\lambda_{\CO_\mathrm g}^\circ \in \check \g_\mathrm g$,  $\check \CO_\mathrm b\in \overline{\Nil}(\check \g_\mathrm b)$, and  $\lambda_{\CO_\mathrm b}^\circ \in \check \g_\mathrm b$
  as in \eqref{sl2}.
  Then \[
  \mathbf d_\ckcO = \mathbf d_{\ckcO_{\mathrm g}}\cuprow \mathbf d_{\ckcOb}.
  \]


 Put
  \[
   \star_\mathrm g:=
  \begin{cases}
   A, &  \text{if $\star=\wtA$ and $p+q$ is odd}; \\
   \star, &  \text{otherwise},\\
  \end{cases}
\]
and
 \[
   \star_\mathrm b:=
  \begin{cases}
   \wtA, &  \text{if $\star=A$ and $p+q$ is odd}; \\
     D, &  \text{if $\star=C$}; \\
       D^*, &  \text{if $\star=C^*$}. \\
   \star, &  \text{otherwise}.\\
  \end{cases}
\]
The orbit $\ckcO_{\mathrm g}$ has good parity in the sense that all its nonzero row lengths have good parity with respect to $\star_\mathrm g$ and $\check \g_\mathrm g$, and likewise the orbit $\ckcOb$ has bad parity.

\trivial[h]{Similar to \eqref{dominant}, we say that an element $\check \nu\in \check \hha$ is dominant if
\be\label{dominant2}
    \la \check \nu, \alpha\ra\notin -\bN^+ \qquad\textrm{for all positive root $\alpha\in \check \hha^*$ of $\check \g$}.
  \ee
The same terminology of course also applies to elements of  $ \check \hha_\mathrm b$ and  $ \check \hha_\mathrm g$.
Let $\lambda_{\check \CO_\mathrm b}\in \check \hha_\mathrm b$ be the unique  dominant element  that represents the $\Ad(\check \g_\mathrm b)$-conjugacy class of $\lambda_{\check \CO_\mathrm b}^\circ$, and likewise let $\lambda_{\check \CO_\mathrm g}\in \check \hha_\mathrm g$ be the unique  dominant element  that represents the $\Ad(\check \g_\mathrm g)$-conjugacy class of $\lambda_{\check \CO_\mathrm g}^\circ$. Put $\lambda_{\check \CO}:=(\lambda_{\check \CO_\mathrm b}, \lambda_{\check \CO_\mathrm g})\in \check \hha$, which is a dominant element that represents the $\Ad(\check \g)$-conjugacy class of $\lambda_{\check \CO}^\circ$.


Define two subsets
\[
\Lambda_\mathrm b:=\lambda_{\check \CO_\mathrm b}+\Z^{n_\mathrm b}\subset \C^{n_\mathrm b}= \check \hha_\mathrm b
\]
 and
 \[
 \Lambda_\mathrm g:=\lambda_{\check \CO_\mathrm g}+\Z^{n_\mathrm g}\subset \C^{n_\mathrm g}=\check \hha_\mathrm g.
 \]
}


Put
\[
  \Lambda_\mathrm b:= \begin{cases}
    \Z^{n_\mathrm b}, &  \text{if $\star \in \{A^\R,  A\}$ and $n$ is even, or $\star \in \{A^\BH,  B, \wtC\}$}; \\
    (\frac{1}{2},\frac{1}{2},\dots,  \frac{1}{2})+ \Z^{n_\mathrm b}, &  \text{otherwise,}
      \end{cases}
\]
which is the $\Z^{n_\mathrm b}$-coset in $\C^{n_\mathrm b}= \check \hha_\mathrm b$ containing all the elements in $\check \hha_\mathrm b$ that represent the  $\Ad(\check \g_\mathrm b)$-conjugacy class of $\lambda_{\check \CO_\mathrm b}^\circ$.
Likewise put
\[
  \Lambda_\mathrm g:= \begin{cases}
   (\frac{1}{2},\frac{1}{2},\dots,  \frac{1}{2})+ \Z^{n_\mathrm g}, &  \text{if $\star \in \{A^\R,  A\}$ and $n$ is even, or $\star \in \{A^\BH,  B, \wtC\}$}; \\
     \Z^{n_\mathrm g}, &  \text{otherwise,}
      \end{cases}
\]
which is the $\Z^{n_\mathrm g}$-coset in $\C^{n_\mathrm g}= \check \hha_\mathrm g$ containing all the elements in $\check \hha_\mathrm g$ that represent the  $\Ad(\check \g_\mathrm g)$-conjugacy class of $\lambda_{\check \CO_\mathrm g}^\circ$.
We also define
\begin{equation}\label{eq:Lambda}
  \Lambda:= \Lambda_\mathrm b\times  \Lambda_\mathrm g\subset \hha_\mathrm b^*\times  \hha_\mathrm g^*= \C^{n_\mathrm b}\times  \C^{n_\mathrm g}= \C^{n}= \check \hha=\hha^*.
\end{equation}
%Then $\Lambda$ contains an element which represents the conjugacy class of $\lambda^\circ_\ckcO$.

\subsection{Separating the abstract Cartan algebra}\label{sec:SepCar}
When $\star\in \set{ B, C, \wtC,C^*,D, D^*}$, we have defined in Section \ref{secrgp0} the notion of $\check \CO$-relevant parabolic subgroups of $G$. We extend this notion to the other cases: If $\star\in \{A^\R, A^\bH\}$, then a parabolic subgroup of $G$ is said to be  $\check \CO$-relevant if it is the stabilizer group of $\mathbf j$-stable subspace of $V$ of dimension $n_\mathrm b$.  If $\star\in \{A,\wtA\}$, then a parabolic subgroup of $G$ is said to be  $\check \CO$-relevant if it is the stabilizer group of totally isotropic subspace of  $V$ of dimension $\frac{n_\mathrm b}{2}$ (in particular, the existence of such a parabolic subgroup implies that $n_\mathrm b$ is even).



% Note that if $\star\in \{A^\bH, A, C, C^*, D, D^* \}$, then $ n_\mathrm b $ is even.


%When $\star\in \set{D,D^*}$, there may be two nilpotent orbits attaching to the same partition, we
%record the following lemma.
Through a case-by-case verification, we record the following lemma without proof.
\begin{lem}\label{leme}
For every $\upgamma=(H, \xi, \Gamma)\in \sP'_\Lambda(G)$, $H$ is contained in a parabolic subgroup of $G$ that is ${\check \CO}'$-relevant for some ${\check \CO}'\in \overline{\Nil}(\check \g)$ with $\mathbf d_{\check \CO'}=\mathbf d_{\check \CO}$.
\end{lem}

In the rest of this paper we assume that $G$ has  a parabolic subgroups that is ${\check \CO}'$-relevant for some ${\check \CO}'\in \overline{\Nil}(\check \g)$ with $\mathbf d_{\check \CO'}=\mathbf d_{\check \CO}$.
Otherwise
\Cref{leme} and \Cref{lem21} imply that $\Unip_\ckcO(G)$ is empty.
The assumption is equivalent to saying that
\be\label{nonemp0}
\textrm{ $n_\mathrm b$ is even if $\star=\wtA$},
\ee
 and
\be\label{nonemp00}
  p,q\geq  \begin{cases}
   \frac{n_\mathrm b}{2},  &  \text{if $\star\in\{A, \wtA\}$};\\
  n_\mathrm b,    &  \text{if $\star\in\{B,C^*, D\}$}.
    \end{cases}
  \ee
  In particular, $\star_\mathrm g=\star$ in all cases.
% In the rest of this paper we assume that  these two conditions are  satisfied. Consequently, $\star_\mathrm g=\star$.

Define two classical groups
\[
  (G_\mathrm b, G_{\mathrm g}) =
  \begin{cases}
   ( \GL_{n_{\mathrm b}}(\R), \GL_{n_{\mathrm g}}(\R) ), &\quad  \text{if } \star = A^\R; \\
  (\GL_{\frac{n_{\mathrm b}}{2}}(\BH), \GL_{\frac{n_{\mathrm g}}{2}}(\BH)  ), &\quad  \text{if } \star = A^\bH; \\
   (\oU(\frac{n_{\mathrm b}}{2}, \frac{n_\mathrm b}{2} ), \oU(p_{\mathrm g}, q_\mathrm g)), &\quad  \text{if $ \star = A$ and $p+q$ is even}; \\
    ( \widetilde \oU(\frac{n_{\mathrm b}}{2}, \frac{n_\mathrm b}{2} ),\oU(p_{\mathrm g}, q_\mathrm g)), &\quad  \text{if $ \star = A$ and $p+q$ is odd}; \\
     (\widetilde \oU(\frac{n_{\mathrm b}}{2}, \frac{n_\mathrm b}{2} ), \widetilde \oU(p_{\mathrm g}, q_\mathrm g)), &\quad  \text{if $ \star = \wtA$}; \\
    (\SO(n_{\mathrm b},n_{\mathrm b}+1), \SO(p_{\mathrm g},q_{\mathrm g})), &\quad  \text{if } \star = B; \\
    (\SO(n_{\mathrm b}, n_{\mathrm b}), \Sp_{2n_{\mathrm g}}(\bR)), &\quad  \text{if } \star = C; \\
    (\oO^*(2n_\mathrm b), \Sp(\frac{p_{\mathrm g}}{2},\frac{q_{\mathrm g}}{2})), &\quad  \text{if }  \star = C^{*}; \\
    (\widetilde{\Sp}_{2n_{\mathrm b}}(\bR), \widetilde{\Sp}_{2n_{\mathrm g}}(\bR)), &\quad  \text{if } \star = \wtC; \\
     (\SO(n_{\mathrm b},n_{\mathrm b}), \SO(p_{\mathrm g},q_{\mathrm g}) ), &\quad  \text{if }  \star = D;\\
   (\rO^{*}(2 n_{\mathrm b}), \rO^{*}(2n_{\mathrm g})) , &\quad  \text{if } \star = D^{*}, \\
    \end{cases}
  \]
  where
\[
  (p_\mathrm g, q_{\mathrm g}) =
  \begin{cases}
  (p-\frac{n_\mathrm b}{2}, q-\frac{n_\mathrm b}{2} ),  &\quad  \text{if } \star \in \{A, \wtA\};\\
   (p-n_\mathrm b, q-n_\mathrm b),  &\quad  \text{if } \star \in \{B, C^*, D\}.\\
  \end{cases}
\]
Then $G_\mathrm b$ has type $\star_\mathrm b$ and $G_\mathrm g$ has type $\star$.

As in \eqref{gc}, we have the complex groups $G_{\mathrm b,\C}$ and $G_{\mathrm g,\C}$, and the complexification homomorphisms $\iota_\mathrm b: G_\mathrm b\rightarrow G_{\mathrm b,\C}$ and  the complexification homomorphisms $\iota_\mathrm g: G_\mathrm g\rightarrow G_{\mathrm g,\C}$.



Suppose that $G_\mathrm b$ is identified with $\mathsf G_{\star_\mathrm b}(V_\mathrm b)$ so that $G_{\mathrm b, \C}$ is identified with $\mathsf G_\C(V_\mathrm b)$,  where $V_\mathrm b$ is a  $[\star_\mathrm b]$-space.  Similarly,  suppose that $G_\mathrm g$ is identified with $\mathsf G_{\star_\mathrm g}(V_\mathrm g)$ so that $G_{\mathrm g, \C}$ is identified with $\mathsf G_\C(V_\mathrm g)$,  where $V_\mathrm g$ is a  $[\star]$-space.

%we have a  $[\star_\mathrm g]$-space $V_\mathrm g$ such that $G_{\mathrm g}$ is identified with  $\mathsf G_{\star_\mathrm g}(V_\mathrm g)$ and  $G_{\mathrm g, \C}$ is identified with $\mathsf G_\C(V_\mathrm g)$.






 Respectively write $\hha_\mathrm b$ and $\hha_\mathrm g$ for the abstract Cartan algebras for $\g_\mathrm b$ and $\g_\mathrm g$.  Then we have identifications
 \[
   \hha_\mathrm b^*=\C^{n_\mathrm b}=\check \hha_\mathrm b\qquad\textrm{and}\qquad  \hha_\mathrm g^*=\C^{n_\mathrm g}=\check \hha_\mathrm g.
 \]
 Using these identifications, we view $\check \g_\mathrm b$ as the Langlands dual (or the metaplectic Langlands dual when $\star=\wtC$) of  $\g_\mathrm b$, and view $\check \g_\mathrm g$ as the Langlands dual (or the metaplectic Langlands dual when $\star=\wtC$) of $\g_\mathrm g$.

 We also have identifications
   \[
    \hha_\mathrm b^*\times  \hha_\mathrm g^*= \C^{n_\mathrm b}\times  \C^{n_\mathrm g}= \C^{n}= \hha^*.
 \]
 Under this identification, we have that
 \[
   \Delta_\mathrm b^+=\Delta_\mathrm b\cap \Delta^+\qquad\textrm{and}\qquad  \Delta_\mathrm g^+=\Delta_\mathrm g\cap \Delta^+,
 \]
 where $\Delta_\mathrm b^+\subset \Delta_\mathrm b \subset \hha_\mathrm b^*$ are respectively the positive root system and the root system of $\g_\mathrm b$, and likewise $ \Delta_\mathrm g^+ \subset \Delta_\mathrm g\subset \hha_\mathrm g^*$ are respectively the positive root system and the root system of $\g_\mathrm g$.




 Similar to \eqref{weightl}, we have the analytic weight lattices
\[
  Q_{\iota_\mathrm b}=\Z^{n_\mathrm b}\subset \C^{n_\mathrm b}=(\C^{n_\mathrm b})^*=\hha_\mathrm b^*,
\]
and
\[
  Q_{\iota_\mathrm g}=\Z^{n_\mathrm g}\subset \C^{n_\mathrm g}=(\C^{n_\mathrm g})^*=\hha_\mathrm g^*.
\]
Then $\Lambda_\mathrm b$ is the unique $Q_{\iota_\mathrm b}$-coset in $\hha_\mathrm b^*$ that contains some (and all) elements in $\hha_\mathrm b^*$ that represents the $\Ad(\check \g_\mathrm b)$-conjugacy class of $\lambda_{\check \CO_\mathrm b}^\circ$. Likewise, $\Lambda_\mathrm g$ is the unique $Q_{\iota_\mathrm g}$-coset in $\hha_\mathrm g^*$ that contains some (and all) elements in $\hha_\mathrm g^*$ that represents the $\Ad(\check \g_\mathrm g)$-conjugacy class of $\lambda_{\check \CO_\mathrm g}^\circ$.



 Write $W_\mathrm b\subset \GL(\hha_\mathrm b)$ for the  Weyl group for $\g_\mathrm b$ so that
 \begin{equation}\label{def:Weylb}
   W_\mathrm b= \begin{cases}
    \sfS_{n_\mathrm b}, &  \text{if $\star \in \{A^\R, A^\bH, A, \wtA\} $}; \\
    \sfW_{n_\mathrm b}, &  \text{if $\star \in \{B,\wtC\} $};\\
     \sfW'_{n_\mathrm b}, &  \text{if $\star \in \{C,C^*, D, D^*\} $},\\
      \end{cases}
 \end{equation}
 and write $W_\mathrm g\subset \GL(\hha_\mathrm g)$ for the Weyl group for $\g_\mathrm g$ so that
 \begin{equation}\label{def:Weylg}
    W_\mathrm g= \begin{cases}
    \sfS_{n_\mathrm g}, &  \text{if $\star \in \{A^\R, A^\bH, A, \wtA\} $}; \\
    \sfW_{n_\mathrm g}, &  \text{if $\star \in \{B, C, \wtC, C^*\} $};\\
     \sfW'_{n_\mathrm g}, &  \text{if $\star \in \{ D, D^*\} $}.\\
      \end{cases}
 \end{equation}
Let $W'_\mathrm g\subset \GL(\hha_\mathrm g)$ denote the integral Weyl group of $\Lambda_\mathrm g$, namely the Weyl group of the root system
\[
  \{\alpha\in \Delta_\mathrm g\mid \la \check \alpha, \nu\ra\in \Z\textrm{ for some (and all) $\nu\in \Lambda_\mathrm g$}\}.
\]
 Then \[
   W'_\mathrm g= \begin{cases}
     \sfW'_{n_\mathrm g}, &  \text{if $\star =\wtC$};\\
     W_\mathrm g, &\text{otherwise}.
      \end{cases}
 \]
%We remark that $W_\mathrm b$ agrees with the integral  Weyl group of $\Lambda_\mathrm g$ in all cases, and $W_\mathrm g$ agrees with the   Weyl group of $\g_\mathrm g$ except when $\star=\wtC$.
Note that
 \be\label{wl00}
   W(\Lambda)=
    W_{\mathrm b}\times W'_{\mathrm g}\subset W_{\mathrm b}\times W_{\mathrm g}\subset W_\Lambda. \ee
% and
% \[
%   W_\Lambda= \begin{cases}
%    \sfW_n'\cap (\sfW_{n_\mathrm b}\times \sfW_{n_\mathrm g}), &  \text{if $\star \in \{D, D^*\}$}; \\
%    W_\mathrm b\times W_\mathrm g, &  \text{otherwise.}
%      \end{cases}
% \]


Let $\lambda_{\check \CO_\mathrm b}\in \Lambda_\mathrm b$ be the unique  dominant element  that represents the $\Ad(\check \g_\mathrm b)$-conjugacy class of $\lambda_{\check \CO_\mathrm b}^\circ$. Also take a dominant element $\lambda_{\check \CO_\mathrm g}\in \Lambda_\mathrm g$ that represents the $\Ad(\check \g_\mathrm g)$-conjugacy class of $\lambda_{\check \CO_\mathrm g}^\circ$, which is unique unless $\star=\wtC$. Put $\lambda_{\check \CO}:=(\lambda_{\check \CO_\mathrm b}, \lambda_{\check \CO_\mathrm g})\in \Lambda$.

 \begin{lem}\label{dmlam}
 The element $\lambda_{\check \CO}\in \hha^*$ is dominant and represents the conjugacy class of $\lambda_{\check \CO}^\circ$.
 \end{lem}
 \begin{proof}
 Note that for all $\alpha\in \Delta$,
 \[
   \la \lambda_{\check \CO}, \check \alpha\ra\in \Z \qquad \textrm{implies}\qquad \alpha\in \Delta_\mathrm b\sqcup \Delta_\mathrm g.
 \]
 This implies that $ \lambda_{\check \CO}$ is dominant.

  It is easy to see that there exists an element $\lambda'_{\check \CO_\mathrm b}\in \hha^*_\mathrm b$ that represents the conjugacy class of $\lambda_{\check \CO_\mathrm b}^\circ$ and an  element $\lambda_{\check \CO_\mathrm g}\in \hha^*_\mathrm g$ that represents the conjugacy class of $\lambda_{\check \CO_\mathrm g}^\circ$ such that
  $\lambda'_{\check \CO}:=(\lambda'_{\check \CO_\mathrm b}, \lambda'_{\check \CO_\mathrm g})$ represents the conjugacy class of $\lambda_{\check \CO}$.
  Since $\lambda_{\check \CO_\mathrm b}$ is $W_\mathrm b$-conjugate to $\lambda'_{\check \CO_\mathrm b}$, and $\lambda_{\check \CO_\mathrm g}$ is $W_\mathrm g$-conjugate
    to $\lambda'_{\check \CO_\mathrm b}$, $\lambda_{\check \CO}$ is $W$-conjugate to $\lambda'_{\check \CO}$. Thus $\lambda_{\check \CO}\in \hha^*$ also represents the conjugacy class of $\lambda_{\check \CO}^\circ$.
   \end{proof}


 We say that a $[\star]$-space $V_0$ is split if
\begin{itemize}
\item $\star\in \{A^\R, A^\bH, C, \wtC\}$, or

\item $\star\in \{A, \wtA\}$ and there exists a totally isotropic subspace of $V_0$ of dimension $\frac{\dim V_0}{2}$, or
\item
 $\star\in \{B, D, C^*, D^*\}$ and  there exists a $\mathbf j$-stable totally isotropic subspace of $V$ of dimension $\frac{\dim V}{2}$.
 \end{itemize}
Up to isomorphism a split $[\star]$-spaces is  determined by its dimension.


Recall that $\star_\mathrm g=\star$ but $\star_\mathrm b$ may not equal  $\star$ in general. As a modification of $V_\mathrm b$, we define a   split $[\star]$-space  $V_{\mathrm b}^\mathrm g$  such that
\[
 \dim V_{\mathrm b}^\mathrm g=
 \begin{cases}
   \dim V_{\mathrm b}-1,  &  \text{if $\star=B$};\\
   \dim V_{\mathrm b},    &  \text{otherwise}.
    \end{cases}
 \]
For simplicity, write $G_\mathrm b^\mathrm g:=\mathsf G_{\star_\mathrm g}(V_\mathrm b^\mathrm g)$. Note that
\be\label{isostar}
  V\cong V_\mathrm b^\mathrm g\times V_\mathrm g
\ee
as $[\star]$-representations.



\subsection{Matching relevant Cartan subgroups}




By a $\star$-representation of a Lie group $E$, we mean a $[\star]$-space $V_1$ together with a Lie group homomorphism $E\rightarrow \mathsf G_\star(V_1)$. An isomorphism of $\star$-representation is defined to be a $[\star]$-sapce  isomorphism $f: V_1\rightarrow V_2$ of  $\star$-representations that makes the diagram
\[
\begin{tikzcd}[column sep={4cm,between origins}]
      & E
      \ar[dl," "']\ar[dr,"  "]&\\
      \mathsf G_\star(V_1)\ar[rr,"\textrm{the isomorphism induced by $f$}"]& &\mathsf G_\star(V_2).\\
    \end{tikzcd}
\]
commutes. The product $V_1\times V_2$ is obviously a $[\star]$-representation of $E$ whenever $V_1$ and $ V_2$ is are $[\star]$-representation of $E$.
Note that a $B$-representation is the same as a $D$-representation.

We say that a Cartan subgroup $H_\mathrm b$ of $G_\mathrm b$ is relevant if
\begin{itemize}
\item
$\star_\mathrm b\in \{A^\R, A^\bH\}$, or
\item $\star\in \{A, \wtA\}$ and $H_\mathrm b$ stabilizes a totally isotropic subspace of $V$ of dimension $\frac{n_\mathrm b}{2}$, or
\item
 $\star\in \{B,C,\wtC, D, C^*, D^*\}$ and $H_\mathrm b$ stabilizes  a $\mathbf j_{V_\mathrm b}$-stable totally isotropic subspace of $V$ of dimension $n_\mathrm b$.
\end{itemize}

Suppose that
 $H_\mathrm b$ be a relevant Cartan subgroup of $G_\mathrm b$. Then $V_\mathrm b$ is naturally a $\star_\mathrm b$-representation of $H_\mathrm b$.

The following lemma can be verified directly.

\begin{lem}\label{match1} \label{match2} \label{match3}
There exits a unique (up to isomorphism) $\star$-representation  of $H_\mathrm b$ on the $[\star]$-space $V_\mathrm b^\mathrm g$
with the following property.
\begin{enumerate}[label=(\alph*),wide=0pt]
    \item When $\star=B$, $V_\mathrm b\cong V_1\times V_\mathrm b^\mathrm g$
    as $\star$-representations of $H_\mathrm b$
    for a one-dimensional $\star$-representation $V_1$ of $H_\mathrm b$ with trivial action.
    \item When $\star\in \{C, C^*\}$,
    $V_\mathrm b\cong V_\mathrm b^\mathrm g$
    as representations of $H_\mathrm b$.
    \item When $\star\in \{A^\bR, A^\bH, A, \wtA, \wtC,  D, D^* \}$,
    $V_\mathrm b\cong V_\mathrm b^\mathrm g$
    as $\star$-representations of $H_\mathrm b$.
\end{enumerate}
\end{lem}

% \begin{lem}\label{match1}
%Suppose that $\star=B$. Then  there is a $\star$-representation of $H_\mathrm b$  on the $\star$-space $V_\mathrm b^\circ$ such that for some trivial one-dimensional $\star$-representation $V_1$ of $H_\mathrm b$,
%\[
%  V_\mathrm b\cong V_1\times V_\mathrm b^\mathrm g
%\]
%as $\star$-representations of $H_\mathrm b$. Moreover, such a $\star$-representation of $H_\mathrm b$ is unique up to isomorphism.
% \end{lem}
%
%
% \begin{lem}\label{match2}
%Suppose that $\star\in \{C, C^*\}$. Then  there is a $\star$-representation of $H_\mathrm b$  on the $\star$-space $V_\mathrm b^\circ$ such that
%\[
% V_\mathrm b^\mathrm g\cong V_\mathrm b
%\]
%as representations of $H_\mathrm b$. Moreover, such a $\star$-representation of $H_\mathrm b$ is unique up to isomorphism.
%
% \end{lem}
%
%
% \begin{lem}\label{match3}
%Suppose that $\star\notin \{B, C, C^*\}$. Then  there is a $\star$-representation of $H_\mathrm b$  on the $\star$-space $V_\mathrm b^\circ$ such that
%\[
% V_\mathrm b^\mathrm g\cong V_\mathrm b
%\]
%as $\star$-representations of $H_\mathrm b$. Moreover, such a $\star$-representation of $H_\mathrm b$ is unique up to isomorphism.
%\qed
% \end{lem}


We view  $V_\mathrm b^\mathrm g$  as a $\star$-representation of  $H_\mathrm b$ as in \Cref{match1}.



  Let $H_\mathrm g$ be a Cartan subgroup of $G_\mathrm g$ so that $V_\mathrm g$ is naturally an $H_\mathrm g$-representation.
Then $V_\mathrm b^\mathrm g\times V_\mathrm g$ is naturally a $\star$-representation of $H_\mathrm b\times H_\mathrm g$. The isomorphism \eqref{isostar} yields a Lie group homomorphism
\be\label{matchmap}
H_\mathrm b\times H_\mathrm g\rightarrow G.
\ee
Write $H$ for the image of the homomorphism \eqref{matchmap}, and let $\zeta: H_\mathrm b\times H_\mathrm g\rightarrow H$ denote the homomorphism induced by \eqref{matchmap}.
Note that $H$ is a Cartan subgroup of $G$. We call the pair $(H, \zeta)$ a matching of $H_\mathrm b\times H_\mathrm g$, which is uniquely defined up to conjugation by $G$.


\subsection{Matching the parameters}
Given a parameter $\gamma_\mathrm b \in\cP'_{\Lambda_\mathrm b}(G_\mathrm b)$ that is represented by
$(H_\mathrm b, \xi_\mathrm b, \Gamma_\mathrm b)$,
and  a parameter $\gamma_\mathrm g \in\cP'_{\Lambda_\mathrm g}(G_\mathrm g)$
that is represented by $(H_\mathrm g, \xi_\mathrm g, \Gamma_\mathrm g)$,
we  define  a parameter $\varphi(\gamma_\mathrm b,  \gamma_\mathrm g) \in\cP'_{\Lambda}(G)$
as in what follows.
Note that \Cref{leme} implies that $H_\mathrm b$ is  relevant.
Take a matching $(H, \zeta)$ of $H_\mathrm b\times H_\mathrm g$.
Let $\xi$ be the composition of
\[
    \hha^*=\hha_\mathrm b^*\times  \hha_\mathrm g^*\xrightarrow{\xi_\mathrm b\times \xi_\mathrm g} \h_\mathrm b^*\times \h_\mathrm g^*\xrightarrow{\textrm{the transpose inverse of the complexified differential of $\zeta$}} \h^*.
\]
Let $\Gamma: \Lambda\rightarrow \Irr'(G)$ to be the map
\[
  \nu=(\nu_\mathrm b, \nu_\mathrm g)\mapsto \Gamma_\mathrm b(\nu_\mathrm b)\otimes \Gamma_\mathrm g(\nu_\mathrm g),
\]
where  $\Gamma_\mathrm b(\nu_\mathrm b)\otimes \Gamma_\mathrm g(\nu_\mathrm g)$
(which is originally defined as an irreducible representation of $H_\mathrm b\times H_\mathrm g$)
is viewed as a representation of $H$ via the descent through the homomorphism
$\xi: H_\mathrm b\times H_\mathrm g\rightarrow H$.




\begin{lem}
The triple $(H, \xi, \Gamma)$ defined above is an element of $\sP'_{\Lambda}(G)$.
\end{lem}
\begin{proof}
Note that
every imaginary root of $G$ with respect to $H$ is either an  imaginary root of $G_\mathrm b$ with respect to $H_\mathrm b$ or an  imaginary root of $G_\mathrm g$ with respect to $H_\mathrm g$ (here $\h$ is identified with $\h_\mathrm b\times \h_\mathrm g$ via $\xi$). This  implies that $\delta(\xi)=\delta(\xi_\mathrm b)+\delta(\xi_\mathrm g)$, and the lemme then easily follows.
\end{proof}





Now we define  $\varphi(\gamma_\mathrm b, \gamma_\mathrm g) \in\cP'_{\Lambda}(G)$ to be the $G$-orbit of the triple  $(H, \xi, \Gamma)$ defined above.
This is independent of the choices of the representatives $(H_\mathrm b, \xi_\mathrm b, \Gamma_\mathrm b)$, $(H_\mathrm g, \xi_\mathrm g, \Gamma_\mathrm g)$, and the matching $(H, \zeta)$. It is easy to see that the map
\be\label{match0}
  \varphi: \cP'_{\Lambda_\mathrm b}(G_\mathrm b)\times \cP'_{\Lambda_\mathrm g}(G_\mathrm g)\rightarrow \cP'_{\Lambda}(G)
\ee
is $W_\mathrm b\times W_\mathrm g$-equivariant under the cross actions.






 \begin{prop}\label{para}
 If either $\star=C^*$ and $n_\mathrm b>0$, or $\star=D^*$ and $n_\mathrm b, n_\mathrm g>0$, then the map \eqref{match0} is injective and
 \[
   \cP'_{\Lambda}(G)=\varphi(\cP'_{\Lambda_\mathrm b}(G_\mathrm b)\times \cP'_{\Lambda_\mathrm g}(G_\mathrm g))\sqcup w\cdot\left(\varphi(\cP'_{\Lambda_\mathrm b}(G_\mathrm b)\times \cP'_{\Lambda_\mathrm g}(G_\mathrm g))\right)
 \]
 for every $w\in W_\Lambda\setminus (W_\mathrm b\times W_\mathrm g)$. The map \eqref{match0} is bijective in all other cases.
 \end{prop}
 \begin{proof}
  In view of \Cref{leme}, this follows from a case-by-case verification.
 \end{proof}

Define a linear map
\be\label{match1234}
  \varphi: \Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b))\otimes \Coh'_{\Lambda_\mathrm g}(\CK'(G_\mathrm g))\rightarrow \Coh_{\Lambda}(\CK'(G))
\ee
such that
\[
 \varphi(\Psi_{\gamma_\mathrm b}\otimes \Psi_{\gamma_\mathrm g})=\Psi_{\varphi(\gamma_\mathrm b, \gamma_\mathrm g)}
\]
for all $\gamma_\mathrm b \in\cP'_{\Lambda_\mathrm b}(G_\mathrm b)$ and $\gamma_\mathrm g \in\cP'_{\Lambda_\mathrm g}(G_\mathrm g)$.


\begin{prop}\label{matchth}
The linear map \eqref{match1234} is $W_\mathrm b\times W_\mathrm g$-equivariant. Moreover
\[
 \varphi(\overline \Psi_{\bar \gamma_\mathrm b}\otimes \overline \Psi_{\bar \gamma_\mathrm g})=\overline \Psi_{\varphi(\bar \gamma_\mathrm b, \bar \gamma_\mathrm g)}
\]
for all $\gamma_\mathrm b \in\cP'_{\Lambda_\mathrm b}(G_\mathrm b)$ and $\gamma_\mathrm g \in\cP'_{\Lambda_\mathrm g}(G_\mathrm g)$.
\end{prop}
\begin{proof}
  This follows from the Kazhdan-Lusztig-Vogan algorithm (see \cite{V4}*{Theorem~12.17}).
  The case of the odd orthogonal group is treated in \cite{GI}*{Section~3} and
  the case of the real metaplectic group is treated in \cite{RT2}*{Theorem~5.2}.
\end{proof}



By \Cref{para} and  \Cref{matchth}, we have the following corollary.

\begin{cor}\label{cor:Ind.DCstar}
 If $\star\in \{C^*, D^*\}$, then
\[
 \Coh_{\Lambda}(\CK'(G))\cong \Ind^{W_\Lambda}_{W_\mathrm b\times W_\mathrm g} (\Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b))\otimes \Coh_{\Lambda_\mathrm g}(\CK'(G_\mathrm g)))
 \]
 as representations of $W_\Lambda$. In all the other cases,
\[
 \Coh_{\Lambda}(\CK'(G))\cong \Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b))\otimes \Coh_{\Lambda_\mathrm g}(\CK'(G_\mathrm g))
 \]
 as representations of $W_\mathrm b\times W_\mathrm g$.
\end{cor}



% \subsection{Irreducible representations and special unipotent representations}

The following proposition is a reformulation of results
in \cite{Mat96}*{Lemma~4.1.3} and \cite{GI}*{Lemma~3.3}.

\begin{prop}\label{propKL33}
Let $\nu=(\nu_\mathrm b, \nu_\mathrm g)\in \Lambda_\mathrm b\times \Lambda_\mathrm g=\Lambda$. Then there is a unique linear map $\varphi_\nu: \CK'_{\nu_\mathrm b}(G_\mathrm b)\otimes \CK'_{\nu_\mathrm g}(G_\mathrm g)\rightarrow \CK'_{\nu}(G)$ that makes the diagram
\[
 \begin{CD}
          \Coh_{ \Lambda_\mathrm b}(\CK'(G_\mathrm b))\otimes  \Coh_{ \Lambda_\mathrm g}(\CK'(G_\mathrm g))
                  @>   \varphi  >>  \Coh_{ \Lambda}(\CK'(G))\\
            @V   \mathrm{ev}_{\nu_\mathrm b} \otimes  \mathrm{ev}_{\nu_\mathrm g}  VV         @ VV  \mathrm{ev}_{\nu} V \\
      \CK'_{\nu_\mathrm b}(G_\mathrm b)\otimes \CK'_{\nu_\mathrm g}(G_\mathrm g) @> \varphi_\nu >>  \CK'_{\nu}(G) \\
  \end{CD}
\]
commutes, where $\mathrm ev$ indicates the evaluation maps. Moreover, $\varphi_\nu$ is injective,  and
\[
\varphi_\nu(\Irr'_{\nu_\mathrm b}(G_\mathrm b)\times  \Irr'_{\nu_\mathrm g}(G_\mathrm g))\subset \Irr'_{\nu}(G).
\]
\end{prop}
\begin{proof}
The first assertion follows directly from \Cref{prop:ev00000}, since the map $\varphi$ is $W(\lambda)=W_\mathrm b\times W'_\mathrm g$-equivariant. Since $\varphi$ is injective,  \Cref{prop:ev00000} also implies that $\varphi_\nu$ is injective.


For the proof of the second assertion, we assume without loss of generality that $\nu$ is dominant. Let $\pi_\mathrm b\in \Irr'_{\nu_\mathrm b}(G_\mathrm b)$ and $\pi_\mathrm g\in \Irr'_{\nu_\mathrm g}(G_\mathrm g)$. Pick  basal elements
\[
  \Psi_\mathrm b \in \Coh_{ \Lambda_\mathrm b}(\CK'(G_\mathrm b)) \quad \textrm{and}\quad \Psi_\mathrm g\in  \Coh_{ \Lambda_\mathrm g}(\CK'(G_\mathrm g))
   \]
 such that $\Psi_\mathrm b(\nu_\mathrm b)=\pi_\mathrm b$ and $\Psi_\mathrm g(\nu_\mathrm g)=\pi_\mathrm g$.
 Then
\[
  \varphi_\nu(\pi_\mathrm b\otimes \pi_\mathrm g)=\mathrm{ev}_{\nu}(\varphi(\Psi_\mathrm b\otimes \Psi_\mathrm g)).
\]
\Cref{matchth} implies that $\varphi(\Psi_\mathrm b\otimes \Psi_\mathrm g)$ is a basel element of  $\Coh_{\Lambda}(\CK'(G))$. Thus by \Cref{lemirr}, $\mathrm{ev}_{\nu}(\varphi(\Psi_\mathrm b\otimes \Psi_\mathrm g))$ is either irreducible or zero. It is clearly nonzero since $\varphi_\nu$ is injective. This proves the last assertion of the proposition.
\end{proof}

%\begin{remark}
%\Cref{propKL33} is
%\end{remark}


\section{Special unipotent representations in type A}\label{sec:GL}




%Recall the Barbasch-Vogan duality map  (\cite[Appendix]{BVUni} and \cite[Section 1]{BMSZ1})
%\be\label{bvd0}
% \begin{array}{rcl}
% \dBV: \overline{\Nil}(\check \g)&\rightarrow &\overline{\Nil}(\g^*),\\
% \check \CO&\mapsto &\textrm{the unique open $\Inn(\g)$-orbit in the associated variety of $I_{\star, \check \CO}$},
 % \end{array}
% \ee
%where $\overline{\Nil}(\check \g)$ denotes the set of
 %$\Ad(\check \g)$-orbits in ${\Nil}(\check \g)$, and $\overline{\Nil}(\g^*)$ denotes  the set of
 %$\Ad(\g)$-orbits in ${\Nil}( \g^*)$.

We begin the explicit counting of special unipotent representations for a real classical group $G$.

Recall that $\CK'(G)$ is the Grothendieck group of the category of genuine Casselman-Wallach representations of $G$ if $\star\in \{\widetilde A, \widetilde C\}$, and $\CK'(G):=\CK(G)$ otherwise.
As an obvious variant of \Cref{countleq} for $\nu=\lambda_{\check \CO}$, we have that
 \begin{equation}\label{boundc22}
     \sharp(\Unip_{\check \CO}(G))
     %=\sum_{\sigma\in \LC_{\lambda_{\check \CO}}} [\sigma: \Coh_{\Lambda}(\CK_{\overline{\CO}}'(G))]
     =\sum_{\sigma\in \LC_{\lambda_{\check \CO}}} [\sigma: \Coh_{\Lambda}(\CK'(G))].
   \end{equation}
(The equality holds because of \Cref{HCLU}.) Here $\Lambda \subset \hha^*$ is defined in \eqref{eq:Lambda}, and the Lusztig left cell $\LC_{\lambda_{\check \CO}}$ is defined in \eqref{ll}.

   %and the equality holds if the analogous condition for a Harish-Chandra cell in $\Coh_{\Lam}(\CK'(G))$ holds.
%Recall that $\CO:=\dBV(\check \CO)$ and $\overline{\CO}$ denotes its Zariski closure.


\subsection{Some Weyl group representations}


The group $\sfS_n$ is  identified with the permutation group of the set $\{1,2, \dots, n\}$, and
 $\sfW_n$ is identified with $\sfS_n \ltimes \set{\pm 1}^n$.

 Define a quadratic character
\be\label{defep}
  \varepsilon: \sfW_n\rightarrow \{\pm 1\}, \quad (s,(x_{1}, x_{2}, \cdots, x_{n}))\mapsto x_{1}x_{2}\cdots x_{n}.
\ee
Then $\sfW_n'$ is the kernel of this character. As always, $\sgn$ denotes the sign character (of an appropriate Weyl group).
Since $\sfS_{n}$ is a quotient of $\sfW_{n}$, we may inflate the sign character of $\sfS_{n}$ to obtain a character of $\sfW_{n}$, to be denoted by $\bsgn$. Then we have that
\[\varepsilon = \sgn \otimes \bsgn.\]


%Denote by $\epsilon$ the unique non-trivial character of $\sfW_n$ which is trivial on $\sfS_n$, which is given by
%\be\label{defep}
  %(s,(x_{1}, x_{2}, \cdots, x_{n}))\mapsto x_{1}x_{2}\cdots x_{n}.
%\ee


The group $\sfW_n$ is naturally embedded in $\sfS_{2n}$ via the homomorphism determined by
\be\label{wn1}
(i, i+1)\in \sfS_n\mapsto (2 i-1, 2i+1)(2i, 2i+2), \qquad (1\leq i\leq n-1),
\ee
and
       \be\label{wn2}
       (1,\cdots,1, \underbrace{-1}_{j\text{-th
        term}}, 1, \cdots, 1)\in \set{\pm 1}^n  \mapsto (2j-1, 2j), \qquad (1\leq j\leq n).
        \ee
Here $(i, i+1)$, $(2 i-1, 2i+1)$, etc., indicate the involutions in the permutation groups.  Note that $\varepsilon $ is also the restriction of $\sgn$ of $\sfS_{2n}$ to $\sfW_n$.


 Let $\YD_{n}$ be the set of Young diagrams of total size $n$.
We identify $\YD_{n}$ with the set $\overline{\Nil}(\g):= \GL_{n}(\bC)\backslash \Nil(\g\l_n(\C))$ of complex nilpotent orbits and
also with the set  $\Irr(\sfS_{n})$ via the Springer
correspondence (see \cite{Carter}*{11.4}).
More specifically, for $ \cO' \in \overline \Nil( \g)=\YD_{n}$, the Springer
correspondence is given by Macdonald's construction for $\sfS_{n}$ via $j$-induction:
\[
  \Spr( \cO') = j_{\prod_{j}\sfS_{\bfcc_{j}(\cO')}}^{\sfS_{n}} \sgn.
\]
%Recall that $\bfcc_{j}(\cO)$ is the $j$-th column length of $\cO$, and $\sgn$ denotes the sign character.

\trivial[h]{
  %\begin{minipage}{\textwidth}
  Here is the diagram to remember
  \[
    \begin{tikzcd}[ampersand replacement=\&]
     \Nil(\GL_{n}) \ar[rr,"\Spr"]\& \& \Irr(\sfS_{n})\\
      \&\YD_{n} \ar[lu,"\text{Jordan canonical forms}"] \ar[ru,"\text{Macdonald's $j$-induction}"']\&
    \end{tikzcd}
  \]
  % \end{minipage}
}

%For $\ckcO\in \Nil(\GL_{n}(\bC))$, we set % its Barbasch-Vogan dual is
%\[
 % \cO:=\dBV(\ckcO) = \ckcO^{t} \in \Nil(\GL_{n}(\bC)).
%\]


Suppose that $\star\in  \{A^\R, A^\BH, A, \widetilde A\}$ in the rest of this section.
Recall that  $W(\Lambda)  = \sfS_{n_{\mathrm b}}\times \sfS_{n_{\mathrm g}}$. It is easy to verify that
\begin{equation}\label{eq:WA}
  \begin{split}
      W_{\lamck} & = \prod_{i\in \bN^{+}}\sfS_{\bfcc_{i}(\ckcO_{\mathrm b})}\times \prod_{i\in \bN^{+}}\sfS_{\bfcc_{i}(\ckcO_{\mathrm g})},\\
    \LC_{\lamck} & = \set{\tau_{\lamck}}, \quad \textrm{where }  \tau_{\lamck} := (j_{W_{\lamck}}^{W(\Lambda)}\sgn )\otimes \sgn =  \ckcOb^{t}\otimes \ckcOg^{t}.
    %, \AND \\
    %\LC_{\lamck} & = \LRC_{\lamck}= \set{\tau_{\lamck}}, \AND \\
   % \wttau_{\lamck} & := j_{W_{[\lamck]}}^{W}\tau_{\lamck} = \ckcO^{t}.
  \end{split}
\end{equation}
Here and as before, a superscript ``$t$" indicates the transpose of a Young diagram.

  The proof of Propositions \ref{count000}-\ref{count002}  follows from Theorem \ref{thm:cohHC} by direct computation. We  omit the details.

   \begin{prop} \label{count000}
  %Suppose $\star=A^\R$ so that $G = \GL_{n}(\bR)$.
 Suppose that $\star=A^\R$.  For all $l\in \BN$, put
  \[
    \cC_l := \bigoplus_{\substack{t,c,d\in \bN \\2t+c+d=l}} \Ind_{\sfW_t\times \sfS_c\times \sfS_d}^{\sfS_{l}} \varepsilon \otimes 1\otimes 1.
  \]
  Then
  \[
    \Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b)) \cong \cC_{n_{\mathrm b}}\quad\textrm{and}\quad   \Coh_{\Lambda_\mathrm g}(\CK'(G_\mathrm g)) \cong \cC_{n_{\mathrm g}}.
  \]
 \end{prop}


\begin{prop}\label{count001}
 Suppose that $\star=A^\BH$.    For all even number $l\in \BN$, put
  \[
  \cC_{l}: =
    \Ind_{\sfW_{\frac{l}{2}}}^{\sfS_{l}}\varepsilon.
  \]
  Then \[
    \Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b)) \cong \cC_{n_{\mathrm b}}\quad\textrm{and}\quad   \Coh_{\Lambda_\mathrm g}(\CK'(G_\mathrm g)) \cong \cC_{n_{\mathrm g}}.
   \]

\end{prop}



\begin{prop}\label{count002}
Suppose that $\star\in \{A, \wtA\}$.   Then
    \[
       \Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b)) \cong  \Ind_{\sfW_{\frac{n_{\mathrm b}}{2}}}^{\sfS_{n_{\mathrm b}}} 1
    \]
    and
    \[
       \Coh_{\Lambda_\mathrm g}(\CK'(G_\mathrm g)) \cong  \bigoplus_{\substack{t,s,r\in \bN\\t+r=p_\mathrm g, t+s = q_\mathrm g}}
    \Ind_{\sfW_{t}\times \sfS_s\times \sfS_r}^{\sfS_{n_\mathrm g}}
 1\otimes \sgn \otimes \sgn.
    \]
    \end{prop}




% Fix $\ckcO\in \Nil(\ckG) = \YD_{n}$ and set
% \[
%   \cO :=\dBV(\ckcO) = \ckcO^{t} \AND \wttau := \Spr^{-1}(\cO).
% \]
% Here $\wttau$ has the partition $\cO$.

% In all the cases, $\ckG = \GL_{n}(\bC)$ and $n$ is even if
% $G = \GL_{\frac{n}{2}}(\bH)$.
% The nilpotent orbit $\ckcO$ is parameterized by Young diagrams.


% \subsection{Definition of special unipotent representation }

% In this section, we let $G = \GL_{n}(\bC)$ and $\fgg:=\Lie(G) = \fgl_{n}(\bC)$.
% Then $\fggC:= \fgg \otimes_{\bR}\bC$ is naturally identified with
% $\fgg\times \fgg$ and $\cU(\fggC)=\cU(\fgg)\otimes \cU(\fgg)$.


% We make the following definition
% \begin{defn}
% For $\ckcO\in \Nil(\GL_{n}(\bC))$, let $\cIck$ be the maximal primitive ideal in
% $\cU(\fgg)$ with infinitesimal character $\lamck$.
% We call an irreducible admissible representation of $G$ is a special unipotent
% representation attached to $\ckcO$
% \end{defn}

% % For $\ckcO\in \Nil(\GL_{n}(\bC))$, let
% % \[
% % \lamckC := (\lambck,\lamck)\in \fhh^{*}\times \fhh^{*}.
% % \]
% % Via Harish-Chandra homomorphism, $\lamckC$ determine an infinitesimal character
% % of $\cZ(\fggC)$.

% % see \cite{BVUni}*{Introduction}.

% Following \cite{BVUni}*{Defintion~1.17}, we make the following definition of
% unipotent representation:
% \begin{defn}
% \end{defn}

% Since $\Lie(G)\otimes_{\bR}\bC$ is naturally

\trivial[h]{\subsection{Special unipotent representations of $G = \GL_n(\bC)$}
\def\lamckC{\lambda^\bC_{\ckcO}}
\def\fggR{\fgg_{\bR}}
\def\fggC{\fgg_{\bC}}
\def\cIck{\cI_{\ckcO}}
\def\WC{W^{\bC}}

The classification of special unipotent representations of $\GL_n(\bC)$ with integral infinitesimal character is a special case of the results of \cite{BVUni}. The classification in general is also well known to the experts. %, see \cite{V.GL}.

\begin{thm} Let $\star =A^{\bC}$ so that $G =\GL_n(\bC)$. Suppose $\ckcO\in \YD_{n} = \Nil(\check \g)$ and $\ckcO$ has $k$ rows.
Let
\[
 \pi_{\ckcO} := 1_{\bfrr_1(\ckcO)}\times  1_{\bfrr_2(\ckcO)}\times \cdots
 \times 1_{\bfrr_k(\ckcO)}
\]
be the normalized parabolic induction where $1_{c}$ denotes the trivial
representations of $\GL_c(\bC)$.
Then
\[
  \Unip_{\ckcO}(G) = \Set{\pi_{\ckcO}}.
\]
\end{thm}
\begin{proof}
  The irreducibility of $\pi_{\ckcO}$ is well known, see
  \cite{V.GL}. It is clearly an element in $\Unip_{\ckcO}(G)$ by the construction.

  %The computation of complex groups doubles that of real groups.
  We let $\WC$ denote the Weyl group of the complexification of $G$. As in Section \ref{sec:intro}, let $\lamckC:=(\lamck,\overline{\lamck})$, which is an element in the dual $\ahh^{*}$ of the  universal Cartan algebra.
  Recall the notation in \cref{eq:WA}.
  We have the following facts:
  \[
    \begin{split}
      \WC  &\cong  \sfS_{n}\times \sfS_{n}\\
      \WC_{[\lamckC]} &= W_{[\lamck]}\times W_{[\lamck]}\\
      \LC_{\lamckC} &= \set{\tau_{\lamck}\boxtimes \tau_{\lamck}}\\
    \end{split}
  \]
  As a representation of $\WC_{[\lamckC]}$, $\Coh_{[\lamckC]}(\CK(G))$ is isomorphic
  to the regular representation of $ \bC[W_{[\lamck]}]$ (under the left and
  right translation), see \cite{BVUni}*{(3.15)}.
  Therefore,
  \[
    \sharp \Unip_{\ckcO}(G)\leq [\tau_{\lamck}\boxtimes \tau_{\lamck}: \bC[W_{[\lamck]}]] = 1
  \]
  by \Cref{cor:bound}.
  This finishes the proof of the theorem.
\end{proof}

}
% In this section, we let $G = \GL_{n}(\bC)$ and

% Then $\fggC:= \fgg \otimes_{\bR}\bC$ is naturally identified with
% $\fgg\times \fgg$ and $\cU(\fggC)=\cU(\fgg)\otimes \cU(\fgg)$.

% When $\lamck$

\trivial[h]{
Since the Lusztig canonical quotient of $\ckcO$ is trivial, the set of unipotent representations
of $G = \GL_n(\bC)$ one-one corresponds to nilpotent orbits in
$\Nil(\ckGc) = \YD_{n}$ if $\lamck$ is integral by
\cite{BVUni}.


\begin{remark}
The Vogan duality gives a duality between Harish-Chandra cells.
In this case, Harish-Chandra cell is the double cell
of Lusztig.
Now we have a duality
\[
 \pi_\ckcO \leftrightarrow \pi_{\ckcO^t}.
\]
\end{remark}

We record the following easy lemma which is a baby case of our results on other
classical groups.
\begin{lem}
  Let $\ckcO' := \DDD(\ckcO)$ be the partition obtained by deleting the first
  column of $\ckcO$. Let $\Phi_{\GL_{a}(\bC),\GL_{b}(\bC)}$ (resp.
  $\Phi_{\GL_{a}(\bC),\GL_{b}(\bC)}$) be the theta lift (resp. big theta lift)
  from $\GL_a(\bC)$ to $\GL_b(\bC)$. Then we have
  \[
    \pi_{\ckcO} = \Phi_{\GL_{\abs{\ckcO'}}(\bC),\GL_{\abs{\ckcO}}(\bC)} (\pi_{\ckcO'})= \Phi_{\GL_{\abs{\ckcO'}}(\bC),\GL_{\abs{\ckcO}}(\bC)} (\pi_{\ckcO'}).
  \]
\end{lem}

One should be able to deduce the local system attached to $\pi_{\ckcO}$ using
the inductive formula.
}

\subsection{Special unipotent representations of $\GL_n(\bR)$ and $\GL_n(\bH)$}\label{sec:GLRH11}


%Special unipotent representations of general linear groups $\GL_{n}(F)$, where $F= \bR$ or $\bH$, are well-known and comprise
%representations of the form
%\[
 % \Ind_{P}^{\GL_{n}(F)}\chi,
%\]
%where $P$ is a parabolic subgroup of $\GL_{n}(F)$,
%and $\chi$ is a character of $P$ trivial on the connected component of $P$. See \cite{V.GL}*{Page 450}. We will review their classifications in the framework of this article.


% We assume that $G  = \GL_{n}(\bC), \GL_{n}(\bR), \GL_{\half n}(\bH)$ and $\star = A,A^{\bC}, A^{\bH}$ respectively.

%



% We list some easy facts below:
% \[
%   \begin{split}
%     W &= \sfS_{n} \\
%     W_{[\lamck]} & = \sfS_{\abs{\ckcO_{e}}}\times \sfS_{\abs{\ckcO_{o}}} \\
%     W_{\lamck} & = \prod_{i\in \bN^{+}}\sfS_{\bfcc_{i}(\ckcO_{e})}\times \prod_{i\in \bN^{+}}\sfS_{\bfcc_{i}(\ckcO_{o})}\\\
%     \tau_{\lamck} & := (j_{W_{\lamck}}^{W_{[\lamck]}}\sgn )\otimes \sgn =  \ckcO_{e}^{t}\boxtimes \ckcO_{o}^{t}\\
%     \LC_{\lamck} & = \LRC_{\lamck}= \set{\tau_{\lamck}}, \AND \\
%     \wttau_{\lamck} & = j_{W_{[\lamck]}}^{W}\tau_{\lamck} = \Spr^{-1}(\cO).
%   \end{split}
% \]


% Now let $\ckcO\in \Nil(\ckGc)$ and decompose
% \[
%   \ckcO = \ckcO_{e} \cuprow \ckcO_{o}
% \]
% where $\ckcO_e$ and $\ckcO_o$ are partitions consist of even and odd rows
% respectively.

% Every irreducible representation in $\Irr(W)$ is special. For the
% infinitesimal character $\lamck$,
% \[

% \]

% In all the cases, let $\DDD$ denote the dual descent of Young diagrams.
% Suppose $\ckcO$ is a Young diagram, it delete the longest row in $\ckcO$


% Let $\YD$ be the set of Young diagrams viewed as a finite multiset of positive
% integers. The set of nilpotent orbits in $\GL_n(\bC)$ is identified with Young
% diagram of $n$ boxes.


% Let $n_e = \abs{\ckcO_e}, n_o =
% \abs{\ckcO_o}$. % and $\lambda_\ckcO = \half \ckhh$.
% By the formula of $a$-function, one can easily see that The cell in
% $W(\lamck)$ consists of the unique representation
% $J_{W_{\lamck}}^{\Wint{\lamck}} (1)$. Now the $W$-cell
% $(J_{W_{\lamck}}^{W_{[\lamck]}} \sgn)\otimes \sgn$ consists a single
% representation
% \[
%   \tau_{\ckcO} = \ckcO_{e}^{t}\boxtimes \ckcO_{o}^{t}.
% \]
% The representation $j_{W_{\lamck}}^{S_{n}} \tau_{\ckcO}$ corresponds to the
% orbit $\cO= \ckcO^t $ under the Springer correspondence.
\trivial[h]{ WLOG, we assume $\ckcO = \ckcO_o$.

  Let $\sigma\in \widehat{S_n}$. We identify $\sigma$ with a Young diagram. Let
  $c_i = \bfcc_i(\sigma)$. Then $\sigma = J^{S_n}_{W'} \epsilon_{W'}$ where
  $W' = \prod S_{c_i}$ (see Carter's book). This implies Lusztig's a-function
  takes value
  \[
    a(\sigma) = \sum_i c_i(c_i-1) /2
  \]
  Comparing the above with the dimension formula of nilpotent Orbits
  \cite{CM}*{Collary~6.1.4}, we get (for the formula, see Bai ZQ-Xie Xun's paper
  on GK dimension of $SU(p,q)$)
  \[
    \half \dim(\sigma) = \dim(L(\lambda)) = n(n-1)/2 - a(\sigma).
  \]
  Here $\dim(\sigma)$ is the dimension of nilpotent orbit attached to the Young
  diagram of $\sigma$ (it is the Springer correspondence, regular orbit maps to
  trivial representation, note that $a(\triv)=0$), $L(\lambda)$ is any highest
  weight module in the cell of $\sigma$.


  Return to our question, let $S' = \prod_i S_{\bfcc_i(\ckcO)}$. We want to find
  the component $\sigma_0$ in $\Ind_{S'}^{S_n} 1$ whose $a(\sigma_0)$ is
  maximal, i.e. the Young diagram of $\sigma_0$ is minimal.

  By the branching rule, $\sigma \subset \Ind_{S'}^{S_n} 1$ is given by adding
  rows of length $\bfcc_i(\ckcO)$ repeatedly (Each time add at most one box in
  each column). Now it is clear that $\sigma_0 = \ckcO^t$ is desired.

  This agrees with the Barbasch-Vogan duality $\dBV$ given by
  \[
    \ckcO \xrightarrow{\Spr}\ckcO \xrightarrow{\otimes \sgn} \ckcO^t \xrightarrow{\Spr} \ckcO^t.
  \]
}

%In this subsection, we assume that  $\star=A^\R$ so that $G = \GL_{n}(\bR)$.
%Recall from \Cref{defpbp0} the set $\PP_{A^\R}(\ckcO)$, which is the set of paintings on $\ckcO^{t}$ that has type $A^\R$.
%We define the set of painted partitions of type $A$ as the following:
%\begin{equation*}%\label{eq:PP.AR}
%  \PP_{A}(\ckcO) = \Set{\uptau:=(\tau, \cP)|
%    \begin{array}{l}
%      \text{$\tau = \ckcO^{t}$}\\
%      \text{$\Im(\cP)\subseteq \set{\bullet,c,d}$}\\
%      \text{$\#\set{i|\cP(i,j)=\bullet}$ is even for all $j\in \bN^{+}$}
%    \end{array}
%  }.
%\end{equation*}
Recall from \Cref{defpbp0} and  \Cref{defpbp1} the set $\PP_{\star}(\ckcO)$, which is the set of paintings on $\ckcO^{t}$ that has type $\star\in \{A^\R, A^\bH, A, \wtA\}$.
Recall that if $\star=A^\R$, then
\begin{equation}\label{eq:PPA.count}
  \#(\PP_{\star}(\ckcO)) = \prod_{r\in \bN^{+}} (\#\set{i\in \bN^{+}| \bfrr_{i}(\ckcO)=r}+1).
\end{equation}
Also note that
if $\star=A^\bH$, then
\begin{equation}\label{eq:PPA.count2}
  \#(\PP_{\star}(\ckcO)) = \begin{cases}
   1,
    & \text{ if $\check \CO=\check \CO_\mathrm g$;}  \\
      0, & \text{ otherwise.} \\
    \end{cases}
\end{equation}

\begin{prop} \label{lem:GL.count2}
  Suppose that $\star \in\{A^\R, A^\bH\}$.  Then
   \begin{equation*}%\label{eq:A.count}
    [\tau_{\lamck}: \Cint{\Lambda}(\CK'(G))] = \# (\PP_{\star}(\ckcOg))\times
    \# (\PP_{\star}(\ckcOb)) = \# (\PP_{\star}(\ckcO)).
  \end{equation*}
\end{prop}
\begin{proof}
  In view of Proposition \ref{count000} and the description of the left cell representation $\tau_{\lamck}$ in \eqref{eq:WA}, the  first equality  follows from  Pieri's rule (\cite[Corollary 9.2.4]{GW}) and
  the following branching formula (see \cite{BV.W}*{Lemma~4.1~(b)}):
\begin{equation}\label{IndFor}
  \Ind_{\sfW_{t}}^{\sfS_{2t}} \varepsilon = \bigoplus_{\substack{\sigma\in \YD_{2t}\\
      \bfcc_{i}(\sigma) \text{ is even for all }i\in \bN^+}} \sigma\qquad (t\in \bN).
\end{equation}
The last equality
  follows from \eqref{eq:PPA.count} and \eqref{eq:PPA.count2}.
\end{proof}
% The $\Wint{\lamck}$-module $\Cint{\lamck}$ is given by the following formula:
% According to Vogan duality, we can obtain the above formula by tensoring
% $\sgn$ on the formula of the unitary groups in \cite{BV.W}*{Section~4}.



We are in the setting of \Cref{thm:mainR00}. Recall the map
  \[
    \begin{array}{ccc}
      \PP_{\star}(\ckcO) & \rightarrow & \Unip_{\ckcO}(G),\\
      \CP & \mapsto & \pi_{\CP{}},
    \end{array}
  \]
 where $\pi_{\CP}$ is defined in \Cref{sec:GLRH}. It  is proved in  \cite[Theorem 3.8]{V.GL} that the above map is injective. Then   the map is bijective by \eqref{boundc22} and \Cref{lem:GL.count2}. This proves  \Cref{thm:mainR00}.

\subsection{Special unipotent representations of unitary groups}\label{secunit}

In this subsection, we suppose  $\star \in \set{A, \wtA}$ so that
\[
  G =
  \begin{cases}
    \rU(p,q),  & \text{if }\star = A;\\
    \tU(p,q),  & \text{if }\star = \wtA.
\end{cases}
\]

%When it is convenient, we also use the symbol $U$ to represent either $A^{*}$ or $\wtA^{*}$.

%We define the set of painted partitions of type $U$ as the following:
%\begin{equation*}%\label{eq:PP.U}
%  \PP_{U}(\ckcO) = \Set{\uptau:=(\tau, \cP)|
%    \begin{array}{l}
%      \text{$\tau = \ckcO^{t}$}\\
%      \text{$\Im(\cP)\subseteq \set{\bullet,s,r}$}\\
%      \text{$\#\set{j|\cP(i,j)=\bullet}$ is even for all $i\in \bN^{+}$}
%    \end{array}
%  }.
%\end{equation*}
For $\cP \in \PP_{\star}(\ckcO)$, we have defined its signature $(p_\CP, q_\cP)$ in \eqref{eq:signature}. Recall that $\CO:=\dBV(\check \CO)=\ckcO^t\subset \Nil(\g^*)$.  Let $\overline \Nil_{G}(\cO)$ denote the set of $G$-orbits in $(\sqrt{-1}\g_0^*)\cap \CO$, where $\g_0$ denotes the Lie algebra of $G$ which equals $\u(p,q)$.
%For a painted partition $\cP$ of type $U$, define the signature of $\CP$ to be the pair
%\[
%    (p_\CP, q_\cP): = \left (\frac{\sharp(\cP^{-1}(\bullet))}{2}+\sharp(\cP^{-1}(r)),\,
%    \frac{ \sharp(\cP^{-1}(\bullet))}{2}+\sharp(\cP^{-1}(s))\right).
%\]

We first consider the case when  $\ckcO = \ckcO_{\mathrm g}$.
%Now assume $\ckcO = \ckcO_{\mathrm g}$.
% and so $\Cint{\ckcO}(G)$ corresponds to the blocks of the infinitesimal
% character of the trivial representation.
In this good parity setting, we will state a counting result on
$\Unip_{\ckcO}(G)$. The elements in $\Unip_{\ckcO}(G)$ can be constructed by
cohomological induction explicitly and they are irreducible and unitary due to
\cite{Mat96,Tr.U}, see also \cite{Tr.H}*{Section~2} and \cite{MR.U}*{Section~4}.
%\trivial[h]{See \cite{MR.U}*{First several paragraphs of Section~4}.}
We refer the reader to \cite{BMSZ2} for the construction of all elements of $\Unip_{\ckcO}(G)$ by the method of theta lifting.


\begin{thm}[\cf {\cite[Theorem 4.2]{BV.W} and \cite{Tr.H}*{Theorem~2.1}}]\label{thmunit0}
  Suppose that $\ckcO = \ckcO_{\mathrm g}$. Then
  \begin{equation} \label{sharpuni0} \sharp(\Unip_{\ckcO}(G))= \sharp \set{\CP\in \mathrm{PAP}_{A^*}(\ckcO)|(p_\CP, q_\CP)=(p,q)}=\sharp(\overline \Nil_{G}(\cO)).
  \end{equation}
  Moreover, for every $\pi\in \Unip_{\ckcO}(G)$, its wavefront set $\WF(\pi)$ is
  the closure in $\sqrt{-1}\g_0^*$ of a unique orbit
  $\sO_\pi\in \overline \Nil_{G}(\cO)$, and the map
  \begin{equation}\label{sharpuni1}
    \begin{array}{rcl}
      \Unip_{\ckcO}(G) &\longrightarrow& \overline \Nil_{G}(\cO), \\%\Nil_{\mathrm g}(\cO),\\
      \pi & \mapsto & \sO_\pi
    \end{array}
  \end{equation}
  is bijective.
\end{thm}

\begin{proof}
\delete{The Harish-Chandra cell representations in $\Coh_{\Lambda}(\CK'(G))$  are all irreducible and explicitly
  described in terms of the Springer correspondence by \cite{Bo}*{Lemma~4}. }
  In view of the counting formula in \eqref{boundc22}, the first equality  in \eqref{sharpuni0}
  follows from Proposition \ref{count002}, \eqref{eq:WA},  \eqref{IndFor}, and Pieri's rule (\cite[Corollary 9.2.4]{GW}).
  The second equality in \eqref{sharpuni0} will follow directly from
  the bijectivity of \eqref{sharpuni1}.
  \trivial[h]{
  {delete the following sentence: }
  The second equality in \eqref{sharpuni0}
  follows from (an easy) direct computation of numbers of elements both-sides.
  }
  % We now prove the second equality,  there is a one-one
  % correspondence of Harish-Chandra cells in $\Cint{\lambda_\ckcO}(\CK'(G))$ with
  % the orbits in $\overline \Nil_{G}(\cO)$ by \cite{BV.W}*{Theorem~4.2} and
  % \cite[Theorem 5]{Bo} (we use \cite{SV}*{Theorem~1.4} to restate the result in
  % terms of real nilpotent ).
  %

The assignment of wavefront set yields a bijection
 \[
   \{\textrm{cell in the basal representation $\Cint{\Lambda}(\CK_{\overline{\CO}}'(G))/\Cint{\Lambda}(\CK_{\overline{\CO}\setminus \CO}'(G))$}\} \rightarrow \overline \Nil_{G}(\cO),
 \]
and every cell representation in  $\Cint{\Lambda}(\CK_{\overline{\CO}}'(G))/\Cint{\Lambda}(\CK_{\overline{\CO}\setminus \CO}'(G))$ is irreducible and isomorphic to $\tau_{\lambda_{\check \CO}}$. See \cite{BV.W}*{Theorem~4.2} and
  \cite[Theorem 5]{Bo} (we have used \cite{SV}*{Theorem~1.4} to rephrase the result in
  terms of real nilpotent orbits).

 Note that \eqref{mulone} implies   that
 \[
 [1_{W_{\lambda_{\ckcO}}} : \tau_{\lambda_{\check \CO}}]=1.
 \]
 Recall from \Cref{dmlam} that $\lambda_{\ckcO}\in \hha^*$ is dominant. As in the proof of Theorem \ref{count2},  for each cell $\CC$ in $\Cint{\lambda_\ckcO}(\CK_{\overline{\CO}}'(G))$ that is not a cell in $\Cint{\lambda_\ckcO}(\CK_{\overline{\CO}\setminus \CO}'(G))$, there is a unique element $\Psi_\CC\in \CC$ such that $ \Psi_\CC(\lambda_{\ckcO})\neq 0$.
 Then
 \[
    \Unip_{\ckcO}(G) =\{ \Psi_\CC(\lambda_{\ckcO})\}_{\CC\textrm{ is a cell  in $\Cint{\lambda_\ckcO}(\CK_{\overline{\CO}}'(G))$ that is not a cell in $\Cint{\lambda_\ckcO}(\CK_{\overline{\CO}\setminus \CO}'(G))$}}.
 \]
 This implies the bijectivity assertion of the theorem.   % The second assertion follows from the main result of
  % \cite{SV}*{Theorem~1.4}, \cite[Theorem 5]{Bo}, and \eqref{sharpuni0}.
\end{proof}

% \trivial[]{
%   Let
%   $\lambda := (\lambda_{1},\cdots,\lambda_{n})=(\underbrace{1/2, \cdots, 1/2}_{a},\underbrace{0,\cdots,0}_{\mathrm b})$
%   how to compute  $\Coh_{\Lam}(\wtU(p,q))$ of the genuine $\wtU(p,q)$ at the
%   infinitesimal character coset $[\lambda]$?

%   Twist the genuine $\wtU(p,q)$ representations with $\det^{1/2}$ yields
%   an isomorphism between $\Coh_{\Lam}(\wtU(p,q))$ with
%   $\Coh_{\Lam+\half}(U(p,q))$.
% }

% If $p,q \geq \half \nbb$, we write
% \[
% \Gg :=\begin{cases}

% \end{cases}
% \]

\begin{lem}\label{thmca0000}
  If  $ \sharp(\Unip_{\ckcO}(G))\neq 0$, then
  $
    \ckcOb= 2\ckcOpb
  $
  for some Young diagram $\ckcOpb$.

\end{lem}
\begin{proof}
Suppose that  $ \sharp(\Unip_{\ckcO}(G))\neq 0$. Then
\be\label{tau5}
   [\tau_{\lambda_{\check \CO_\mathrm b}}: \Coh_{\Lambda_{\mathrm b}}(\CK'(G_\mathrm b))]\neq 0.
\ee
Recall from Proposition \ref{count002} that
  \[
       \Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b)) \cong  \Ind_{\sfW_{\frac{n_{\mathrm b}}{2}}}^{\sfS_{n_{\mathrm b}}} 1.
    \]
Thus \eqref{tau5}
 is the same as saying that
\[
 [ {\check \CO_\mathrm b}^t: \Ind_{\sfW_{t}}^{\sfS_{2t}} 1 ]\neq 0.
\]
Similar to \eqref{IndFor}, we have that
\begin{equation}\label{IndFor3}
  \Ind_{\sfW_{t}}^{\sfS_{2t}} 1= \bigoplus_{\substack{\sigma\in \YD_{2t}\\
      \bfrr_{i}(\sigma) \text{ is even for all }i\in \bN^+}} \sigma\qquad (t\in \bN).
\end{equation}
This implies the lemma.
\end{proof}

Now we assume that $
    \ckcOb= 2\ckcOpb
  $
  for some Young diagram $\ckcOpb$.

The group $G$ has an $\check \CO$-relevant parabolic subgroup $P$ whose Levi quotient  is naturally isomorphic to $G'_{\mathrm b}\times G_{\mathrm g}$, where
$G'_{\mathrm b}:=\GL_{\frac{n_{\mathrm b}}{2}}(\C)$. Let $\pi_{\ckcOpb}$ denote the
unique element in $\Unip_{\ckcOpb}(\GL_{\frac{n_{\mathrm b}}{2}}(\C))$. Then for
every $\pi_\mathrm g\in \Unip_{\ckcO_{\mathrm g}}(\Gg)$, the normalized smooth parabolic
induction $\pi_{\ckcOpb}\rtimes \pi_{\mathrm g}$ is irreducible by
\cite{Mat96}*{Theorem~3.2.2} and is an element of $\Unip_{\ckcO}(G)$ (\cf
\cite{MR.U}*{Theorem~5.3}).

\begin{thm}\label{thmunit012}
  The equality  \begin{equation}\label{unitarred1}
    \sharp(\Unip_{\ckcO}(G)) =
    \sharp(\Unip_{\ckcO_{\mathrm g}}(\Gg))
  \end{equation}
  holds,
  and the map
  \begin{equation}
  \label{bij00}
    \begin{array}{ccc}
      \Unip_{\ckcOg}(\Gg)&\longrightarrow &\Unip_{\ckcO}(G),\\
      \pi_{0}& \mapsto & \pi_{\ckcOpb}\ltimes \pi_{0}\\
    \end{array}
  \end{equation}
  is bijective. %Consequently, % Then
  % the map
  % \[
  %   \begin{array}{ccc}
  %     \Unip_{\ckcO_{\mathrm g}}(\Gg)&\longrightarrow &\Unip_{\ckcO}(G),\\
  %     \pi_{0}& \mapsto & \pi_{\ckcOpb}\rtimes \pi_{0} \\
  %   \end{array}
  % \]
  % is bijective. Consequently, \be\label{unitarred1} \sharp(\Unip_{\ckcO}(G)) =
  % \sharp(\Unip_{\ckcO_{\mathrm g}}(\Gg)). \ee
\end{thm}

\begin{proof}
\delete{ As in the good parity case,  the structure of cells in the basal representation
  $\Coh_{\Lambda}(\CK'(G))$ (see \cite[Theorem 5]{Bo}) implies
  the equality in \eqref{boundc22}.}
  By the counting formula in \eqref{boundc22},
  \[
    \sharp(\Unip_{\check \CO}(G)) =[\tau_{\lamck}: \Coh_{\Lambda}(\CK'(G))].
  \]
  Similarly,
  \[
    \sharp(\Unip_{\check \CO_\mathrm g}(G_\mathrm g)) = [\tau_{\lambda_{\check \CO_\mathrm g}}: \Coh_{\Lambda_{\mathrm g}}(\CK'(G_\mathrm g))].
  \]
 The proof of \Cref{thmca0000} shows that
 \[
 [\tau_{\lambda_{\check \CO_\mathrm b}}:\Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b))]=1.
 \]
  The above three equalities clearly imply \eqref{unitarred1}.

 By the  calculation of  the wavefront set of the induced representations (\cite[Corollary 5.0.10]{B.Orbit}),  Theorem \ref{thmunit0} implies that all the representations $\pi_{\ckcOpb}\rtimes \pi_{\mathrm g}$, where $\pi_\mathrm g$ varies in $\Unip_{\ckcO_{\mathrm g}}(\Gg)$, have pairwise distinct wavefront sets.   Thus the map \eqref{bij00} is injective. Hence it is bijection by the counting assertion \eqref{unitarred1}.
\end{proof}

  % \begin{enumT}
  %   \item The set $\Unip_{\ckcO_b}(\rU(p,q))\neq \emptyset$ if and only if $p=q$
  %   and each row lenght in $\ckcO$ has even multiplicity.
  %   \item Suppose $\Unip_{\ckcO_b}(\rU(p,p))\neq \emptyset$, let $\ckcO'$ be the
  %   Young diagram such that $\bfrr_i(\ckcO') = \bfrr_{2i}(\ckcO_b)$ and $\pi'$
  %   be the unique special uinpotent representation in
  %   $\Unip_{\ckcO'}(\GL_{p}(\bC))$. Then the unique element in
  %   $\Unip_{\ckcO_b}(\rU(p,p))$ is given by
  %   \[
  %     \pi := \Ind_{P}^{\rU(p,p)} \pi'
  %   \]
  %   where $P$ is a parabolic subgroup in $\rU(p,p)$ with Levi factor equals to
  %   $\GL_p(\bC)$.
  %   \item In general, when $\Unip_{\ckcO_b}(\rU(p,p))\neq \emptyset$, we have a
  %   natural bijection
  %   \[
  %     \begin{array}{rcl}
  %       \Unip_{\ckcO_{\mathrm g}}(\rU(n_1,n_2)) &\longrightarrow& \Unip_{\ckcO}(\rU(n_1+p,n_2+p))\\
  %       \pi_0 & \mapsto & \Ind_P^{\rU(n_1+p,n_2+p)} \pi'\otimes \pi_0
  %     \end{array}
  %   \]
  %   where $P$ is a parabolic subgroup with Levi factor
  %   $\GL_p(\bC)\times \rU(n_1,n_2)$.
  % \end{enumT}

\trivial[h]{
From the branching rule, the cell is parameterized by painted partition
\[
\PP{}(\rU):=\set{\uptau\in \PP{}| \begin{array}{l}\Im (\uptau) \subseteq  \set{\bullet, s,r}\\
  \text{``$\bullet$'' occurs even times in each row}
\end{array}
  }.
\]

The bijection $\PP{}(\rU)\rightarrow \SYD, \uptau\mapsto \sO$ is given by the following recipe:
The shape of $\sO$ is the same as that of $\uptau$.
$\sO$ is the unique (up to row switching) signed Young diagram such that
\[
  \sO(i,\bfrr_i(\uptau)) := \begin{cases}
    +,  & \text{when }\uptau(i,\bfrr_i(\uptau))=r;\\
    -,  & \text{otherwise, i.e. }\uptau(i,\bfrr_i(\uptau))\in \set{\bullet,s}.
  \end{cases}
\]

\begin{eg}
  \[
 \ytb{\bullet\bullet\bullet\bullet r,\bullet\bullet , sr,s,r}
 \quad
 \mapsto\quad
 \ytb{+-+-+,+-, -+,-,+}
  \]
\end{eg}
}

Theorems \ref{thmu1} and \ref{thmu2} then follow from Theorems \ref{thmunit0} and \ref{thmunit012}.

\begin{remark}
  When $\check \CO\neq \check \CO_{\mathrm g}$, the wavefront set $\WF(\pi)$, where $\pi\in \Unip_{\ckcO}(G)$,  may not be the closure of a single orbit in
   $\overline \Nil_{G}(\cO)$.
  % the parabolic induction of a real nilpotent orbit may be reducible. When $\ckcO_{\mathrm b}\neq \emptyset$, a special unipotent representation may thus have
 % a reducible associated variety. Nevertheless, the map
  % $\Unip_{\ckcO}(G) \ni \pi \mapsto \WF(\pi)$ remains to be injective in the case of unitary groups.
\end{remark}



\section{Special unipotent representations in type BCD : counting}\label{sec:BCD}


%\section{Counting of special unipotent representations in type BCD}


%\begin{remark}
%If
%\end{remark}

In this section, we assume that $\star \in \set{B,C,\wtC,C^{*},D,D^{*}}$.
If  $\star\in \{C, C^*, D, D^*\}$, we say that $\check \CO_\mathrm b$ has type I if
  \be\label{assumi}
  \textrm{the number of negative entries of $\lambda_{\check \CO_\mathrm b}$ has the same parity as $\frac{n_\mathrm b}{2}$};
  \ee
  otherwise we say that $\check \CO_\mathrm b$ has type II.


\subsection{The coherent continuation representations}
 Let
$\sfH_{t} := \sfW_t\ltimes \set{\pm 1}^t$ ($t\in\bN$), to be viewed as a  subgroup in $\sfW_{2t}$ such
that
\begin{itemize}
  \item the first factor $\sfW_{t}$ sits in $\sfS_{2t}\subset \sfW_{2t}$ as in \eqref{wn1} and \eqref{wn2},
    \item the element $(1,\cdots,1, \underbrace{-1}_{i\text{-th
        term}}, 1, \cdots, 1)\in \set{\pm 1}^{t}$ acts on $\bC^{2t}$ by
        \[
          % (x_{1},\cdots, x_{2i-2}, x_{2i-1}, x_{2i},x_{2i+1},\cdots, x_{2t} )
        (x_{1},x_{2},\cdots, x_{2t} ) \mapsto (x_{1},\cdots, x_{2i-2}, -x_{2i},-x_{2i-1},x_{2i+1},\cdots, x_{2t}).
        \]
\end{itemize}
Note that $\sfH_{t}$ is also a subgroup of $\sfW'_{2t}$. Define a quadratic
character
\[
  \begin{array}{rcl}
    \tilde{\varepsilon} :  \sfH_{t}=  \sfW_{t}\ltimes \set{\pm 1}^{t}& \rightarrow & \set{\pm 1},\\
                                  (g,(a_{1},a_{2},\cdots, a_{t})) & \mapsto & a_{1}a_{2}\cdots a_{t}.
  \end{array}
\]







     The proof of the following Propositions \ref{count003} and \ref{count004}  also follows from Theorem \ref{thm:cohHC} by direct computation. We  omit the details.




\begin{prop}\label{count003}
As representations of $W_\mathrm b$,
    \[
       \Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b)) \cong
        \begin{cases}
  \bigoplus_{\substack{2t+c+d=n_\mathrm b}} \Ind_{\sfH_{t} \times \sfW_{c}\times \sfW_{d}}^{\sfW_{n_\mathrm b}}
         \tilde{\varepsilon}\otimes 1\otimes 1, &  \text{if $\star \in \{B,  \wtC \}$}; \medskip\\
      \bigoplus_{\substack{2t+a=n_\mathrm b}} %\Res_{\sfW_{n}}^{\sfW'_{n}} \left(
          \Ind_{\sfH_{t} \times \sfS_a}^{\sfW_{n_\mathrm b}}\tilde{\varepsilon}\otimes 1, &  \text{if $\star \in \{C, D \}$};\medskip \\
         %\Res_{\sfW_{n}}^{\sfW'_{n}} \left(
          \Ind_{\sfH_{\frac{n_\mathrm b}{2}}}^{\sfW'_{n_\mathrm b}}\tilde{\varepsilon}, &  \text{if $\star \in \{C^*, D^* \}$},
     \end{cases}
       \]
       where in the case when $\star\in \{C,D\}$, the right-hand side space is viewed as a representation of $W_\mathrm b=\sfW_{n_\mathrm b}'$ by restriction.
      \end{prop}

\begin{prop}\label{count004}
As representations of $W_\mathrm g$,
    \[
       \Coh_{\Lambda_\mathrm g}(\CK'(G_\mathrm g)) \cong
        \begin{cases}
     \bigoplus_{\substack{0\leq p_\mathrm g-(2t+a+2r)\leq 1,\\0\leq q_\mathrm g - (2t+a+2s)\leq 1}} \Ind_{\sfH_{t} \times \sfS_{a}\times \sfW_s\times \sfW_r}^{\sfW_{n_\mathrm g}}
         \tilde{\varepsilon} \otimes 1 \otimes \sgn \otimes \sgn, &  \text{if $\star=B$}; \medskip\\
     \bigoplus_{2t+a+c+d=n_\mathrm g}\Ind_{\sfH_{t} \times \sfS_{a} \times \sfW_c\times \sfW_d}^{W_{n_\mathrm g}}\tilde{\varepsilon} \otimes
          \sgn \otimes 1 \otimes 1, &  \text{if $\star =C$};\medskip \\
          \bigoplus_{2t+a+a'=n_\mathrm g}\Ind_{\sfH_{t} \times \sfS_{a} \times \sfS_{a'}}^{\sfW_{n_\mathrm g}}\tilde{\varepsilon} \otimes
          \sgn \otimes 1, &  \text{if $\star =\wtC$};\medskip \\
          \bigoplus_{\substack{(t+s,t+r)=(\frac{p_\mathrm g}{2},\frac{q_\mathrm g}{2})}} \Ind_{\sfH_{t} \times \sfW_s\times \sfW_t}^{\sfW_{n_\mathrm g}}
         \tilde{\varepsilon} \otimes \sgn \otimes \sgn, &  \text{if $\star =C^*$}; \medskip\\
        \bigoplus_{\substack{2t+c+d+2r=p_\mathrm g\\2t+c+d+2s=q_\mathrm g}}
          \Ind_{\sfH_{t} \times \sfW_s\times \sfW_r\times \sfW'_{c}\times \sfW_{d} }^{\sfW_{n_\mathrm g}}\tilde{\varepsilon} \otimes \bsgn \otimes \bsgn \otimes 1\otimes
          1, &  \text{if $\star =D$}; \medskip \\
          \bigoplus_{\substack{2t+a=n_\mathrm g}} \Ind_{\sfH_{t} \times \sfS_{a}}^{\sfW'_{n_\mathrm g}}
         \tilde{\varepsilon} \otimes \sgn, &  \text{if $\star =D^*$}, \\
     \end{cases}
       \]
       where in the case when $\star=D$,  the right-hand side space is viewed as a representation of $W_\mathrm g=\sfW_{n_\mathrm g}'$ by restriction.
      \end{prop}



   \subsection{The Lusztig  left cells}
  \label{sec:LCBCD}

To ease the notation, for every sequence $a_1\geq a_2\geq \dots \geq a_k\geq 0$ ($k\geq 0$) of integers,   we let $[a_1, a_2, \cdots, a_k]_{\mathrm{col}}$ denote the Young diagram
whose $i$-th column has length $a_i$ if $1 \leq i \leq k$ and length $0$
otherwise. Likewise, we let $[a_1, a_2, \cdots, a_k]_{\mathrm{row}}$ denote the Young diagram
whose $i$-th  row has length $a_i$ if $1 \leq i \leq k$ and length $0$ otherwise. All Weyl group notation such as $W_b$, $W'_g$ and
$W(\Lambda)$ are in \Cref{sec:SepCar}.

 As usual, we identify $\Irr(\sfW_{t})$ ($t\in \BN$) with the set of bipartitions $\tau =(\tau_{L},\tau_{R})$ of total size $t$ (\cite[Section 11.4]{Carter}). Here the total size refers to
$\abs{\tau_{L}}+\abs{\tau_{R}}$.
%Given the chosen embedding of $\sfS_{n}$ into $\sfW'_{n}$,
We also let $(\tau_{L},\tau_{R})_{I}\in \Irr(\sfW'_t)$ denote the  irreducible representation  given by
  \begin{itemize}
    \item the restriction of $(\tau_{L},\tau_{R})\in \Irr(\sfW_{t})$  if
    $\tau_{L}\neq \tau_{R}$, and
    \item
    the induced representation
    $\Ind_{\sfS_{t}}^{\sfW'_{t}} \tau_{L}$ if $\tau_{L}=\tau_{R}$.
  \end{itemize}
  Take an element $w\in \sfW_t$ such that $w \sfW_t'$ generate the group $\sfW_t/\sfW'_t$. Define   $(\tau_{L},\tau_{R})_{II}\in \Irr(\sfW'_t)$ to be the twist of $(\tau_{L},\tau_{R})_{I}$ by the conjugation by $w$, namely there is a linear isomorphism $\kappa: (\tau_{L},\tau_{R})_{I}\rightarrow (\tau_{L},\tau_{R})_{II}$ such that
  \[
    \kappa(g\cdot u)= (wgw^{-1})\cdot (\kappa(u)), \quad \textrm{for all }g\in \sfW'_t, \ u\in (\tau_{L},\tau_{R})_{I}.
  \]


  Note that
  \[
     (\tau_{L},\tau_{R})_{I}=(\tau_{R},\tau_{L})_{I}\quad \textrm{and}\quad (\tau_{L},\tau_{R})_{II}=(\tau_{R},\tau_{L})_{II}
  \]
in all cases, and  $(\tau_{L},\tau_{R})_{I}=(\tau_{R},\tau_{L})_{II}$ when     $\tau_{L}\neq \tau_{R}$.



  In the rest of this subsection, we describe the Lusztig left cell $\LC_{\lambda_{\ckcO}}$
  attached to $\lambda_{\ckcO}$.
 Define two Young diagrams
 \begin{equation}\label{eq:taub}
    \begin{split}
      \tau_{L,\mathrm b} := \begin{cases}
        \big[\half(\bfrr_{1}(\ckcO'_{\mathrm b})+1), \half(\bfrr_{2}(\ckcO'_{\mathrm b})+1), \cdots, \half(\bfrr_{c}(\ckcO'_{\mathrm b})+1)\big]_{\mathrm{col}},
               &\quad \text{if } \star \in \set{B,\wtC}; \\% \smallskip \\
         \big[\half\bfrr_{1}(\ckcO'_{\mathrm b}), \half\bfrr_{2}(\ckcO'_{\mathrm b}),\cdots, \half\bfrr_{c}(\ckcO'_{\mathrm b})\big]_{\mathrm{col}},
        &\quad  \text{if } \star \in \set{C,C^{*}, D,D^{*}},\\
      \end{cases}
    \end{split}
  \end{equation}
  and
   \begin{equation}\label{eq:taub2}
    \begin{split}
      \tau_{R,\mathrm b} := \begin{cases}
        \big(\half(\bfrr_{1}(\ckcO'_{\mathrm b})-1), \half(\bfrr_{2}(\ckcO'_{\mathrm b})-1), \cdots, \half(\bfrr_{c}(\ckcO'_{\mathrm b})-1)\big)_{\mathrm{col}},
               &\quad \text{if } \star \in \set{B,\wtC}; \\% \smallskip \\
         \big(\half\bfrr_{1}(\ckcO'_{\mathrm b}), \half\bfrr_{2}(\ckcO'_{\mathrm b}),\cdots, \half\bfrr_{c}(\ckcO'_{\mathrm b})\big)_{\mathrm{col}},
        &\quad  \text{if } \star \in \set{C,C^{*}, D,D^{*}},\\
      \end{cases}
    \end{split}
  \end{equation}
 where $c:= \bfcc_{1}(\ckcO'_{\mathrm b})$.

 %Recall  from \eqref{wl00} that
% \[
%   W(\Lambda)=
   % W_{\mathrm b}\times W'_{\mathrm g},
 %\]
% where
%  \[
 % W'_\mathrm g: = \begin{cases}
  %   \sfW'_{n_\mathrm g}, &  \text{if $\star =\wtC $}; \\
  % W_\mathrm g, &  \text{otherwise}
  %    \end{cases}
%  \]
%which is the Weyl group of the integral root system
 % \[
 %  \{\alpha\in \Delta_\mathrm g\mid \la \lambda_{\check \CO_\mathrm g},  \check \alpha\ra\in \Z\}.
%  \]
 Define an irreducible  representation $\tau_{\mathrm b}\in \Irr(W_{\mathrm b})$ attached to $\ckcO_{\mathrm b}$ by
\begin{equation}\label{eq:taub}
 \tau_{\mathrm b}:= \left\{
     \begin{array}{ll}
       ( \tau_{L,\mathrm b}, \tau_{R,\mathrm b}), \quad
       & \text{if } \star \in \set{B,\wtC}; \medskip\\
         ( \tau_{L,\mathrm b}, \tau_{R,\mathrm b})_I, \quad & \text{if $\star \in \set{C,C^{*}, D,D^{*}}$ and $\check \CO_\mathrm b$ has type I;}\medskip\\
        ( \tau_{L,\mathrm b}, \tau_{R,\mathrm b})_{II}, \quad & \text{if $\star \in \set{C,C^{*}, D,D^{*}}$ and $\check \CO_\mathrm b$ has type II}.
\end{array}
  \right.
\end{equation}



Recall the set  $\CPPs(\ckcO_{\mathrm g})$ from   \Cref{defn:PP}.   Put
  \[
    {\mathrm A}(\ckcO) := {\mathrm A}(\ckcO_{\mathrm g}):= \textrm{the power set of $\CPPs(\ckcO_{\mathrm g})$},
    \]
    which is identified with the free $\bF_2$-vector space with free basis $\CPP(\ckcO_{\mathrm g})$. Here $\bF_{2}:=\bZ/2\bZ$ is the field with two elements only.
Note that   $\{\emptyset, \CPP(\ckcO_{\mathrm g})\}$ is a subgroup of ${\mathrm A}(\ckcO)$.  Define
   \begin{equation*}%\label{def:barA}
  \bar{\mathrm A}(\ckcO):= \bar{\mathrm A}(\ckcO_{\mathrm g}):=
  \begin{cases}
 {\mathrm A}(\ckcO)/\{\emptyset, \CPP(\ckcO_{\mathrm g})\}, & \quad \text{if  } \star =\wtC;\\
 {\mathrm A}(\ckcO),  & \quad \text{otherwise.}
  \end{cases}
    % \begin{cases}
    %   \wtA(\ckcO)/\wp\sim\wp^{c} & \text{when } \star \in \set{\wtC,D,D^{*}}.\\
    %   \wtA(\ckcO) & \text{when } \star \in \set{B,C,C^{*}},\\
    % \end{cases}
  \end{equation*}

  Generalizing \eqref{ijo}, for each $\wp\in  {\mathrm A}(\ckcO)$,    we define a pair \[
(\imath_\wp, \jmath_\wp):=(\imath_\star(\check \CO, \wp), \jmath_\star(\check \CO, \wp))
\]
 of Young diagrams  as in what follows.

If $\star=B$, then
 \[
   \mathbf c_{1}(\jmath_\wp)=\frac{\mathbf r_1(\check \CO_{\mathrm g})}{2},
\]
and for all $i\geq 1$,
\[
(\mathbf c_{i}(\imath_\wp), \mathbf c_{i+1}(\jmath_\wp))=
   \left\{
     \begin{array}{ll}
           (\frac{\mathbf r_{2i+1}(\check \CO_{\mathrm g})}{2},  \frac{\mathbf r_{2i}(\check \CO_{\mathrm g})}{2}), &\hbox{if $(2i, 2i+1)\in \wp$}; \smallskip\\
            (\frac{\mathbf r_{2i}(\check \CO_{\mathrm g})}{2},  \frac{\mathbf r_{2i+1}(\check \CO_{\mathrm g})}{2}), &\hbox{otherwise}.\\
            \end{array}
   \right.
\]


If $\star=\widetilde{C}$, then for all $i\geq 1$,
\[
(\mathbf c_{i}(\imath_\wp), \mathbf c_{i}(\jmath_\wp))=
   \left\{
     \begin{array}{ll}
           (\frac{\mathbf r_{2i}(\check \CO_{\mathrm g})}{2},  \frac{\mathbf r_{2i-1}(\check \CO_{\mathrm g})}{2}), &\hbox{if $(2i-1, 2i)\in \wp$}; \smallskip\\
            (\frac{\mathbf r_{2i-1}(\check \CO_{\mathrm g})}{2},  \frac{\mathbf r_{2i}(\check \CO_{\mathrm g})}{2}), &\hbox{otherwise}.\\
            \end{array}
   \right.
\]


If $\star\in\{D,D^*\}$, then
 \[
   \mathbf c_{1}(\imath_\wp)= \left\{
     \begin{array}{ll}
            \frac{\mathbf r_1(\check \CO_{\mathrm g})+1}{2},   &\hbox{if $\mathbf r_1(\check \CO_{\mathrm g})>0$}; \smallskip\\
       0,  &\hbox{if $\mathbf r_1(\check \CO_{\mathrm g})=0$},\\
            \end{array}
   \right.
 \]
and for all $i\geq 1$,
\[
(\mathbf c_{i}(\jmath_\wp), \mathbf c_{i+1}(\imath_\wp))=
   \left\{
     \begin{array}{ll}
            (\frac{\mathbf r_{2i+1}(\check \CO_{\mathrm g})-1}{2},  \frac{\mathbf r_{2i}(\check \CO_{\mathrm g})+1}{2}), &\hbox{if $(2i, 2i+1)\in \wp$}; \smallskip\\
        (\frac{\mathbf r_{2i}(\check \CO_{\mathrm g})-1}{2},  0), & \hbox{if $(2i, 2i+1)$ is tailed in $\check \CO_{\mathrm g}$};\smallskip\\
         (0,  0), &\hbox{if $(2i, 2i+1)$ is vacant in $\check \CO_{\mathrm g}$};\\
         (\frac{\mathbf r_{2i}(\check \CO)-1}{2},  \frac{\mathbf r_{2i+1}(\check \CO_{\mathrm g})+1}{2}), &\hbox{otherwise}.\\
            \end{array}
   \right.
\]


If $\star\in\{C,C^*\}$, then for all $i\geq 1$,
\[
(\mathbf c_{i}(\jmath_\wp), \mathbf c_{i}(\imath_\wp))=
   \left\{
     \begin{array}{ll}
            (\frac{\mathbf r_{2i}(\check \CO_{\mathrm g})-1}{2},  \frac{\mathbf r_{2i-1}(\check \CO_{\mathrm g})+1}{2}), &\hbox{if $(2i-1, 2i)\in \wp$}; \smallskip\\
        (\frac{\mathbf r_{2i-1}(\check \CO_{\mathrm g})-1}{2},  0), & \hbox{if $(2i-1, 2i)$ is tailed in $\check \CO_{\mathrm g}$};\smallskip\\
         (0,  0), &\hbox{if $(2i-1, 2i)$ is vacant in $\check \CO_{\mathrm g}$};\\
         (\frac{\mathbf r_{2i-1}(\check \CO_{\mathrm g})-1}{2},  \frac{\mathbf r_{2i}(\check \CO_{\mathrm g})+1}{2}), &\hbox{otherwise}.\\
            \end{array}
   \right.
\]


We define an element $\tau_{\wp}\in \Irr(\Wg')$ by
  \begin{equation}\label{eq:tauwp}
    \tau_{\wp} :=
    \begin{cases}
      (\imathp,\jmathp),  \quad &  \text{if } \star \in \set{B,C, C^{*} }; \\
      (\imathp,\jmathp)_{I}= (\imathp,\jmathp)_{II},  \quad &  \text{if   $ \star \in \set{D,D^{*}}$};\\
       (\imathp,\jmathp)_I, \quad & \text{if $\star =\wtC$  and $ \frac{n_\mathrm g}{2}$ is even;}\medskip \\
            (\imathp,\jmathp)_{II}, \quad & \text{if $\star =\wtC$ and  $ \frac{n_\mathrm g}{2}$ is odd.}
    \end{cases}
  \end{equation}
  Note that  if $\star=\wtC$, then $\tau_{\wp} = \tau_{\wp^{c}}$, where $\wp^{c}$ is the complement of $\wp$ in $\CPPs(\ckcO_{\mathrm g})$.
Therefore in all cases,   $\tau_{\bar \wp}\in \Irr(\Wg')$ is obviously defined for every $\bar \wp\in \bar{\mathrm A}(\check \CO)$.

\delete{
\begin{remark} When $\star\neq \wtC$, $\mathrm A(\ckcO)$ gives another description of Lusztig's canonical
  quotient attached to $\ckcO$. The set $\CPP_{\star}(\ckcO)$ appears implicitly in
\cite{So}*{Section~5}.


  \trivial[h]{ This can be seen from the following
    lemma, c.f. \cite{BVUni}*{Proposition~5.28}. }
\end{remark}
}

  To simplify the notation, we write $\LC_{\ckcO}:= \LC_{\lambda_{\ckcO}}$. Recall that $\LC_{\ckcO}$ is the set of all $\sigma\in \Irr(W(\Lambda))$  that occurs in the multiplicity free representation
   \[
    \left(J_{\Wlamck}^{W(\Lambda)} \sgn\right) \otimes \sgn.
  \]

\begin{prop}[\cf Barbasch-Vogan {\cite{BVUni}*{Proposition~5.28}}]
    \label{lem:Lcell}
    The
  map    \[
      \begin{array}{rcl}
        \bar{\mathrm A}(\ckcO) & \rightarrow & \LC_{\ckcO},\\
                       \bar \wp & \mapsto &  \tau_{\mathrm b} \otimes \tau_{\bar \wp}
      \end{array}
    \]
    is well-defined and bijective, and
        \[
      \tau_{\ckcO}:=\tau_{\mathrm b}\otimes \tau_{\emptyset}
    \] is the unique special representation in $\LC_{\ckcO}$.
    % \begin{equation}\label{eq:dBV.W}
    %   \Spr ^{-1}(j_{\WLamck}^{W}(\tau_{\ckcO})) = \textrm{the unique Zariski open orbit in $\mathrm{AV}(I_{\star, \ckcO})$}.
    %   \end{equation} Here
    %   $\mathrm{AV}$ indicates the associated variety.
 Moreover,
    \begin{equation}\label{eq:dBV.W}
      \Spr ^{-1}(j_{W(\Lambda)}^{W}(\tau_{\ckcO}))
      = \dBV(\ckcO),
       \end{equation}
    as $\Ad(\g)$-orbits,
    and
  \begin{equation}\label{eq:dBV.W2}
     \dBV(\ckcO)=   (\ckcOpb)^{t} \cupcol (\ckcOpb)^{t}\cupcol \dBV(\ckcOg)
   \end{equation}
as Young diagrams.
 \end{prop}

          % \[
          %   (\bfcc_{i}(\imathp), \bfcc_{i}(\jmathp)):=
          %   \begin{cases}
          %     (\half (\bfrr_{2i-1}(\ckcO_{\mathrm g})+1),\half (\bfrr_{2i}(\ckcO_{\mathrm g})-1)) &\text{if } (2i-1,2i)\in \wp, \\
          %     (\half (\bfrr_{2i}(\ckcO_{\mathrm g})+1), \half (\bfrr_{2i-1}(\ckcO_{\mathrm g})-1))
          %     & \text{if } (2i-1,2i)\notin \wp\\
          %     & \text{ and }\bfrr_{2i}(\ckcO_{\mathrm g})\neq 0,
          %     \\
          %     (0,0)
          %     & \text{if } \bfrr_{2i-1}(\ckcO_{\mathrm g})=0,\\
          %     (0, \half (\bfrr_{2i-1}(\ckcO_{\mathrm g})-1)) & \text{otherwise}
          %   \end{cases}
          % \]

          % \[
          %   (\bfcc_{l+1}(\imathp), \bfcc_{l+1}(\jmathp)) := (0,\half(\bfrr_{2l+1}(\ckcO_{\mathrm g})-1))
          % \]
          % and for all $1\leq i\leq l$

    \trivial[h]{ The last equality could be checked using Sommer's formula on
      Springer correspondence directly: double columns $(2c+1,2c+1)$ corresponds
      to
      $ B_{c=\alpha_{2i-1}}\times D_{c+1=\alpha_{2i}+1}=D_{c+1=\alpha_{2i-1}+1}\times C_{c=\alpha_{2i}}$
      factor in type $B,\wtC$. double columns $(2c,2c)$ corresponds to factor
      $D_{c=\beta_{2i-1}}\times C_{c=\beta_{2i}}=D_{c=\beta_{2i-1}}\times B_{c=\beta_{2i}}$
      in type $C,C^{*},D,D^{*}$. Here $\dBV$ is the metaplectic dual if
    $\star=\wtC$ and is the Barbasch-Vogan dual otherwise.
}

  \begin{proof}
    When  $\ckcO=\ckcO_{\mathrm g}$ and $\star\neq \wtC$, the proposition is proved in \cite{BVUni}*{Proposition~5.28}.  When $\star\neq \wtC$, the equalities
    \eqref{eq:dBV.W} and \eqref{eq:dBV.W2} are proved in \cite{BVUni}*{Proposition~A2}. In general, the proposition follows from
    %from an induction on number of columns of $\ckcO_{\mathrm g}$ using
    Lusztig's formula of $J$-induction in \cite{Lu}*{\S 4.4-4.6}.
    \end{proof}

    \trivial[h]{{ {\bf Suppose $\star=C$.}
      In this case, bad parity is even and each row length occur with even
      multiplicity. Suppose
      $\ckcO_{\mathrm b} = (C_{1}, C_{1}, C_{2},C_{2}, \cdots, C_{k'},C_{k'})$ with
      $c_{1}=2k$ and $k' = \bfrr_{1}(\ckcO_{\mathrm b})$.
      \[
        W_{\lamckb} = S_{C_{1}}\times S_{C_{2}}\times \cdots S_{C_{k'}}.
      \]
      The symbol of trivial representation of trivial group of type D is
      \[
        \binom{0,1, \cdots, k-1}{0,1, \cdots, k-1}.
      \]
      Now it is easy to see that (use the similar computation as below)
      \[
        J_{W_{\lamckb}}^{W_{\mathrm b}}\sgn = ((\half C_{1}, \half C_{2},\cdots, \half C_{k'}),(\half C_{1}, \half C_{2},\cdots, \half C_{k'})).
      \]


      For the good parity part. Let
      $r'_{i} = \floor{\half(\bfrr_{i}(\ckcO_{\mathrm g})-\bfrr_{i+1}(\ckcO_{\mathrm g}))}$.
      Suppose $\ckcO_{\mathrm g}$ has $2l+1$ columns (superscripts denote the
      multiplicity)
      \[
        \ckcO_{\mathrm g} = ((2l+1)^{2r'_{2l+1}+1}, 2l^{2r'_{2l}}, (2l-1)^{2r'_{2l-1}}, \cdots, 2^{2r'_{2}}, 1^{2r'_{1}} )
      \]
      and
      % $\ckcO_{\mathrm g} = (2c_{1}+1, C_{2}, C_{2},C_{3},C_{3},\cdots, C_{k'},C_{k'})$
      % with $2c_{1}+1=2l+1$ and $2k'+1 = \bfrr_{1}(\ckcO_{\mathrm g})$.
      \[
        W_{\lamckg} = W_{l}\times \underbrace{S_{2l+1}\times \cdots \times S_{2l+1}}_{2r'_{2l+1}\text{-terms}} \times \prod_{i<2l+1} \underbrace{S_{i}\times \cdots\times S_{i}}_{r'_{i}\text{-terms}}
      \]

      The symbol of sign representation of $W_{l}$ is
      \[
        \binom{0,1,2, \cdots, l}{1,2, \cdots, l}.
      \]
      The induction begins with the longest columns to the shorter columns

      Induce to include all $2l+1$-length columns yields
      \[
        \binom{r'_{2l+1}+0,r'_{2l+1}+1,r'_{2l+1}+2, \cdots, r'_{2l+1}+l}{ r'_{2l+1}+1,r'_{2l+1}+2, \cdots, r'_{2l+1}+l}.
      \]
      Now move the shorter columns, we see that when even columns
      $(2i)^{2r'_{2i}}$ occurs, it adds $(i)^{r'_{2i}}$ columns on the both
      sides of the bipartition; when odd columns $(2i+1)^{r'_{2i+1}}$ occur, the
      bifurcation happens: one can
      \begin{itemize}
        \item attach columns $(i+1)^{r'_{2i+1}}$ on the left and columns
              $(i)^{r'_{2i+1}}$ on the right, which corresponds to
              $(2i+1,2i+2)\neq \wp$, or
        \item attach columns $(i)^{r'_{2i+1}}$ on the left and columns
              $(i+1)^{r'_{2i+1}}$ on the right, which corresponds to
              $(2i+1,2i+2)\in \wp$,
      \end{itemize}

      Therefore,
      \[
        \begin{array}{ccc}
          J_{W_{\lamckg}}^{W_{\mathrm g}} \sgn
          &\leftrightarrow&  \bF_{2}(\CPP(\ckcO_{\mathrm g}))\\
          (\cktau_{L},\cktau_{R}) =:\cktau_{\wp}&\leftrightarrow & \wp
        \end{array}
      \]
      where
      \[
        \bfrr_{l+1}(\cktau_{L}) = r'_{2l+1} = \half (\bfrr_{2l+1}(\ckcO_{\mathrm g})-1)
      \]
      and, if $(2i-1,2i)\notin \wp$,
      \[
        \begin{split}
          \bfrr_{i}(\cktau_{L}) & = \sum_{l\geq 2i-1} r'_{l}
          = \half(\bfrr_{2i-1}(\ckcO)-1)\\
          \bfrr_{i}(\cktau_{R}) & = 1 + \sum_{l\geq 2i} r'_{l} = \half(\bfrr_{2i}(\ckcO)+1)
        \end{split}
      \]
      if $(2i-1,2i)\in \wp$,
      \[
        \begin{split}
          \bfrr_{i}(\cktau_{L}) & = \sum_{l\geq 2i} r'_{l}
          = \half(\bfrr_{2i}(\ckcO)-1)\\
          \bfrr_{i}(\cktau_{R}) & = 1 + \sum_{l\geq 2i-1} r'_{l} = \half(\bfrr_{2i-1}(\ckcO)+1)
        \end{split}
      \]

      % \[
      %   \begin{split}
      %     \bfrr_{l+1}(\cktau_{L}) & = r'_{2l+1} =
      %     \half (\bfrr_{2l+1}(\ckcO_{\mathrm g})-1)\\
      %     (\bfrr_{i}(\cktau_{L}), \bfrr_{i}(\cktau_{R})) & =
      %     \begin{cases}
      %       (\half(\bfrr_{2i-1}(\ckcO_{\mathrm g})-1), \half(\bfrr_{2i}(\ckcO_{\mathrm g})+1)) & (2i-1,2i)\notin \wp\\
      %       (\half(\bfrr_{2i}(\ckcO_{\mathrm g})-1), \half(\bfrr_{2i-1}(\ckcO_{\mathrm g})+1)) & (2i-1,2i)\in \wp
      %     \end{cases}
      %   \end{split}
      % \]

      Since $\tau_{\wp} = \cktau_{\wp}\otimes \sgn$, we get the claim.

      We adopt the convention that
      \[
        \sfS_{\cO} := \prod_{i\in \bN^{+}}\sfS_{\bfcc_{i}(\cO)}
      \]
      so that $j_{\sfS_{\cO}}^{\sfS_{\abs{\cO}}}\sgn = \cO$ for each partition
      $\cO$.

      Now consider the orbit under the Springer correspondence.

      Let
      $\ckcO'_{\mathrm b}: = [\bfrr_{2}(\ckcO_{\mathrm b}), \bfrr_{4}(\ckcO_{\mathrm b}),\cdots, \bfrr_{2k}(\ckcO_{\mathrm b})]$,
      $\cO'_{\mathrm b}:=(\ckcO'_{\mathrm b})^{t}$ and $\cO_{\mathrm b}:=\cO'_{\mathrm b}\cupcol \cO'_{\mathrm b}$.
      Clearly, $\ckcO_{\mathrm b} = \ckcO'_{\mathrm b}\cuprow \ckcO'_{\mathrm b}$. Note that
      $\tau_{\mathrm b} = j_{S_{\cO'_{\mathrm b}}}^{W'_{\mathrm b}} \sgn$ (by the formula of fake degree
      see Lusztig or Carter's book). So, by induction by stage of $j$-induction,
      we have
      \[
        \wttau_{\cO}:= j_{W'_{\mathrm b}\times W_{\mathrm g}}^{W_{n}} (\tau_{\mathrm b}\otimes \tau_{\emptyset}) = j_{S_{\cO'_{\mathrm b}}\times W_{\mathrm g}}^{W_{n}} \sgn\otimes \tau_{\wp}.
      \]
      By Barbasch-Vogan, $\cO_{\mathrm g}:=\Spr(\tau_{\emptyset}) = d_{BV}(\ckcO_{\mathrm g})$,
      which is well know how to calculate. (In fact, one can deduce the result
      by our computation. )

      Since the Springer correspondence commutes with parabolic induction, we
      get
      $\Spr(\wttau) = \Ind_{\GL_{\cO'_{\mathrm b}}\times \Sp(2g)}^{\Sp(2n)} 0\times \cO_{\mathrm g} = \cO_{\mathrm b}\cupcol \cO_{\mathrm g}$.


      \medskip

      {\bf Suppose $\star=D$.}

      The bad parity part is the same as that of the case when $\star = C$.

      Now consider the good parity part.
      \[
        \ckcO_{\mathrm g} = ((2l)^{2r'_{2l}+1}, (2l-1)^{2r'_{2l-1}}, (2l-2)^{2r'_{2l-2}}, \cdots, 2^{2r'_{2}}, 1^{2r'_{1}} )
      \]
      and
      \[
        W_{\lamckg} = W'_{l}\times \underbrace{S_{2l}\times \cdots \times S_{2l}}_{2r'_{2l}\text{-terms}} \times \prod_{i<2l} \underbrace{S_{i}\times \cdots\times S_{i}}_{r'_{i}\text{-terms}}
      \]

      The symbol of sign representation of $W'_{l}$ is
      \[
        \binom{0,1, \cdots, l-1}{1,2, \cdots, l\phantom{-1}}.
      \]
      (Here we always made the choice of the top and bottom row to compatible
      with the type $C$ case. )

      Induce to include all $2l$-length columns yields
      \[
        \binom{r'_{2l}+0,r'_{2l}+1, \cdots, r'_{2l}+l-1}{ r'_{2l}+1,r'_{2l}+2, \cdots, r'_{2l}+l\phantom{-1}}.
      \]
      Now move the shorter columns. When odd columns $(2i+1)^{2r'_{2i+1}}$
      occurs, it adds $(i)^{r'_{2i+1}}$ columns on the left and
      $(i+1)^{r'_{2i+1}}$ on the right. When even columns $(2i)^{r'_{2i}}$
      occur, the bifurcation happens: one can
      \begin{itemize}
        \item attach columns $(i)^{r'_{2i}}$ on the left and columns
              $(i)^{r'_{2i}}$ on the right, which corresponds to
              $(2i,2i+1)\neq \wp$, or
        \item attach columns $(i-1)^{r'_{2i}}$ on the left and columns
              $(i+1)^{r'_{2i}}$ on the right, which corresponds to
              $(2i,2i+ 1)\in \wp$,
      \end{itemize}

      Therefore,
      \[
        \begin{array}{ccc}
          \bF_{2}(\CPP(\ckcO_{\mathrm g}))&\longrightarrow
          & J_{W_{\lamckg}}^{W_{\mathrm g}} \sgn \\
          \wp&\mapsto&    (\cktau_{L},\cktau_{R}) =:\cktau_{\wp}
        \end{array}
      \]
      where
      \[
        \bfrr_{l}(\cktau_{L}) = r'_{2l} = \half (\bfrr_{2l}(\ckcO_{\mathrm g})-1)
      \]
      \[
        \bfrr_{1}(\cktau_{R}) = 1+ \sum_{i} r'_{i} = \half (\bfrr_{1}(\ckcO_{\mathrm g})+1)
      \]
      and, if $(2i,2i+1)\notin \wp$,
      \[
        \begin{split}
          \bfrr_{i}(\cktau_{L}) & = \sum_{l\geq 2i} r'_{l}
          = \half(\bfrr_{2i}(\ckcO)-1)\\
          \bfrr_{i+1}(\cktau_{R}) & = 1 + \sum_{l\geq 2i+1} r'_{l} = \half(\bfrr_{2i+1}(\ckcO)+1)
        \end{split}
      \]
      if $(2i,2i+1)\in \wp$,
      \[
        \begin{split}
          \bfrr_{i}(\cktau_{L}) & = \sum_{l\geq 2i+1} r'_{l}
          = \half(\bfrr_{2i+1}(\ckcO)-1)\\
          \bfrr_{i}(\cktau_{R}) & = 1 + \sum_{l\geq 2i} r'_{l} = \half(\bfrr_{2i}(\ckcO)+1)
        \end{split}
      \]

      Also note that $\cktau_{\wp}=\cktau_{\wp^{c}}$. The rest parts are the
      same as that of type $C$.

      {\bf Suppose $\star=B$. }

      In this case, bad parity is odd and every odd row occurs with even
      times.

      We can write
      $r'_{i} := \floor{\half(\bfrr_{i}(\ckcO_{\mathrm b})-\bfrr_{i-1}(\ckcO_{\mathrm b}))}$
      \[
        \ckcO_{\mathrm b} % = [2r_{1}+1, 2r_{1}+1, \cdots, 2r_{k}+1,2r_{k}+1]
        % = (2c_{0},2c_{1},2c_{1}, \cdots, 2c_{l}, 2c_{l}).
        = ((2l)^{2r'_{2l}+1}, (2l-1)^{2r'_{2l-1}},\cdots, 1^{2r'_{1}})
      \]
            %             with $k = c_{0}$ and $l = r_{1}$.
      Then
      \[
        W_{\lamckb} = W_{l} \times \underbrace{S_{2l}\times \cdots \times S_{2l}}_{2r'_{2l}\text{-terms}} \times \prod_{i<2l} \underbrace{S_{i}\times \cdots\times S_{i}}_{r'_{i}\text{-terms}}
      \]
      (Note that in the product, $r'_{i}=0$ if $i$ is odd.) The computation of
      $\cksigma_{\mathrm b} = J_{W_{\lamckb}}^{W_{\mathrm b}} \sgn$ is similar to that of the
      good parity for type $C$ with no bifurcating, one deduce that
      $J$-induction and $j$-induction gives the same result.
      \[
        \begin{split}
          \cksigma_{\mathrm b} &=
          \binom{0, 1+r_{l}, 2+r_{l-1}\cdots, l+r_{1}}{1+r_{l},2+r_{l-1}, \cdots, l+r_{1}}\\
          & = ([r_{1},r_{2},\cdots, r_{l}],[r_{1}+1,r_{2}+1,\cdots,r_{l}+1])\\
        \end{split}
      \]
      with $r_{i} = \half\bfrr_{2i-1}(\ckcO_{\mathrm b}) = \half\bfrr_{2i}(\ckcO_{\mathrm b})$.
      Now
      \[
        \sigma_{\mathrm b} = ((r_{1}+1,r_{2}+1,\cdots,r_{l}+1), (r_{1},r_{2},\cdots, r_{l})) = j_{S_{\cO'_{\mathrm b}}}^{W_{\mathrm b}}\sgn
      \]
      where
      $\cO'_{\mathrm b}=(\bfrr_{2}(\ckcO_{\mathrm b}),\bfrr_{4}(\ckcO_{\mathrm b}),\cdots, \bfrr_{2l}(\ckcO_{\mathrm b}))$.
      Under the Springer correspondence of type $B$, it corresponds to
      $\Ind_{\GL_{\mathrm b}}^{\SO(2b+1)}\cO'_{\mathrm b} = \cO'_{\mathrm b}\cuprow \cO'_{\mathrm b}\cuprow (1)$.

      % \[
      %   \begin{split}
      %     \cksigma_{\mathrm b} &:= \sigma_{\mathrm b}\otimes \sgn = j_{W_{\lamckb}}^{W_{\mathrm b}} \sgn \\
      %     & = %\dagger_{2c_{l}}\cdots \dagger_{2c_{1}}
      %     \sigma_{\mathrm b}\otimes \sgn = j_{W_{\lamckb}}^{W_{\mathrm b}} \sgn\otimes
      %     \binom{0, 1, \cdots, c_{0}}{1, \cdots, c_{0}}\\
      %     & =
      %     \binom{0, 1+r_{k}, 2+r_{k-1}\cdots, c_{0}+r_{1}}{1+r_{k},2+r_{k-1}, \cdots, c_{0}+r_{1}}\\
      %     & = ([r_{1},r_{2},\cdots, r_{k}],[r_{1}+1,r_{2}+1,\cdots,r_{k}+1])\\
      %     &= ((c_{1},c_{2},\cdots, c_{k}),(c_{0},c_{1}, \cdots, c_{l}))\\
      %   \end{split}
      % \]


      % We take the convention that $\dagger \cO = [r_{i}+1]$. By abuse of
      % notation, let $\dagger_{n} \sigma$ denote the
      % $j_{S_{n} \times W_{\abs{\sigma}}}^{W_{n+\abs{\sigma}}} \sgn\otimes \sigma$.
      % We can write
      % \[
      %   \ckcO_{\mathrm b} = [2r_{1}+1, 2r_{1}+1, \cdots, 2r_{k}+1,2r_{k}+1] = (2c_{0},2c_{1},2c_{1}, \cdots, 2c_{l}, 2c_{l})
      % \]
      % with $k = c_{0}$ and $l = r_{1}$.

      % \[
      %   \begin{split}
      %     W_{\lamckb} &= W_{c_{0}} \times S_{2c_{1}} \times S_{2c_{2}}\times \cdots \times S_{2c_{l}}\\
      %     \cksigma_{\mathrm b} &:= \sigma_{\mathrm b}\otimes \sgn = j_{W_{\lamckb}}^{W_{\mathrm b}} \sgn \\
      %     & = \dagger_{2c_{l}}\cdots \dagger_{2c_{1}}
      %     \binom{0, 1, \cdots, c_{0}}{1, \cdots, c_{0}}\\
      %     & =
      %     \binom{0, 1+r_{k}, 2+r_{k-1}\cdots, c_{0}+r_{1}}{1+r_{k},2+r_{k-1}, \cdots, c_{0}+r_{1}}\\
      %     & = ([r_{1},r_{2},\cdots, r_{k}],[r_{1}+1,r_{2}+1,\cdots,r_{k}+1])\\
      %     &= ((c_{1},c_{2},\cdots, c_{k}),(c_{0},c_{1}, \cdots, c_{l}))\\
      %   \end{split}
      % \]

      % Therefore
      % \[
      %   \begin{split}
      %     \sigma_{\mathrm b} &= \cksigma_{\mathrm b}\otimes \sgn = ((r_{1}+1,r_{2}+1,\cdots,r_{k}+1),(r_{1},r_{2},\cdots, r_{k})) \\
      %     & = j_{S_{2r_{1}+1}\times \cdots S_{2r_{k}+1}}^{W_{\mathrm b}} \sgn\\
      %     & = j_{S_{\mathrm b}}^{W_{\mathrm b}} (2r_{1}+1, 2r_{2}+1, \cdots, 2r_{k}+1)
      %   \end{split}
      % \]
      % which corresponds to the orbit
      % \[
      %   \cO_{\mathrm b} = (2r_{1}+1, 2r_{1}+1,2r_{2}+1, 2r_{2}+1, \cdots,2r_{k}+1, 2r_{k}+1 ) = \ckcO_{\mathrm b}^{t}.
      % \]
      % (Note that $\cO'_{\mathrm b} = (2r_{1}+1,2r_{2}+1, \cdots, 2r_{k}+1)$ which
      % corresponds to $j_{W_{L_{\mathrm b}}}^{S_{\mathrm b}}\sgn$ and
      % $\ind_{L}^{G} \cO'_{\mathrm b} = \cO_{\mathrm b}$. ) This implies the unique special
      % representation is
      % \[
      %   \sigma_{\mathrm b} = (j_{W_{\lamckb}}^{W_{\mathrm b}}\sgn), \quad \text{where
      % } W_{L,b} = \prod_{i=1}^{k} S_{2r_{i}+1}.
      % \]
      % The $J$-induction is calculated by \cite{Lu}*{(4.5.4)}. It is easy to
      % see that in our case $J_{W_{\lamckb}}^{W_{\mathrm b}} \sgn$ consists of the
      % single special representation by induction.


      Now we consider the good parity part, where each row of $\ckcO_{\mathrm g}$ has
      even length.

      Assume $r'_{i} := \half(\bfrr_{i}(\ckcO_{\mathrm g})-\bfrr_{i-1}(\ckcO_{\mathrm g}))$ and
      so
      \[
        \ckcO_{\mathrm g} % = [2r_{1}+1, 2r_{1}+1, \cdots, 2r_{k}+1,2r_{k}+1]
        % = (2c_{0},2c_{1},2c_{1}, \cdots, 2c_{l}, 2c_{l}).
        = ((2l+1)^{2r'_{2l+1}}, (2l)^{2r'_{2l}},\cdots, 1^{2r'_{1}})
      \]
      % Consider
      % \[
      %   \cO_{\mathrm g} = [2r_{1},2r_{2}, \cdots, 2r_{2k-1},2r_{2k}] = (C_{1},C_{1}, C_{2},C_{2},\cdots, C_{l}, C_{l}).
      % \]
      with $l =\min\set{i|\bfrr_{2i+2}(\ckcO_{\mathrm g}) = 0}$.

      Then
      \[
        W_{\lamckg} = \times \prod_{i\leq 2l+1} \underbrace{S_{i}\times \cdots\times S_{i}}_{r'_{i}\text{-terms}}
      \]

      Note that the trivial representation of the trivial group has symbol
      \[
        \binom{0,1, 2, \cdots, l\phantom{-1}}{0,1, \cdots, l-1}.
      \]


      Induce to include all $2l+1$-length columns yields
      \[
        \binom{r'_{2l+1}+0,r'_{2l+1}+1,r'_{2l+1}+2,\cdots, r'_{2l+1}+l\phantom{-1}}{ r'_{2l+1}+0,r'_{2l+1}+1, \cdots, r'_{2l+1}+l-1}.
      \]
      Now move the shorter columns. When odd columns $(2i+1)^{2r'_{2i+1}}$
      occurs, it adds $(i+1)^{r'_{2i+1}}$ columns on the left and
      $(i)^{r'_{2i+1}}$ on the right. When even columns $(2i)^{r'_{2i}}$ occur,
      the bifurcation happens: one can
      \begin{itemize}
        \item attach columns $(i)^{r'_{2i}}$ on the left and columns
              $(i)^{r'_{2i}}$ on the right, which corresponds to
              $(2i,2i+1)\neq \wp$, or
        \item attach columns $(i-1)^{r'_{2i}}$ on the left and columns
              $(i+1)^{r'_{2i}}$ on the right, which corresponds to
              $(2i,2i+1)\in \wp$.
      \end{itemize}


      Therefore,
      \[
        \begin{array}{ccc}
          \bF_{2}(\CPP(\ckcO_{\mathrm g}))&\longrightarrow
          & J_{W_{\lamckg}}^{W_{\mathrm g}} \sgn \\
          \wp&\mapsto&    (\cktau_{L},\cktau_{R}) =:\cktau_{\wp}
        \end{array}
      \]
      where
      % \[
      %   \bfrr_{2l+1}(\cktau_{L}) = r'_{2l+1} = \half \bfrr_{2l+1}(\ckcO_{\mathrm g})
      % \]
      \[
        \bfrr_{1}(\cktau_{L}) = \sum_{i} r'_{i} = \half \bfrr_{1}(\ckcO_{\mathrm g})
      \]
      and, if $(2i,2i+1)\notin \wp$,
      \[
        \begin{split}
          \bfrr_{i+1}(\cktau_{L}) & = \sum_{l\geq 2i+1} r'_{l}
          = \half\bfrr_{2i+1}(\ckcO)\\
          \bfrr_{i}(\cktau_{R}) & = \sum_{l\geq 2i} r'_{l} = \half\bfrr_{2i}(\ckcO)
        \end{split}
      \]
      if $(2i,2i+1)\in \wp$,
      \[
        \begin{split}
          \bfrr_{i+1}(\cktau_{L}) & = \sum_{l\geq 2i} r'_{l}
          = \half\bfrr_{2i}(\ckcO)\\
          \bfrr_{i}(\cktau_{R}) & = \sum_{l\geq 2i+1} r'_{l} = \half\bfrr_{2i+1}(\ckcO)
        \end{split}
      \]

      Some remarks on the BV-dual. The calculation of $\cO_{\mathrm g}$ from
      $\tau_{\emptyset}$ can be reduced to the case of quasi-distinguished
      orbits (other case are deduced from this by parabolic induction,
      corresponds to attach two even columns for the balanced pairs). Compare
      Sommer's description of Springer correspondence with ours, we deduce that
      \[
        \cO_{\mathrm g} = (\bfrr_{1}(\ckcO_{1})+1,\bfrr_{2}(\ckcO_{2})-1,\bfrr_{3}(\ckcO_{3})+1, \cdots, \bfrr_{2l}(\ckcO_{2l})-1,\bfrr_{2l+1}(\ckcO_{2l+1})+1)
      \]
      The rest parts are similar to that of type $D$.
    }


    We give the main steps of the proof for the case when $\star = \wtC$.


    We first consider the good parity part $\ckcO_{\mathrm g}$, where each row has
    even length.

    Set $r'_{i} := \half(\bfrr_{i}(\ckcO_{\mathrm g})-\bfrr_{i-1}(\ckcO_{\mathrm g}))$,
    $l =\min\set{i|\bfrr_{2i+1}(\ckcO_{\mathrm g})=0}$, and write
    \[
      \ckcO_{\mathrm g} % = [2r_{1}+1, 2r_{1}+1, \cdots, 2r_{k}+1,2r_{k}+1]
      % = (2c_{0},2c_{1},2c_{1}, \cdots, 2c_{l}, 2c_{l}).
     % = ((2l)^{2r'_{2l}}, (2l-1)^{2r'_{2l-1}},\cdots, 1^{2r'_{1}})
      = (\underbrace{2l,\cdots, 2l}_{2r'_{2l}}, \underbrace{2l-1,\cdots, 2l-1}_{2r'_{2l-1}},\cdots,
      \underbrace{1,\cdots, 1}_{2r'_{1}})
    \]
    where $i^{r'}$ denotes $r'$-copies of length $i$ columns.
    % Consider
    % \[
    %   \cO_{\mathrm g} = [2r_{1},2r_{2}, \cdots, 2r_{2k-1},2r_{2k}] = (C_{1},C_{1}, C_{2},C_{2},\cdots, C_{l}, C_{l}).
    % \]
    The Weyl group $W_{\mathrm g}$ of good parity is $\sfW'_{n_{\mathrm g}}$ with
    $n_{\mathrm g} = \half\abs{\ckcO_{\mathrm g}}$. For $1\leq k\leq l$, let
    \[
      % S_{r,s} = \prod_{i=r}^{s} \underbrace{\sfS_{i}\times \cdots\times \sfS_{i}}_{r'_{i}\text{-terms}}
      \vec{S}_{i} = \underbrace{\sfS_{i}\times \cdots\times \sfS_{i}}_{r'_{i}\text{-times}} \AND n_{k} = \sum_{i=k}^{2l} i\cdot r'_{i}.
      % \AND n_{r,s} = \sum_{i=r}^{s} i\cdot r'_{i}.
    \]

    Then $W_{\lamckg}=\prod_{i=1}^{l} \vec{S}_{i}$ and
    \[
      \begin{split}
        \ckLV_{\ckcO_{\mathrm g}}& :=J_{W_{\lamckg}}^{\Wg}\sgn\\
        & = J_{\vec{S}_{1}\times \sfW'_{n_{2}}}^{\sfW'_{n_{1}}} \Big(\sgn \otimes J_{\vec{S}_{2}\times \sfW'_{n_{3}}}^{\sfW'_{n_{2}}}\Big(\sgn
        \otimes \cdots\big(J_{\vec{S}_{l}} \sgn\big)\cdots \Big)\Big) \\
      \end{split}
    \]
    Applying \cite{Lu}*{(4.6.2)} inductively, we see that the operation
    $J_{\vec{S}_{i}\times \sfW'_{n_{i+1}}}^{\sfW'_{n_{i}}}(\sgn \otimes \underline{\ \ \ })$ yields a multiplicity-free representation and
    doubles (resp. keeps) the number of irreducible constituents if $i$ is odd (resp. even). Informally we will say that a bifurcation occurs when attaching an odd length column.
    Denote by $\ckLC_{\ckcO_{\mathrm g}}$ the multiset of irreducible constituents of $\ckLV_{\ckcO_{\mathrm g}}$.

    First assume $\CPPs(\ckcO_{\mathrm g}) = \emptyset$. Define
    \[
      \tA'(\ckcO):= \bZ_{2}[\emptyset]
    \]
    to be the trivial group.
    Then $\ckLV_{\ckcO_{\mathrm g}}$ is
    irreducible (with the corresponding bipartition marked by the label $I$).  Hence, $\LC_{\ckcO_{\mathrm g}}$
    %$\LC_{\ckcO)}$
    and $\tA'(\ckcO)$ can be obviously identified.


    Now assume $\CPPs(\ckcO_{\mathrm g})\neq \emptyset$. Then the two parts of the
    bipartition of an irreducible constituent after each operation
    $J_{\vec{S}_{i}\times \sfW'_{n_{i+1}}}^{\sfW'_{n_{i}}}(\sgn \otimes \underline{\ \ \ })$ are different. Let
    \[i_{0}:= \min\Set{i| (2i-1,2i)\in \CPPs(\ckcO_{\mathrm g})}.\]
    % $(2i_{0}-1,2i_{0})$ be the element in such that $i_{0}$ is minimal.
    Then we will have a bijection
    \[
      \tA'(\ckcO):= \set{\wp\in \bZ_{2}[\CPPs(\ckcO_{\mathrm g})]|(2i_{0}-1,2i_{0})\notin \wp} \longrightarrow \ckLC_{\ckcO_{\mathrm g}}
    \]
    which records the bifurcation when attaching odd length columns. More precisely, by Lusztig's formula of $J$-induction, a bijection is given by sending
      $\wp$ to $\cktau_{\wp}:= (\cktau_{L},\cktau_{R})$, where
    \[
      (\bfrr_{i}(\cktau_{L}),\bfrr_{i}(\cktau_{R})) := \begin{cases} (\half\bfrr_{2i}(\ckcO_{\mathrm g}),\half\bfrr_{2i-1}(\ckcO_{\mathrm g}))
        & \text{if } (2i-1,2i)\notin \wp ,\\
        (\half\bfrr_{2i-1}(\ckcO_{\mathrm g}),\half\bfrr_{2i}(\ckcO_{\mathrm g}))
        & \text{if } (2i-1,2i)\in \wp .\\
      \end{cases}
    \]
    By interchanging the two parts of a bipartition belonging to $\ckLC_{\ckcO_{\mathrm g}}$, we thus obtain a bijection of $\tA'(\ckcO)$ with $\LC_{\ckcO_{\mathrm g}}$, which sends $\wp$ to $\tau_{\wp}$.


    \trivial[h]{ Note that the trivial representation of the trivial group is
      represented by the symbol
      \[
        \binom{0,1, 2, \cdots, l-1}{0,1,2, \cdots, l-1}_{I}.
      \]
      % Induce to include all $2l$-length columns yields
      % \[
      %   \binom{r'_{2l+1}+0,r'_{2l+1}+1,r'_{2l+1}+2,\cdots, r'_{2l+1}+l\phantom{-1}}{ r'_{2l+1}+0,r'_{2l+1}+1, \cdots, r'_{2l+1}+l-1}.
      % \]

      Now move the shorter columns. When even columns $(2i)^{2r'_{2i}}$
      occurs, it adds $(i)^{r'_{2i}}$ columns on the left and $(i)^{r'_{2i}}$ on
      the right. When odd columns $(2i-1)^{r'_{2i-1}}$ occur, the bifurcation
      happens: one can
      \begin{itemize}
        \item attach columns $(i-1)^{r'_{2i-1}}$ on the left and columns
              $(i)^{r'_{2i-1}}$ on the right, which corresponds to
              $(2i-1,2i)\neq \wp$, or
        \item attach columns $(i)^{r'_{2i-1}}$ on the left and columns
              $(i-1)^{r'_{2i-1}}$ on the right, which corresponds to
              $(2i-1,2i)\in \wp$.
      \end{itemize}
      Note that when we first encounter the longest odd column, we make the
      choice that the size of left part is larger than that of the right part.
      Now If $(2i-1,2i)\notin \wp$,
      \[
        \begin{split}
          \bfrr_{i}(\cktau_{L}) & = \sum_{l\geq 2i} r'_{l}
          = \half\bfrr_{2i}(\ckcO_{\mathrm g})\\
          \bfrr_{i}(\cktau_{R}) & = \sum_{l\geq 2i-1} r'_{l} = \half\bfrr_{2i-1}(\ckcO_{\mathrm g})
        \end{split}
      \]
      if $(2i-1,2i)\in \wp$,
      \[
        \begin{split}
          \bfrr_{i}(\cktau_{L}) & = \sum_{l\geq 2i-1} r'_{l}
          = \half\bfrr_{2i-1}(\ckcO_{\mathrm g})\\
          \bfrr_{i}(\cktau_{R}) & = \sum_{l\geq 2i} r'_{l} = \half\bfrr_{2i}(\ckcO_{\mathrm g})
        \end{split}
      \]
    }


    Now we consider the bad parity part, where each row has
    odd length.
    %For a partition $\cO$, we set
    %\[
    % \sfS_{\cO} := \prod_{i\in \bN^{+}}\sfS_{\bfcc_{i}(\cO)}
    %\]
    %so that $j_{\sfS_{\cO}}^{\sfS_{\abs{\cO}}}\sgn = \cO$.



    Suppose $\ckcOpb$ is nonempty.
    % such that
    % \[
    %   \ckcO_{\mathrm b} = (c_{0},c_{1}, c_{1}, c_{2},c_{2}, \cdots, c_{k}, c_{k})
    % \]
    % where
    Let $2k+1=\bfrr_{1}(\ckcOpb)$ and $c_{i} = \bfcc_{2i+1}(\ckcOpb)$.
    Now
    \[
      W_{\lamckb} = \sfW_{c_{0}} \times \sfS_{2c_{1}} \times \sfS_{2c_{2}}\times \cdots \times \sfS_{2c_{k}}
    \]
    and %$J_{W_{\lamckb}}^{W_{\mathrm b}}\sgn$ is irreducible by
    \[
      \begin{split}
        \cktau_{\mathrm b} &:= J_{W_{\lamckb}}^{\Wb} \sgn
        = \big((c_{1},c_{2},\cdots, c_{k}),(c_{0},c_{1}, \cdots, c_{l})\big)\\
        & = \big([\half(\bfrr_{1}(\ckcOpb)-1),\half(\bfrr_{2}(\ckcOpb)-1),\cdots, \half(\bfrr_{c_{0}}(\ckcOpb)-1)],\\
        & \hspace{2em} [\half(\bfrr_{1}(\ckcOpb)+1),\half(\bfrr_{2}(\ckcOpb)+1),\cdots, \half(\bfrr_{c_{0}}(\ckcOpb)+1)]\big)
      \end{split}
    \]
    is irreducible by \cite{Lu}*{(4.5.4)}. Tensoring with sign yields the
    formula of $\tau_{\mathrm b}$. Moreover, by the fake degree formula (see
    \cite{Carter}*{p~376}), we have
    \[
      \tau_{\mathrm b} = \cktau_{\mathrm b}\otimes \sgn = j_{\sfS_{\cO'_{\mathrm b}}}^{\sfW_{n_{\mathrm b}}} \sgn,
    \]
    where
    $ \cOpb:= (\ckcOpb)^{t}$
    % $:=(\bfrr_{1}(\ckcO),\bfrr_{4}(\ckcO),\cdots , \bfrr_{2c_{0}}(\ckcO))$,
    and $\sfS_{\cOpb} := \prod_{1\leq i\leq c_{0}}\sfS_{\bfrr_{i}(\ckcOpb)}$. The proof for the first part is now complete.

    \medskip \def\ckfll{\check{\fll}}

    Next we give the main steps of the proof for the second part, when $\star = \wtC$.
    %the proof of \eqref{eq:dBV.W}.

    Recall the definition of the metaplectic Barbasch-Vogan dual in
    \cite{BMSZ1}. A key property is that this duality map commutes with parabolic induction: Suppose
    $\ckfll\subset \ckfgg$ is a parabolic subalgebra of $\ckfgg$ and
    $\fll$ is the corresponding parabolic subalgebra in $\fgg$, then
    \begin{equation*}%\label{eq:inddBV}
      \dBV(\ckcO) =  \Ind_{\fll}^{\fgg}(\dBV(\ckcO_{\ckfll}))
    \end{equation*}
    for each nilpotent orbit $\ckcO$ in $\ckfgg$ such that
    $\ckcO_{\ckfll}:=\ckcO\cap \ckfll\neq \emptyset$. This is clear by reducing
    to the type $B$ case, as in \cite{BMSZ1}*{Proposition~3.8}. By removing pairs
    of rows with the same lengths in $\ckcO$, we are reduced to check the equality in \eqref{eq:dBV.W}
    in the case when $\ckcOpb=\emptyset$ and
    $\bfrr_{2i-1}(\ckcO_{\mathrm g})>\bfrr_{2i}(\ckcO_{\mathrm g})$ for all $i$ such that
    $i\leq \bfcc_{1}(\ckcO_{\mathrm g})$. In this case, both sides of \eqref{eq:dBV.W}
    can be easily computed and are equal to
    \[
      (\bfrr_{1}(\ckcOg)-1, \bfrr_{2}(\ckcOg)+1, \cdots,\bfrr_{2c-1}(\ckcOg)-1,\bfrr_{2c}(\ckcOg)+1),
    \]
    where $c = \min\set{i|\bfrr_{2i+1}(\ckcOg)=0}$. The general case follows
    from the aforementioned compatibility with parabolic induction.
    }
    %\end{proof}



    % Now we compare the metaplectic dual defined in \cite{BMSZ1} with the Weyl
    % group representations.
    \trivial[h]{ Compare Sommer's description of Springer correspondence we
      deduce that the RHS is
      \[
        \cO_{\mathrm g} = (\bfrr_{1}(\ckcO_{1})-1,\bfrr_{2}(\ckcO_{2})+1,\bfrr_{3}(\ckcO_{3})+1, \cdots, \bfrr_{2l-1}(\ckcO_{2l-1})-1,\bfrr_{2l}(\ckcO_{2l})+1)
      \]
      The LHS is calculated by $((((\ckcO^{t})_{D})^{+})^{-})_{C}$. We write
      $R_{i}=\bfrr_{i}(\ckcO)=2r_{i}$. Now under our assumption,
      $R_{2i-1}>R_{2i}$, we have
      \[
        \begin{split}
          ((((\ckcO^{t})_{D})^{+})^{-})_{C} &=
          ((((R_{1},R_{2}, \cdots, R_{2l-1},R_{2l})_{D})^{+})^{-})_{C}\\
          &=((R_{1}-1,R_{2}, \cdots, R_{2l-1},R_{2l},1))_{C}\\
          &=(R_{1}-1,R_{2}+1, \cdots, R_{2l-1}-1,R_{2l}+1)\\
        \end{split}
      \]
      So the proof is done.

    }

    %At last, one can see that
    %$\dBV(\ckcO_{\mathrm b}\cuprow \ckcO_{\mathrm g}) = \ckcO_{\mathrm b}^{t} \cupcol \dBV(\ckcO_{\mathrm g})$
    %using \eqref{eq:inddBV}.


  % \begin{remark}
  %   When $\star=\wtC$, one can see that
  %   $\dBV(\ckcO_{\mathrm b}\cuprow \ckcO_{\mathrm g}) = \ckcO_{\mathrm b}^{t} \cupcol \dBV(\ckcO_{\mathrm g})$
  %   using \eqref{eq:inddBV}. \trivial[]{ This could be checked using the
  %   formula of Springer correspondence directly, see Sommer's. }
  % \end{remark}
%

Recall that $\Wg' =\sfW'_{n_{\mathrm g}}$ when $\star \in \set{\wtC,D,D^{*}}$. Since the representation theory of $\sfW_{n}$ is more elementary than that of
$\sfW'_{n}$, we prefer to work with $\sfW_n$ instead of $\sfW_n'$ in some situations. For this reason,
%when $\star \in \set{\wtC,D,D^{*}}$
we also define for all cases
\begin{equation}\label{eq:ttauwp}
\wttau_{\wp} = (\imath_{\wp},\jmath_{\wp})\in \Irr(\sfW_{n_\mathrm g}), \qquad \wp\in {\mathrm A}(\ckcO).
\end{equation}
See \eqref{eq:tauwp} for the description of $\imath_{\wp}$ and $\jmath_{\wp}$.

For later use, we record the following lemma, which follows immediately from our explicit descriptions of  $\tau_{\mathrm b}$ and $\tau_{\wp}$.

\begin{lem}\label{lem:WLcell}
Let $\wp\in {\mathrm A}(\ckcO)$. If $\star=\wtC$, then
  \[
    \Ind_{\sfW_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}} \tau_{\mathrm b}\otimes\tau_{\wp}  =
    \begin{cases}
       \tau_{\mathrm b}\otimes \wttau_{\emptyset}, &\quad  \text{if } n_{\mathrm g}=0; \\
      (\tau_{\mathrm b}\otimes \wttau_{\wp}) \oplus ( \tau_{\mathrm b}\otimes \wttau_{\wp^{c}}),
      &\quad \text{otherwise}.
    \end{cases}
  \]
If $\star\in\set{D,D^{*}}$, then
  \[
    \Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}} \tau_{\mathrm b}\otimes \tau_{\wp} \cong
    \begin{cases}
      \wttau_{\mathrm b}, & \quad \text{if } n_{\mathrm g}=0; \\
      ( \wttau_{\mathrm b}\otimes \wttau_{\wp})  \oplus ( \wttau_{\mathrm b}\otimes \wttau_{\wp}^{s}),
      &\quad \text{otherwise}.
    \end{cases}
  \]
  Here $\wttau_{\mathrm b} = \Ind_{\sfW'_{n_{\mathrm b}}}^{\sfW_{n_{\mathrm b}}}\tau_{\mathrm b}$ and $\wttau_{\wp}^{s}:= \wttau_{\wp}\otimes \varepsilon$ (recall the quadratic character $\varepsilon$ from \eqref{defep}).

  %\brsgn \neq \wttau_{\wp}$.

  % Then we have a bijection
  % \[
  %     \begin{array}{lccccccc}
  %       \tA(\ckcO)&=&\tA(\ckcO_{\mathrm g}) & \longrightarrow & \tLC(\ckcO_{\mathrm g})
  %       & \longrightarrow & \tLC(\ckcO)\\
  %                   &  &\wp & \mapsto & \wttau_{\wp} &
  %                                                    \mapsto & \tau_{\mathrm b}\otimes \wttau_{\wp}.
  %     \end{array}
  % \]

 \trivial[h]{
  Let
\[
  \tLV_{\ckcO}:= \Ind_{\sfW'_{n_{\mathrm g}}\times \sfW_{n_{\mathrm b}}}^{\sfW_{n_{\mathrm g}}\times \sfW_{n_{\mathrm b}}}\LV_{\ckcO}
\]
and $\tLC_{\ckcO}$ be the set of irreducible constituents of the (multiplicity free) $\sfW_{n_{\mathrm g}}\times \sfW_{n_{\mathrm b}}$-module $\tLV_{\ckcO}$.
Then we have a
bijection:
  \[
      \begin{array}{lccccccc}
        \tA(\ckcO)&\cong&\tA(\ckcO_{\mathrm g}) & \longrightarrow & \tLC(\ckcO_{\mathrm g})
        & \longrightarrow & \tLC_{\ckcO}\\
                  &  &\wp & \mapsto & \wttau_{\wp}
        & \mapsto & \wttau_{\wp}\otimes \tau_{\mathrm b}.
      \end{array}
  \]
  }
\end{lem}

\subsection{From coherent continuation representation to counting}




We have defined in \eqref{defpbp2222} the set $\PBPs(\ckcO)$ when $\ckcO$ has good parity. Similarly, we make the following definition in the bad parity case.
\begin{defn}
  Let $\PBPs(\ckcOb)$ be the set of all triples
  $\uptau = (\imath,\cP)\times(\jmath,\cQ)\times \star $ where $(\imath,\cP)$ and
  $(\jmath,\cQ)$ are painted partitions such that
  \begin{itemize}
    \item $(\imath,\jmath) = (\tau_{L,\mathrm b},\tau_{R,\mathrm b})$ (see \eqref{eq:taub});
    \item the symbols of $\cP$ are in
          \[
          \begin{cases}
            \set{\bullet, c,d},  & \text{if } \star\in \set{B,\wtC}; \\
            \set{\bullet, d},  & \text{if } \star\in \set{C,D};\\
            \set{\bullet},  & \text{if } \star\in \set{C^{*},D^{*}};\\
          \end{cases}
          \]
    \item the symbols of $\cQ$ are in

          \[
          \begin{cases}
            \set{\bullet, c},  & \text{if } \star\in \set{C,D};\\
            \set{\bullet},  & \text{if } \star\in \set{B,\wtC, C^{*},D^{*}}.\\
          \end{cases}
          \]
  \end{itemize}
\end{defn}

%We define the partition $\ckcOpb$ by $\ckcOb = 2\ckcOpb$. To be more precise, $\bfrr_{i}(\ckcO'_{\mathrm b}):= \bfrr_{2i}(\ckcO_{\mathrm b})$, for all $i\in \bN^{+}$. Let $\cO'_{\mathrm b}:= (\ckcO'_{\mathrm b})^{t}$.
  %\item $\cO_{\mathrm b}:= \cO'_{\mathrm b}\cupcol \cO'_{\mathrm b}$.
 %$\ckcOpb$ is a partition of $\half\abs{\ckcOb}$.

% Recall from \eqref{Gpb} the group
% \[
%   G'_{\mathrm b} := \begin{cases}
%     \GL_{n_{\mathrm b}}(\bR), & \text{if } \star \in \set{B,C,D}; \\
%     \widetilde{\GL}_{n_{\mathrm b}}(\bR), & \text{if } \star = \wtC; \\
%     \GL_{\frac{n_{\mathrm b}}{2}}(\bH), & \text{if } \star \in \set{C^{*},D^{*}}.\\
%   \end{cases}
% \]
%When $\star=\wtC$, let $\Unip_{\ckcOpb}(\Gpb)$ be the set of genuine unipotent representations of $\Gpb$ which is naturally identified with $\Unip_{\ckcOpb}(\GL(n_{\mathrm b},\bR))$.

% \begin{prop}\label{prop:BP.PP} In all cases,
% \[
%     \begin{split}
%       \sharp(\PBP_{\star}(\ckcO_{\mathrm b})) = \sharp(\PP_{\star '}(\ckcO'_{\mathrm b})) = \sharp(\Unip_{\ckcO'_{\mathrm b}}(G'_{\mathrm b})),
%     \end{split}
%   \]
% where
% \begin{equation}\label{def:star'}
% \star ':= \begin{cases}
%     A^{\bR}, & \text{if } \star \in \set{B,C,\wtC,D}; \\
%     A^{\bH}, & \text{if } \star \in \set{C^{*},D^{*}}.\\
%   \end{cases}
%   \end{equation}
% %is the set of painted partitions of type $A$ or $A^{\bH}$ attached to $\ckcO'_{\mathrm b}$.
% \end{prop}

% \begin{proof} Suppose that $\star \in \Set{C^{*},D^{*}}$. Then
% \[
%     \begin{split}
%       \sharp(\PBP_{\star}(\ckcO_{\mathrm b};\tau_{\mathrm b}))= \sharp(\PP_{A^{\bH}}(\ckcO'_{\mathrm b}))= 1.
%     \end{split}
% \]
%   Suppose that $\star \in \Set{B,C,\wtC,D}$.
%   %Recall the Young diagrams $\tau_{L,b}$ and $\tau_{R,b})$ from \eqref{eq:taub} and \eqref{eq:taub2}.
%    It is easy to see that we have a bijection
%   \[
%     \begin{array}{ccc}
%       \PBP_{\star}(\ckcO_{\mathrm b}) &  \rightarrow & \PP_{A^{\bR}}(\ckcO'_{\mathrm b}),\\
%       (\tau_{L,b},\cP)\times (\tau_{R,b},\cQ)\times & \mapsto & ((\ckcO'_{\mathrm b})^t,\cP'),
%     \end{array}
%   \]
%   where $\cP'$ is defined by the condition that
%   \[
%     \cP(\bfcc_{j}(\tau_{L,b}),j)=d \Longleftrightarrow \cP'(\bfrr_{j}(\ckcO'_{\mathrm b}),j)=d, \quad \textrm{ for all } j=1,2,\cdots, \bfcc_{1}(\ckcO'_{\mathrm b}).
%   \]
%   The last equality is in Theorems \ref{thm:mainR} and \ref{thm:mainH}.   \end{proof}


%   \trivial[h]{
%     % Let $\tau' = \ckcO'^{t}_{\mathrm b}$ and $\tau_{\mathrm b}=(\tau_{L,b}, \tau_{R,b})$. Here
%     % $\tau_{L,b}, \tau_{R,b}$.
%     Now the claim follows for the fact that the bottom rows in $\uptau_{L}$ can
%     be filled by $\bullet/c$ or $d$ and
%     \[
%       \bfcc_{i}(\tau_{L,b}) = \bfcc_{j}(\tau_{L,b}) \Leftrightarrow \bfcc_{i}(\cOpb) = \bfcc_{j}(\cOpb) \quad \textrm{ for all } i,j\in \bN^{+}.
%     \]
%   }





 We introduce some additional notation. For each bipartition $\tau$, let
\[
  \PBP_{\star}(\tau) := \Set{ \uptau \text{ is a painted bipartition }\mid  \star_{\uptau}=\star, (\imath_{\uptau},\jmath_{\uptau}) = \tau}
  % \uptau=(\imath, \cP)\times (\jmath,\cP)\times \alpha|}
\]
and
\[
  \PBP_{G}(\tau) := \Set{\uptau \text{ is a painted bipartition }\mid G_{\uptau}=G, (\imath_{\uptau},\jmath_{\uptau}) = \tau}.
  % \uptau=(\imath, \cP)\times (\jmath,\cP)\times \alpha|}
\]
Put
\[
  \tPBP_{\star}(\ckcO) := %\bigsqcup_{\tau\in\LC(\ckcOg)}\PBP_{\star}(\tau).
  \bigsqcup_{\wp \subseteq \CPP(\ckcO)}\PBP_{\star}(\wttau_{\wp})
\]
and
\[
  \tPBP_{G}(\check \CO):=   \bigsqcup_{\wp \subseteq \CPP(\ckcO)}\PBP_{G}(\wttau_{\wp}),
 \]
where $\wttau_{\wp} := (\imath_{\wp},\jmath_{\wp})$ (see \eqref{eq:ttauwp}).


%Recall the group $G_\mathrm g$ from \eqref{gg00} (with $l=\nnb$).  Its Langlands dual group is identified with $\check G_\mathrm g$.

Recall the notion of $\check \CO$ being $G$-relevant (\Cref{secrgp0}). Note that if  $\star =D^{*}$, then $\check \CO$ is not $G$-relevant if and only if $\check \CO$ has bad parity and type II (see \eqref{assumi}).

\begin{prop}\label{prop:countBCD}
 If  $\star =D^{*}$ and $\check \CO$ is not $G$-relevant, then
  \[
  \sum_{\bar \wp\in \bar{\mathrm A}(\ckcO)} [\tau_{\mathrm b}\otimes \tau_{\bar \wp}: \Coh_{\Lambda} (\CK'(G))]=0.
  \]
In all other cases,   % \[
  %   [\tau_{\mathrm b}: \cC_{\mathrm b}] = \PBP_{\star,b}(\ckcO_{\mathrm b}) = \PBP_{G'}(\ckcO'_{n_{\mathrm b}}) = \Unip_{\ckcO'_{\mathrm b}}(G'_{n_{\mathrm b}})
  % \]
  % and
  % \[
  %   \sum_{\tau\in \LC_{\ckcO_{\mathrm g}}} [\tau:\cC_{\mathrm g}] = \PBP_{\mathrm g}(\ckcO_{\mathrm g}).
  % \]
 \[
 \sum_{\bar \wp\in \bar{\mathrm A}(\ckcO)} [\tau_{\mathrm b}\otimes \tau_{\bar \wp}: \Coh_{\Lambda} (\CK'(G))]=
           \sharp (\PBP_{\star}(\ckcO_{\mathrm b}))\cdot \sharp(\tPBP_{G_{\mathrm g}}(\ckcO_{\mathrm g})).
           \]
 \end{prop}



 \begin{proof}
   We use the following
  formulas (\cite{Mc}*{p220 (6)})  to compute the multiplicities:
  \begin{equation}\label{eq:indSW}
    \begin{split}
      \Ind_{\sfH_{t}}^{\sfW_{2t}} \tilde{\varepsilon}& \cong   \bigoplus_{\sigma\in \Irr(\sfS_{t})} (\sigma,\sigma),\\
      \Ind_{\sfH_{t}}^{\sfW'_{2t}} \tilde{\varepsilon} &\cong  \bigoplus_{\sigma\in \Irr(\sfS_{t})} (\sigma,\sigma)_{I},\\
      \Ind_{\sfS_{t}}^{\sfW_{t}}\sgn &\cong \bigoplus_{a+b=t}\Ind_{\sfW_{a}\times \sfW_{\mathrm b}}^{\sfW_{t}} \bsgn\otimes \sgn \cong \bigoplus_{a+b=t} ([a]_{\mathrm{col}},[b]_{\mathrm{col}}),\\
      \Ind_{\sfS_{t}}^{\sfW_{t}} 1 &\cong \bigoplus_{a+b=t}\Ind_{\sfW_{a}\times \sfW_{\mathrm b}}^{\sfW_{t}} 1 \otimes \epsilon \cong \bigoplus_{a+b=t} ([a]_{\mathrm{row}},[b]_{\mathrm{row}}),
    \end{split}
\end{equation}
where $t\in \bN$.

We skip the details when $\star \in \set{B,\wtC, C,D,C^{*}}$, and present the computation for $\star = D^{*}$, which is the most complicated case.
 Suppose that $\star=D^*$ so that $G=\oO^*(2n)$.  If $\check \CO$ has bad parity, then
  \begin{eqnarray*}
 && \sum_{\bar \wp\in \bar{\mathrm A}(\ckcO)} [\tau_{\mathrm b}\otimes \tau_{\bar \wp}: \Coh_{\Lambda} (\CK'(G))] \medskip \\
 &=&[\tau_{\mathrm b} : \Coh_{\Lambda} (\CK'(G))] \medskip \\
 &=& [\tau_\mathrm b:\Ind_{\sfH_{t}}^{\sfW'_{2t}} \tilde{\varepsilon}] \medskip \\
& =& \begin{cases}
    1=\sharp (\PBP_{\star}(\ckcO_{\mathrm b}))\cdot \sharp(\tPBP_{G_{\mathrm g}}(\ckcO_{\mathrm g})),  \qquad &  \text{if $\check \CO$ is $G$-relevant;}\medskip \\
          0, \qquad & \text{if $\check \CO$ is not $G$-relevant.}
       \end{cases}
  \end{eqnarray*}


Now we assume that $\check \CO$ does not have bad parity so that $n_\mathrm g>0$.
 Put
 \[
   \sfW'_{\nbb, \ngg}:=\sfW'_n\cap (\sfW_{\nbb}\times \sfW_{\ngg})\supseteq \sfW'_{\nbb}\times \sfW'_{\ngg}= W_{\mathrm b}\times W_{\mathrm g}.
 \]


Recall that
  \[
    \wttau_{\mathrm b} := \Ind_{\sfW'_{\nbb}}^{\sfW_{\nbb}} \tau_{\mathrm b} = (\cOpb,\cOpb)\in \Irr(\sfW_{\nnb})
    \]
    and
    \[
    \wttau_{\wp}: = (\imath_{\wp},\jmath_{\wp})\in \Irr(\sfW_{\nng}) \quad \textrm{ for all } \wp \subseteq \CPP(\ckcOg).
  \]
  Note that $\imath_{\wp}\neq \jmath_{\wp}$ since
  $\bfcc_{1}(\imath_{\wp})> \bfcc_{1}(\jmath_{\wp})$, which implies that
  \begin{equation*}%\label{eq:W''}
    \Ind_{\sfW'_{\nbb}\times \sfW'_{\ngg}}^{\sfW_{n_{\mathrm b},n_{\mathrm g}}'} \tau_{\mathrm b}\otimes \tau_{\wp}
    \cong (\wttau_{\mathrm b}\otimes \wttau_{\wp})|_{\sfW_{n_{\mathrm b},n_{\mathrm g}}'}.
  \end{equation*}

  \trivial[h]{ When $\nbb=0$, $W'' = W_{\mathrm g} = \sfW'_{\ngg}$ and so
    $\wttau_{\wp}|_{\sfW'_{\ngg}} = \tau_{\wp}$.

    Now we assume $\nbb\neq 0$ and $\ngg\neq 0$ (the general case). This
    follows from the following points
    \begin{itemize}
      \item the dimension of the two sides are equal ($W_{\mathrm b}\times W_{\mathrm g}$ has
            index $2$ in $W''$).
      \item
            \[
            \begin{split}
              &[\Ind_{W_{\mathrm b}\times W_{\mathrm g}}^{W''}\tau_{\mathrm b}\otimes \tau_{\wp}:(\wttau_{\mathrm b}\otimes \wttau_{\wp})|_{W''}] \\
              =& [\Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\tau_{\mathrm b}\otimes \tau_{\wp}:\wttau_{\mathrm b}\otimes \wttau_{\wp}]\\
              =& [\wttau_{\mathrm b}\otimes \wttau_{\wp} \oplus \wttau_{\mathrm b}\otimes (\wttau_{\wp}\otimes \brsgn):\wttau_{\mathrm b}\otimes \wttau_{\wp}] =1\\
            \end{split}
            \]
            where $\wttau_{\wp}\otimes \brsgn$ has the bipartition obtained by
            switching the left and right side of $\wttau_{\wp}$.
      \item the LHS is irreducible, by
            \[
            \begin{split}
              & [\Ind_{W_{\mathrm b}\times W_{\mathrm g}}^{W''}\tau_{\mathrm b}\otimes \tau_{\wp}:
              \Ind_{W_{\mathrm b}\times W_{\mathrm g}}^{W''}\tau_{\mathrm b}\otimes \tau_{\wp}]_{W''}\\
              =&  [\tau_{\mathrm b}\otimes \tau_{\wp} : (\Ind_{W_{\mathrm b}\times W_{\mathrm g}}^{W''}\tau_{\mathrm b}\otimes \tau_{\wp})|_{W_{\mathrm b}\times W_{\mathrm g}}]\\
              =& [\tau_{\mathrm b}\otimes \tau_{\wp} : \tau_{\mathrm b}\otimes \tau_{\wp} + (\cOpb,\cOpb)_{II} \otimes \tau_{\wp} ] = 1
            \end{split}
            \]
    \end{itemize}
  }

  For ease of notation, write $\sfW'':=\sfW_{n_{\mathrm b},n_{\mathrm g}}'$. Put
  \[
    \cC_{\mathrm b}:=   \Ind_{\sfH_{\frac{n_\mathrm b}{2}}}^{\sfW_{n_\mathrm b}}\tilde{\varepsilon} \quad\textrm{and}\quad  \cC_\mathrm g:=  \bigoplus_{\substack{2t+a=n_\mathrm g}} \Ind_{\sfH_{t} \times \sfS_{a}}^{\sfW'_{n_\mathrm g}}
         \tilde{\varepsilon} \otimes \sgn,
           \]
           where $\cC_\mathrm b$ is viewed as a representation of $\sfW_{n_\mathrm b}'$ by restriction.
   For every finite group $E$ and any  two finite-dimensional  representations $V_1$ and $V_2$ of $E$, put
  \[
    [V_1, V_2]_E:=\dim \Hom_E(V_1, V_2).
  \]
   For each $\wp\in \mathrm A (\ckcOg)$, we have that
  \[
    \begin{split}
    [\tau_{\mathrm b}\otimes \tau_{\wp}: \Coh_{\Lambda} (\CK'(G))]
      = & [\tau_{\mathrm b}\otimes \tau_{\wp} :
      \Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW''} \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}\\
      = & [\Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW''} \tau_{\mathrm b}\otimes \tau_{\wp} :
      \Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW''} \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW''}\\
      = & [(\wttau_{\mathrm b}\otimes \wttau_{\wp})|_{\sfW''}:
      \Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW''} \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW''}\\
      = & [\wttau_{\mathrm b}\otimes \wttau_{\wp}:
      \Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}} \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
       = & [\wttau_{\mathrm b}:\Ind_{\sfW'_{n_{\mathrm b}}}^{\sfW_{n_{\mathrm b}}} \cC_{\mathrm b}]_{\sfW_{n_{\mathrm b}}}\cdot
           [\wttau_{\wp}:\Ind_{\sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm g}}} \cC_{\mathrm g}]_{\sfW_{n_{\mathrm g}}}\\
      =& \sharp(\PBP_{\star}(\ckcOb)))\cdot \sharp(\PBP_{\Gg}(\wttau_{\wp})).
    \end{split}
  \]
  The last equality follows from the branching rules
  % of $\sfW_{n}$ in
  % \eqref{eq:CC.C} and
  \eqref{eq:indSW} and
  Pieri's rule (\cite[Corollary 9.2.4]{GW}).
  % , where the factor $\sfH_{t}$ amounts to
  % painting ``$\bullet$'' on $\imath_{\wp}$ and $\jmath_{\wp}$, the factor
  % $\sfS_{a}$ amounts to painting ``$s$'' on $\imath_{\wp}$ and painting ``$r$''
  % on $\jmath_{\wp}$, each ``permissible" way of painting (see \Cref{def:pbp1})
  % contributing $1$ to the multiplicity
  % $[\wttau_{\wp}:\Ind_{\sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm g}}} \cC_{\mathrm g}^{p_{\mathrm g},q_{\mathrm g}}]_{\sfW_{n_{\mathrm g}}}$.
\end{proof}


Now \Cref{prop:countBCD}, \Cref{lem:Lcell} and \eqref{boundc22} imply the following corollary.
\begin{cor}\label{prop:countBCD22}
 The following equality holds:
  % \[
  %   [\tau_{\mathrm b}: \cC_{\mathrm b}] = \PBP_{\star,b}(\ckcO_{\mathrm b}) = \PBP_{G'}(\ckcO'_{n_{\mathrm b}}) = \Unip_{\ckcO'_{\mathrm b}}(G'_{n_{\mathrm b}})
  % \]
  % and
  % \[
  %   \sum_{\tau\in \LC_{\ckcO_{\mathrm g}}} [\tau:\cC_{\mathrm g}] = \PBP_{\mathrm g}(\ckcO_{\mathrm g}).
  % \]
  \begin{eqnarray*}
 && \sharp(\Unip_{\ckcO}(G))\\
  & = & \begin{cases}
    0,  \qquad &  \text{if $\star=D^*$ and $\check \CO$ is not $G$-relevant;}\medskip \\
          \sharp (\PBP_{\star}(\ckcO_{\mathrm b}))\cdot \sharp(\tPBP_{G_{\mathrm g}}(\ckcO_{\mathrm g})), \qquad & \text{otherwise.}
       \end{cases}
  \end{eqnarray*}
 \end{cor}



When $\ckcO $ has good parity, we will see from \Cref{prop:PBP1} and \Cref{prop:PBP2} that
  \[
    \sharp(\tPBP_{G}(\ckcO)) =
    \left\{
    \begin{array}{ll}
       \sharp (\PBP_{G}(\ckcO)),  & \hbox{if $\star\in \{C^*,D^*\}$}; \smallskip\\
       2^{\sharp(\CPPs(\check \CO))} \cdot \sharp (\PBP_{G}(\ckcO)),  &\hbox{if $\star\in \{B, C,D,\widetilde {C}\}$}.
    \end{array}
  \right.
  \]
 \Cref{prop:countBCD22} will thus imply Theorem \ref{countup}.% in the introductory section.

% \begin{prop}\label{prop:countBCD} Assume that $\check \CO$ has $\star$-good parity.  Then
%   % \[
%   %   [\tau_{\mathrm b}: \cC_{\mathrm b}] = \PBP_{\star,b}(\ckcO_{\mathrm b}) = \PBP_{G'}(\ckcO'_{n_{\mathrm b}}) = \Unip_{\ckcO'_{\mathrm b}}(G'_{n_{\mathrm b}})
%   % \]
%   % and
%   % \[
%   %   \sum_{\tau\in \LC_{\ckcO_{\mathrm g}}} [\tau:\cC_{\mathrm g}] = \PBP_{\mathrm g}(\ckcO_{\mathrm g}).
%   % \]
%   \[
%   \sharp (\Unip_{\ckcO}(G))\leq
%      \sharp ({\tPBP_{G}(\ckcO)}).
%   \]
%  \end{prop}


% \begin{proof} Since we are at the good parity case, Lemma \ref{lem:Lcell} and \eqref{boundc22} imply that
% \[
% \sharp (\Unip_{\ckcO}(G))
%   \leq \sum_{\wp\in \bar{\mathrm A}(\ckcO)} [\tau_{\wp}: \Coh_{\Lambda}(\CK'(G))].
%   \]
%     For the rest of the proof, the necessary computation for all cases are similar. We will present the computation for $\star = D^{*}$, and skip the details when $\star \in \set{B,\wtC, C,D,C^{*}}$.

% Suppose that $\star=D^*$ so that $G=\oO^*(2n)$. Then $W_{\Lambda} = \sfW'_{n}$, and Proposition \ref{prop:cohBCD44} implies that
% \[
% \Coh_{\Lambda}(\CK'(G))\cong   \bigoplus_{\substack{2t+a=n}} \Ind_{\sfH_{t} \times \sfS_{a}}^{\sfW'_{n}}
%          \tilde{\varepsilon} \otimes \sgn.
%          \]

%          For each $\wp\in \bar{\mathrm A}(\ckcO)$, we have that
% \[
% \begin{split}
%  &[\tau_{\wp} : \Coh_{\Lambda}(\CK'(G))]\\
%  = &
% [\wttau_{\wp}|_{\sfW'_{n}}:\sum_{2t+a=n} \Ind_{\sfH_{t}\times \sfS_{a}}^{\sfW'_{n}}\tilde{\varepsilon} \otimes \sgn]_{\sfW'_{n}}\\
% = & [\wttau_{\wp}: \sum_{2t+a=n} \Ind_{\sfH_{t}\times \sfS_{a}}^{\sfW'_{n}}\tilde{\varepsilon} \otimes \sgn]_{\sfW_{n}}\\
% = & \PBP_{\star}(\ttau_\wp)
% \end{split}
% \]
%   The last equality follows from the branching rules of $\sfW_{n}$ in \eqref{eq:CC.C} and \eqref{eq:indSW}, where the factor $\sfH_{t}$ amounts to painting ``$\bullet$'' on $\imath_{\wp}$ and $\jmath_{\wp}$, the factor $\sfS_{a}$ amounts to painting ``$s$'' on $\imath_{\wp}$ and painting ``$r$'' on $\jmath_{\wp}$, each ``permissible" way of painting (see \Cref{def:pbp1})
%   contributing $1$ to the multiplicity $[\tau_{\wp} : \Coh_{\Lambda}(\CK'(G))]_{\sfW'_{n}}$.
% \end{proof}


%  \begin{remark} We will see from \Cref{prop:PBP1} and \Cref{prop:PBP2} that
%   \[
%     \sharp(\tPBP_{G}(\ckcO)) =
%     \left\{
%     \begin{array}{ll}
%        \sharp (\PBP_{G}(\ckcO)),  & \hbox{if $\star\in \{C^*,D^*\}$}; \smallskip\\
%        2^{\sharp(\CPPs(\check \CO))} \cdot \sharp (\PBP_{G}(\ckcO)),  &\hbox{if $\star\in \{B, C,D,\widetilde {C}\}$}.
%     \end{array}
%   \right.
%   \]
%  Proposition \ref{prop:countBCD} will thus imply Theorem \ref{countup} in the introductory section.
%  \end{remark}
%   % Suppose $n_{\mathrm b}=0$ then
%   % \[
%   %   \begin{split}
%   %     [\tau_{\wp} : \cC_{\mathrm g}]_{\sfW'_{n_{\mathrm g}}} = &
%   %     [\wttau_{\wp}|_{W_{\mathrm g}}:\sum_{2t+a=n_{\mathrm g}} \Ind_{\sfH_{t}\times \sfS_{a}}^{\sfW'_{n_{\mathrm g}}}\tsgn\otimes \sgn]_{\sfW'_{n_{\mathrm g}}}\\
%   %     = & [\wttau_{\wp}: \sum_{2t+a=n_{\mathrm g}} \Ind_{\sfH_{t}\times \sfS_{a}}^{\sfW'_{n_{\mathrm g}}}\tsgn\otimes \sgn]_{\sfW_{n_{\mathrm g}}}\\
%   %     = & \PBP_{\star}(\ttau_\wp)
%   %   \end{split}
%   % \]






\section{Special unipotent representations in type BCD :  reduction to good parity}\label{sec:red}

The goal of this section is to prove \Cref{reduction}.
\Cref{prop:countBCD22} implies that $\Unip_{\check \CO}(G)$ is empty if  $\check \CO$ is not $G$-relevant (this notion is defined in \Cref{secrgp0}). Thus we further assume that $\check \CO$ is $G$-relevant. With our earlier assumptions \eqref{nonemp0} and \eqref{nonemp00}, this is equivalent to saying that $\check \CO$ has type I when $\star=D^*$ and $\check \CO$ has bad parity.


If $\star=C^*$, or $\star=D^*$ and $\check \CO $ does not have bad parity, by possibly changing $\omega_{\check V_\mathrm b}$ and $\omega_{\check V_\mathrm g}$ defined in \eqref{omega12} to their negatives, we
assume without loss of generality that  ${\check \CO_\mathrm b}$ has type I.

\subsection{Separating bad parity and good parity for special unipotent representations}

By Proposition \ref{propKL33},  we have an injective linear map
\[
 \varphi_{\lambda_{\check \CO}} : \CK'_{\lambda_{\check \CO_\mathrm b}}(G_{\mathrm b})\otimes  \CK'_{\lambda_{\check \CO_\mathrm g}}(G_{\mathrm g})\rightarrow\CK'_{\lambda_{\check \CO}}(G)
\]
and an injective map
\be\label{injirr}
   \varphi_{\lambda_{\check \CO}} : \Irr'_{\lambda_{\check \CO_\mathrm b}}(G_\mathrm b)\times  \Irr'_{\lambda_{\check \CO_\mathrm g}}(G_\mathrm g)\rightarrow  \Irr'_{\lambda_{\check \CO}}(G).
\ee

\begin{lem}\label{imageu}
The set $\Unip_{\ckcO}(G)$ is contained in the image of the map \eqref{injirr}.
\end{lem}
\begin{proof}
We  assume that $\star\in\{C^*, D^*\}$, and $n_\mathrm b, n_\mathrm g>0$. Otherwise the map \eqref{injirr} is bijective and the lemma is obviously true.
Let $\pi\in \Unip_{\ckcO}(G)$. Let $\Psi\in \Coh_{ \Lambda}(\CK'(G))$ be the unique basal  element such that $\Psi(\lambda_{\check \CO})=\pi$ (see \Cref{lemirr}).
 Denote by $\CC$ the cell  containing $\Psi$ in the basal representation $ \Coh_{\Lambda}(\CK'(G))$ of $W(\Lambda)$. Then Proposition \ref{hcass222} implies that
 \[
  \sigma_\CC\cong  \left( j_{W_{\lambda_\ckcO}}^{W(\Lambda)} \sgn\right)\otimes \sgn\cong \tau_\mathrm b\otimes \tau_{\emptyset}.
  \]
  In particular, $\tau_\mathrm b$ occurs in the cell representation $\la \CC\ra /\la \overline \CC\setminus \CC\ra$ (in the notation of \Cref{seccell}).

  Write $\Coh:= \Coh_{\Lambda}(\CK'(G))$ and write $\Coh_{\mathrm I}$ for the image of the map
\[
  \varphi: \Coh_{\Lambda_\mathrm b}(\CK'(G_\mathrm b))\otimes \Coh _{\Lambda_\mathrm g}(\CK'(G_\mathrm g))\rightarrow \Coh_{\Lambda}(\CK'(G))
\]
which is defined in \eqref{match1}. Assume by contradiction that $\pi$ is not contained in the image of the map \eqref{injirr}. Then $\CC$ has no intersection with $\Coh_{\mathrm I}$,  and the natural homomorphism
\[
\la \CC\ra /\la \overline \CC\setminus \CC\ra \rightarrow \Coh/(\Coh_{\mathrm I}+\la \overline \CC\setminus \CC\ra )
\]
is injective. Note that $\tau_\mathrm b$ does not occur in
$\Coh/(\Coh_{\mathrm I}+\la \overline \CC\setminus \CC\ra )$
since it does not occur in  $\Coh/\Coh_{\mathrm I}$ by \Cref{cor:Ind.DCstar} and \Cref{count003}.
This is a contradiction and the lemma is now proved.
\end{proof}

\begin{prop}\label{propKL333}
The map  \eqref{injirr} restricts to a bijective map
\[
\varphi_{\lambda_{\check \CO}}:
\Unip_{\ckcO_{\mathrm b}}(G_{\mathrm b})\times \Unip_{\ckcO_{\mathrm g}}(G_{\mathrm g})
\rightarrow \Unip_{\ckcO}(G).
\]

\end{prop}
\begin{proof}
Let $\pi_\mathrm b\in  \Irr'_{\lambda_{\check \CO_\mathrm b}}(G_\mathrm b)$ and $\pi_\mathrm g\in  \Irr'_{\lambda_{\check \CO_\mathrm g}}(G_\mathrm g)$.  Pick a basal  element $\Psi_\mathrm b$ of  $\Coh_{ \Lambda_\mathrm b}(\CK'(G_\mathrm b))$ such that $\Psi_\mathrm b(\lambda_{\check \CO_\mathrm b})=\pi_\mathrm b$. Likewise pick a basal  element $\Psi_\mathrm g$ of $ \Coh_{ \Lambda_\mathrm b}(\CK'(G_\mathrm g))$ such that $\Psi_\mathrm g(\lambda_{\check \CO_\mathrm g})=\pi_\mathrm g$.
Write $\Psi:=\varphi(\Psi_\mathrm b\otimes \Psi_\mathrm g)$. Denote by $\CC$ the cell in $ \Coh_{\Lambda}(\CK'(G))$ containing $\Psi$, and similarly define the
 cells $\CC_\mathrm g\ni \Psi_{\mathrm g}$ and $\CC_\mathrm b\ni \Psi_{\mathrm b}$.

Put $\pi:= \varphi_{\lambda_{\check \CO}}(\pi_\mathrm b, \pi_\mathrm g)=\Psi(\lambda_{\check \CO})$. Write
\[
  G_2:=G_\mathrm b \times G_\mathrm g, \qquad \pi_2:=\pi_\mathrm b\widehat \otimes \pi_\mathrm g\in \Irr(G_2),
  \]
  and
  \[
   I_{2, \lambda_{\check \CO}}:=\textrm{the maximal ideal of $\CU(\g_2)$ with infinitesimal character $\lambda_{\check \CO}$.}
  \]
Then
 \begin{eqnarray*}
   && \pi\in  \Unip_{\ckcO}(G)\\
    &\Longleftrightarrow& \sigma_\CC\cong  \left( j_{W_{\lambda_\ckcO}}^{W(\Lambda)} \sgn\right)\otimes \sgn \quad (\textrm{by Proposition \ref{hcass222}})\\
   &\Longleftrightarrow& \sigma_{\CC_\mathrm b}\cong  \left( j_{W_{\mathrm b, \lambda_{\ckcO_\mathrm b}}}^{W_\mathrm b} \sgn\right)\otimes \sgn \ \ \textrm{and}\ \  \sigma_{\CC_\mathrm g}\cong  \left( j_{W'_{\mathrm g, \lambda_{\ckcO_\mathrm g}}}^{W'_\mathrm g} \otimes \sgn\right)\otimes \sgn\\
 &\Longleftrightarrow& \pi_\mathrm b\in  \Unip_{\ckcO_{\mathrm b}}(G_{\mathrm b}) \ \ \textrm{and}\ \  \pi_\mathrm g\in  \Unip_{\ckcO_{\mathrm g}}(G_{\mathrm g}) \quad (\textrm{by Proposition \ref{hcass222}}).
 \end{eqnarray*}
 Here $W_{\mathrm b, \lambda_{\ckcO_\mathrm b}}$ denote the stabilizer of $\lambda_{\ckcO_\mathrm b}$ in $W_{\mathrm b, \lambda_{\ckcO_\mathrm b}}$, and likewise $W'_{\mathrm g, \lambda_{\ckcO_\mathrm g}}$ denote the stabilizer of $\lambda_{\ckcO_\mathrm g}$ in $W_{\mathrm g}$.

 Thus we have proved that the inverse image of $\Unip_{\ckcO}(G)$ under the map \eqref{injirr} equals  $\Unip_{\ckcO_{\mathrm b}}(G_{\mathrm b})\times \Unip_{\ckcO_{\mathrm g}}(G_{\mathrm g})$. Together with \Cref{imageu},  this proves the proposition. \end{proof}




%In  this section, we assume that if $\star=D^*$ and $\check \CO$ has bad parity, then  the number of
  %        positive entries in $\lambda_{\check \CO}$ has the same parity as $ \frac{n}{2}$.


\subsection{The case of bad parity}


% Recall from \Cref{cor:bound}, we have the inequality
% \[
% \begin{split}
% \sharp (\Unip_{\ckcO}(G))&\leq \sum_{\sigma\in \LC_{\ckcO}} [\sigma: \Coh_{\Lambda_{n_{\mathrm b},n_{\mathrm g}}}(\CK(G))]\\
%   & =\sum_{\wp\in \barA(\ckcO)} [\tau_{\mathrm b}\otimes \tau_{\wp}: \Coh_{\Lambda_{n_{\mathrm b},n_{\mathrm g}}}(\CK(G))] \quad (\textrm{by Lemma \ref{lem:Lcell}}).
% \end{split}
% \]


% %\subsection{From coherent continuation representation to counting}

% We have defined in \eqref{defpbp2222} the set $\PBPs(\ckcO)$ when $\ckcO$ has good parity. Similarly, we make the following definition in the bad parity case.
% \begin{defn}
%   Let $\PBPs(\ckcOb)$ be the set of all triples
%   $\uptau = (\imath,\cP)\times(\jmath,\cQ)\times \star $ where $(\imath,\cP)$ and
%   $(\jmath,\cQ)$ are painted partitions such that
%   \begin{itemize}
%     \item $(\imath,\jmath) = (\tau_{L,\mathrm b},\tau_{R,\mathrm b})$ (see \eqref{eq:taub});
%     \item the image of $\cP$ is contained in
%           \[
%           \begin{cases}
%             \set{\bullet, c,d},  & \text{if } \star\in \set{B,\wtC}; \\
%             \set{\bullet, d},  & \text{if } \star\in \set{C,D};\\
%             \set{\bullet},  & \text{if } \star\in \set{C^{*},D^{*}};\\
%           \end{cases}
%           \]
%     \item the image of $\cQ$ is contained in

%           \[
%           \begin{cases}
%             \set{\bullet, c},  & \text{if } \star\in \set{C,D};\\
%             \set{\bullet},  & \text{if } \star\in \set{B,\wtC, C^{*},D^{*}}.\\
%           \end{cases}
%           \]
%   \end{itemize}
% \end{defn}

%We define the partition $\ckcOpb$ by $\ckcOb = 2\ckcOpb$. To be more precise, $\bfrr_{i}(\ckcO'_{\mathrm b}):= \bfrr_{2i}(\ckcO_{\mathrm b})$, for all $i\in \bN^{+}$. Let $\cO'_{\mathrm b}:= (\ckcO'_{\mathrm b})^{t}$.
  %\item $\cO_{\mathrm b}:= \cO'_{\mathrm b}\cupcol \cO'_{\mathrm b}$.
 %$\ckcOpb$ is a partition of $\half\abs{\ckcOb}$.


Recall from \eqref{Gpb} the group
\[
  G'_{\mathrm b} := \begin{cases}
    \GL_{n_{\mathrm b}}(\bR), & \text{if } \star \in \set{B,C,D}; \\
    \widetilde{\GL}_{n_{\mathrm b}}(\bR), & \text{if } \star = \wtC; \\
    \GL_{\frac{n_{\mathrm b}}{2}}(\bH), & \text{if } \star \in \set{C^{*},D^{*}}.\\
  \end{cases}
\]
%When $\star=\wtC$, let $\Unip_{\ckcOpb}(\Gpb)$ be the set of genuine unipotent representations of $\Gpb$ which is naturally identified with $\Unip_{\ckcOpb}(\GL(n_{\mathrm b},\bR))$.

\begin{lem}\label{prop:BP.PP} %In all cases,
  The equalities
\[
    \begin{split}
      \sharp(\PBP_{\star}(\ckcO_{\mathrm b})) = \sharp(\PP_{\star '}(\ckcO'_{\mathrm b})) = \sharp(\Unip_{\ckcO'_{\mathrm b}}(G'_{\mathrm b}))
    \end{split}
  \]
  hold, where
\begin{equation}\label{def:star'}
\star ':= \begin{cases}
    A^{\bR}, & \text{if } \star \in \set{B,C,\wtC,D}; \\
    A^{\bH}, & \text{if } \star \in \set{C^{*},D^{*}}.\\
  \end{cases}
  \end{equation}
%is the set of painted partitions of type $A$ or $A^{\bH}$ attached to $\ckcO'_{\mathrm b}$.
\end{lem}

\begin{proof} Suppose that $\star \in \Set{C^{*},D^{*}}$. Then
\[
    \begin{split}
      \sharp(\PBP_{\star}(\ckcO_{\mathrm b};\tau_{\mathrm b}))= \sharp(\PP_{A^{\bH}}(\ckcO'_{\mathrm b}))= 1.
    \end{split}
\]
  Suppose that $\star \in \Set{B,C,\wtC,D}$.
  %Recall the Young diagrams $\tau_{L,b}$ and $\tau_{R,b})$ from \eqref{eq:taub} and \eqref{eq:taub2}.
   It is easy to see that we have a bijection
  \[
    \begin{array}{ccc}
      \PBP_{\star}(\ckcO_{\mathrm b}) &  \rightarrow & \PP_{A^{\bR}}(\ckcO'_{\mathrm b}),\\
      (\tau_{L,b},\cP)\times (\tau_{R,b},\cQ)\times \star & \mapsto & ((\ckcO'_{\mathrm b})^t,\cP'),
    \end{array}
  \]
  where $\cP'$ is defined by the condition that
  \[
    \cP(\bfcc_{j}(\tau_{L,b}),j)=d \Longleftrightarrow \cP'(\bfrr_{j}(\ckcO'_{\mathrm b}),j)=d, \quad \textrm{ for all } j=1,2,\cdots, \bfcc_{1}(\ckcO'_{\mathrm b}).
  \]
  The last equality is in Theorem \ref{thm:mainR00}.   \end{proof}


  \trivial[h]{
    % Let $\tau' = \ckcO'^{t}_{\mathrm b}$ and $\tau_{\mathrm b}=(\tau_{L,b}, \tau_{R,b})$. Here
    % $\tau_{L,b}, \tau_{R,b}$.
    Now the claim follows for the fact that the bottom rows in $\uptau_{L}$ can
    be filled by $\bullet/c$ or $d$ and
    \[
      \bfcc_{i}(\tau_{L,b}) = \bfcc_{j}(\tau_{L,b}) \Leftrightarrow \bfcc_{i}(\cOpb) = \bfcc_{j}(\cOpb) \quad \textrm{ for all } i,j\in \bN^{+}.
    \]
  }



Let $P_{\mathrm b}$ be a parabolic subgroup of $G_{\mathrm b}$ that is  $\check \CO_\mathrm b$-relevant as defined in Section \ref{secrgp0}. Then
  $G'_{\mathrm b}$ is naturally isomorphic to the Levi quotient of $P_\mathrm b$.


\def\fIb{\fI_{\mathrm b}}
\def\pib{\pi_{\mathrm b}}


\begin{prop}\label{lem:Unip.BP}
%We are in the setting of \Cref{prop:BP.PP}.
%Suppo For every we have a bijection
For every $\pi'\in \Unip_{\Gpb}(\ckcOpb)$, the normalized induced representation
$\Ind_{\Pb}^{\Gb}\pi'$ is irreducible and belongs to $\Unip_{\Gpb}(\ckcOpb)$.
Moreover, the map
  \be\label{badind}
    \begin{array}{rcl}
      \Unip_{\ckcO'_{\mathrm b}}(G'_{\mathrm b}) & \rightarrow & \Unip_{\ckcOb}(\Gb), \\
      \pi' & \mapsto & % \pib:=
                        \Ind_{\Pb}^{\Gb}\pi'
    \end{array}
  \ee
  is bijective.
\end{prop}

% \begin{prop}\label{lem:Unip.BP}
% %We are in the setting of \Cref{prop:BP.PP}.
% Suppose that $n_{\mathrm g}=0$.
% \begin{enumerate}
% \item Then we have a bijection
%   \[
%     \begin{array}{rccc}
%       \fIb: &\Unip_{\ckcO'_{\mathrm b}}(G'_{\mathrm b}) & \longrightarrow & \Unip_{\ckcO}(\Gb) \\
%       &\pi' & \mapsto & \pib:=\Ind_{\Pb}^{\Gb}\pi'.
%     \end{array}
%   \]
%   % where $P$ is a parabolic subgroup of $G$ whose Levi component is
%   % isomorphic to $G'_{\mathrm b}$.
%  \item Suppose by $\sO'$ the real nilpotent orbit in $G'_{\mathrm b}$ such that $\WF(\sO')=\overline{\sO'}$.  % \item Denote by $\sO'$ the real nilpotent orbit in $G'_{\mathrm b}$ such that $\sO'_{\bC}=\cO$, and let $\sO$ be the real induction of $\sO'$ to $\Gb$.
%   Then the wavefront cycle of $\pi $ is
%   \[
%     \WF(\pib) = \overline{\sO}
%   \]
%   where $\sO$ is the real induction of $\sO'$ to $\Gb$.
%  \end{enumerate}
% \end{prop}
\begin{proof}
  % Let $\sO_{\pi'}$ be the open $\Gpb$-orbit in the wavefront set of $\pi'$.
  % It occurs with multiplicity one in the wavefront cycle of $\pi'$ by .
%   where $\sO'$ is a $\Gpb$
% Suppose by $\sO'$ the real nilpotent orbit in $G'_{\mathrm b}$ such that the
% wave front set of $\pi'$ is $\sO'$ $\WF(\sO')
% =\overline{\sO'}$.  % \item Denote by $\sO'$ the real nilpotent orbit in %
% $G'_{\mathrm b}$ such that $\sO'_{\bC}=\cO$, and let $\sO$ be the real induction of $\sO'$ to $\Gb$.
% %   Then the wavefront cycle of $\pi $ is
% %   \[
% %     \WF(\pib) = \overline{\sO}
% %   \]

  By the construction of $\pi'$  (see \Cref{sec:GLRH}) and
  % first note that $\WF(\pi')=[\sO']$.
  % It follows from
  a result of Barbasch \cite[Corollary 5.0.10]{B.Orbit}, the
  wavefront cycle of $\Ind_{\Pb}^{\Gb}\pi'$ is a single orbit $\sO$ with
  multiplicity one and its complexification is $\dBV(\ckcOb)$.
  Note that every irreducible summand of  $\Ind_{\Pb}^{\Gb}\pi'$ belongs
  to $\Unip_{\ckcOb}(\Gb)$. Hence $\Ind_{\Pb}^{\Gb}\pi'$ has to be irreducible.

  % We claim that $\Ind_{\Pb}^{\Gb}\pi'$ is irreducible. If not, $\Ind_{\Pb}^{\Gb}\pi'$  must contain an irreducible subquotient with infinitesimal
  % character $\lambda_{\ckcOb}$ and GK-dimension $<\half\dim_{\bC}\dBV(\ckcOb)$, by \cite[Korollar 3.6]{BK}. This will
  % contradict to the assertion of \Cref{lem:Lcell} on the associated variety of the maximal primitive ideal $\cI_{\ckcOb}$.
  % \trivial[h]{
  %   First, it is not obvious to me that the wavefront of $\Ind_{P}^{G}\pi$
  %   must be contained in $\Ind\WF(\pi)$. But it is clear that the leading term
  %   must be $\sum_{\sO\text{ open in } \WF(\pi)}\Ind\sO$. So the boundaries has
  %   less GK-dimension.

  %   Suppose $\pi_{0}$ is the sub-quotient with less GK-dimension.
  %   On the other hand, the maximal primitive ideal $\cI_{\ckcO}$  with infinitesimal
  %   character must contain $\Ann\pi_{0}$. In other words,
  %   $\AV_{\bC}(\pi_{0})\supseteq \bcO$ which implies GK-dimension of
  %   $\pi_{0}\geq \half\dim_{\bC}\cO$, a contradiction.
  %   % Let $\lambda = \lamck$.
  %   % Note that every $W_{[\lambda]}$-module in $\Grt_{\lambda}(G)$ is in $\Ind_{W_{\lambda}}^{W_{[\lambda]}}$
  % }
  %


  We now suppose that $\star=D$ so that $\Gb=\SO(\nnb, \nnb)$. We will prove the injectivity of the map \eqref{badind}.
    Fix a split Cartan subgroup
    $$H=(\bR^\times)^{\nnb}\subseteq \Gpb\subseteq \Gb $$ and write $H = MA$ where
    $M = \set{\pm 1}^{\nnb}$ is the compact part of $H$ and
    $A = (\bR^\times_+)^{\nnb}$ is the split part of $H$. We identify a
    character of $A$ with a vector in $\bC^{\nnb}$ as usual. Let
    \[
    K:=\{(g_1, g_2)\in \rO(\nnb)\times \rO(\nnb)\mid \det(g_1)\cdot \det(g_2)=1\}
    \]
    be a maximal compact subgroup of $\Gb$, and let
    $B$ be a Borel subgroup of $\Gb$ containing $H$ and the unipotent radical of $\Pb$.

 For each integer $l$ such that $0\leq l \leq \nnb$, put
    \[
      \delta_{l} = \underbrace{1_{1}\otimes \cdots \otimes 1_{1}}_{l} \otimes
      \underbrace{\sgn_{1} \otimes \cdots \otimes \sgn_{1}}_{\nnb-l}\in \Irr(M),
    \]
    where $1_{1}$ denotes the trivial character of $\{\pm 1\}$ and $\sgn_{1}$ denotes the non-trivial character of $\{\pm 1\}$.
It is a fine $M$-type (\cite{Vg}*{Definition~4.3.8}). Let $\lambda_{l}$ be
    the restriction to $K$ of the irreducible
    $\rO(\nnb)\times \rO(\nnb)$-representation
    $\wedge^{l}\,\bC^{\nnb}\otimes \wedge^{0}\,\bC^{\nnb}$. Then $\lambda_{l}$ is a
    fine $K$-type, see \cite{BGG.M}*{\S 6}.

    \def\cusp{\fC}

    Vogan proves that there is a well-defined injective map
\[
      \begin{array}{lccc}
       \fX\colon &   W_H\backslash \Irr(H)&\rightarrow & \Irr(G_\mathrm b),\\
       & \textrm{the $W_H$-orbit of $\chi\in \Irr(H)$} & \mapsto & (\Ind_{B}^{\Gb}\chi)(\lambda_{l_\chi}),
      \end{array}
    \]
    where $W_H$ denotes the real Weyl group of $G_\mathrm b$ with respect to $H$,  $l_\chi\in\{0,1, \dots, n_\mathrm b\}$ is the integer such that $\chi|_M$ is conjugate to $\delta_{l_\chi}$ by $W_H$, and $(\Ind_{B}^{\Gb}\chi)(\lambda_{l_\chi})$ denotes the unique
    irreducible subquotient in the normalized induced representation
    $\Ind_{B}^{\Gb}\chi$ containing the $K$-type $\lambda_{l}$. See \cite{Vg}*{Theorem 4.4.8}.

        Now take
         \[
         \pi' = 1_{n_{1}}\times \cdots \times 1_{n_{r}}\times \sgn_{n_{r+1}}\times \cdots \times \sgn_{n_{k}}\in \Unip_{\Gpb}(\ckcOpb),
         \]
       where   $k\geq r\geq 0$,  and $n_1, n_2, \dots, n_k$ are positive integers with  $n_1+n_2+ \dots+ n_k=\nnb$.



    Write
    \begin{eqnarray*}
    \delta_{\pi'}&:=&\delta_{n_{1}+n_{2}+\dots + n_{r}}\in \Irr(M),\\
        \nu_{\pi'} &:=& \big( {\tfrac{n_{1}-1}{2},\tfrac{n_{1}-3}{2},\dots ,\tfrac{1-n_{1}}{2}, \dots , \tfrac{n_{k}-1}{2},\tfrac{n_{k}-3}{2},\dots ,\tfrac{1-n_{k}}{2}} \big)\in \Irr(A).
   \end{eqnarray*}
   Clearly the map
   \[
   \begin{array}{rcl}
     \fP:   \Unip_{\Gpb}(\ckcOpb)&\rightarrow &  W_H\backslash \Irr(H),\\
      \pi' &\mapsto & \textrm{the $W_H$-orbit of $\delta_{\pi'}\otimes \nu_{\pi'}$}
      \end{array}
      \]
       is well-defined and
    injective.

   Note that the map \eqref{badind} equals the composition $\fX\circ \fP$, and hence it is also injective. This proves the injectivity of \eqref{badind} in the case when $\star=D$. The same proof works in the case when $\star\in \{B, C, \wtC\}$ and we omit the details. When $\star\in \{C^*, D^*\}$, the map \eqref{badind} has to be injective since its domain is a singleton. Thus \eqref{badind} is injective in all cases.




  The bijection of \eqref{badind}  follows from the injectivity  and the counting
  inequalities below:
  \[
    \abs{\PP_{\star'}(\ckcO'_{\mathrm b})}=\abs{\Unip_{\ckcO'_{\mathrm b}}(G'_{\mathrm b})}\leq \abs{\Unip_{\ckcO_\mathrm b}(G_\mathrm b)}
    \leq \abs{\PBP_{\star}(\ckcO_{\mathrm b})} = \abs{\PP_{\star'}(\ckcO'_{\mathrm b})}.
  \]
  Here $\star' \in \set{A^\R,A^{\bH}}$ is as in \eqref{def:star'}, the first inequality follows from the injectivity of \eqref{badind}, the second inequality follows from  \Cref{prop:countBCD22}, and the last equality is in \Cref{prop:BP.PP}.
\end{proof}




\trivial[h]{
We introduce some additional notation. For each bipartition $\tau$, let
\[
  \PBP_{\star}(\tau) := \Set{ \uptau|\uptau \text{ is a painted bipartition and
    } \star_{\uptau}=\star, (\imath_{\uptau},\jmath_{\uptau}) = \tau}
  % \uptau=(\imath, \cP)\times (\jmath,\cP)\times \alpha|}
\]
and
\[
  \tPBP_{\star}(\ckcO_{\mathrm g}) := %\bigsqcup_{\tau\in\LC(\ckcOg)}\PBP_{\star}(\tau).
  \bigsqcup_{\wp \subseteq \CPP(\ckcO_{\mathrm g})}\PBP_{\star}(\wttau_{\wp}),
\]
where $\wttau_{\wp} := (\imath_{\wp},\jmath_{\wp})$ (see \eqref{eq:ttauwp}). Similarly, define
\[
  \tPBP_{G_{\mathrm g}}(\ast):= \Set{\uptau\in \tPBP_{\star}(\ast )|\Sign(\uptau)= \Sign(G_{\mathrm g})}, \quad  \quad
  \ast  = \ckcO_{\mathrm g} \text{ or } \tau.
\]

Recall from \Cref{cor:bound}, we have the inequality
\[
\begin{split}
\sharp (\Unip_{\ckcO}(G))&\leq \sum_{\sigma\in \LC_{\ckcO}} [\sigma: \Coh_{\Lambda_{n_{\mathrm b},n_{\mathrm g}}}(\CK(G))]\\
  & =\sum_{\wp\in \barA(\ckcO)} [\tau_{\mathrm b}\otimes \tau_{\wp}: \Coh_{\Lambda_{n_{\mathrm b},n_{\mathrm g}}}(\CK(G))] \quad (\textrm{by Lemma \ref{lem:Lcell}}).
\end{split}
\]


\begin{prop}\label{prop:countBCD}
  In all cases, we have
  % \[
  %   [\tau_{\mathrm b}: \cC_{\mathrm b}] = \PBP_{\star,b}(\ckcO_{\mathrm b}) = \PBP_{G'}(\ckcO'_{n_{\mathrm b}}) = \Unip_{\ckcO'_{\mathrm b}}(G'_{n_{\mathrm b}})
  % \]
  % and
  % \[
  %   \sum_{\tau\in \LC_{\ckcO_{\mathrm g}}} [\tau:\cC_{\mathrm g}] = \PBP_{\mathrm g}(\ckcO_{\mathrm g}).
  % \]
  \[
  \sum_{\wp\in \barA(\ckcO)} [\tau_{\mathrm b}\otimes \tau_{\wp}: \Coh_{\Lambda_{n_{\mathrm b},n_{\mathrm g}}}(\CK(G))]
      = \sharp (\PBP_{\star}(\ckcO_{\mathrm b};\tau _{\mathrm b}))\cdot \sharp(\tPBP_{G_{\mathrm g}}(\ckcO_{\mathrm g})).
  \]
 In particular, when $\ckcO = \ckcO_{\mathrm g}$, namely $\ckcO $ has good parity, we have
  \[
  \sharp (\Unip_{\ckcO}(G))\leq
     \sharp ({\tPBP_{G}(\ckcO)}).
  \]
 \end{prop}

 \begin{remark} When $\ckcO $ has good parity, we will see from \Cref{prop:PBP1} and \Cref{prop:PBP2} that
  \[
    \sharp(\tPBP_{G}(\ckcO)) =
    \left\{
    \begin{array}{ll}
       \sharp (\PBP_{G}(\ckcO)),  & \hbox{if $\star\in \{C^*,D^*\}$}; \smallskip\\
       2^{\sharp(\CPPs(\check \CO))} \cdot \sharp (\PBP_{G}(\ckcO)),  &\hbox{if $\star\in \{B, C,D,\widetilde {C}\}$}.
    \end{array}
  \right.
  \]
 Proposition \ref{prop:countBCD} will thus imply Theorem \ref{countup} in the introductory section.
 \end{remark}

\begin{proof} We use the descriptions of $\tau_{\mathrm b}$ and $\tau_{\wp}$ (in \eqref{eq:taub} and \eqref{eq:tauwp}) to compute the multiplicities, using branching rules of Weyl groups in \eqref{eq:CC.C} and \eqref{eq:indSW} as well as \Cref{lem:WLcell}. We skip the details when $\star \in \set{B,\wtC, C,D,C^{*}}$, and present the computation for $\star = D^{*}$, which is the most complicated case.

  Recall that $(W_{\mathrm b},W_{\mathrm g}) = (\sfW'_{\nbb},\sfW'_{\ngg})$, where $n_{\mathrm b}=\half \abs{\ckcO_{\mathrm b}}$ and $n_{\mathrm g}=\half\abs{\ckcO_{\mathrm g}}$.

  First suppose $\ngg = 0$. Then $\tau_{\mathrm b} = (\cOpb,\cOpb)_{I}$ and
  \[
    \begin{split}
      [\tau_{\mathrm b}:\cC_{\mathrm b}^{\nbb}] = &
      [\tau_{\mathrm b}: \Ind_{\sfH_{\frac{\nbb}{2}}}^{\sfW'_{\nbb}}\tsgn]\\
      = & [(\cOpb,\cOpb)_{I}: \bigoplus_{\sigma}(\sigma,\sigma)_{I}]\\
      = & 1.
    \end{split}
  \]

  Now suppose $\ngg>0$. Let
  \[
    \wttau_{\mathrm b} := \Ind_{\sfW'_{\nbb}}^{\sfW_{\nbb}} \tau_{\mathrm b} = (\cOpb,\cOpb) \AND \wttau_{\wp}: = (\imath_{\wp},\jmath_{\wp}) \quad \textrm{ for all } \wp \subseteq \CPP(\ckcOg).
  \]
  Note that $\imath_{\wp}\neq \jmath_{\wp}$ since
  $\bfcc_{1}(\imath_{\wp})> \bfcc_{1}(\jmath_{\wp})$. It is then easy to see that
  \begin{equation*}%\label{eq:W''}
    \Ind_{\sfW'_{\nbb}\times \sfW'_{\ngg}}^{\sfW_{n_{\mathrm b},n_{\mathrm g}}'} \tau_{\mathrm b}\otimes \tau_{\wp}
    = (\wttau_{\mathrm b}\otimes \wttau_{\wp})|_{\sfW_{n_{\mathrm b},n_{\mathrm g}}'}.
  \end{equation*}

  \trivial[h]{ When $\nbb=0$, $W'' = W_{\mathrm g} = \sfW'_{\ngg}$ and so
    $\wttau_{\wp}|_{\sfW'_{\ngg}} = \tau_{\wp}$.

    Now we assume $\nbb\neq 0$ and $\ngg\neq 0$ (the general case). This
    follows from the following points
    \begin{itemize}
      \item the dimension of the two sides are equal ($W_{\mathrm b}\times W_{\mathrm g}$ has
            index $2$ in $W''$).
      \item
            \[
            \begin{split}
              &[\Ind_{W_{\mathrm b}\times W_{\mathrm g}}^{W''}\tau_{\mathrm b}\otimes \tau_{\wp}:(\wttau_{\mathrm b}\otimes \wttau_{\wp})|_{W''}] \\
              =& [\Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\tau_{\mathrm b}\otimes \tau_{\wp}:\wttau_{\mathrm b}\otimes \wttau_{\wp}]\\
              =& [\wttau_{\mathrm b}\otimes \wttau_{\wp} \oplus \wttau_{\mathrm b}\otimes (\wttau_{\wp}\otimes \brsgn):\wttau_{\mathrm b}\otimes \wttau_{\wp}] =1\\
            \end{split}
            \]
            where $\wttau_{\wp}\otimes \brsgn$ has the bipartition obtained by
            switching the left and right side of $\wttau_{\wp}$.
      \item the LHS is irreducible, by
            \[
            \begin{split}
              & [\Ind_{W_{\mathrm b}\times W_{\mathrm g}}^{W''}\tau_{\mathrm b}\otimes \tau_{\wp}:
              \Ind_{W_{\mathrm b}\times W_{\mathrm g}}^{W''}\tau_{\mathrm b}\otimes \tau_{\wp}]_{W''}\\
              =&  [\tau_{\mathrm b}\otimes \tau_{\wp} : (\Ind_{W_{\mathrm b}\times W_{\mathrm g}}^{W''}\tau_{\mathrm b}\otimes \tau_{\wp})|_{W_{\mathrm b}\times W_{\mathrm g}}]\\
              =& [\tau_{\mathrm b}\otimes \tau_{\wp} : \tau_{\mathrm b}\otimes \tau_{\wp} + (\cOpb,\cOpb)_{II} \otimes \tau_{\wp} ] = 1
            \end{split}
            \]
    \end{itemize}
  }

  For ease of notation, write $\sfW'':=\sfW_{n_{\mathrm b},n_{\mathrm g}}'$. We then have
  \[
    \begin{split}
      & [\tau_{\mathrm b}\otimes \tau_{\wp} :
      \Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW''} \cC_{\mathrm b}^{\nbb} \otimes \cC_{\mathrm g}^{p_{\mathrm g},q_{\mathrm g}}]_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}\\
      = & [\Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW''} \tau_{\mathrm b}\otimes \tau_{\wp} :
      \Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW''} \cC_{\mathrm b}^{\nbb} \otimes \cC_{\mathrm g}^{p_{\mathrm g},q_{\mathrm g}}]_{\sfW''}\\
      = & [(\wttau_{\mathrm b}\otimes \wttau_{\wp})|_{\sfW''}:
      \Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW''} \cC_{\mathrm b}^{\nbb} \otimes \cC_{\mathrm g}^{p_{\mathrm g},q_{\mathrm g}}]_{\sfW''}\\
      = & [\wttau_{\mathrm b}\otimes \wttau_{\wp}:
      \Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}} \cC_{\mathrm b}^{\nbb} \otimes \cC_{\mathrm g}^{p_{\mathrm g},q_{\mathrm g}}]_{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
       = & [\wttau_{\mathrm b}:\Ind_{\sfW'_{n_{\mathrm b}}}^{\sfW_{n_{\mathrm b}}} \cC_{\mathrm b}^{\nbb}]_{\sfW_{n_{\mathrm b}}}\cdot
           [\wttau_{\wp}:\Ind_{\sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm g}}} \cC_{\mathrm g}^{p_{\mathrm g},q_{\mathrm g}}]_{\sfW_{n_{\mathrm g}}}\\
      =& \sharp(\PBP_{\star}(\ckcO_{\mathrm b}; \tau _{\mathrm b})))\cdot \sharp(\PBP_{\star}(\wttau_{\wp})).
    \end{split}
  \]
  The last equality follows from the explicit description of $\cC_{\mathrm b}^{\nbb}$ and $\cC_{\mathrm g}^{p_{\mathrm g},q_{\mathrm g}}$ in Section \ref{sec:explicitCoh}, and
  the branching rules of $\sfW_{n}$ in \eqref{eq:CC.C} and \eqref{eq:indSW}, where the factor $\sfH_{t}$ amounts to painting ``$\bullet$'' on $\imath_{\wp}$ and $\jmath_{\wp}$, the factor $\sfS_{a}$ amounts to painting ``$s$'' on $\imath_{\wp}$ and painting ``$r$'' on $\jmath_{\wp}$, each ``permissible" way of painting (see \Cref{def:pbp1})
  contributing $1$ to the multiplicity $[\wttau_{\wp}:\Ind_{\sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm g}}} \cC_{\mathrm g}^{p_{\mathrm g},q_{\mathrm g}}]_{\sfW_{n_{\mathrm g}}}$.
\end{proof}

}



  \trivial[h]{

    Suppose $\star =C^{*}$.

    For the bad parity, $n_{\mathrm b}=2n'_{\mathrm b}$ must be even.
    \[
      \begin{split}
        & [\tau_{\mathrm b}\otimes \tau_{\wp} :
        \cC_{\mathrm b}^{\nbb} \otimes \cC_{\mathrm g}^{\ngg,\ngg}]_{\sfW'_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
        = & [\Ind_{\sfW'_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}} \tau_{\mathrm b}\otimes \tau_{\wp} :
        \cC_{\mathrm b}^{\nbb} \otimes \cC_{\mathrm g}^{\ngg,\ngg}]_{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
        = & [\wttau_{\mathrm b}\otimes \tau_{\wp}:
        \cC_{\mathrm b}^{\nbb} \otimes \cC_{\mathrm g}^{\ngg,\ngg}]_{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
        =& \# \PBP_{\star}(\ckcO_{\mathrm b})\cdot \# \PBP_{\star}(\tau_{\wp})
      \end{split}
    \]

    The alternative approach using restriction. For the bad parity,
    $n_{\mathrm b}=2n'_{\mathrm b}$ must be even.
    \[
      \begin{split}
        \cC_{\mathrm b}^{n_{\mathrm b}} &=
        \Res_{\sfW_{n_{\mathrm b}}}^{\sfW'_{n_{\mathrm b}}} \Ind_{\sfH_{n'_{\mathrm b}}}^{\sfW_{n_{\mathrm b}}}\tilde{\varepsilon} \\
        &= \bigoplus_{\sigma\in \Irr(\sfS_{n'_{\mathrm b}})} \left((\sigma,\sigma)_{I} \oplus (\sigma,\sigma)_{II}\right).
      \end{split}
    \]
    For the good parity,
    \[
      \begin{split}
        \cC_{\mathrm g}^{2p,2q} %& = \bigoplus_{p+q=m} \Cint{\rho}(\Sp(p,q)) \\
        & =\bigoplus_{\substack{(t+s,t+r)=(p,q)}} \bigoplus_{\sigma} \Ind_{\sfW_{2t}\times \sfW_s\times \sfW_r}^{\sfW_{p+q}}
        (\sigma,\sigma)\otimes \sgn \otimes \sgn \\
      \end{split}
    \]
    Now the branching rule implies the irreducible components of
    $\cC_{\mathrm g}^{2p,2q}$ are given by the dot-diagram attaching two columns on the
    right, which we mark them by $s$ and $r$ respectively. }


  % Suppose $\star=C$
  % \[
  %   \begin{split}
  %     & [\tau_{\mathrm b}\otimes \tau_{\wp} :
  %     \cC_{\mathrm b}^{\nbb} \otimes \cC_{\mathrm g}^{\ngg,\ngg}]_{\sfW'_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
  %     = & [\Ind_{\sfW'_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}} \tau_{\mathrm b}\otimes \tau_{\wp} :
  %     \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
  %     = & [\wttau_{\mathrm b}\otimes \tau_{\wp}:
  %     \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
  %     =& \# \PBP_{\star}(\ckcO_{\mathrm b})\cdot \# \PBP_{\star}(\ckcO_{\mathrm g};\wp)
  %   \end{split}
  % \]
%
  % For the bad parity, $n_{\mathrm b}=2n'_{\mathrm b}$ must be even.
  % \[
  %   \begin{split}
  %     \cC_b^{n_{\mathrm b}} &= \Res_{\sfW_{n_{\mathrm b}}}^{\sfW'_{n_{\mathrm b}}} \left( \bigoplus_{2t+a=n_{\mathrm b}}\Ind_{\sfH_{t}\times \sfS_{a}}^{\sfW_{n_{\mathrm b}}}\tilde{\varepsilon} \otimes 1
  %     \right)\\
  %     &= \bigoplus_{2t+c+d=n_{\mathrm b}}\bigoplus_{\sigma\in \Irr(\sfS_{t})} \left((\sigma,\sigma)_{I} \oplus (\sigma,\sigma)_{II}\right) \times ([d,],[c,]).
  %   \end{split}
  % \]
  % Note that $\tau_{\mathrm b}=(\cO'_{\mathrm b},\cO'_{\mathrm b})_{I}$. Therefore we only need to
  % consider the case when $c=d$ in the above formula.
  % \[
  %   \begin{split}
  %     [\tau_{\mathrm b}: \cC_{\mathrm b}^{n_{\mathrm b}}] & = [\cO'_{\mathrm b}:\bigoplus_{\substack{t+d = n'_{\mathrm b}\\ \sigma}} \sigma \times 1].
  %   \end{split}
  % \]
  % By the counting of unipotent representation of $\GL(n'_{\mathrm b},\bR)$. We see
  % that $\PBP_{\star,b}(\ckcO_{\mathrm b})$ is identified with
  % $\PBP_{A^{\bR}}(\ckcO'_{\mathrm b})$ by send $(\uptau_{L},\uptau_{R})$ to the
  % painted partition $\uptau'$ such that
  % \[
  %   \uptau_{L}(i,j)=d \Leftrightarrow \uptau'(i,j)=d.
  % \]

  % For the good parity, this is clear by the branching rules.


  \trivial[h]{


    Suppose $\star = D$. Suppose that $n_{\mathrm g}\neq 0$. Since
    $\bfcc_{1}(\imath_{\wp})>\bfcc_{1}(\jmath_{\wp})$, we have
    $\wttau^{s}_{\wp}:=\wttau_{\wp}\otimes \brsgn\ncong\wttau_{\wp}$.
    \[
      \begin{split}
        & [\tau_{\mathrm b}\otimes \tau_{\wp} :
        \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}\\
        = & [\Ind_{\sfW'_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}} \tau_{\mathrm b}\otimes \tau_{\wp} :
        \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
        = & [\wttau_{\mathrm b}\otimes \wttau_{\wp}\oplus \wttau_{\mathrm b}\otimes \wttau_{\wp}^{s}:
        \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{W''}\\
        = & [\wttau_{\mathrm b}\otimes \wttau_{\wp}:
        \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW_{n_{\mathrm g}}\times \sfW_{n_{\mathrm b}}}\\
        =& \# \PBP_{\star}(\ckcO_{\mathrm b})\cdot \# \PBP_{\star}(\ckcO_{\mathrm g};\wp)
      \end{split}
    \]
    The terms involving $\wttau_{\sP}^{s}$ vanish since every irreducible
    component $(\sigma_{L},\sigma_{R})$ in $\cC_{\mathrm g}$ satisfies
    $\sigma_{L}\supseteq \sigma_{R}$ but
    $\bfcc_{1}(\imath_{\wp})>\bfcc_{1}(\jmath_{\wp})$.

    Suppose that $n_{\mathrm g} = 0$.
    \[
      \begin{split}
        & [\tau_{\mathrm b} : \cC_{\mathrm b}^{n_{\mathrm b}}]_{\sfW'_{n_{\mathrm b}}}\\
        =& [\Ind_{\sfW'_{n_{\mathrm b}}}^{\sfW_{n_{\mathrm b}}} \tau_{\mathrm b} : \bigoplus_{\substack{2t+a=n}}
        \Ind_{\sfH_{t}\times \sfS_{a}}^{\sfW_{n}}\tilde{\varepsilon}\otimes 1] \\
        =& [ \wttau_{\mathrm b} : \bigoplus_{\substack{2t+a=n}}
        \Ind_{\sfH_{t}\times \sfS_{a}}^{\sfW_{n}}\tilde{\varepsilon}\otimes 1] \\
      \end{split}
    \]
    In any cases, the counting formula holds. There is place to confuse: Why
    there shouldn't be double the size of special unipotent representations?

    In fact, $\AC_{\bC}(\pi)$ can only be the fixed type, say $\cO_{I}$! Note
    that we fixed an infinitesimal character which has half-integral values.
    This choice implicitly force us to fix real Siegel parabolic when we do
    induction from $\GL$! The non-trivial outer automorphism, say $c$, will
    permute the infinitesimal character to the another one and we then will have
    $\AC_{\bC}({}^{c}\pi)i = \cO_{II}$.


    Using Barbasch's formula of wavefront, we see that the induction
    $\pi_{I}:=\Ind_{\GL}^{\SO}\pi'$ must be irreducible, where $\pi'$ is a
    unipotent representation of $\GL$. This will also implies
    $\Ind_{\GL}^{\rO}\pi'$ is irreducible and restricted to two $\SO$-modules,
    $\pi_{I}$ and $\pi_{II}$.

  }


  \trivial[h]{ Suppose $\star = \wtC$. Then
    \[
      \begin{split}
        & [\tau_{\mathrm b}\otimes \tau_{\wp} :
        \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}\\
        = & [ \tau_{\mathrm b}\otimes \Ind_{\sfW'_{n_{\mathrm g}}}^{\sfW_{n_{\mathrm g}}}\tau_{\wp} : \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
        = &\sum_{\sP\in \tA(\ckcO)} [\tau_{\mathrm b}\otimes \wttau_{\wp}:
        \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW_{n_{\mathrm b}}\times \sfW_{n_{\mathrm g}}}\\
        =& \# \PBP_{\star}(\ckcO_{\mathrm b})\cdot \# \PBP_{\star}(\ckcO_{\mathrm g})
      \end{split}
    \]

    Suppose $\star = B$. Then
    \[
      \begin{split}
        & \sum_{\sP\in \tA'(\ckcO)}[\tau_{\mathrm b}\otimes \tau_{\wp} :
        \cC_{\mathrm b} \otimes \cC_{\mathrm g}]_{\sfW_{n_{\mathrm b}}\times \sfW'_{n_{\mathrm g}}}\\
        =& \# \PBP_{\star}(\ckcO_{\mathrm b})\cdot \# \PBP_{\star}(\ckcO_{\mathrm g};\wp)
      \end{split}
    \]
  }



\subsection{Coherent continuation representations and parabolic induction}





 The normalized smooth parabolic induction from $P_{\mathrm b}$ to $G_\mathrm b$ yields a linear map
\[
 \Ind:  \CK'(G'_{\mathrm b})\rightarrow \CK'(G_\mathrm b).
\]
This induces a linear map
\[
\begin{array}{rcl}
 \Ind:  \Coh_{\Lambda_\mathrm b}(\CK'(G'_{\mathrm b}))&\rightarrow &  \Coh_{\Lambda_\mathrm b}( \CK'(G_\mathrm b)),\\
   \Psi'_\mathrm b&\mapsto & \left(\nu\mapsto \Ind(\Psi'_\mathrm b(\nu))\right).
   \end{array}
\]

Let $P$ be a $\check \CO$-relevant parabolic subgroup of $G$ as in \Cref{reduction}.
Then  $G'_\mathrm b\times G_\mathrm g$ (or its quotient by $\{\pm 1\}$ when $\star=\wtC$) is naturally isomorphic to the  Levi quotient  of $P$. The
 normalized smooth parabolic induction using $P$ yields a linear map
\[
 \Ind:  \CK'(G'_{\mathrm b})\otimes \CK'(G_{\mathrm g})\rightarrow \CK'(G),
\]
which further induces a linear map (see \cite{Vg}*{Corollary 7.2.10})
\[
\begin{array}{rcl}
 \Ind:  \Coh_{\Lambda_{\mathrm b}}(\CK'(G'_{\mathrm b}))\otimes  \Coh_{\Lambda_\mathrm g}(\CK'(G_{\mathrm g})) &\rightarrow &  \Coh_{\Lambda}( \CK'(G)),\\
  \Psi'_\mathrm b\otimes \Psi_\mathrm g&\mapsto & \left((\nu_\mathrm b,\nu_\mathrm g)\mapsto \Ind(\Psi'_\mathrm b(\nu_\mathrm b))\otimes \Psi_\mathrm g(\nu_\mathrm g))\right).
   \end{array}
\]
 % This follows from the compatibility of parabolic induction with coherent families
 % .
  \trivial[h]{
  Note that for real parabolic induction, $\chi_\fqq(W)= R_\fqq^0(W)$ since other terms all vanishes \cite{Vg}*{Proposition~6.3.5}. This is how \cite{Vg}*{Corollary 7.2.10} implies our claim.
  }

The following result follows from Langlands' construction of standard modules. See \cite{Vg}*{Lemma~6.6.12 and Theorem~6.6.15}.
\begin{lem}\label{lem:cohred000}
       The  diagram
    \be\label{cdt}
    \begin{tikzcd}[column sep={4cm,between origins}]
      & \Coh_{\Lambda_{\mathrm b}}(\CK'(G'_{\mathrm b}))\otimes  \Coh_{\Lambda_{\mathrm g}}(\CK'(G_{\mathrm g}))
      \ar[dl,"\Ind \otimes  \mathrm{Id }"'] \ar[dr,"\Ind "]&\\
   \Coh_{\Lambda_\mathrm b}(\CK'(G_{\mathrm b}))   \otimes     \Coh_{\Lambda_{\mathrm g}}(\CK'(G_{\mathrm g})) \ar[rr,"\varphi"]& & \Coh_{\Lambda}(\CK'(G))
    \end{tikzcd}
  \ee
   commutes.
 \end{lem}


  \begin{prop}\label{lem:cohred111}
    For all  $\pi'\in \Unip_{\ckcO'_{\mathrm b}}(G'_{\mathrm b})$ and  $\pi_{\mathrm g}\in  \Unip_{\ckcO_{\mathrm g}}(G_{\mathrm g})$, the  normalized smooth induction
    $\Ind_P^G (\pi_\mathrm g\widehat \otimes \pi')$ is irreducible and belongs to  $\Unip_{\ckcO}(G)$.
    %Here   $P$ is a parabolic subgroup of $G$ containing $G_\mathrm g\times G'_\mathrm b$ (or its quotient by $\{\pm 1\}$ when $\star=\wtC$) as a Levi subgroup.
 \end{prop}
\begin{proof}
By using the evaluation maps, the commutative  diagram \eqref{cdt} descends to a commutative diagram
\be\label{tri}
\begin{tikzcd}[column sep={4cm,between origins}]
      & \CK'_{\lambda_{\check \CO_\mathrm b}}(G'_{\mathrm b})   \otimes \CK'_{\lambda_{\check \CO_\mathrm g}}(G_{\mathrm g})
      \ar[dl," \Ind \otimes \mathrm{Id}"']\ar[dr,"\Ind "]&\\
      \CK'_{\lambda_{\check \CO_\mathrm b}}(G_{\mathrm b})\otimes  \CK'_{\lambda_{\check \CO_\mathrm g}}(G_{\mathrm g})\ar[rr,"\varphi_{\lambda_{\check \CO}}"]& & \CK'_{\lambda_{\check \CO}}(G).
    \end{tikzcd}
\ee
Here $\varphi_{\lambda_{\check \CO}}$ is as in Proposition \ref{propKL33}. Thus  $\Ind_P^G (\pi_\mathrm g\widehat \otimes \pi')$ is irreducible
    by Propositions \ref{lem:Unip.BP} and \ref{propKL33}. As before,   \cite[Corollary 5.0.10]{B.Orbit} implies that $\Ind_P^G (\pi_\mathrm g\widehat \otimes \pi')\in \Unip_{\ckcO}(G)$.
\end{proof}



By \Cref{lem:cohred111}, we have a well-defined map
\be\label{ind000}
  \Ind: \Unip_{\ckcO'_{\mathrm b}}(G'_{\mathrm b})\times \Unip_{\ckcO_{\mathrm g}}(G_{\mathrm g})   \longrightarrow \Unip_{\ckcO}(G).
  \ee
In view of the commutative diagram \eqref{tri},   Propositions \ref{propKL33} and \ref{lem:Unip.BP} implies that the map \eqref{ind000} is injective.
On the other hands,
Propositions \ref{propKL333} and \ref{lem:Unip.BP} imply that the domain
and codomain of the map  \eqref{ind000} have the same cardinality.
Thus the map  \eqref{ind000}  is bijective. This finishes the proof of  \Cref{reduction}.

% We would like to reduce the problem to consider the bad and good parts
% separately.
%

\def\fhhaso{(\fhh^a_1)^*}
\def\fhhast{(\fhh^a_2)^*}
\newcommand{\ff}{f}
\newcommand{\ffcoh}{\varphi}

\section{Combinatorics of painted bipartitions}
\label{sec:com}

Throughout this section, we assume that $\star \in \{B,C,\wtC,C^{*},D,D^{*}\}$, and $\ckcO = \ckcOg$, namely $\ckcO $ has $\star$-good parity.

Recall the set  $\CPPs(\ckcO)$ of primitive $\star$-pairs in $\ckcO$ (\Cref{defn:PP}). For each subset $\wp$ of $\CPPs(\ckcO)$, we have defined a pair   $(\imath_{\wp},\jmath_{\wp})$ of Young diagrams in \Cref{sec:LCBCD}. Our main object of interest is the disjoint union:
\[
  \tPBP_{G}(\check \CO):=   \bigsqcup_{\wp \subseteq \CPP(\ckcO)}\PBPGOP ,
 \]
where
\[
\PBPGOP := \set{\uptau \text{ is a painted bipartition}|  (\imath_{\uptau},\jmath_{\uptau}) = (\imath_{\wp},\jmath_{\wp}), G_{\uptau}=G}.
\]


\subsection{Main combinatorial results}
%\subsection{Painted bipartitions in quaternionic group cases}
% The following two combinatorial results follow by induction on $\mathbf c_1(\check \CO)$. As the proof is quite tedious, we omit the details.
%
%\subsection{Non-existence of painted bipartition in quaternionic group cases}

We say that the orbit $\check \CO$ is  quasi-distinguished
if there is no $\star$-pair that is balanced in $\check \CO$ (see \Cref{defn:PP}).

For the quaternionic groups, we have the following non-existence result on painted
bipartitions.

\begin{prop} \label{prop:PBP1} Suppose that $\star\in \set{C^{*}, D^{*}}$.
If $\PBP_{G}(\check \CO, \wp)$ is nonempty for some $\wp\subset \CPPs(\ckcO)$, then    $\check \CO$ is quasi-distinguished and $\wp=\emptyset$. Consequently,
     \[
     \sharp(\tPBP_{G}(\ckcO)) = \sharp(\PBP_{G}(\ckcO)).
  \]
\end{prop}

\trivial[h]{
\begin{prop} \label{prop:PBP1} Suppose that $\star\in \set{C^{*}, D^{*}}$.

\noindent \item(a) If $\wp\subset \CPPs(\ckcO)$ is nonempty, then
\[
    \PBP_{G}(\check \CO, \tau_{\wp}) = \emptyset.
  \]
 Consequently,
     \[
     \sharp(\tPBP_{G}(\ckcO)) = \sharp(\PBP_{G}(\ckcO)).
  \]
\noindent (b) If the set $\PBP_\star(\ckcO)$ is nonempty, then $\check \CO$ is quasi-distinguished.

\trivial[h]{
\begin{enumerate}
 \item[(a)] If $\wp\subset \CPPs(\ckcO)$ is nonempty, then
\[
    \PBP_{G}(\tau_{\wp}) = \emptyset.
  \]
 Consequently,
     \[
     \sharp(\tPBP_{G}(\ckcO)) = \sharp(\PBP_{G}(\ckcO)).
  \]
\item[(b)] If the set $\PBP_\star(\ckcO)$ is nonempty, then $\check \CO$ is quasi-distinguished.
\end{enumerate}
}
\end{prop}
}
%\begin{remark} We will prove a more precise result on the counting of bipartitions for quaternionic groups in \Cref{sec:PrQu}.
%\end{remark}

\begin{proof}
 Suppose that
  $\uptau = (\imath_{\wp}, \cP)\times (\jmath_{\wp},\cQ)\times \star\in \PBP_{G}(\check \CO, \wp)$.
Assume by contradiction that  $\wp \neq \emptyset$.

   First assume that  $\star = C^{*}$.  Pick an element $(2i-1, 2i)\in \wp$. Then we have that
  \begin{equation}\label{eq:res.C*}
    \bfcc_{i}(\imath_{\wp}) = \half(\bfrr_{2i-1}(\ckcO)+1)>
    \half(\bfrr_{2i}(\ckcO)-1) = \bfcc_{i}(\jmath_{\wp}).
      \end{equation}
   By the requirements of a painted bipartition, we also have that
  \begin{eqnarray*}
    \bfcc_{i}(\imath_{\wp})& = &\sharp\set{j\in \BN^+ \mid (i,j)\in \BOX{\imath_\wp}, \, \cP(i,j)=\bullet} \\
    &= &\sharp\set{j\in \BN^+\mid  (i,j)\in \BOX{\jmath_\wp}, \, \cQ(i,j)=\bullet} \\
    &\leq & \bfcc_{i}(\jmath_{\wp}).
  \end{eqnarray*}
 This contradicts \eqref{eq:res.C*} and therefore $\wp = \emptyset$.



  Now assume that $\star = D^{*}$. Pick an element  $(2i, 2i+1)\in \wp$.
  Then we have that
  \begin{equation}\label{eq:res.D*}
    \bfcc_{i+1}(\imath_{\wp}) = \half(\bfrr_{2i}(\ckcO)+1)>
    \half(\bfrr_{2i+1}(\ckcO)-1) = \bfcc_{i}(\jmath_{\wp}).
  \end{equation}
      By the requirements of a painted bipartition, we also have that
  \begin{eqnarray*}
  \bfcc_{i+1}(\imath_{\wp})& \leq & \sharp\set{j\in \BN^+ \mid (i,j)\in \BOX{\imath_\wp}, \,  \cP(i,j)=\bullet} \\
  &=&\sharp\set{j\in \BN^+ \mid (i,j)\in \BOX{\jmath_\wp}, \,  \cQ(i,j)=\bullet} \\
  &\leq & \bfcc_{i}(\jmath_{\wp}).  \end{eqnarray*}
 This contradicts \eqref{eq:res.D*} and therefore  $\wp = \emptyset$.

It is also straightforward to show that $\check \CO$ is quasi-distinguished from the requirements of a painted bipartition. We omit the details.
\end{proof}

In view of \Cref{prop:PBP1}, we  assume in the rest of this section that $\check \CO$ is quasi-distinguished when $\star\in \{C^*,D^*\}$.

%The purpose of this section is to prove the   following combinatorial result.


%We shall deal with the two quaternionic cases first, which are simple. When $\star \in \set{B, C, \wtC, D}$, the proof of the main statement of the above proposition involves an elaborate reduction argument (by removing elements from $\wp$ one-by-one), and will be handled separately in \Cref{lem:down} below.
%[Proof of {\Cref{prop:PBP}} the quaternionic case]


\delete{
The following proposition implies that we will only need to consider
quasi-distinguished nilpotent orbits $\ckcO$ when $\star\in \set{C^*, D^*}$.

\begin{prop}\label{prop:CD*}
  Suppose that $\star\in \set{C^*, D^*}$. If the set $\PBP_\star(\ckcO)$ is nonempty, then $\check \CO$ is quasi-distinguished.
\end{prop}
\begin{proof}
  Suppose that $\tau=(\imath,\cP)\times(\jmath,\cQ)\times \star \in  \mathrm{PBP}_\star(\check \CO)$. If  $\star=C^*$, then the definition of a painted bipartition implies that
 \[
 \bfcc_i(\imath)\leq \bfcc_i(\jmath) \qquad \textrm{for all } i=1,2,3, \cdots.
 \]
This forces $\check \CO$ to be quasi-distinguished.

 If  $\star=D^*$, then the definition of a painted bipartition implies that
 \[
 \bfcc_{i+1}(\imath)\leq \bfcc_i(\jmath) \qquad \textrm{for all } i=1,2,3, \cdots.
 \]
This also forces $\check \CO$ to be quasi-distinguished.
 \end{proof}
 }

%\subsection{Descent of painted bi-partition}



%\subsection{Counting in type $B,C,\wtC,D$}


%The following combinatorial result follows by induction on $\mathbf c_1(\check \CO)$.
In the rest of the section, we will define a notion of descent for painted
bipartitions which will be used as an induction mechanism and we will deduce certain counting formulas by a generating function approach. The following
proposition will then be an immediate consequence of a certain (independence) property of the generating functions in \Cref{prop:gf.BD} and \Cref{prop:gf.C}. %the independence of $\wp$

% we are devoted to establish the following counting
% result.
% which
% imply the following counting result.

\begin{prop} \label{prop:PBP2}
Suppose that   $\star\in \set{B,C,\wtC,D}$. Then
  \[
    \sharp(\PBPop{G}{}{\ckcO}{\wp}) = \sharp(\PBPop{G}{}{\ckcO}{\emptyset}), \quad \textrm{for all } \wp \subset \CPPs(\ckcO).
  \]
 Consequently,
     \[
     \sharp(\tPBP_{G}(\ckcO)) = 2^{\sharp(\CPPs(\ckcO))}\cdot \sharp(\PBP_{G}(\ckcO)).
  \]
\end{prop}

% We will define a notion of descent of painted
% bipartition and then deduce the formulas of the generating functions
% on the counting problem in \Cref{lem:gf.BD} and \Cref{lem:gf.C}.
% Then \Cref{prop:PBP2} is a immediate consequence of the independence of $\wp$ of
% the generating functions.

 \subsection{Type $C$ and $\wtC$: shape shifting}
 In this subsection, we assume that $\star \in \set{C,\wtC}$. We will define a shape shifting operation on painted bipartitions which we will be used in defining the notion of descent.


 Recall that $\ckcO$ is an orbit with good parity. In this subsection we assume that  $(1,2)\in \CPPs(\ckcO)$, namely the pair $(1,2)$ is primitive in $\check \CO$.
 Let $\wp$ be a subset of  $\CPPs(\ckcO)$ such that $(1,2)\notin \wp$.
 Put  $\wp_{\uparrow}:= \wp\cup \set{(1,2)}\subset \CPPs(\ckcO)$.

% We have the following decomposition of the power set
% $\mathrm A(\ckcO)$ of $\CPPs(\ckcO)$:
% \[
% \mathrm A(\ckcO) = \mathrm A_{\mathrm s}(\ckcO) \sqcup \mathrm A_{\mathrm{ns}}(\ckcO),
% \]
% where
% \[
% \mathrm A_{\mathrm s}(\ckcO) : = \set{\wp\subseteq \CPPs(\ckcO) | (1,2)\notin \wp} \AND
%  \mathrm A_{\mathrm{ns}}(\ckcO): = \set{\wp\subseteq \CPPs(\ckcO) | (1,2)\in \wp}.
% \]


 \trivial[h]{Clearly, the map
 $\wp \mapsto \wp_{\uparrow}$ defines a bijection from $\mathrm A_{\mathrm s}(\ckcO)$ to
 $\mathrm A_{\mathrm{ns}}(\ckcO)$.
 }
 % For each $\wp\in A(\ckcO)$, we define
 % $\wp_{\leftrightarrow}:= (\wp-\set{(1,2)})\cup (\set{(1,2)} - \wp)$. Clearly,
 % the map $\wp \mapsto \wp_{\leftrightarrow}$ defines bijection between
 % $\Ass(\ckcO)$ and $\Ans(\ckcO)$.
 %
 %
Note  that
  \[
      (\bfcc_{1}(\imath_{\wpu}), \bfcc_{1}(\jmath_{\wpu})) =
      \begin{cases}
        (\bfcc_{1}(\jmath_{\wpd})+1, \bfcc_{1}(\imath_{\wpd})-1), & \text{when
        } \star = C;\\
        (\bfcc_{1}(\jmath_{\wpd}), \bfcc_{1}(\imath_{\wpd})), & \text{when
        } \star = \wtC,\\
      \end{cases}
  \]
  and
  \[
      (\bfcc_{i}(\imath_{\wpu}),\bfcc_{i}(\jmath_{\wpu})) =(\bfcc_{i}(\imath_{\wpd}),\bfcc_{i}(\jmath_{\wpd})),\qquad \text{for $i=2, 3, 4, \dots$}.
  \]

 For
 $\uptau := (\imath_{\wp},\cP_{\uptau})\times (\jmath_{\wp},\cQ_{\uptau})\times \alpha \in \PBPOP $,
 we will define an element
 \[
   \uptauu:= (\imath_{\wpu}, \cP_{\uptauu})\times (\jmath_{\wpu},\cQ_{\uptauu})\times \alpha\in \PBPop{\star}{}{\ckcO}{\wpu}
 \]
 by the following recipe.



 \newcommand{\localtextbulletone}{\textcolor{black}{\raisebox{.45ex}{\rule{.6ex}{.6ex}}}}

\medskip
 {\bfseries The case when $\star = C$.}
 Note that $\bfcc_1(\imath_{\wpu})> \bfcc_1(\imath_\wp)\geq 1$ since $(1,2)\in \CPP_\star(\ckcO)$.
  For all $(i,j)\in \BOX{\imath_{\wpu}}$, we define $\cP_{\uptauu}(i,j)$ case by
  case as in what follows.
 \begin{enumerate}[label=(\alph*)]
   \item Suppose that
   $\cP_{\uptaud}(\bfcc_{1}(\imath_{\wpd}),1)\neq \bullet$.
   \begin{enumerate}[label={\localtextbulletone}]
     \item If $\bfcc_{1}(\imath_{\wpd})\geq 2$ and
     $\cP_{\uptau}(\bfcc_{1}(\imath_{\wpd})-1,1) = c$,
     we define
     \[
       \cP_{\uptauu}(i,j) := \begin{cases}
         r ,& \text{if $j=1$ and $\bfcc_{1}(\imath_{\wpd})-1
           \leq i \leq \bfcc_{1}(\imath_{\wpu})-2$};\\
         c ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpu})-1,1)$};\\
         d ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpu}),1)$};\\
         \cP_{\uptaud}(i,j) ,&\text{otherwise}.
       \end{cases}
     \]
     \item Otherwise, we define
     \[
       \cP_{\uptauu}(i,j) := \begin{cases}
         r ,& \text{if $j=1$ and $\bfcc_{1}(\imath_{\wp})
           \leq i \leq \bfcc_{1}(\imath_{\wpu})-1$};\\
         \cP_{\uptaud}(\bfcc_{1}(\imath_{\wpd}),1), &
         \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpu}),1)$};\\
         \cP_{\uptaud}(i,j) ,&\text{otherwise},
       \end{cases}
     \]
   \end{enumerate}
   \item Suppose that $\cP_{\uptaud}(\bfcc_{1}(\imath_{\wpd}),1)=\bullet$.
   \begin{enumerate}[label={\localtextbulletone}]
     \item If $\bfcc_{2}(\imath_{\wpd}) = \bfcc_{1}(\imath_{\wpd})$
     and
     $\cP_{\uptaud}(\bfcc_{1}(\imath_{\wpd}),2) = r$,
     we define
     \[
       \cP_{\uptauu}(i,j) := \begin{cases}
         r ,& \text{if $j=1$ and $\bfcc_{1}(\imath_{\wpd})\leq i \leq \bfcc_{1}(\imath_{\wpu})-1$};\\
         c ,& \text{if $(i,j)=(\bfcc_{2}(\imath_{\wpd}),2)$};\\
         d ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpu}),1)$};\\
         \cP_{\uptaud}(i,j) ,&\text{otherwise}.
       \end{cases}
     \]
     \item Otherwise, we define
     \[
       \cP_{\uptauu}(i,j) := \begin{cases}
         r ,& \text{if $j=1$ and $\bfcc_{1}(\imath_{\wpd})\leq i \leq \bfcc_{1}(\imath_{\wpu})-2$};\\
         c ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpu})-1,1)$};\\
         d ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpu}),1)$};\\
         \cP_{\uptaud}(i,j) ,&\text{otherwise}.
       \end{cases}
     \]
   \end{enumerate}
 \end{enumerate}

Note that $\BOX{\jmath_{\wpu}}\subseteq \BOX{\jmath_{\wp}}$.   For all $(i,j)\in \BOX{\jmath_{\wpu}}$, we define
   \[
     \cQ_{\uptauu}(i,j) := \cQ_{\uptau}(i,j).
   \]

\medskip
{\bfseries The case when $\star = \wtC$.} %Note that $\BOX{\imath_{\wpu}}\subseteq \BOX{\imath_{\wp}}$.
  For all $(i,j)\in \BOX{\imath_{\wpu}}$, define
  \begin{equation} \label{eq:T.M1}
     \cP_{\uptauu}(i,j) :=
     \begin{cases}
       s,& \text{if $j=1$ and  $\cQ_{\uptau}(i,j)=r$;}\\
       c,& \text{if $j=1$ and  $\cQ_{\uptau}(i,j)=d$;}\\
       \cP_{\uptau}(i,j), &\text{otherwise.}
     \end{cases}
     % \cP_{\uptau}(i,j).
   \end{equation}
  For all $(i,j)\in \BOX{\jmath_{\wpu}}$,
   % For $\uptaum\in\PBPs(\tau_{\PPm})$, define $\uptau=:T_{\PPm,\wp}(\uptaum)$
   % by the following formula:
  \begin{equation} \label{eq:T.M2}
    \cQ_{\uptauu}(i,j) :=
    \begin{cases}
      r,& \text{if $j=1$ and  $\cP_{\uptau}(i,j)=s$;}\\
      d,& \text{if $j=1$ and  $\cP_{\uptau}(i,j)=c$;}\\
      \cQ_{\uptau}(i,j), &\text{otherwise.}
    \end{cases}
  \end{equation}


 % to an element $\uptauu\in \PBP_{\star}(\ttau_{\wpu})$ such that

In both cases, it is routine to check that $\uptauu$ is a painted
bipartition and is an element of $\PBPop{\star}{}{\ckcO}{\wpu}$.

\begin{lem}\label{lem:sn}
 %Suppose that $(1,2)\in \CPPs(\ckcO)$ and let  $\wp\in \mathrm A_\mathrm s(\ckcO)$. Then
 The map
  \[
    T_{\wp,\wpu}\colon \PBPOP \rightarrow
    \PBPop{\star}{}{\ckcO}{\wpu}, \quad \uptau \mapsto \uptauu
  \]
  defined above is bijective.
\end{lem}
\begin{proof}
  Let $\uptauu = (\imath_{\wpu}, \cP_{\uptauu})\times (\jmath_{\wpu},\cQ_{\uptauu})\times \alpha \in\PBPop{\star}{}{\ckcO}{\wpu}$. We will define a painted bipartition $\uptaud\in \PBPOP$ by the following recipe.



  \medskip

  {\bfseries The case when $\star = C$.}
  %For all $(i,j)\in \BOX{\jmath_{\wpd}}$, we define $\cP_{\uptaud}(i,j)$ and $\cQ_{\uptaud}(i,j)$
  Note that $$\bfcc_1(\imath_{\wpu})= \bfcc_1(\jmath_{\wp})+1>  \bfcc_1(\imath_\wp)= \bfcc_1(\jmath_{\wpu})+1.$$
  We define $\cP_{\uptaud}$ and $\cQ_{\uptaud}$  case by case as in what follows.
 \begin{enumerate}[label=(\alph*)]
   \item Suppose that
   $\cP_{\uptauu}(\bfcc_{1}(\imath_{\wpu})-1,1)=c$.
   \begin{enumerate}[label={\localtextbulletone}]
     \item
           If $\bfcc_{1}(\jmath_{\wpu})\geq 1$ and
           $\cP_{\uptauu}(\bfcc_{1}(\jmath_{\wpu}),1) = r$,
         for all $(i,j)\in \BOX{\imath_{\wpd}}$  we define
     %       If $\bfcc_{1}(\imath_{\wpd})\geq 2$ and
     % $\cP_{\uptau}(\bfcc_{1}(\imath_{\wpd})-1,1) = r$,
          \[
       \cP_{\uptaud}(i,j) := \begin{cases}
         c ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpd})-1,1)$};\\
         d ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpd}),1)$};\\
         \cP_{\uptauu}(i,j) ,&\text{otherwise},
       \end{cases}
     \]
     and for all $(i,j)\in \BOX{\jmath_{\wpd}}$ we define
     \[
       \cQ_{\uptaud}(i,j) := \begin{cases}
         s ,& \text{if $j=1$ and $\bfcc_{1}(\imath_{\wpd})\leq i \leq \bfcc_{1}(\jmath_{\wpd})$};\\
         \cQ_{\uptauu}(i,j), &\text{otherwise}.
       \end{cases}
     \]

     %% Note that c_1(j_wpu)+1 =c_1(i_wpd)
     \item Otherwise, for all $(i,j)\in \BOX{\imath_{\wpd}}$ we define
     \[
       \cP_{\uptaud}(i,j) := \begin{cases}
         \bullet ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpd}),1)$};\\
         \cP_{\uptauu}(i,j) ,&\text{otherwise},
       \end{cases}
     \]
     and for all $(i,j)\in \BOX{\jmath_{\wpd}}$ we define
     \[
       \cQ_{\uptaud}(i,j) := \begin{cases}
         \bullet ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpd}),1)$};\\
         s ,& \text{if $j=1$ and $\bfcc_{1}(\imath_{\wpd})+1\leq i \leq \bfcc_{1}(\jmath_{\wpd})$};\\
         \cQ_{\uptauu}(i,j) ,&\text{otherwise}.
       \end{cases}
     \]
   \end{enumerate}
   \item Suppose that $\cP_{\uptauu}(\bfcc_{1}(\imath_{\wpu})-1,1)=r$.
   \begin{enumerate}[label={\localtextbulletone}]
     \item If $\bfcc_{2}(\imath_{\wpu}) = \bfcc_{1}(\jmath_{\wpu})+1$
     and
     $(\cP_{\uptauu}(\bfcc_{1}(\imath_{\wpu}),1), \cP_{\uptauu}(\bfcc_{2}(\imath_{\wpu}),2) ) = (d,c)$,
         for all $(i,j)\in \BOX{\imath_{\wpd}}$  we define
     \[
       \cP_{\uptaud}(i,j) := \begin{cases}
         \bullet ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpd}),1)$};\\
         r ,& \text{if $(i,j)=(\bfcc_{2}(\imath_{\wpd}),2)$};\\
         \cP_{\uptauu}(i,j) ,&\text{otherwise},
       \end{cases}
     \]
     and  for all $(i,j)\in \BOX{\jmath_{\wpd}}$  we define
     \[
       \cQ_{\uptaud}(i,j) := \begin{cases}
         \bullet ,& \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpd}),1)$};\\
         s ,& \text{if $j=1$ and $\bfcc_{1}(\imath_{\wpd})+1\leq i \leq \bfcc_{1}(\jmath_{\wpd})$};\\
         \cQ_{\uptauu}(i,j), &\text{otherwise}.
       \end{cases}
     \]
     \item Otherwise,
         for all $(i,j)\in \BOX{\imath_{\wpd}}$  we define
     \[
       \cP_{\uptaud}(i,j) := \begin{cases}
         \cP_{\uptauu}(\bfcc_{1}(\imath_{\wpu}),1), & \text{if $(i,j)=(\bfcc_{1}(\imath_{\wpd}),1)$};\\
         \cP_{\uptauu}(i,j) ,&\text{otherwise},
       \end{cases}
     \]
     and for all $(i,j)\in \BOX{\jmath_{\wpd}}$  we define
     \[
       \cQ_{\uptaud}(i,j) := \begin{cases}
         s ,& \text{if $j=1$ and $\bfcc_{1}(\imath_{\wpd})\leq i \leq \bfcc_{1}(\jmath_{\wpd})$};\\
         \cQ_{\uptauu}(i,j) ,&\text{otherwise}.
       \end{cases}
     \]
   \end{enumerate}
 \end{enumerate}

\medskip

  {\bfseries The case when $\star = \wtC$.}
  The definition of $T_{\wpu,\wp}$ is given by the formulas \eqref{eq:T.M1} and
  \eqref{eq:T.M2} with the
  role of $\wp$ and $\wpu$ switched.


In both cases, it is routine to check that
  \[
    T_{\wpu,\wp}\colon
    \PBPop{\star}{}{\ckcO}{\wpu} \rightarrow \PBPOP  , \qquad \uptauu\mapsto \uptaud
  \]
 is well-defined and is the inverse of $T_{\wp,\wpu}$.
\end{proof}


% % The rest of this section is devoted to the proof of the following lemma, which
% % clearly implies Proposition \ref{prop:PBP}.




% % Suppose $\star = \wtC$, $\wp\neq \emptyset$, and
% % $t:=\min{t|(2t-1,2t)\in \wp}$. Let $\PPm:=\wp - \set{(2t-1,2t)}$. Let
% % $\PPm:=\wp - \set{(2t-1,2t)}$.

% \begin{lem}\label{lem:down}
%   Suppose $\star \in \set{B, C, \wtC, D}$ and $\wp$ is a non-empty subset of
%   $\CPPs(\ckcO)$. Let
%   \[
%     t:=
%     \begin{cases}
%       \min\set{i|(2i-1,2i)\in \wp}, & \text{if $\star \in \set{C,\wtC}$};\\
%       \min\set{i|(2i,2i+1)\in \wp}, & \text{if $\star \in \set{B,D}$},\\
%     \end{cases}
%   \]
%   and
%   \[
%     \PPm:=
%     \begin{cases}
%       \wp \setminus \set{(2t-1,2t)},  & \text{if $\star \in \set{C,\wtC}$};\\
%       \wp \setminus   \set{(2t,2t+1)}, & \text{if $\star \in \set{B,D}$}.\\
%     \end{cases}
%   \]
%   Then
%   \[
%     \sharp(\PBP_{\star}(\tau_{\PPm})) = \sharp(\PBP_{\star}(\tau_{\wp})).
%   \]
% \end{lem}

% \begin{proof}
%   We prove the equality by defining a bijection
%   \[
%     T_{\PPm,\wp}\colon \PBP_{\star}(\tau_{\PPm}) \rightarrow \PBP_{\star}(\tau_{\wp})\quad \uptaum \mapsto \uptau
%   \]
%   % and its inverse $T_{\wp,\PPm}$
%   explicitly case by case. In the following,
%   $\uptau = (\imath_{\wp},\cP_{\uptau})\times (\jmath_{\wp},\cQ_{\uptau})$ will
%   always denote an element in $\PBP_{\star}(\tau_{\wp})$ and
%   $\uptaum = (\imath_{\PPm},\cP_{\uptaum})\times (\jmath_{\PPm},\cQ_{\uptaum})$
%   an element in $\PBP_{\star}(\tau_{\PPm})$.

%   \medskip
% \end{proof}



\subsection{Naive descent of a painted bipartition}\label{sec:comb}


%In this subsection, we define the descent of a painted bipartition.
%as alluded to in Section \ref{subsec:comTOrep}.
As before, let  $\star\in \{ B, C,  D, \widetilde{C},  C^*, D^*\}$ and let $\check \CO$ be a Young diagram that has $\star$-good parity.


Define a symbol
\[
\star':=\widetilde{C}, \ D, \  C, \ B, \ D^*\  \textrm{ or } \ C^*
\]
respectively if
\[
\star=B,\  C, \ D, \ \widetilde{C}, \ C^* \ \textrm{ or }\  D^*.
\]
We call $\star'$
 the Howe dual of $\star$.

%In the rest of this section, we assume that $\check \CO\neq \emptyset$.

 %Put\[
%l':=l_{\star', \check \CO'}
%\]


\def\bipartl{\mathrm{bi\cP_L}}
\def\bipartr{\mathrm{bi\cP_R}}
\def\dsdiagl{\mathrm{DS_L}}
\def\dsdiagr{\mathrm{DS_R}}
\def\DDl{\eDD_\mathrm{L}}
\def\DDr{\eDD_\mathrm{R}}


For a Young diagram $\imath$, its naive descent, which is denoted by $\nabla_\mathrm{naive}(\imath)$, is defined to be the Young diagram obtained from $\imath$ by removing the first column. By convention, $\nabla_\mathrm{naive}(\emptyset)=\emptyset$.

We start with the notion of the naive descent of a painted bipartition. Let $\uptau=(\imath,\cP)\times (\jmath,\cQ)\times \alpha$ be a painted bipartition such that $\star_\tau=\star$. Put
\delete{\begin{equation} \label{eq:def.alphap}
\alpha'=\begin{cases} B^+,
& \textrm{if $\alpha = \wtC$ and $\cP_\tau(l_{\star,\ckcO},1),1) \neq c$;}\\
B^-,
& \textrm{if $\alpha = \wtC$ and $\cP_\tau(l_{\star,\ckcO},1),1)  = c$;}\\
\star', & \textrm{if $\alpha\neq \widetilde C$}.
\end{cases}
\end{equation}
}
  \begin{equation} \label{eq:def.alphap}
    \alphapn=\begin{cases} B^+,
  & \textrm{if $\alpha=\widetilde{C}$ and $c$ does not occur in the first column of $(\imath,\cP)$}; \smallskip \\
  B^-,
  & \textrm{if $\alpha=\widetilde{C}$ and  $c$ occurs in the first column of $(\imath,\cP)$}; \smallskip \\
  \star', & \textrm{if $\alpha\neq \widetilde C$}.
  \end{cases}
  \end{equation}

\begin{lem}\label{lemDDn1}
  If $\star \in \set{B,C,C^*}$, then there is a unique painted bipartition of the form $\uptaupn= (\imathpn,\cPpn)\times (\jmathpn,\cQpn)\times \alphapn$ with the following properties:
  \begin{itemize}
        \item $
   (\imathpn,\jmathpn)= (\imath,\DD_\mathrm{naive}(\jmath)); \smallskip
   $
   \item for all $(i,j)\in \BOX{\imathpn}$,
   \[
     \cPpn(i,j)=\begin{cases}
    \bullet \textrm{ or } s,&\textrm{ if  $\ \cP(i,j)\in \{\bullet, s\}$;} \smallskip \\
  \cP(i,j),& \textrm{ if $\ \cP(i,j)\notin \{\bullet, s\}$};\end{cases}
   \]
   \item for all $(i,j)\in \BOX{\jmathpn}$,
   \[
     \cQpn(i,j)=\begin{cases}
    \bullet \textrm{ or } s,&\textrm{ if  $\ \cQ(i,j+1)\in \{\bullet, s\}$;} \smallskip \\
  \cQ(i,j+1), & \textrm{ if $\ \cQ(i,j+1)\notin \{\bullet, s\}$}.  \end{cases}
   \]
    \end{itemize}
    \end{lem}




   \begin{proof}
    First assume that the images of $\cP$ and $\cQ$ are both contained in $\{\bullet, s\}$. Then  the image of $\cP$  is in fact contained in $\{\bullet\}$, and $(\imath, \jmath)$ is  right interlaced in the sense that
 \[
 \mathbf{c}_1(\jmath)\geq \mathbf{c}_1(\imath)\geq \mathbf{c}_2(\jmath)\geq \mathbf{c}_2(\imath)\geq \mathbf{c}_3(\jmath)\geq \mathbf{c}_3(\imath) \geq \cdots.
 \]
 Hence $ (\imath',\jmath'):= (\imath,\DD(\jmath))$ is left interlaced in the sense that
 \[
 \mathbf{c}_1(\imath')\geq \mathbf{c}_1(\jmath')\geq \mathbf{c}_2(\imath')\geq \mathbf{c}_2(\jmath')\geq \mathbf{c}_3(\imath')\geq \mathbf{c}_3(\jmath') \geq \cdots.
 \]
 Then it is clear that there is a unique painted bipartition of the form  $\uptaupn=(\imathpn,\cPpn)\times (\jmathpn,\cQpn)\times \alphapn$ such that symbols of $\cPpn$ and $\cQpn$ are both in $\{\bullet, s\}$. This proves the lemma in the special case when the images of $\cP$ and $\cQ$ are both contained in $\{\bullet, s\}$.

 The proof of the lemma in the general case is easily reduced to this special case.
   \end{proof}
    \begin{lem}\label{lemDDn2}
    If $\star \in \set{ \wtC, D,D^*}$, then there is a unique painted bipartition of the form $\uptaupn= (\imathpn,\cPpn)\times (\jmathpn,\cQpn)\times \alphapn$ with the following properties:
  \begin{itemize}
        \item $
   (\imathpn,\jmathpn)= (\DD_\mathrm{naive}(\imath),\jmath); \smallskip
   $
   \item for all $(i,j)\in \BOX{\imathpn}$,
   \[
     \cPpn(i,j)=\begin{cases}
    \bullet \textrm{ or } s,&\textrm{ if  $\ \cP(i,j+1)\in \{\bullet, s\}$;} \smallskip \\
  \cP(i,j+1),& \textrm{ if $\ \cP(i,j+1)\notin \{\bullet, s\}$};\end{cases}
   \]
   \item for all $(i,j)\in \BOX
          {\jmathpn}$,
   \[
     \cQpn(i,j)=\begin{cases}
    \bullet \textrm{ or } s,&\textrm{ if  $\ \cQ(i,j)\in \{\bullet, s\}$;} \smallskip \\
  \cQ(i,j), & \textrm{ if $\ \cQ(i,j)\notin \{\bullet, s\}$}.  \end{cases}
   \]

    \end{itemize}
\end{lem}
\begin{proof}
  The proof is similar to that of \Cref{lemDDn1}.
\end{proof}
 In the notation of \Cref{lemDDn1} and \Cref{lemDDn2}, we call $\uptaupn$ the naive descent of $\uptau$, to be denoted by $\DDn(\uptau)$.




 \begin{eg} If
    \[
     \uptau = \ytb{\bullet\bullet\bullet {c},\bullet {s} {c},{s},{c}}
    \times \ytb{\bullet\bullet\bullet ,\bullet {r} {d},{d}{d}, \none}
    \times \widetilde C, \]
   then
   \[
    \nabla_{\mathrm{naive}}(\uptau) =\ytb{\bullet\bullet{c} ,\bullet{c},\none }
    \times  \ytb{\bullet\bullet {s} ,\bullet {r} {d},{d}{d}}\times B^-.
    \]

\end{eg}


\subsection{Descent of a painted bipartition}
%   By convention, $\check \nabla_{\mathrm{naive}}(\emptyset)=\emptyset$.
   The dual descent of a Young diagram $\check \CO$ is defined to be
  \[
   \check \CO':=\check \nabla(\check \CO):=\check \nabla_\star( \check \CO):=\begin{cases}
   \tytb{\   }\, , \quad& \textrm{if $\star\in \{D, D^*\}$ and $|\check \CO|=0$};\smallskip\\
    %\textrm{the Young diagram obtained from $\check \CO$ by removing the first row}
  % \quad & \textrm{otherwise},
   \check \nabla_{\mathrm{naive}}(\check \CO), \quad & \textrm{otherwise},
    \end{cases}
  \]
  where $\tytb{\   }$ denotes the Young diagram that has total size $1$,
  and $\ckDDn(\ckcO)$ denotes the Young diagram obtained from $\check \CO$ by removing the first row. We also view $\check \CO'$ as a nilpotent orbit in the Langlands dual (or metaplectic Langlands dual) of the complexified Lie algebra of a classical real Lie group of type $\star'$.


The dual descent of a subset $\wp\subset \mathrm{PP}_{\star}(\check \CO)$ is defined to be the subset
\begin{equation*}\label{eq:DD.wp}
  \wp':=\ckDD(\wp):=\{(i,i+1)\mid i\in \bN^+, \, (i+1, i+2)\in \wp \}\subset \mathrm{PP}_{\star'}(\check \CO').
\end{equation*}
Note that
\[
 (\imath_{\wp'}, \jmath_{\wp'})=\begin{cases}
    (\imath_\wp, \nabla_{\mathrm{naive}}(\jmath_{\wp})), & \textrm{if $\star=B$, or $\star\in\{C, C^*\}$ and $(1,2)\notin \wp$;} \\
    ( \imath_{\wpm},  \nabla_{\mathrm{naive}}(\jmath_{\wpm})), & \textrm{if $\star\in \{C, C^*\}$ and $(1,2)\in \wp$}; \\
        ( \nabla_{\mathrm{naive}}(\imath_{\wp}),\jmath_{\wp}), & \textrm{if $\star\in \{D, D^*\}$, or $\star=\wtC$ and $(1,2)\notin \wp$}; \\
          ( \nabla_{\mathrm{naive}}(\imath_{\wpm}),\jmath_{\wpm}), & \textrm{if  $\star=\wtC$ and $(1,2)\in \wp$}, \\
 \end{cases}
\]
where $\imath_{\wp'}:=\imath_{\star'}(\check \CO', \wp')$, $\jmath_{\wp'}:=\jmath_{\star'}(\check \CO', \wp')$, and $\wpm=\wp\setminus \{(1,2)\}$.
%and %$\tauwpp = $(\imathwpp,\jmathwpp)$ be the
%bipartition defined by \eqref{eq:ttauwp} with respect to $\ckcO'$.
%
Suppose that
\[
\uptau=(\imath,\cP)\times(\jmath,\cQ)\times \alpha \in  \PBPOP.
\]
We will define an element
\[
  \uptau' := (\imathwpp, \cP')\times (\jmathwpp, \cQ')\times \alphapn \in \PBPs(\ckcOp,\wp'),
\]
to be called the descent of $\uptau$.

\medskip

{\bfseries The case when $\star = B$. }
%\begin{enumerate}[label={\localtextbulletone}]
\begin{enumerate}[label=(\alph*),wide=0pt]
  \item If
    \[
    \begin{cases}
      \alpha = B^+; & \\
      (2,3) \notin \wp ;& \\
      \bfrr_2(\ckcO)>0; & \\
      \cQ(\bfcc_1(\imath_{\wp}),1)\in \set{r,d},
    \end{cases}
    \]
    we define %
        \[
        \cP'(i,j) := \begin{cases}
          s, & \ \text{ if $(i,j) = (\bfcc_1(\imathwpp),1)$;}\\
          \cPpn(i,j), & \ \text{ otherwise}
        \end{cases}
        % \quad \text{for all $(i,j)\in \BOX{\imathwpp}$,}
        \] for all $(i,j)\in \BOX{\imathwpp}$, and
        $\cQ' := \cQpn $.
        \trivial[h]{
          Note that $\bfcc_{1}(\imathwpp) = \bfcc_{1}(\imath_{\wp})$
        }
  \item If
    \[
    \begin{cases}
      \alpha = B^+; & \\
      (2,3)\in \wp ;& \\
      \cQ(\bfcc_2(\jmath_{\wp}),1)\in \set{r,d},
    \end{cases}
    \]
    we define
    $\cP' := \cPpn $, and
    \[
    \cQ'(i,j) := \begin{cases}
      r, & \ \text{ if $(i,j) = (\bfcc_1(\jmathwpp),1)$;}\\
      \cQpn(i,j), & \ \text{ otherwise}
    \end{cases}
    \] for all $(i,j)\in \BOX{\jmathwpp}$.
    \trivial[h]{
      Note that $\bfcc_{1}(\jmathwpp) = \bfcc_{2}(\jmath_{\wp})$
    }
        \item Otherwise, we define $\cP' := \cPpn$ and $\cQ':= \cQpn$.
\end{enumerate}

\medskip
{\bfseries The case when $\star = D$. }
\begin{enumerate}[label=(\alph*),wide=0pt]
  \item If
  \[
    \begin{cases}
      \bfrr_2(\ckcO)=\bfrr_{3}(\ckcO)>0; & \\
      \cP(\bfcc_{2}(\imath_{\wp}),2) = c;  &\\
      \cP(i,1)\in \set{r,d}, & \text{for all
        $\bfcc_{2}(\imath_{\wp})\leq i\leq \bfcc_{1}(\imath_{\wp})$},
    \end{cases}
  \]
  we define %
  \[
    \cP'(i,j) := \begin{cases}
      r, & \ \text{ if $(i,j) = (\bfcc_1(\imathwpp),1)$;}\\
      \cPpn(i,j), & \ \text{ otherwise}
    \end{cases}
    % \quad \text{for all $(i,j)\in \BOX{\imathwpp}$,}
  \] for all $(i,j)\in \BOX{\imathwpp}$, and
  $\cQ' := \cQpn $.
  \item If
  \[
    \begin{cases}
      (2,3)\in \wp ;& \\
      \cP(\bfcc_2(\imath_{\wp})-1,1)\in \set{r,c},
    \end{cases}
  \]
  we define
  \[
    \cP'(i,j) := \begin{cases}
      r, & \ \text{ if $(i,j) = (\bfcc_1(\imathwpp)-1,1)$;}\\
      \cP(\bfcc_2(\imath_{\wp})-1,1), & \ \text{ if $(i,j) = (\bfcc_1(\imathwpp),1)$;}\\
      \cPpn(i,j), & \ \text{ otherwise}
    \end{cases}
  \] for all $(i,j)\in \BOX{\imathwpp}$,  and
  $\cQ' := \cQpn $.
  \item Otherwise, we define $\cP' := \cPpn$ and $\cQ':= \cQpn$.
\end{enumerate}

\medskip

{\bfseries The Case when $\star \in \set{C,\wtC,C^{*},D^{*}}$}.
\begin{enumerate}[label=(\alph*),wide=0pt]
  \item If $(1,2)\notin \wp$, we define
  \[
    \uptau' := \DDn(\uptau).
  \]
  % \[
  %   \alpha' = \alphapn, \quad
  %   \cP' := \cPpn \AND
  %   \cQ' := \cQpn.
  % \]
  \item If $(1,2)\in \wp$, then $\star \in \set{C,\wtC}$ (by \Cref{prop:PBP1}) and we define
  \[
  \uptau' := \DDn(\uptau_{\wpm}),
  \]
  where $\wpm := \wp \setminus \set{(1,2)}$,
  $\uptau_{\wpm}:= T_{\wpm,\wp}^{-1}(\uptau)$,
  and $T_{\wpm,\wp}$ is as in \Cref{lem:sn}.
 \end{enumerate}

\medskip
In all cases, it is routine to check that $\uptau'$ thus constructed is an element in $\PBPOPp$, which is called the descent of $\uptau$.
To summarize, we have a map
  \begin{equation}
    \label{eq:DD.CC}
    \DD \colon \PBPOP \rightarrow \PBPOPp.
  \end{equation}
 %where $\wp':=\ckDD(\wp)$.
We call $\DD$ the descent map of painted bipartitions.

%We shall summarize what we have done by the following result.
%\begin{prop}
%  Suppose that $\bfrr_1(\ckcO)>0$ and $\ckcO' := \ckDD(\ckcO)$.
%  For each $\wp \subseteq  \CPPs(\ckcO)$, the assignment $\uptau\mapsto \uptau'$ given above yields a well-defined map:
%  \begin{equation}
%    \label{eq:DD.CC}
%    \DD \colon \PBPOP \rightarrow \PBPOPp,
%  \end{equation}
% where $\wp':=\ckDD(\wp)$.
%\end{prop}

\subsection{Properties of the descent map}
%Tails of painted bipartitions of type $B$ and $D$
%\label{sec:tail}

%In this subsection we continue to assume that $\mathbf r_1(\ckcO)>0$. When $\star\in \{C^*, D^*\}$, we further assume that  $\ckcO$ is quasi-distinguished.

We first define the notion of the tail of a painted bipartition, when $\star\in\set{B, D, C^*}$.


%Let $(\imath,\jmath) = (\imath_{\star}(\ckcO),\jmath_{\star}(\ckcO))$.
%Note that $l\geq l'$ if $\star\in \{B,C^*\}$,   and $l\geq l'+1$ if $\star=D$.
\def\startt{\star_{\mathrm t}}
Put
\[
  \startt:= \begin{cases}
  D, & \ \text{ if $\star\in \set{B,D}$}; \\
  C^*, &\  \text{ if $\star=C^*$},
\end{cases}
\quad
\textrm{and}\quad
k := \begin{cases}
  \frac{\bfrr_{1}(\ckcO)-\bfrr_{2}(\ckcO)}{2} + 1, &\
    \text{if $\star\in \{B,D\}$}; \\
\lfloor\frac{\bfrr_{1}(\ckcO)-\bfrr_{2}(\ckcO)-1}{2}\rfloor,  & \  \text{if $\star=C^*$}.
  \end{cases}
\]
Note that $k$ is a non-negative integer, and is positive when $\star \in \set{B,D}$.

\trivial[h]{
Note that $\bfrr_{2}(\ckcO)>0$ is odd in our assumption.
}

% We have $k = \bfcc_{1}(\jmath)-\bfcc_{1}(\imath)+1$,
% $\bfcc_{1}(\jmath)-\bfcc_{1}(\imath)$,
% and $\bfcc_{1}(\imath)-\bfcc_{1}(\jmath)$
% when $\star = B,D,C^{*}$, respectively.

From the pair $(\star, \ckcO)$, we define a Young diagram $\ckcO_{\bftt}$ as follows.
\begin{itemize}
  \item If $\star \in \set{B,D}$, then $\ckcO_{\bftt}$ consists of two rows with
        lengths $2k-1$ and $1$.
  \item If $\star =C^*$, then $\ckcO_{\bftt}$ consists of one row with length
        $2k+1$.
\end{itemize}
Note that in all the three cases
 $\check \CO_{\mathbf t}$ has good parity (with respect to $\star_{\mathbf t}$), $\mathrm{PP}_{\star_{\mathbf t}}(\check \CO_{\mathbf t})=\emptyset$,  and every element in $\PBP_{\star_\bftt}(\ckcO_\bftt)$ has the form
 \begin{equation}
 \label{tail0}
  \ytb{{x_1} , {x_2} , {\enon\vdots},{\enon{\vdots}},{x_k}  } \times \emptyset \times
  D,\qquad \qquad  \ytb{{x_1} , {x_2} , {\enon\vdots},{\enon{\vdots}},{x_k}  } \times \emptyset \times
  D,\qquad\textrm{or}\qquad \emptyset \times  \ytb{{x_1} , {x_2} , {\enon\vdots},{\enon{\vdots}},{x_k}  } \times
 C^*,
\end{equation}
according to $\star=B, D$, or $C^*$, respectively. When $k=0$ (and thus $\star=C^*$), the element in $\PBP_{\star_\bftt}(\ckcO_\bftt)$ is understood to be
$\emptyset \times  \emptyset \times C^*$.


%Here $k$ can be zero if $\star = C^*$.
% Here $k=l-l'+1, l-l'$ or $l-l'$ respectively.
%\subsubsection{The case when $\star = B$}

\medskip


 When $\star\in\set{B, D, C^*}$, the tail $\uptau_\bftt\in \PBP_{\star_\bftt}(\ckcO_\bftt)$ of an element $ \uptau=(\imath,\cP)\times(\jmath,\cQ)\times \alpha \in
\mathrm{PBP}_\star(\check \CO, \wp) $ will be the painted bipartition in \eqref{tail0}, specified by the multiset $\{x_1, x_2, \cdots, x_k\}$ case by case as follows.

\medskip

{\bfseries The case when $\star = B$.} In this case,  $\mathbf c_1(\imath)\leq \mathbf c_1(\jmath)$. The multiset $\{x_1, x_2, \cdots, x_k\}$ is the
union of the multiset
\[
  \set{\cQ(j,1)| \bfcc_{1}(\imath)+1 \leq j \leq  \bfcc_{1}(\jmath) }
    % \cQ(\bfcc_{1}(\imath)+1,1),\cQ(\bfcc_{1}(\imath)+2,1),\cdots, \cQ(\bfcc_{1}(\jmath),1)}
\]
with the set
\[
  \begin{cases}
 \set{c}, &
 \qquad
  \text{if $\alpha = B^+$, and either $\bfcc_{1}(\imath)=0$ or $\cQ(\bfcc_{1}(\imath),1)\in \set{\bullet,s}$};  \\
 \set{s},&
  \qquad \text{if $\alpha = B^-$, and either $\bfcc_{1}(\imath)=0$ or $\cQ(\bfcc_{1}(\imath),1)\in \set{\bullet,s}$}; \\
%  \qquad\text{when } \alpha_\tau = B^-, \text{ and, } l'=0 \textrm{ or } \cQ_\tau(l',1)\in \set{\bullet,s},  \\
\set{\cQ(\bfcc_{1}(\imath),1)},&
\qquad
\text{otherwise.}
%\text{if $\bfcc_{1}(\imath)>0$ and $\cQ(\bfcc_{1}(\imath),1)\in \{r,d\}$.}
\end{cases}
\]

{\bfseries The case when $\star = D$.} In this case,  $\mathbf c_1(\imath)>\mathbf c_1(\jmath)$ when $|\check \CO|>0$.
The multiset $\{x_1, x_2, \cdots, x_k\}$
is the union of the multiset
\[
\set{\cP(j,1)| \bfcc_{1}(\jmath)+2 \leq j \leq \bfcc_{1}(\imath)}
\]
with the set
\[
\begin{cases}
 \set{d}, &\textrm{ if $|\check \CO|$=0};\\
    \set{c},                          &
    \ \text{if $\bfrr_2(\ckcO)=\bfrr_3(\ckcO)>0$, $\ \cP(\bfcc_1(\imath),1)\in \set{r,d}$,   and }\\   &\qquad ( \cP(\bfcc_{1}(\jmath)+1,1), \cP(\bfcc_{1}(\jmath)+1,2)) = (r,c);                                                                     \\
    \set{\cP(\bfcc_{1}(\jmath)+1,1)}, &
    \    \text{otherwise.}
  \end{cases}
\]


{\bfseries The case $\star = C^*$.}  In this case,  $\check \CO$ is quasi-distinguished,
$\wp=\emptyset$,
and $\mathbf c_1(\imath)\leq \mathbf c_1(\jmath)$.
The multiset $\{x_1, x_2, \cdots, x_k\}$
equals the multiset
\[
  \set{\cQ(j,1)| \bfcc_{1}(\imath)+1 \leq j \leq  \bfcc_{1}(\jmath) }.
    % \cQ(\bfcc_{1}(\imath)+1,1),\cQ(\bfcc_{1}(\imath)+2,1),\cdots, \cQ(\bfcc_{1}(\jmath),1)}
\]


We introduce one final notation when $\star \in \set{B,D}$:
\[
x_\uptau := \cP_{\uptau_\bftt}(k,1),
\]
which is the symbol in the last box of the tail $\uptau_\bftt$.

\trivial[h]{

 The following technical lemma is easy to check.

\begin{lem}\label{tailtip}
If $\star=B$, then
\[
\hspace{9em} x_\tau=s\Longleftrightarrow
\begin{cases}
  \alpha=B^-;\\
  \bfcc_1(\jmath)=0 \text{ or }\cQ(\bfcc_{1}(\jmath),1) \in\set{\bullet, s},
  \end{cases}
%\quad \textrm{if and only if}\quad \alpha=B^- \ \textrm{ and }\  \cQ(l,1) = s,
\]
and
\[
x_\tau=d \Longleftrightarrow
%\quad \textrm{if and only if}\quad
\cQ(\bfcc_{1}(\jmath),1) =d.
\]
If $\star=D$, then
\[
x_\tau=s\Longleftrightarrow \cP(\bfcc_{1}(\imath),1) = s,
\]
and
\[
x_\tau=d\Longleftrightarrow \cP(\bfcc_{1}(\imath),1) =d.
\]
\qed
\end{lem}
}

%Note that, when $\star\in \set{C^{*}, D^{*}}$, we will only consider the case
%when $\ckcO$ is quasi-distinguished and $\wp=\emptyset$ since $\PBPOP = \emptyset $ otherwise.

The following two propositions summarize key properties of the descent map. Both readily follow from the detailed description of the descent algorithm.

\begin{prop} \label{lem:PBPd.C}
  Suppose that  $\star\in \set{C,\wtC, D^*}$.
  %Write $\ckcO' := \ckDD(\ckcO)$ and  $\wp':=\ckDD(\wp)$.

 \noindent (a) When $\star = D^{*}$ or $\bfrr_1(\ckcO)>\bfrr_2(\ckcO)$,
    the descent map \eqref{eq:DD.CC} is bijective. %Case $D^{*}$.

\noindent (b) When $\star\in \{C,\widetilde C\}$ and $\bfrr_1(\ckcO)=\bfrr_2(\ckcO)$,
    the descent map \eqref{eq:DD.CC} is injective and its image equals
    \[
      \Set{\uptau'\in \PBPOPp |  x_{\uptau'}\neq s}.
    \]

\end{prop}
%\begin{proof}
%  This readily follows from the (explicit) definition of the descent algorithm.
%\end{proof}
Recall that $\cO = \dBV(\ckcO)$ is the Barbasch-Vogan dual of $\ckcO$.
Write
\[\ckcOpp := \ckDD^2(\ckcO):=\ckDD(\ckcO') \AND \wp'':=\ckDD^2(\wp):= \ckDD(\wp').\]
Then we have the double descent  map
\[
\DD^2:=\DD\circ \DD\, \colon\,  \PBPOP \longrightarrow
    \PBPOPpp.
\]

\begin{prop}
\label{lem:delta}
Suppose that $\star \in \set{B,D,C^*}$. % and $\bfrr_2(\ckcO)>0$.
%$\wp \subseteq  \CPPs(\ckcO)$.
% and let $\tauwppp$ be the bipartition attached to $\wp''$ with respect to $\ckcO''$.
Consider the map
\begin{equation}\label{eq:delta}
  %delta  \colon
  \PBPOP \longrightarrow
    \PBPOPpp \times \PBP_{\star_\bftt}(\ckcO_\bftt),
    \qquad \uptau \mapsto (\DD^2(\uptau),\uptau_\bftt).
\end{equation}
\begin{enumerate}[label=(\alph*),wide=2pt]
\item
Suppose that
$\star = C^*$ or $\bfrr_2(\ckcO)>\bfrr_3(\ckcO)$. Then the map \eqref{eq:delta} is bijective, and for every $\uptau\in  \PBP_\star(\ckcO) $,
    % We have the following equation of signatures.
\begin{equation*}\label{eq:sign.D}
\Sign(\uptau)
=(\bfcc_2(\cO),\bfcc_2(\cO))+\Sign(\DD^2(\uptau))+\Sign(\uptau_\bftt).
\end{equation*}

\item
Suppose that  $\star \in \set{B,D}$ and $\bfrr_2(\ckcO)=\bfrr_3(\ckcO)>0$.
Then the map \eqref{eq:delta} is injective with image %equals
\begin{equation*}\label{eq:delta.I}
    \Set{ (\uptau'',\uptau_0)  \in \PBPOPpp \times \PBP_D(\ckcO_\bftt)  |
    \begin{array}{l}
        \text{either
    $x_{\uptau''} = d$, or} \\
    \text{$x_{\uptau''}\in \set{r,c}$  and
    $\cP_{\uptau_0}^{-1}(\set{s,c})\neq \emptyset$},
    \end{array}
}
\end{equation*}
and for every $\uptau\in  \PBPOP$,
\begin{equation*}\label{eq:sign.GD}
\Sign(\uptau)
=(\bfcc_2(\cO)-1,\bfcc_2(\cO)-1)+\Sign(\DD^2(\uptau))+\Sign(\uptau_\bftt).
\end{equation*}
\end{enumerate}
\end{prop}
%\begin{proof}
  % One can deduce the inverse of $\delta$ (implemented in \cite{MU}) and signature formula via a patient analysis % The proposition can be verified
  % % by a patient analysis
  % of the descent algorithm.
 % \end{proof}



%We have the following immediate corollary.
The following corollary will be used in \cite{BMSZ2}.
\begin{cor}\label{prop:DD.BDinj}
  Suppose that $\star \in \set{B, D,C^*}$.
 Denote
  \[
    \varepsilon_{\uptau} := \begin{cases}
      0, & \text{if $\star\in \set{B,D}$ and $x_{\uptau}=d$;}\\
      1, & \text{otherwise.}
    \end{cases}
  \]
  Then the map
\begin{equation*}
  \begin{array}{rcl}
   \PBPOP&\rightarrow&
   \PBPOPp \times \BN\times \bN\times \Z/2\Z, \smallskip\\
   \uptau& \mapsto & (\DD(\uptau), p_\uptau, q_\uptau, \varepsilon_\uptau)
   \end{array}
\end{equation*}
is injective.
\end{cor}
\begin{proof}
This is easy to verify in the special  case where $\bfrr_{3}(\ckcO)=0$ and
    \[
      (\bfrr_{1}(\ckcO), \bfrr_{2}(\ckcO))
      =
      \begin{cases}
        (2k-2,0), & \text{if } \star=B;\\
        (2k-1,1), & \text{if } \star=D;\\
        (2k-1,0), & \text{if } \star=C^{*}.\\
      \end{cases}
    \]
    \trivial[h]{
    Then $\ckcO$ is the regular nilpotent orbit.
    % % in $\check \fgg$
    and $\cO =\dBV(\ckcO) = (1^{\bfrr_{1}(\ckcO)+1})_{\star}$.
    }
    In general, it follows from the injectivity of $\DD$ in \Cref{lem:PBPd.C}
    and the signature formula in \Cref{lem:delta}.
\end{proof}


\subsection{Generating functions}\label{sec: generating}

%We drop the assumption that $\mathbf r_1(\check \CO)>0$. As before $\wp\subset \mathrm{PP}_\star(\check \CO)$.

We introduce some generating functions to count painted bipartitions. %$(\ckcO,\wp)$
When $\star \in  \set{B,D, C^{*}}$, we define
\[
   f_{\star,\ckcO,\wp}(\bfpp,\bfqq) := \sum_{\uptau \in \PBPOP} \bfpp^{p_{\uptau}} \bfqq^{q_{\uptau}},
\]
where $(p_{\uptau}, q_{\uptau})$ is as in \eqref{ptqt}.
 This is an element in the polynomial ring $\bZ[\bfpp,\bfqq]$, where $\bfpp$ and $\bfqq$ are indeterminants. The coefficient of $\bfpp^{p}\bfqq^{q}$ in $f_{\star,\ckcO,\wp}(\bfpp,\bfqq)$  equals the cardinality of
 $\PBPop{G}{}{\ckcO}{\wp}$.

\trivial[h]{
Clearly $f_{\star,\ckcO,\wp}=0$, if $\star\in \set{C^*}$ and $\wp\neq \emptyset$.
}

When $\star\in \{B, D\}$, for each subset $S\subset \set{c,d,r,s}$, we also define
\[
  \PBPOP[S] := \set{\uptau\in \PBPOP|x_{\uptau}\in S}
\]
and the corresponding generating function
\[
   f_{\star,\ckcO,\wp}^{S}(\bfpp,\bfqq) := \sum_{\uptau \in \PBPOP[S]} \bfpp^{p_{\uptau}} \bfqq^{q_{\uptau}}.
\]
Note that \[
  f_{D,\yrow{0}, \emptyset}^{\set{d}} := 1, \quad
  f_{D,\yrow{0}, \emptyset}^{\set{c,r}} := 0,
  \AND
  f_{D,\yrow{0}, \emptyset}^{\set{s}} := 0.
\]
In the following we will compute
$f_{\star,\ckcO,\wp}^{\set{d}}$, $f_{\star,\ckcO,\wp}^{\set{c,r}}$ and
$f_{\star,\ckcO,\wp}^{\set{s}}$ whose sum is the desired function
$f_{\star, \ckcO,\wp}$.
% % By to ease the notation,
% \[
%   f_{\star,\ckcO,\wp} %:= f_{\star,\ckcO,\wp}^{\set{c,d,r,s}} =
%   f_{\star,\ckcO,\wp}^{\set{s}}
%   + f_{\star,\ckcO,\wp}^{\set{c,r}}
%   + f_{\star,\ckcO,\wp}^{\set{d}}
% \]
% whose coefficient of $\bfpp^{p}\bfqq^{q}$ equals the cardinality of
% $\PBPop{\SO(p,q)}{}{\ckcO}{\wp}$.
% $\PBPGOP$
% with $\Sign(G)=(p,q)$.

\def\CSk#1#2{h_{#1}^{#2}}
\def\TSk#1#2{g_{#1}^{#2}}
\def\RS{\nu}

For every integer $k$, we define
\[
\RS_{k} := \begin{cases}
    \sum_{i=0}^{k} \bfpp^{2i}\bfqq^{2(k-i)}, \quad &\textrm{if $k\geq 0$};\\
    0,\quad & \textrm{if $k<0$.}
\end{cases}
\]

It is straightforward to check the following identities: For $k\in \BN$
\[
  f_{B,\yrow{2k},\emptyset}^{S}  = \begin{cases}
      (\bfpp^{2}\bfqq+ \bfpp\bfqq^{2})\RS_{k-1}, \quad &\textrm{if $S=\set{d}$};\\
      \bfpp\RS_{k} + \bfpp^{2}\bfqq\RS_{k-1}, \quad &\textrm{if $S=\set{c,r}$};\\
       \bfqq^{2k+1}, \quad &\textrm{if $S=\set{s}$},
       \end{cases}
\]
and for $k\in \BN^+$
\[
 f_{D,\yrow{2k-1,1},\emptyset}^{S} = \begin{cases}
      \bfpp\bfqq\RS_{k-1} + \bfpp^{2}\bfqq^{2}\RS_{k-2}, \quad &\textrm{if $S=\set{d}$};\\
      (\bfpp^{2}+\bfpp\bfqq)\RS_{k-1}, \quad &\textrm{if $S=\set{c,r}$};\\
      \bfqq^{2k}, \quad &\textrm{if $S=\set{s}$}.
      \end{cases}
\]

\delete{
It is straightforward to check the following identities in the case of type $B$:
\[
  \begin{split}
   f_{B,\yrow{2k},\emptyset}^{\set{d}} & = (\bfpp^{2}\bfqq+ \bfpp\bfqq^{2})\RS_{k-1}; \\
   f_{B,\yrow{2k},\emptyset}^{\set{c,r}} & = \bfpp\RS_{k} + \bfpp^{2}\bfqq\RS_{k-1}; \\
  f_{B,\yrow{2k},\emptyset}^{\set{s}} & = \bfqq^{2k+1}.
  \end{split}
\] \trivial[h]{
  For reference, rest := count columns filled by r and s.
\[
  \begin{split}
    f_{B,\yrow{2k},\emptyset}^{\set{d}} &:=  B^{+} + rest + d \cup B^{-}+rest+d; \\
    f_{B,\yrow{2k},\emptyset}^{\set{c,r}}   &:= B^{+} + rest \cup B^{-}+rest+r;\\
    f_{B,\yrow{2k},\emptyset}^{\set{s}} & := B^{-} + ss\cdots s.\\
  \end{split}
\]
}
Likewise, we have the following identities in the case of type $D$:
\[
  \begin{split}
 f_{D,\yrow{2k-1,1},\emptyset}^{\set{d}}&= \bfpp\bfqq\RS_{k-1} + \bfpp^{2}\bfqq^{2}\RS_{k-2}; \\
f_{D,\yrow{2k-1,1},\emptyset}^{\set{c,r}}&= (\bfpp^{2}+\bfpp\bfqq)\RS_{k-1};  \\
 f_{D,\yrow{2k-1,1},\emptyset}^{\set{s}}&= \bfqq^{2k}.
  \end{split}
\]
}

\trivial[h]{
Likewise for every  $k\in \BN^+$, we have the following results in the case of type $D$:
\[
  \begin{split}
  \TSk{k}{\set{d}} &:= f_{D,\yrow{2k-1,1},\emptyset}^{\set{d}}= \bfpp\bfqq\RS_{k-1} + \bfpp^{2}\bfqq^{2}\RS_{k-2}; \\
  \TSk{k}{\set{c,r}} &:= f_{D,\yrow{2k-1,1},\emptyset}^{\set{c,r}}= (\bfpp^{2}+\bfpp\bfqq)\RS_{k-1};  \\
  \TSk{k}{\set{s}}& := f_{D,\yrow{2k-1,1},\emptyset}^{\set{s}}= \bfqq^{2k}. \\
  \end{split}
\]
}
For every $k\in \BN$, we also define
\[
  \begin{split}
    \CSk{k}{\set{d}} &:= (\bfpp^{2}\bfqq^{2} + \bfpp\bfqq^{3})\RS_{k-2}, \\
  \CSk{k}{\set{c,r}} &:= \bfpp\bfqq\RS_{k-1}+\bfpp^{2}\bfqq^{2}\RS_{k-2},\\
  \CSk{k}{\set{s}} &:= \bfqq^{2k}.\\
  \end{split}
\]


\trivial[h]{
  For reference, rest = column filled by r and s.
\[
  \begin{split}
  \TSk{k}{\set{d}} &:=  rest + d\cup rest+cd \\
  \TSk{k}{\set{c,r}} &:= rest+c \cup rest+r\\
  \TSk{k}{\set{s}}& :=\CSk{k}{\set{s}} := ss\cdots s,\\
  \CSk{k}{\set{d}} &:= rest+cd \cup s+rest + d\\
  \CSk{k}{\set{c,r}} &:= rest+c \cup s+rest+r \\
  \end{split}
\]
}





\begin{prop}\label{prop:gf.BD}
  Suppose that $\star\in\set{B,D}$ and %$\ckcO$ is a good parity partition such that
  $\bfrr_{2}(\ckcO)>0$. Let $k:=\frac{\bfrr_{1}(\ckcO)-\bfrr_{2}(\ckcO)}{2}+1$ and let $S = \set{d}, \set{c,r}$, or $ \set{s}$.

\begin{enumerate}[label=(\alph*),wide=0pt]
\item If $(2,3)\in \CPPs(\ckcO)$, then
    \[
      f_{\star,\ckcO, \wp}^{S} = (\bfpp\bfqq)^{\bfcc_{1}(\ckcO)}
      f_{D,\yrow{2k-1,1},\emptyset}^{S}
        % \TSk{k}{S}
      \cdot  f_{\star,\ckDD^{2}(\ckcO),\ckDD^{2}(\wp)}.
    \]

\item  If $(2,3)\notin \CPPs(\ckcO)$,
    then
    \[
      f_{\star,\ckcO, \wp}^{S} := (\bfpp\bfqq)^{\bfcc_{1}(\ckcO)-1} (
      f_{D,\yrow{2k-1,1},\emptyset}^{S}
      %\TSk{k}{S}
      \cdot f_{\star,\ckDD^{2}(\ckcO),\ckDD^{2}(\wp)}^{\set{d}}
      + \CSk{k}{S} \cdot f_{\star,\ckDD^{2}(\ckcO),\ckDD^{2}(\wp)}^{\set{c,r}}).
    \]
\end{enumerate}
\end{prop}
\begin{proof}
  This follows from \Cref{lem:delta}, after a routine calculation.
\end{proof}


\begin{prop}\label{prop:gf.C}
  Suppose that $\star\in\set{C,\wtC}$ and %$\ckcO$ is a good parity partition such that
  $\bfrr_{1}(\ckcO)>0$.
  % we have the following  formulas of the generating functions
  % with $S \in \set{\set{d}, \set{c,r}, \set{s}}$:
  \begin{enumerate}[label=(\alph*),wide=0pt]
    \item If $(1,2)\in \CPPs(\ckcO)$, then
    \[
      \# \PBPOP =  f_{\star',\ckDD(\ckcO), \ckDD(\wp)}(1,1).
    \]
    \item If $(1,2)\notin \CPPs(\ckcO)$,
    then
    \[
      \# \PBPOP = f_{\star',\ckDD(\ckcO), \ckDD(\wp)}^{\set{c,r}}(1,1) + f_{\star',\ckDD(\ckcO), \ckDD(\wp)}^{\set{d}}(1,1).
    \]
  \end{enumerate}

\end{prop}
\begin{proof}
  This follows from
  \Cref{lem:PBPd.C}, after a routine calculation.
\end{proof}

As a consequence of \Cref{prop:gf.BD} and \Cref{prop:gf.C},
when $\star \in \set{B,C,\wtC, D}$, the generating functions $f_{\star,\ckcO,\wp}$ are independent of $\wp$ and so
  \[
    f_{\star,\ckcO,\wp} = f_{\star,\ckcO,\emptyset}, \quad \text{for all $\wp\subseteq \CPPs(\ckcO)$.}
  \]
Consequently,
\[
    \# \PBPOP = \# \PBPop{\star}{}{\ckcO}{\emptyset}, \quad \text{for all $\wp\subseteq  \CPPs(\ckcO)$.}
\]
This proves \Cref{prop:PBP2}.
% In this section, we exhibit the inductive structure of painted bipartitions.
% The key is to define the descent of a painted bipartition.
% As before, let  $\star\in \set{B, C,  D, \wtC,  C^*, D^*}$ and let $\check \CO$ be a Young diagram that has $\star$-good parity.


The following two results are easy to check using \Cref{lem:PBPd.C} and \Cref{lem:delta}.
%we may prove similar results using \Cref{}.
%With the counting tools we have developed, all are easy to check.

%The following lemma is straight forward  to check.
\begin{prop}\label{lem:gf.C*}
  Suppose that $\star = C^{*}$. Then
  \[
      f_{\star, \ckcO,\emptyset} =
     \begin{cases}
     \nu_{\frac{\bfrr_1(\ckcO)-1}{2}}, &\quad \text{if }\bfrr_2(\ckcO) = 0;  \\
     (\bfpp\bfqq)^{\bfrr_{2}(\ckcO)+1} \RS_{k}\cdot f_{\star,\ckDD^{2}(\ckcO),\emptyset},
     & \quad \text{if } \bfrr_2(\ckcO)>0. \\
     \end{cases}
  \]
  where $k := \frac{\bfrr_{1}(\ckcO)-\bfrr_{2}(\ckcO)}{2}-1$.
%  \begin{enumerate}[label=(\alph*),wide=0pt]
%    \item For all $k\in \bN$, %The following equation holds:
%          \[
%          f_{\star, \yrow{2k-1},\emptyset} = \RS_{k}.
%          \]
%    \item Assume that           $\bfrr_{2}(\ckcO)>0$. Then $\DD^{2}(\ckcO)$ is also non-empty and the following recursive formula holds:
%          \[
%          f_{\star,\ckcO,\emptyset} = (\bfpp\bfqq)^{\bfrr_{2}(\ckcO)+1} \RS_{k}\cdot f_{\star,\DD^{2}(\ckcO),\emptyset},
%          \]
%  \end{enumerate}
\end{prop}

%We have the following consequence of the above lemma.

\begin{prop}\label{lem:gf.D*}
  Suppose that $\star = D^{*}$. Then
  \[
    \# \PBP_G(\ckcO,\emptyset) = f_{\star',\ckDD(\ckcO),\emptyset}(1,1).
  \]
  \end{prop}

The following result is clear by \Cref{lem:gf.C*} and \Cref{lem:gf.D*}.

\begin{prop}\label{prop:count.CD*}
  Suppose that $\star\in \set{C^*, D^*}$. % and $\ckcO$ is quasi-distinguished.
  Then the number of $\PBP_{G}(\ckcO)$ equals the number of $G$-orbits in
  $(\sqrt{-1}\g_0^*)\cap \CO$, where $\g_0$ denotes the Lie algebra of $G$ and $\CO:=\dBV(\ckcO)$.
\end{prop}


% \section{Combinatorics of painted bipartitions}

% \trivial[h]{
% In this section, we assume that $\star \in \{B,C,\wtC,C^{*},D,D^{*}\}$, and $\ckcO = \ckcOg$, namely $\ckcO $ has $\star$-good parity.
% Recall the set  $\CPPs(\ckcO)$ of primitive $\star$-pairs in $\ckcO$. For each subset $\wp$ of $\CPPs(\ckcO)$, we have defined a bipartition $\tau_{\wp}=(\imath_{\wp},\jmath_{\wp})$ in \Cref{sec:LCBCD}.

% \begin{prop} \label{prop:PBP} If $\star\in \set{C^{*}, D^{*}}$, then
%   \[
%     \PBP_{\star}(\tau_{\wp}) = \emptyset, \quad \text{for all nonempty subset   $\wp\subset \CPPs(\ckcO)$.}
%   \]
% \end{prop}
% \begin{proof}
% Suppose that
%   $\emptyset\neq \wp\subset \CPPs(\ckcO)$.

%    First assume that  $\star = C^{*}$. Then we have that
%   \begin{equation}\label{eq:res.C*}
%     \bfcc_{i}(\imath_{\wp}) = \half(\bfrr_{2i-1}(\ckcO)+1)>
%     \half(\bfrr_{2i}(\ckcO)-1) = \bfcc_{i}(\jmath_{\wp}),
%     \quad \textrm{ for all } \,\, (2i-1, 2i)\in \wp,
%   \end{equation}
%   Let $\uptau = (\imath_{\wp}, \cP)\times (\jmath_{\wp},\cQ)\times \star$ be an element in $\PBP_{\star}(\tau_{\wp})$. By the requirements of a painted bipartition, we have that
%   \[
%     \bfcc_{i}(\imath_{\wp}) = \sharp\set{j| \cP(i,j)=\bullet} = \sharp\set{j| \cQ(i,j)=\bullet} \leq \bfcc_{i}(\jmath_{\wp}), \quad \textrm{ for all } \,\, i=1,2,3,\cdots,
%   \]
%   which contradicts \eqref{eq:res.C*}. Hence, $\PBP_{\star}(\tau_{\wp})= \emptyset$.



%   Now we assume that $\star = D^{*}$.
%   Then we have that
%   \begin{equation}\label{eq:res.D*}
%     \bfcc_{i+1}(\imath_{\wp}) = \half(\bfrr_{2i}(\ckcO)+1)>
%     \half(\bfrr_{2i+1}(\ckcO)-1) = \bfcc_{i}(\jmath_{\wp}),
%     \quad \textrm{ for all } \,\, (2i, 2i+1)\in \wp.
%   \end{equation}
%   Let $\uptau = (\imath_{\wp}, \cP)\times (\jmath_{\wp},\cQ)\times \star$ be an element in $\PBP_{\star}(\tau_{\wp})$. By the requirements of a painted bipartition, we have that
%   \[
%     \bfcc_{i+1}(\imath_{\wp}) \leq \sharp\set{j| \cP(i,j)=\bullet} =\sharp\set{j| \cQ(i,j)=\bullet} \leq \bfcc_{i}(\jmath_{\wp}), \quad \textrm{ for all } \,\, i = 1,2,3, \cdots,
%   \]
%   which contradicts \eqref{eq:res.D*}. Hence, $\PBP_{\star}(\tau_{\wp})= \emptyset$.

% \end{proof}



% %The purpose of this section is to prove the   following combinatorial result.


% %We shall deal with the two quaternionic cases first, which are simple. When $\star \in \set{B, C, \wtC, D}$, the proof of the main statement of the above proposition involves an elaborate reduction argument (by removing elements from $\wp$ one-by-one), and will be handled separately in \Cref{lem:down} below.
% %[Proof of {\Cref{prop:PBP}} the quaternionic case]

%     \smallskip


% \begin{prop} \label{prop:PBP} Suppose that   $\star\in \set{B,C,\wtC,D}$. Then
%   \[
%     \sharp(\PBP_{\star}(\tau_{\wp})) = \sharp(\PBP_{\star}(\tau_{\emptyset})), \quad \textrm{for all } \wp \subseteq \CPPs(\ckcO).
%   \]
%  Consequently,
%   \[
%     \sharp(\tPBP_{\star}(\ckcO)) = 2^{\sharp(\CPPs(\ckcO))}\cdot \sharp(\PBP_{\star}(\ckcO)), \,\, \text{ and } \,\, \sharp(\tPBP_{\mathrm g}(\ckcO)) = 2^{\sharp(\CPPs(\ckcO))}\cdot \sharp(\PBP_{\mathrm g}(\ckcO)).
%   \]
% \end{prop}

% The rest of this section is devoted to the proof of the following lemma, which clearly implies Proposition \ref{prop:PBP}.
% }

% In this section, we assume that $\star \in \{B,C,\wtC,C^{*},D,D^{*}\}$, and $\ckcO = \ckcOg$, namely $\ckcO $ has $\star$-good parity.
% Recall the set  $\CPPs(\ckcO)$ of primitive $\star$-pairs in $\ckcO$. For each subset $\wp$ of $\CPPs(\ckcO)$, we have defined a bipartition $\tau_{\wp}=(\imath_{\wp},\jmath_{\wp})$ in \Cref{sec:LCBCD}.

% The following two combinatorial results follow by induction on $\mathbf c_1(\check \CO)$. As the proof is quite tedious, we omit the details.
% \begin{prop} \label{prop:PBP1} Suppose that $\star\in \set{C^{*}, D^{*}}$. Then
% \[
%     \PBP_{G}(\tau_{\wp}) = \emptyset, \quad \text{for all nonempty $\wp\subset \CPPs(\ckcO)$.}
%   \]
%  Consequently,
%      \[
%      \sharp(\tPBP_{G}(\ckcO)) = \sharp(\PBP_{G}(\ckcO)).
%   \]
% \end{prop}

% \begin{proof}
% Suppose that
%   $\emptyset\neq \wp\subset \CPPs(\ckcO)$, and there was an element $\uptau = (\imath_{\wp}, \cP)\times (\jmath_{\wp},\cQ)\times \star\in \PBP_{G}(\tau_{\wp})$.

%    First assume that  $\star = C^{*}$.  Pick an element $(2i-1, 2i)\in \wp$. Then we have that
%   \begin{equation}\label{eq:res.C*}
%     \bfcc_{i}(\imath_{\wp}) = \half(\bfrr_{2i-1}(\ckcO)+1)>
%     \half(\bfrr_{2i}(\ckcO)-1) = \bfcc_{i}(\jmath_{\wp}).
%       \end{equation}
%    By the requirements of a painted bipartition, we also have that
%   \begin{eqnarray*}
%     \bfcc_{i}(\imath_{\wp})& = &\sharp\set{j\in \BN^+ \mid (i,j)\in \BOX{\imath_\wp}, \, \cP(i,j)=\bullet} \\
%     &= &\sharp\set{j\in \BN^+\mid  (i,j)\in \BOX{\jmath_\wp}, \, \cQ(i,j)=\bullet} \\
%     &\leq & \bfcc_{i}(\jmath_{\wp}).
%   \end{eqnarray*}
%  This contradicts \eqref{eq:res.C*} and therefore  $\PBP_{G}(\tau_{\wp})= \emptyset$.



%   Now we assume that $\star = D^{*}$. Pick an element  $(2i, 2i+1)\in \wp$.
%   Then we have that
%   \begin{equation}\label{eq:res.D*}
%     \bfcc_{i+1}(\imath_{\wp}) = \half(\bfrr_{2i}(\ckcO)+1)>
%     \half(\bfrr_{2i+1}(\ckcO)-1) = \bfcc_{i}(\jmath_{\wp}).  \end{equation}
%       By the requirements of a painted bipartition, we also have that
%   \begin{eqnarray*}
%   \bfcc_{i+1}(\imath_{\wp})& \leq & \sharp\set{j\in \BN^+ \mid (i,j)\in \BOX{\imath_\wp}, \,  \cP(i,j)=\bullet} \\
%   &=&\sharp\set{j\in \BN^+ \mid (i,j)\in \BOX{\jmath_\wp}, \,  \cQ(i,j)=\bullet} \\
%   &\leq & \bfcc_{i}(\jmath_{\wp}).  \end{eqnarray*}
%  This contradicts \eqref{eq:res.D*} and therefore  $\PBP_{G}(\tau_{\wp})= \emptyset$.
% \end{proof}



% %The purpose of this section is to prove the   following combinatorial result.


% %We shall deal with the two quaternionic cases first, which are simple. When $\star \in \set{B, C, \wtC, D}$, the proof of the main statement of the above proposition involves an elaborate reduction argument (by removing elements from $\wp$ one-by-one), and will be handled separately in \Cref{lem:down} below.
% %[Proof of {\Cref{prop:PBP}} the quaternionic case]

%     \smallskip

% The following combinatorial result follows by induction on $\mathbf c_1(\check \CO)$. We omit the details.

% \begin{prop} \label{prop:PBP2} Suppose that   $\star\in \set{B,C,\wtC,D}$. Then
%   \[
%     \sharp(\PBP_{G}(\tau_{\wp})) = \sharp(\PBP_{G}(\tau_{\emptyset})), \quad \textrm{for all } \wp \subset \CPPs(\ckcO).
%   \]
%  Consequently,
%      \[
%      \sharp(\tPBP_{G}(\ckcO)) = 2^{\sharp(\CPPs(\ckcO))}\cdot \sharp(\PBP_{G}(\ckcO)).
%   \]
% \end{prop}


% \trivial[h]{
% The rest of this section is devoted to the proof of the following lemma, which clearly implies Proposition \ref{prop:PBP}.



% \def\PPm{\wp_{\downarrow}}
% \def\uptaum{\uptau_{\downarrow}}

% % Suppose $\star = \wtC$, $\wp\neq \emptyset$, and
% % $t:=\min{t|(2t-1,2t)\in \wp}$. Let $\PPm:=\wp - \set{(2t-1,2t)}$. Let
% % $\PPm:=\wp - \set{(2t-1,2t)}$.

% \begin{lem}\label{lem:down}
%   Suppose $\star \in \set{B, C, \wtC, D}$ and
%   $\wp$ is a non-empty subset of $\CPPs(\ckcO)$.
%   Let
%   \[
%     t:=
%     \begin{cases}
%       \min\set{i|(2i-1,2i)\in \wp}, & \text{if $\star \in \set{C,\wtC}$};\\
%       \min\set{i|(2i,2i+1)\in \wp}, & \text{if $\star \in \set{B,D}$},\\
%     \end{cases}
%   \]
%   and
%   \[
%     \PPm:=
%     \begin{cases}
%       \wp \setminus \set{(2t-1,2t)},  & \text{if $\star \in \set{C,\wtC}$};\\
%       \wp \setminus   \set{(2t,2t+1)}, & \text{if $\star \in \set{B,D}$}.\\
%     \end{cases}
%   \]
%   Then
%   \[
%     \sharp(\PBP_{\star}(\tau_{\PPm})) = \sharp(\PBP_{\star}(\tau_{\wp})).
%   \]
% \end{lem}

% \begin{proof}
%   We prove the equality by defining a bijection
%   \[
%     T_{\PPm,\wp}\colon \PBP_{\star}(\tau_{\PPm}) \rightarrow \PBP_{\star}(\tau_{\wp})\quad \uptaum \mapsto \uptau
%   \]
%   %and its inverse $T_{\wp,\PPm}$
%   explicitly case by case.
%   In the following, $\uptau = (\imath_{\wp},\cP_{\uptau})\times (\jmath_{\wp},\cQ_{\uptau})$
%   will always denote an element in $\PBP_{\star}(\tau_{\wp})$ and
%   $\uptaum = (\imath_{\PPm},\cP_{\uptaum})\times (\jmath_{\PPm},\cQ_{\uptaum})$
%   an element in $\PBP_{\star}(\tau_{\PPm})$.

%   \medskip

%   % \[
%   %   T_{\wp,\PPm}\colon \PBP_{\star}(\tau_{\wp}) \rightarrow \PBP_{\star}(\tau_{\PPm}).
%   % \]


%   %We start with the simplest case.

%   \smallskip

%   Case $\star = \wtC$:
%   %Let $(b_{1},b_{2}) = (\frac{\bfrr_{2t-1}(\ckcO)}{2},\frac{\bfrr_{2t}(\ckcO)}{2})$.
%   We have
%   \[
%     \begin{split}
%       (\bfcc_{t}(\imath_{\PPm}), \bfcc_{t}(\jmath_{\PPm}))
%       &= (\bfcc_{t}(\jmath_{\wp}), \bfcc_{t}(\imath_{\wp})),\AND\\
%       % (\bfcc_{t}(\imath_{\PPm}), \bfcc_{t}(\jmath_{\PPm}))
%       % &= (b_{1},b_{2})= (\bfcc_{t}(\jmath_{\wp}), \bfcc_{t}(\imath_{\wp})),\AND\\
%       (\bfcc_{i}(\imath_{\PPm}), \bfcc_{i}(\jmath_{\PPm}) )
%       & = (\bfcc_{i}(\imath_{\wp}), \bfcc_{i}(\jmath_{\wp}) ) \quad \text{for $i\neq t$}.
%     \end{split}
%   \]

%   For $\uptaum\in\PBPs(\tau_{\PPm})$, define $\uptau=:T_{\PPm,\wp}(\uptaum)$ by the following formula:
%   \[
%     \begin{split}
%       \text{$\textrm{ for all } (i,j)\in \BOX{\imath_{\wp}}$,} \quad   \cP_{\uptau}(i,j) &=  \cP_{\uptaum}(i,j),\\
%       \text{$\textrm{ for all } (i,j)\in \BOX{\jmath_{\wp}}$,} \quad \cQ_{\uptau}(i,j) &= \begin{cases}
%         r& \text{if $j=t$ and  $\cP_{\uptaum}(i,j)=s$,}\\
%         d& \text{if $j=t$ and  $\cP_{\uptaum}(i,j)=c$,}\\
%         \cQ_{\uptaum}(i,j) &\text{otherwise.}
%       \end{cases}
%     \end{split}
%   \]
%  We easily check that the above formula defines a valid
%   painted bipartition $\uptau$ and construct the inverse map $T_{\wp,\PPm}$ by reversing the process.
%   This finishes the proof for the case when $\star=\wtC$. \medskip

%   \trivial[h]{The inverse map
%   \[
%     T_{\wp,\PPm}\colon \PBP_{\star}(\tau_{\wp}) \rightarrow \PBP_{\star}(\tau_{\PPm}).
%   \]
%   is given by the following formula:
%   \[
%     \begin{split}
%       \text{$\textrm{ for all } (i,j)\in \BOX{\imath_{\PPm}}$,} \quad \cP_{\uptaum}(i,j) &= \begin{cases}
%         s& \text{if $j=t$ and  $\cQ_{\uptau}(i,j)=r$,}\\
%         c& \text{if $j=t$ and  $\cQ_{\uptau}(i,j)=d$,}\\
%         \cP_{\uptau}(i,j) &\text{otherwise.}
%       \end{cases}\\
%       \text{$\textrm{ for all } (i,j)\in \BOX{\jmath_{\PPm}}$,} \quad   \cQ_{\uptaum}(i,j) &=  \cQ_{\uptau}(i,j).\\
%     \end{split}
%   \]
%   }
%   % We leave it to the reader to check that the above formula does define a valid
%   % painted bipartition $\uptaum$. Retain the above notation, it is easy to check that the
%   % inverse map
%   % \[
%   %   T_{\PPm,\wp}\colon \PBP_{\star}(\tau_{\PPm}) \rightarrow \PBP_{\star}(\tau_{\wp})\quad \uptaum \mapsto \uptau
%   % \]
%   % is given by the following formula:
%   % \[
%   %   \begin{split}
%   %     \text{$\textrm{ for all } (i,j)\in \BOX{\imath_{\wp}}$,} \quad   \cP_{\uptau}(i,j) &=  \cP_{\uptaum}(i,j),\\
%   %     \text{$\textrm{ for all } (i,j)\in \BOX{\jmath_{\wp}}$,} \quad \cQ_{\uptau}(i,j) &= \begin{cases}
%   %       r& \text{if $j=t$ and  $\cP_{\uptaum}(i,j)=s$,}\\
%   %       d& \text{if $j=t$ and  $\cP_{\uptaum}(i,j)=c$,}\\
%   %       \cQ_{\uptaum}(i,j) &\text{otherwise.}
%   %     \end{cases}
%   %   \end{split}
%   % \]

%   \medskip

%   Case $\star = C$:
%   % Let
%   % $(b_{1},b_{2}) = (\frac{\bfrr_{2t-1}(\ckcO)-1}{2},\frac{\bfrr_{2t}(\ckcO)+1}{2})$.
%   We have
%   \[
%     \begin{split}
%       (\bfcc_{t}(\imath_{\PPm}), \bfcc_{t}(\jmath_{\PPm})) &=
%       (\bfcc_{t}(\jmath_{\wp})+1, \bfcc_{t}(\imath_{\wp})-1) \AND \\
%      %  &= (b_{2},b_{1}),  \\
%      % &= (b_{1}-1,b_{2}+1),\AND\\
%       % (\bfcc_{t}(\imath_{\PPm}), \bfcc_{t}(\jmath_{\PPm})) &= (b_{2},b_{1}),  \\
%       % (\bfcc_{t}(\imath_{\wp}), \bfcc_{t}(\jmath_{\wp})) &= (b_{1}-1,b_{2}+1),\AND\\
%       (\bfcc_{i}(\imath_{\PPm}),\bfcc_{i}(\jmath_{\PPm})) &=(\bfcc_{i}(\imath_{\wp}),\bfcc_{i}(\jmath_{\wp}))\quad \text{for $i\neq t$}.
%     \end{split}
%   \]
%   % Let
%   % $a = \half(\bfrr_{2t-1}(\ckcO)-\bfrr_{2t}(\ckcO))-1 = \bfcc_{t}(\jmath_{\PPm})-\bfcc_{t}(\imath_{\PPm})$.

%   \trivial[h]{
%     The idea of the definition of $T_{\PPm,\wp}$ is that we move ``$s$'' appeared
%     in the $t$-th column of $\cQ_{\uptaum}$ to the $t$-th column of
%     $\cP_{\uptau}$.
%   }

%   For $\uptaum\in \PBPs(\tau_{\PPm})$, we define $\uptau$ by the following algorithm:
%   \begin{description}
%     \item[STEP~1] Define a map
%           $\cP'\colon \BOX{\imath_{\wp}}\rightarrow \set{\bullet,r,c,d}$ (as a candidate for $\cP_{\uptau}$), by the following rules:
%           \begin{enumerate}[label=(\alph*)]
%             \item Suppose
%             $\cP_{\uptaum}(\bfcc_{t}(\imath_{\PPm}),t)\neq \bullet$.
%             \begin{itemize}
%               \item If $\bfcc_{t}(\imath_{\PPm})\geq 2$ and
%               $\cP_{\uptaum}(\bfcc_{t}(\imath_{\PPm})-1,t) = c$,
%               we define
%               \[
%                 \cP'(i,j) := \begin{cases}
%                   r ,& \text{if $j=t$ and $\bfcc_{t}(\imath_{\PPm})-1
%                     \leq i \leq \bfcc_{t}(\imath_{\wp})-2$},\\
%                   c ,& \text{if $(i,j)=(\bfcc_{t}(\imath_{\wp})-1,t)$},\\
%                   d ,& \text{if $(i,j)=(\bfcc_{t}(\imath_{\wp}),t)$},\\
%                   \cP_{\uptaum}(i,j) ,&\text{otherwise}.
%                 \end{cases}
%               \]
%               \item Otherwise, we define
%               \[
%                 \cP'(i,j) := \begin{cases}
%                   r ,& \text{if $j=t$ and $\bfcc_{t}(\imath_{\PPm})
%                     \leq i \leq \bfcc_{t}(\imath_{\wp})-1$},\\
%                   \cP_{\uptaum}(\bfcc_{t}(\imath_{\PPm}),t) ,&
%                   \text{if $(i,j)=(\bfcc_{t}(\imath_{\wp}),t)$},\\
%                   \cP_{\uptaum}(i,j) ,&\text{otherwise}.
%                 \end{cases}
%               \]
%             \end{itemize}
%             \item Suppose $\cP_{\uptaum}(\bfcc_{t}(\imath_{\PPm}),t)=\bullet$.
%             \begin{itemize}
%               \item If $\bfcc_{t+1}(\imath_{\PPm}) = \bfcc_{t}(\imath_{\PPm})$
%               and
%               $\cP_{\uptaum}(\bfcc_{t}(\imath_{\PPm}),t+1) = r$,
%               we define
%               \[
%                 \cP'(i,j) := \begin{cases}
%                   r ,& \text{if $j=t$ and $\bfcc_{t}(\imath_{\PPm})\leq i \leq \bfcc_{t}(\imath_{\wp})-1$},\\
%                   c ,& \text{if $(i,j)=(\bfcc_{t+1}(\imath_{\PPm}),t+1)$},\\
%                   d ,& \text{if $(i,j)=(\bfcc_{t}(\imath_{\wp}),t)$},\\
%                   \cP_{\uptaum}(i,j) ,&\text{otherwise}.
%                 \end{cases}
%               \]
%               \item Otherwise, we define
%               \[
%                 \cP'(i,j) := \begin{cases}
%                   r ,& \text{if $j=t$ and $\bfcc_{t}(\imath_{\PPm})\leq i \leq \bfcc_{t}(\imath_{\wp})-2$},\\
%                   c ,& \text{if $(i,j)=(\bfcc_{t}(\imath_{\wp})-1,t)$},\\
%                   d ,& \text{if $(i,j)=(\bfcc_{t}(\imath_{\wp}),t)$},\\
%                   \cP_{\uptaum}(i,j) ,&\text{otherwise}.
%                 \end{cases}
%               \]
%             \end{itemize}
%           \end{enumerate}

%     \item[STEP 2] From the construction of $\cP'$, there are four possibilities for $\cP'$ to violate the requirements of a painting on $\imath_{\wp}$, which are detailed as follows. We must have $t>1$ and violations occur in positions of $(i,j)\in \BOX{\imath_{\wp}}$ inside the following $2\times 2$ square
%          \[
%           A :=
%           \begin{pmatrix}
%             (\bfcc_{t}(\imath_{\wp})-1,t-1) & (\bfcc_{t}(\imath_{\wp})-1,t) \\
%             (\bfcc_{t}(\imath_{\wp})\;\phantom{-1}\;,t-1) & (\bfcc_{t}(\imath_{\wp})\;\phantom{-1}\;,t) \\
%           \end{pmatrix}
%           \]

%           %\[
%           %A :=
%           %\begin{pmatrix}
%           %  \cP'(\bfcc_{t}(\imath_{\wp})-1,t-1) & \cP'(\bfcc_{t}(\imath_{\wp})-1,t) \\
%           %  \cP'(\bfcc_{t}(\imath_{\wp})\;\phantom{-1}\;,t-1) & \cP'(\bfcc_{t}(\imath_{\wp})\;\phantom{-1}\;,t) \\
%           %\end{pmatrix}
%           %\]
%           \trivial[h]{
%           Note that  $\cP'(\bfcc_{t}(\imath_{\wp})-1,t-1)$ is always equal to
%           $\bullet$.
%           }

%     Let $\cP_{\uptau}\colon \BOX{\imath_{\wp}}\rightarrow \set{\bullet,r,c,d}$
%           be the painting on $\imath_{\wp}$ defined as follows:
%           \begin{itemize}
%             \item When $(i,j)\in \BOX{\imath_{\wp}}$ and
%             $\set{i-\bfcc_{t}(\imath_{\wp})+1, j-t+1}\nsubseteq \set{0,1}$
%             (i.e. $(i,j)$ is not one of the four boxes corresponding to
%             $A$), we define
%             \[
%               \cP_{\uptau}(i,j):= \cP'(i,j).
%             \]

%             \item For the four boxes corresponding to $A$, we modify the symbols by
%             setting
%             \begin{equation} \label{eq:modP}
%               \begin{split}
%               %  &\begin{pmatrix}
%               %    \cP_{\uptau}(\bfcc_{t}(\imath_{\wp})-1,t-1) & \cP_{\uptau}(\bfcc_{t}(\imath_{\wp})-1,t) \\
%               %   \cP_{\uptau}(\bfcc_{t}(\imath_{\wp})\;\phantom{-1}\;,t-1)
%               %    & \cP_{\uptau}(\bfcc_{t}(\imath_{\wp})\;\phantom{-1}\;,t) \\
%               % \end{pmatrix}\\
%               \cP_{\uptau}|_A  :=&
%                 \begin{cases}
%                   \begin{pmatrix}
%                     r & c\\
%                     r & d
%                   \end{pmatrix}, & \text{if } \cP'|_A =
%                   \begin{pmatrix}
%                     \bullet & r\\
%                     r & r
%                   \end{pmatrix},\\[1.5em]
%                   \begin{pmatrix}
%                     r & c\\
%                     c & d
%                   \end{pmatrix}, & \text{if } \cP'|_A =
%                   \begin{pmatrix}
%                     \bullet & r\\
%                     c & r
%                   \end{pmatrix},\\[1.5em]
%                   \begin{pmatrix}
%                     r & c\\
%                     d & d
%                   \end{pmatrix}, & \text{if } \cP'|_A =
%                   \begin{pmatrix}
%                     \bullet & r\\
%                     d & r
%                   \end{pmatrix},\\[1.5em]
%                   \begin{pmatrix}
%                     c & c\\
%                     d & d
%                   \end{pmatrix}, & \text{if } \cP'|_A =
%                   \begin{pmatrix}
%                     \bullet & r\\
%                     d & c
%                   \end{pmatrix}.\\
%                 \end{cases}
%               \end{split}
%             \end{equation}
%           \end{itemize}

%     \item[STEP 3] The painted bipartition $\uptau$ is uniquely determined by
%           $\cP_{\uptau}$. More precisely, $\cQ_{\uptau}$ is given by the following
%           formula: for $(i,j)\in \BOX{\jmath_{\wp}}$,
%           \[
%           \cQ_{\uptau}(i,j) :=
%           \begin{cases}
%             s, & \begin{minipage}{17em}if $\cP'$ is not a valid painting on $\imath_{\wp}$\\
%               and $(i,j)= (\bfcc_{t}(\imath_{\wp})-1,t-1)$,
%               \end{minipage}\\
%             \cQ_{\uptaum}(i,j), & \text{otherwise.}
%             \end{cases}
%           \]
%   \end{description}

%  It is not difficult to check that $\uptau$ is a valid painted bipartition
%  and to construct the inverse map $T_{\wp,\PPm}$ by reversing the above steps.

%  \trivial[h]{
%    The inverse map $T_{\wp,\PPm}$ is given by the following algorithm:
%    \begin{description}
%      \item[STEP 1] We first recover $\cP'$.
%            If $t=1$ or $\cP'(\bfcc_{t}(\imath_{\wp})-1,t-1)=\bullet$, then
%            $\cP':= \cP_{\wp}$.
%            Otherwise,
%            $\cP'$ is given by $\cP_{\wp}$ except the $2\times 2$ square in
%            \eqref{eq:modP} which is given by reversing the formula cited.
%      \item[STEP 2]

%            \def\xxn{\cP_{\uptaum}(\bfcc_t(\imath_{\PPm})-1,t)} %x_0
%            \def\xxo{\cP_{\uptaum}(\bfcc_t(\imath_{\wp}),t)} %x_1
%            \def\xxd{\cP_{\uptaum}(\bfcc_t(\imath_{\wp}),t+1)} %x_2
%            \def\yyn{\cP'(\bfcc_t(\imath_{\PPm})-1,t)} %y_0
%            \def\yyo{\cP'(\bfcc_t(\imath_{\wp})-1,t)} %y_1
%            \def\yyt{\cP'(\bfcc_t(\imath_{\wp}),t)} %y_3
%            \def\yyd{\cP'(\bfcc_t(\imath_{\wp}),t+1)} %y_2
%            We have the following cases:
%            \begin{enumerate}[label=(\alph*)]
%              \item Suppose $\yyo=r$.
%              \begin{itemize}
%                \item If $\bfcc_{t+1}(\imath_{\wp}) = \bfcc_{t}(\imath_{\PPm})$
%                and
%                \[
%                  (\yyd,\yyt) = (c,d),
%                \]
%                let
%                \[
%                  (\xxo,\xxd):=(\bullet, r)
%                \]
%                \item Otherwise, let \[
%                  \xxo:=\yyt.
%                \]
%              \end{itemize}
%              \item Suppose $\yyo=c$
%              \begin{itemize}
%                \item If $\bfcc_{t}(\imath_{\PPm})\geq 2$ and $\xxn=r$,
%                then let
%                \[
%                  (\xxn,\xxo):=(c,d).
%                \]
%                \item Otherwise, let
%                \[
%                  \xxo :=\bullet.
%                \]
%              \end{itemize}
%            \end{enumerate}
%            For the boxes $(i,j)$ in $\BOX{\imath_{\uptaum}}$ which are not specified
%            in the above procedure, set
%            \[
%            \cP_{\uptaum}(i,j):=\cP'(i,j).
%            \]
%      \item[STEP 3]
%            Now $\cP_{\uptaum}$ uniquely determine the painted bipartition
%            $\uptaum$.
%    \end{description}
%    The construction of the inverse map implies that $T_{\PPm,\wp}$ is a
%    bijection.
%  }

%   \def\ckcOa{\ckcO^{\uparrow}}
%   \def\PPa{\wp^{\uparrow}}
%   \def\PPam{\wp^{\uparrow}_{\downarrow}}
%   \def\uptaua{\uptau^{\uparrow}}
%   \def\tauPPa{\tau_{\PPa}}
%   \def\tauPPam{\tau_{\PPam}}
%   \def\stara{\star^{\uparrow}}

%   \medskip

%   {Now suppose $\star \in \set{B,D}$.}
%   We will prove the lemma by appealing to the corresponding assertion for the case of $\wtC/C$.
%   Let
%   \[
%     \stara := \begin{cases}
%       \wtC ,& \text{when $\star=B$},\\
%       C ,& \text{when $\star=D$},
%     \end{cases}
%   \]
%   and $\ckcOa$ be the partition defined by
%   \[
%     \bfrr_{1}(\ckcOa) = \bfrr_{1}(\ckcO)+2, \AND \bfrr_{i+1}(\ckcOa)
%     = \bfrr_{i}(\ckcO)\quad \text{for all $i=1,2,3,\cdots,$}.
%   \]
%   Clearly
%   \[
%     \CPP_{\stara }(\ckcOa) = \set{(1,2)}\cup \set{(i+1,i+2)|(i,i+1)\in \CPP_{\star}(\ckcO)}.
%   \]




%   % Let $\PPa$ denote the subset in
%   % $\CPP(\ckcOa)$ defined by
%   % \[
%   %   \PPa:=\set{(i+1,i+2)|(i,i+1)\in \sP}.
%   % \]
%   % Let $r_{0}:= \half \bfrr_{1}(\ckcO)+1 = \bfcc_{1}(\imath_{\PPa})$. For $x=c$
%   % or $s$, define
%   % \[
%   %   \PBP_{\wtC}^{x}(\tauPPa):= \Set{\uptaua\in \PBP_{\wtC}(\tau_{\PPa})|\cP_{\uptaua}\left(r_{0},1\right)=x}
%   % \]
%   % where $\tauPPa$ is the bipartition defined with respect to $\ckcOa$.

%   % Let $\PPam:=(\PPa)_{\downarrow}$. It is easy to check that
%   % \begin{itemize}
%   %   \item
%   %   $\PBP_{\wtC}(\tauPPa) = \PBP_{\wtC}^{c}(\tauPPa)\sqcup \PBP_{\wtC}^{s}(\tauPPa)$,
%   %   \item the map $T_{\PPa,\PPam}$ restricted into a bijection from
%   %   $\PBP_{\wtC}^{x}(\tauPPa)$ onto $\PBP_{\wtC}^{x}(\tauPPam)$ (here $x=s$ or
%   %   $c$), and
%   %   \item the descent map restricted to bijections
%   %   \[
%   %     \text{
%   %         $\PBP_{\wtC}^{s}(\tau_{\PPa})\longrightarrow \PBP_{B^{+}}(\tau_{\sP})$
%   %         and
%   %         $\PBP_{\wtC}^{c}(\tau_{\PPa})\longrightarrow \PBP_{B^{-}}(\tau_{\sP})$.
%   %     }
%   %   \]
%   % \end{itemize}

%   % Now the bijection $T_{\wp,\wpm}$ is defined by making the following diagram
%   % commutative
%   % \[
%   %   \begin{tikzcd}
%   %     \PBP_{\wtC}^{s}(\tau_{\PPa}) \ar[r] \ar[d] & \PBP_{B^{+}}^{s}(\tau_{\wp}) \ar[d]\\
%   %     \PBP_{\wtC}^{s}(\tau_{\PPam}) \ar[r] & \PBP_{B^{+}}^{s}(\tau_{\PPm}) \\
%   %   \end{tikzcd}
%   % \]

%  % For each subset $\sP\subset \CPP(\ckcO)$,
%   Let $\PPa$ denote the subset in
%   $\CPP_{\stara }(\ckcOa)$ defined by
%   \[
%     \PPa:=\set{(i+1,i+2)|(i,i+1)\in \sP}.
%   \]
%   % Let $r_{0}:= \half \bfrr_{1}(\ckcO)+1 = \bfcc_{1}(\imath_{\PPa})$.
%   % For $x=c$
%   % or $s$, define
%   % \[
%   %   \PBP_{\wtC}^{x}(\tauPPa):= \Set{\uptaua\in \PBP_{\wtC}(\tau_{\PPa})|\cP_{\uptaua}\left(r_{0},1\right)=x}
%   % \]
%   % where $\tauPPa$ is the bipartition defined with respect to $\ckcOa$.

% Let $\PPam:=(\PPa)_{\downarrow}$. Recall from \cite[Section 2.3]{BMSZ2} the (naive) descent map $\DD$ of painted bipartitions.
% It is easy to check that the descent maps (horizontal arrows) in the following diagram are bijections.
%  %(c.f. \cite{BMSZ1}*{Lemma???}). % restricted to bijections
%  % \[
%  %   \PBP_{\wtC}(\tau_{\PPa})\longrightarrow \PBP_{B}(\tau_{\sP}).
%  % \]
%   \[
%     \begin{tikzcd}
%       \PBP_{\wtC}(\tau_{\PPam}) \ar[r,"\DD",two heads,hook] \ar[d,two heads,hook,"T_{\PPam,\PPa}"']
%       & \PBP_{B}(\tau_{\PPm}) \ar[d,dashed,"T_{\PPm,\wp}"]\\
%       \PBP_{\wtC}(\tau_{\PPa}) \ar[r,"\DD",two heads,hook] & \PBP_{B}(\tau_{\wp}) \\
%     \end{tikzcd}
%   \]
%  Since there is a bijection $T_{\PPam,\PPa}$ in the left vertical arrow by case $\wtC$, we may define a bijection $T_{\PPm,\wp}$ in the right vertical arrow by making the above diagram commutative.
%  This completes the proof for the case $B$. The case $D$ is entirely similar.
% \end{proof}


% }

\appendix


\begin{bibdiv}
  \begin{biblist}
% \bib{AB}{article}{
%   title={Genuine representations of the metaplectic group},
%   author={Adams, Jeffrey},
%   author = {Barbasch, Dan},
%   journal={Compositio Mathematica},
%   volume={113},
%   number={01},
%   pages={23--66},
%   year={1998},
% }

% \bib{Ad83}{article}{
%   author = {Adams, J.},
%   title = {Discrete spectrum of the reductive dual pair $(O(p,q),Sp(2m))$ },
%   journal = {Invent. Math.},
%   number = {3},
%  pages = {449--475},
%  volume = {74},
%  year = {1983}
% }

%\bib{Ad07}{article}{
%  author = {Adams, J.},
%  title = {The theta correspondence over R},
%  journal = {Harmonic analysis, group representations, automorphic forms and invariant theory,  Lect. Notes Ser. Inst. Math. Sci. Natl. Univ. Singap., 12},
% pages = {1--39},
% year = {2007}
% publisher={World Sci. Publ.}
%}


\bib{ABV}{book}{
  title={The Langlands classification and irreducible characters for real reductive groups},
  author={Adams, J.},
  author={Barbasch, D.},
  author={Vogan, D. A.},
  series={Progress in Math.},
  volume={104},
  year={1991},
  publisher={Birkhauser}
}

\bib{AC}{article}{
  title={Algorithms for representation theory of
    real reductive groups},
  volume={8},
  DOI={10.1017/S1474748008000352},
  number={2},
  journal={J. Institute Math. Jussieu},
  publisher={Cambridge University Press},
  author={Adams, J.},
  author={du Cloux, F.},
  year={2009},
  pages={209--259}
}

\bib{ArPro}{article}{
author = {Arthur, J.},
title = {On some problems suggested by the trace formula},
bookTitle = {Lie group representations, II (College Park, Md.), Lecture Notes in Math., vol. 1041},
pages = {1--49},
year = {1984}
}


\bib{ArUni}{article}{
author = {Arthur, J.},
title = {Unipotent automorphic representations: conjectures},
journal = {Orbites unipotentes et repr\'esentations, II, Ast\'erisque},
pages = {13--71},
volume = {171-172},
year = {1989}
}

% \bib{AK}{article}{
%   author = {Auslander, L.},
%   author = {Kostant, B.},
%   title = {Polarizations and unitary representations of solvable Lie groups},
%   journal = {Invent. Math.},
%  pages = {255--354},
%  volume = {14},
%  year = {1971}
% }


% \bib{B.Uni}{article}{
%   author = {Barbasch, D.},
%   title = {Unipotent representations for real reductive groups},
%  %booktitle = {Proceedings of ICM, Kyoto 1990},
%  journal = {Proceedings of ICM (1990), Kyoto},
%    % series = {Proc. Sympos. Pure Math.},
%  %   volume = {68},
%      pages = {769--777},
%  publisher = {Springer-Verlag, The Mathematical Society of Japan},
%       year = {2000},
% }


\bib{B89}{article}{
  author = {Barbasch, D.},
  title = {The unitary dual for complex classical Lie groups},
  journal = {Invent. Math.},
  volume = {96},
  number = {1},
 pages = {103--176},
 year = {1989}
}

\bib{B.Orbit}{article}{
  author = {Barbasch, D.},
  title = {Orbital integrals of nilpotent orbits},
 %booktitle = {The mathematical legacy of {H}arish-{C}handra ({B}altimore,{MD}, 1998)},
    journal = {The mathematical legacy of {H}arish-{C}handra, Proc. Sympos. Pure Math.},
    %series={The mathematical legacy of {H}arish-{C}handra, Proc. Sympos. Pure Math},
    volume = {68},
     pages = {97--110},
 publisher = {Amer. Math. Soc., Providence, RI},
      year = {2000},
}


\bib{B10}{article}{
  author = {Barbasch, D.},
  title = {The unitary spherical spectrum for split classical groups},
  journal = {J. Inst. Math. Jussieu},
% number = {9},
 pages = {265--356},
 volume = {9},
 year = {2010}
}



\bib{B17}{article}{
  author = {Barbasch, D.},
  title = {Unipotent representations and the dual pair correspondence},
  bookTitle = {J. Cogdell et al. (eds.), Representation Theory, Number Theory, and Invariant Theory, In Honor of Roger Howe. Progress in Math., vol. 323},
  %series ={Progress in Math.},
  pages = {47--85},
  year = {2017},
}


\bib{Bo}{article}{
   author={Bo\v{z}i\v{c}evi\'{c}, M.},
   title={Double cells for unitary groups},
   journal={J. Algebra},
   volume={254},
   date={2002},
   number={1},
   pages={115--124},
   issn={0021-8693},
 %  review={\MR{1927434}},
   doi={10.1016/S0021-8693(02)00070-4},
}



\bib{BMSZ1}{article}{
      title={On the notion of metaplectic Barbasch-Vogan duality},
      year={2020},
      author={Barbasch, D.},
      author = {Ma, J.-J.},
      author = {Sun, B.},
      author = {Zhu, C.-B.},
      eprint={2010.16089},
      archivePrefix={arXiv},
      primaryClass={math.RT}
}

\bib{BMSZ2}{article}{
      title={Special unipotent representations of real classical groups: construction and unitarity},
      author={Barbasch, D.},
      author = {Ma, J.-J.},
      author = {Sun, B.},
      author = {Zhu, C.-B.},
      year={2021},
      eprint={arXiv:1712.05552},
      archivePrefix={arXiv},
      primaryClass={math.RT}
}



\bib{BV1}{article}{
   author={Barbasch, D.},
   author={Vogan, D. A.},
   title={Primitive ideals and orbital integrals in complex classical
   groups},
   journal={Math. Ann.},
   volume={259},
   date={1982},
   number={2},
   pages={153--199},
   issn={0025-5831},
 %  review={\MR{656661}},
   doi={10.1007/BF01457308},
}

\bib{BV2}{article}{
   author={Barbasch, D.},
   author={Vogan, D. A.},
   title={Primitive ideals and orbital integrals in complex exceptional
   groups},
   journal={J. Algebra},
   volume={80},
   date={1983},
   number={2},
   pages={350--382},
   issn={0021-8693},
 %  review={\MR{691809}},
   doi={10.1016/0021-8693(83)90006-6},
}

\bib{BV.W}{article}{
  author={Barbasch, D.},
  author={Vogan, D. A.},
  editor={Trombi, P. C.},
  title={Weyl Group Representations and Nilpotent Orbits},
  bookTitle={Representation Theory of Reductive Groups:
    Proceedings of the University of Utah Conference 1982},
  year={1983},
  publisher={Birkh{\"a}user Boston},
  address={Boston, MA},
  pages={21--33},
  %doi={10.1007/978-1-4684-6730-7_2},
}


\bib{BVUni}{article}{
 author = {Barbasch, D.},
 author = {Vogan, D. A.},
 journal = {Annals of Math.},
 number = {1},
 pages = {41--110},
 title = {Unipotent representations of complex semisimple groups},
 volume = {121},
 year = {1985}
}

% \bib{BB}{article}{
%    author={Beilinson, Alexandre},
%    author={Bernstein, Joseph},
%    title={Localisation de $\mathfrak g$-modules},
%    language={French, with English summary},
%    journal={C. R. Acad. Sci. Paris S\'{e}r. I Math.},
%    volume={292},
%    date={1981},
%    number={1},
%    pages={15--18},
%    issn={0249-6291},
%    review={\MR{610137}},
% }

\bib{BGG.M}{article}{
   author={Bernstein, I. N.},
   author={Gel'fand, I. M.},
   author={Gel'fand, S. I.},
   title={Models of representations of compact Lie groups},
   language={Russian},
   journal={Funkcional. Anal. i Prilo\v{z}en.},
   volume={9},
   date={1975},
   number={4},
   pages={61--62},
   %issn={0374-1990},
   %review={\MR{0414792}},
}

\bib{Bor}{article}{
 author = {Borho, W.},
 journal = {S\'eminaire Bourbaki, Exp. No. 489},
 pages = {1--18},
 title = {Recent advances in enveloping algebras of semisimple Lie-algebras},
 year = {1976/77}
}

\bib{BK}{article}{
author={Borho, W.},
author={Kraft, H.},
title={\"{U}ber die Gelfand-Kirillov-Dimension},
journal={Math. Ann.},
volume={220},
date={1976},
number={1},
pages={1--24},
issn={0025-5831},
% review={\MR{412240}},
doi={10.1007/BF01354525},
}


\bib{BM}{article}{
   author={Borho, W.},
   author={MacPherson, R.},
   title={Repr\'{e}sentations des groupes de Weyl et homologie d'intersection
   pour les vari\'{e}t\'{e}s nilpotentes},
   language={French, with English summary},
   journal={C. R. Acad. Sci. Paris S\'{e}r. I Math.},
   volume={292},
   date={1981},
   number={15},
   pages={707--710},
   issn={0249-6291},
  % review={\MR{618892}},
}

% \bib{Br}{article}{
%   author = {Brylinski, R.},
%   title = {Dixmier algebras for classical complex nilpotent orbits via Kraft-Procesi models. I},
%   journal = {The orbit method in geometry and physics (Marseille, 2000). Progress in Math.}
%   volume = {213},
%   pages = {49--67},
%   year = {2003},
% }

%\bib{BK}{article}{
%   author={Brylinski, J.-L.},
%   author={Kashiwara, M.},
%   title={Kazhdan-Lusztig conjecture and holonomic systems},
%  journal={Invent. Math.},
%   volume={64},
%   date={1981},
%   number={3},
%   pages={387--410},
%   issn={0020-9910},
%   review={\MR{632980}},
%   doi={10.1007/BF01389272},
%}

\bib{Carter}{book}{
   author={Carter, R. W.},
   title={Finite groups of Lie type},
   series={Wiley Classics Library},
   %note={Conjugacy classes and complex characters;
   %Reprint of the 1985 original;
   %A Wiley-Interscience Publication},
   publisher={John Wiley \& Sons, Ltd., Chichester},
   date={1993},
   pages={xii+544},
   isbn={0-471-94109-3},
   %review={\MR{1266626}},
}

\bib{Cas}{article}{
   author={Casian, L. G.},
   title={Primitive ideals and representations},
   journal={J. Algebra},
   volume={101},
   date={1986},
   number={2},
   pages={497--515},
   issn={0021-8693},
  % review={\MR{847174}},
   doi={10.1016/0021-8693(86)90208-5},
}

% \bib{Ca89}{article}{
%  author = {Casselman, W.},
%  journal = {Canad. J. Math.},
%  pages = {385--438},
%  title = {Canonical extensions of Harish-Chandra modules to representations of $G$},
%  volume = {41},
%  year = {1989}
% }



% \bib{Cl}{article}{
%   author = {Du Cloux, F.},
%   journal = {Ann. Sci. \'Ecole Norm. Sup.},
%   number = {3},
%   pages = {257--318},
%   title = {Sur les repr\'esentations diff\'erentiables des groupes de Lie alg\'ebriques},
%   url = {http://eudml.org/doc/82297},
%   volume = {24},
%   year = {1991},
% }

\bib{CM}{book}{
  title = {Nilpotent orbits in semisimple Lie algebra: an introduction},
  author = {Collingwood, D. H.},
  author = {McGovern, W. M.},
  year = {1993},
  publisher = {Van Nostrand Reinhold Co.},
}


% \bib{Dieu}{book}{
%    title={La g\'{e}om\'{e}trie des groupes classiques},
%    author={Dieudonn\'{e}, Jean},
%    year={1963},
% 	publisher={Springer},
%  }

% \bib{DKPC}{article}{
% title = {Nilpotent orbits and complex dual pairs},
% journal = {J. Algebra},
% volume = {190},
% number = {2},
% pages = {518 - 539},
% year = {1997},
% author = {Daszkiewicz, A.},
% author = {Kra\'skiewicz, W.},
% author = {Przebinda, T.},
% }

% \bib{DKP2}{article}{
%   author = {Daszkiewicz, A.},
%   author = {Kra\'skiewicz, W.},
%   author = {Przebinda, T.},
%   title = {Dual pairs and Kostant-Sekiguchi correspondence. II. Classification
% 	of nilpotent elements},
%   journal = {Central European J. Math.},
%   year = {2005},
%   volume = {3},
%   pages = {430--474},
% }


%\bib{DM}{article}{
%  author = {Dixmier, J.},
% author = {Malliavin, P.},
%  title = {Factorisations de fonctions et de vecteurs ind\'efiniment diff\'erentiables},
%  journal = {Bull. Sci. Math. (2)},
%  year = {1978},
%  volume = {102},
%  pages = {307--330},
%}

%\bibitem[DM]{DM}
%J. Dixmier and P. Malliavin, \textit{Factorisations de fonctions et de vecteurs ind\'efiniment diff\'erentiables}, Bull. Sci. Math. (2), 102 (4),  307-330 (1978).



\bib{Du77}{article}{
  author = {Duflo, M.},
  journal = {Annals of Math.},
  number = {1},
  pages = {107-120},
  title = {Sur la Classification des Ideaux Primitifs Dans
    L'algebre Enveloppante d'une Algebre de Lie Semi-Simple},
  volume = {105},
  year = {1977}
}

% \bib{Du82}{article}{
%  author = {Duflo, M.},
%  journal = {Acta Math.},
%   volume = {149},
%  number = {3-4},
%  pages = {153--213},
%  title = {Th\'eorie de Mackey pour les groupes de Lie alg\'ebriques},
%  year = {1982}
% }



% \bib{GZ}{article}{
% author={Gomez, R.},
% author={Zhu, C.-B.},
% title={Local theta lifting of generalized Whittaker models associated to nilpotent orbits},
% journal={Geom. Funct. Anal.},
% year={2014},
% volume={24},
% number={3},
% pages={796--853},
% }

% \bib{EGAIV2}{article}{
%   title = {\'El\'ements de g\'eom\'etrie alg\'brique IV: \'Etude locale des
%     sch\'emas et des morphismes de sch\'emas. II},
%   author = {Grothendieck, A.},
%   author = {Dieudonn\'e, J.},
%   journal  = {Inst. Hautes \'Etudes Sci. Publ. Math.},
%   volume = {24},
%   year = {1965},
% }


% \bib{EGAIV3}{article}{
%   title = {\'El\'ements de g\'eom\'etrie alg\'brique IV: \'Etude locale des
%     sch\'emas et des morphismes de sch\'emas. III},
%   author = {Grothendieck, A.},
%   author = {Dieudonn\'e, J.},
%   journal  = {Inst. Hautes \'Etudes Sci. Publ. Math.},
%   volume = {28},
%   year = {1966},
% }


\bib{FJMN}{article}{
   author={Folz{-Donahue}, T.},
   author={Jackson, S. G.},
   author={Milev, T.},
   author={No\"{e}l, A. G.},
   title={Sign signatures and characters of Weyl Groups},
   journal={Adv. in Appl. Math.},
   volume={130},
   date={2021},
   pages={Paper No. 102225, 73},
   issn={0196-8858},
  % review={\MR{4272991}},
   doi={10.1016/j.aam.2021.102225},
}

\bib{GI}{article}{
   author={Gan, W. T.},
   author={Ichino, A.},
   title={On the irreducibility of some induced representations of real
   reductive Lie groups},
   journal={Tunis. J. Math.},
   volume={1},
   date={2019},
   number={1},
   pages={73--107},
   issn={2576-7658},
  % review={\MR{3907735}},
   doi={10.2140/tunis.2019.1.73},
}

\bib{GW}{book}{
   author={Goodman, R.},
   author={Wallach, N. R.},
   title={Symmetry, representations, and invariants},
   series={Graduate Texts in Math.},
   volume={255},
   publisher={Springer, Dordrecht},
   date={2009},
   pages={xx+716},
   isbn={978-0-387-79851-6},
   %review={\MR{2522486}},
   %doi={10.1007/978-0-387-79852-3},
}
% \bib{HLS}{article}{
%     author = {Harris, M.},
%     author = {Li, J.-S.},
%     author = {Sun, B.},
%      title = {Theta correspondences for close unitary groups},
%  %booktitle = {Arithmetic Geometry and Automorphic Forms},
%     %series = {Adv. Lect. Math. (ALM)},
%     journal = {Arithmetic Geometry and Automorphic Forms, Adv. Lect. Math. (ALM)},
%     volume = {19},
%      pages = {265--307},
%  publisher = {Int. Press, Somerville, MA},
%       year = {2011},
% }

% \bib{HS}{book}{
%  author = {Hartshorne, R.},
%  title = {Algebraic Geometry},
% publisher={Graduate Texts in Mathematics, 52. New York-Heidelberg-Berlin: Springer-Verlag},
% year={1983},
% }

% \bib{He}{article}{
% author={He, H.},
% title={Unipotent representations and quantum induction},
% journal={arXiv:math/0210372},
% year = {2002},
% }



\bib{Ho}{article}{
author={Hotta, R.},
title={On Joseph's construction of Weyl group representations},
journal={Tohoku Math. J.},
volume={36},
%number = {3},
pages={49--74 },
year={1984},
}




\bib{Howe79}{article}{
title={$\theta$-series and invariant theory},
author={Howe, R.},
bookTitle = {Automorphic Forms, Representations and $L$-functions, Proc. Sympos. Pure Math, vol. 33},
year={1979},
pages={275--285},
}

% \bib{HoweRank}{article}{
% author={Howe, R.},
% title={On a notion of rank for unitary representations of the classical groups},
% journal={Harmonic analysis and group representations, Liguori, Naples},
% pages={223-331},
% year={1982},
% }

\bib{Howe89}{article}{
author={Howe, R.},
title={Transcending classical invariant theory},
journal={J. Amer. Math. Soc.},
volume={2},
pages={535--552},
year={1989},
}

% \bib{Howe95}{article}{,
%   author = {Howe, R.},
%   title = {Perspectives on invariant theory: Schur duality, multiplicity-free actions and beyond},
%   journal = {Piatetski-Shapiro, I. et al. (eds.), The Schur lectures (1992). Ramat-Gan: Bar-Ilan University, Isr. Math. Conf. Proc. 8,},
%   year = {1995},
%   pages = {1-182},
% }



% \bib{HL}{article}{
% author={Huang, J.-S.},
% author={Li, J.-S.},
% title={Unipotent representations attached to spherical nilpotent orbits},
% journal={Amer. J. Math.},
% volume={121},
% number = {3},
% pages={497--517},
% year={1999},
% }


% \bib{HZ}{article}{
% author={Huang, J.-S.},
% author={Zhu, C.-B.},
% title={On certain small representations of indefinite orthogonal groups},
% journal={Represent. Theory},
% volume={1},
% pages={190--206},
% year={1997},
% }


 \bib{H}{book}{
   author={Humphreys, J. E.},
    title={Representations of semisimple Lie algebras in the BGG category
    $\scr{O}$},
    series={Graduate Studies in Math.},
    volume={94},
   publisher={Ameri. Math. Soc., Providence, RI},
   date={2008},
   pages={xvi+289},
  isbn={978-0-8218-4678-0},
  %  review={\MR{2428237}},
    doi={10.1090/gsm/094},
}



\bib{Jan}{book}{
   author={Jantzen, J. C.},
   title={Moduln mit einem h\"{o}chsten Gewicht},
   series={Lecture Notes in Math.},
   volume={750},
   publisher={Springer-Verlag, Berlin/Heidelberg/New York},
   date={1979},
  % pages={xvi+289},
   % isbn={978-0-8218-4678-0},
   % review={\MR{2428237}},
   % doi={10.1090/gsm/094},
}

\bib{J79W}{article}{
   author={Joseph, A.},
   title={$W$-module structure in the primitive spectrum of the enveloping
   algebra of a semisimple Lie algebra},
   conference={
      title={Noncommutative harmonic analysis},
      address={Proc. Third Colloq., Marseille-Luminy},
      date={1978},
   },
   book={
      series={Lecture Notes in Math.},
      volume={728},
      publisher={Springer, Berlin},
   },
   date={1979},
   pages={116--135},
  % review={\MR{548328}},
}

 \bib{J79D}{article}{
   author={Joseph, A.},
   title={Dixmier's problem for Verma and principal series submodules},
   journal={J. London Math. Soc. (2)},
   volume={20},
   date={1979},
   number={2},
   pages={193--204},
   issn={0024-6107},
  % review={\MR{551445}},
   doi={10.1112/jlms/s2-20.2.193},
}


\bib{J1}{article}{
   author={Joseph, A.},
   title={Goldie rank in the enveloping algebra of a semisimple Lie algebra. I},
   journal={J. Algebra},
   volume={65},
   date={1980},
   number={2},
   pages={269--283},
   issn={0021-8693},
  % review={\MR{585721}},
   doi={10.1016/0021-8693(80)90217-3},
}

\bib{J2}{article}{
   author={Joseph, A.},
   title={Goldie rank in the enveloping algebra of a semisimple Lie algebra. II},
   journal={J. Algebra},
   volume={65},
   date={1980},
   number={2},
   pages={284--306},
   issn={0021-8693},
  % review={\MR{585721}},
   doi={10.1016/0021-8693(80)90217-3},
}

% \bib{J3}{article}{
%    author={Joseph, A.},
%    title={Goldie rank in the enveloping algebra of a semisimple Lie algebra.
%    III},
%    journal={J. Algebra},
%    volume={73},
%    date={1981},
%    number={2},
%    pages={295--326},
%    issn={0021-8693},
%    review={\MR{640039}},
%    doi={10.1016/0021-8693(81)90324-0},
% }

\bib{J.hw}{article}{
   author={Joseph, A.},
   title={On the variety of a highest weight module},
   journal={J. Algebra},
   volume={88},
   date={1984},
   number={1},
   pages={238--278},
   issn={0021-8693},
  % review={\MR{741942}},
   doi={10.1016/0021-8693(84)90100-5},
}


\bib{J.av}{article}{
   author={Joseph, A.},
   title={On the associated variety of a primitive ideal},
   journal={J. Algebra},
   volume={93},
   date={1985},
   number={2},
   pages={509--523},
   issn={0021-8693},
  % review={\MR{786766}},
   doi={10.1016/0021-8693(85)90172-3},
}

% \bib{J.ann}{article}{
%    author={Joseph, Anthony},
%    title={Annihilators and associated varieties of unitary highest weight
%    modules},
%    journal={Ann. Sci. \'{E}cole Norm. Sup. (4)},
%    volume={25},
%    date={1992},
%    number={1},
%    pages={1--45},
%    issn={0012-9593},
%    review={\MR{1152612}},
% }


% \bib{JLS}{article}{
% author={Jiang, D.},
% author={Liu, B.},
% author={Savin, G.},
% title={Raising nilpotent orbits in wave-front sets},
% journal={Represent. Theory},
% volume={20},
% pages={419--450},
% year={2016},
% }

\bib{King}{article}{
author={King, D. R.},
title={The character polynomial of the annihilator of an irreducible Harish-Chandra module},
journal={Amer. J. Math.},
volume={103},
%issue ={4},
pages={1195--1240},
year={1981},
}


\bib{Ki62}{article}{
author={Kirillov, A. A.},
title={Unitary representations of nilpotent Lie groups},
journal={Uspehi Mat. Nauk},
volume={17},
issue ={4},
pages={57--110},
year={1962},
}

\bib{Ko70}{article}{
author={Kostant, B.},
title={Quantization and unitary representations},
bookTitle ={Lectures in Modern Analysis and Applications III, Lecture Notes in Math., vol. 170},
pages={87--208},
year={1970},
}


% \bib{KP}{article}{
% author={Kraft, H.},
% author={Procesi, C.},
% title={On the geometry of conjugacy classes in classical groups},
% journal={Comment. Math. Helv.},
% volume={57},
% pages={539--602},
% year={1982},
% }

% \bib{KR}{article}{
% author={Kudla, S. S.},
% author={Rallis, S.},
% title={Degenerate principal series and invariant distributions},
% journal={Israel J. Math.},
% volume={69},
% pages={25--45},
% year={1990},
% }


% \bib{Ku}{article}{
% author={Kudla, S. S.},
% title={Some extensions of the Siegel-Weil formula},
% journal={In: Gan W., Kudla S., Tschinkel Y. (eds) Eisenstein Series and Applications. Progress in Mathematics, vol 258. Birkh\"auser Boston},
% %volume={69},
% pages={205--237},
% year={2008},
% }





% \bib{LZ1}{article}{
% author={Lee, S. T.},
% author={Zhu, C.-B.},
% title={Degenerate principal series and local theta correspondence II},
% journal={Israel J. Math.},
% volume={100},
% pages={29--59},
% year={1997},
% }

% \bib{LZ2}{article}{
% author={Lee, S. T.},
% author={Zhu, C.-B.},
% title={Degenerate principal series of metaplectic groups and Howe correspondence},
% journal = {D. Prasad at al. (eds.), Automorphic Representations and L-Functions, Tata Institute of Fundamental Research, India,},
% year = {2013},
% pages = {379--408},
% }

% \bib{Li89}{article}{
% author={Li, J.-S.},
% title={Singular unitary representations of classical groups},
% journal={Invent. Math.},
% volume={97},
% number = {2},
% pages={237--255},
% year={1989},
% }

% \bib{LiuAG}{book}{
%   title={Algebraic Geometry and Arithmetic Curves},
%   author = {Liu, Q.},
%   year = {2006},
%   publisher={Oxford University Press},
% }

% \bib{LM}{article}{
%    author = {Loke, H. Y.},
%    author = {Ma, J.},
%     title = {Invariants and $K$-spectrums of local theta lifts},
%     journal = {Compositio Math.},
%     volume = {151},
%     issue = {01},
%     year = {2015},
%     pages ={179--206},
% }

% \bib{DL}{article}{
%    author={Deligne, P.},
%    author={Lusztig, G.},
%    title={Representations of reductive groups over finite fields},
%    journal={Ann. of Math. (2)},
%    volume={103},
%    date={1976},
%    number={1},
%    pages={103--161},
%    issn={0003-486X},
%    review={\MR{393266}},
%    doi={10.2307/1971021},
% }

 \bib{KL}{article}{
    author={Kazhdan, D.},
    author={Lusztig, G.},
    title={Representations of Coxeter groups and Hecke algebras},
    journal={Invent. Math.},
    volume={53},
    date={1979},
    number={2},
    pages={165--184},
    issn={0020-9910},
  %  review={\MR{560412}},
    doi={10.1007/BF01390031},
 }

\bib{Lsp}{article}{
   author={Lusztig, G.},
   title={A class of irreducible representations of a Weyl group},
   journal={Nederl. Akad. Wetensch. Indag. Math.},
   volume={41},
   date={1979},
   number={3},
   pages={323--335},
   issn={0019-3577},
  % review={\MR{546372}},
}


\bib{Lcell}{article}{
   author={Lusztig, G.},
   title={A class of irreducible representations of a Weyl group. II},
   journal={Nederl. Akad. Wetensch. Indag. Math.},
   volume={44},
   date={1982},
   number={2},
   pages={219--226},
   issn={0019-3577},
  % review={\MR{662657}},
}


\bib{Lu}{book}{
   author={Lusztig, G.},
   title={Characters of reductive groups over a finite field},
   series={Annals of Math. Studies},
   volume={107},
   publisher={Princeton University Press, Princeton, NJ},
   date={1984},
   pages={xxi+384},
   isbn={0-691-08350-9},
   isbn={0-691-08351-7},
  % review={\MR{742472}},
   doi={10.1515/9781400881772},
}


% \bib{Lu.I}{article}{
%    author={Lusztig, G.},
%    title={Intersection cohomology complexes on a reductive group},
%    journal={Invent. Math.},
%    volume={75},
%    date={1984},
%    number={2},
%    pages={205--272},
%    issn={0020-9910},
%    review={\MR{732546}},
%    doi={10.1007/BF01388564},
% }


% \bib{LS}{article}{
%    author = {Lusztig, G.},
%    author = {Spaltenstein, N.},
%     title = {Induced unipotent classes},
%     journal = {J. London Math. Soc.},
%     volume = {19},
%     year = {1979},
%     pages ={41--52},
% }


% \bib{Ma}{article}{
%    author = {Mackey, G. W.},
%     title = {Unitary representations of group extentions},
%     journal = {Acta Math.},
%     volume = {99},
%     year = {1958},
%     pages ={265--311},
% }

\bib{Mat96}{article}{
   author={Matumoto, H.},
   title={On the representations of ${\rm U}(m,n)$ unitarily induced from
   derived functor modules},
   journal={Compos. Math.},
   volume={100},
   date={1996},
   number={1},
   pages={1--39},
   issn={0010-437X},
  % review={\MR{1377407}},
}

\bib{Mat}{article}{
   author={Matumoto, H.},
   title={On the representations of ${\rm Sp}(p,q)$ and ${\rm SO}^*(2n)$
   unitarily induced from derived functor modules},
   journal={Compos. Math.},
   volume={140},
   date={2004},
   number={4},
   pages={1059--1096},
   issn={0010-437X},
  % review={\MR{2059231}},
   doi={10.1112/S0010437X03000629},
}

\bib{Mc}{article}{
   author = {McGovern, W. M.},
    title = {Cells of Harish-Chandra modules for real classical groups},
    journal = {Amer. J. Math.},
    volume = {120},
    issue = {01},
    year = {1998},
    pages ={211--228},
}


\bib{Mil}{article}{
   author = {Mili\v{c}i\'c, D.},
    title = {Localizations and representation theory of reductive Lie groups},
    journal = {preprint, http://www.math.utah.edu/~milicic/Eprints/book.pdf},
   % volume = {120},
    %issue = {01},
    %year = {1998},
   % pages ={211--228},
}


% \bib{Mo96}{article}{
%  author={M{\oe}glin, C.},
%     title = {Front d'onde des repr\'esentations des groupes classiques $p$-adiques},
%     journal = {Amer. J. Math.},
%     volume = {118},
%     issue = {06},
%     year = {1996},
%     pages ={1313--1346},
% }

\bib{Mo17}{article}{
  author={M{\oe}glin, C.},
  title = {Paquets d'Arthur Sp\'eciaux Unipotents aux Places Archim\'ediennes et Correspondance de Howe},
  bookTitle = {J. Cogdell et al. (eds.), Representation Theory, Number Theory, and Invariant Theory, In Honor of Roger Howe. Progress in Math., vol. 323}
  %series ={Progress in Math.},
  pages = {469--502}
  year = {2017}
}

\bib{MR.C}{article}{
   author={M{\oe}glin, C.},
   author={Renard, D.},
   title={Paquets d'Arthur des groupes classiques complexes},
   language={French, with English and French summaries},
   conference={
      title={Around Langlands correspondences},
   },
   book={
      series={Contemp. Math.},
      volume={691},
      publisher={Amer. Math. Soc., Providence, RI},
   },
   date={2017},
   pages={203--256},
  % review={\MR{3666056}},
   doi={10.1090/conm/691/13899},
}

\bib{MR.U}{article}{
   author={M{\oe}glin, C.},
   author={Renard, D.},
   title={Sur les paquets d'Arthur des groupes unitaires et quelques
   cons\'{e}quences pour les groupes classiques},
   language={French, with English and French summaries},
   journal={Pacific J. Math.},
   volume={299},
   date={2019},
   number={1},
   pages={53--88},
   issn={0030-8730},
  % review={\MR{3947270}},
   doi={10.2140/pjm.2019.299.53},
}


% \bib{MVW}{book}{
%   volume={1291},
%   title={Correspondances de Howe sur un corps $p$-adique},
%   author={M{\oe}glin, C.},
%   author={Vign\'eras, M.-F.},
%   author={Waldspurger, J.-L.},
%   series={Lecture Notes in Mathematics},
%   publisher={Springer}
%   ISBN={978-3-540-18699-1},
%   date={1987},
% }

% \bib{NOTYK}{article}{
%    author = {Nishiyama, K.},
%    author = {Ochiai, H.},
%    author = {Taniguchi, K.},
%    author = {Yamashita, H.},
%    author = {Kato, S.},
%     title = {Nilpotent orbits, associated cycles and Whittaker models for highest weight representations},
%     journal = {Ast\'erisque},
%     volume = {273},
%     year = {2001},
%    pages ={1--163},
% }

% \bib{NOZ}{article}{
%   author = {Nishiyama, K.},
%   author = {Ochiai, H.},
%   author = {Zhu, C.-B.},
%   journal = {Trans. Amer. Math. Soc.},
%   title = {Theta lifting of nilpotent orbits for symmetric pairs},
%   volume = {358},
%   year = {2006},
%   pages = {2713--2734},
% }


% \bib{NZ}{article}{
%    author = {Nishiyama, K.},
%    author = {Zhu, C.-B.},
%     title = {Theta lifting of unitary lowest weight modules and their associated cycles},
%     journal = {Duke Math. J.},
%     volume = {125},
%     number= {03},
%     year = {2004},
%    pages ={415--465},
% }



% \bib{Ohta}{article}{
%   author = {Ohta, T.},
%   %doi = {10.2748/tmj/1178227492},
%   journal = {Tohoku Math. J.},
%   number = {2},
%   pages = {161--211},
%   publisher = {Tohoku University, Mathematical Institute},
%   title = {The closures of nilpotent orbits in the classical symmetric
%     pairs and their singularities},
%   volume = {43},
%   year = {1991}
% }

% \bib{Ohta2}{article}{
%   author = {Ohta, T.},
%   journal = {Hiroshima Math. J.},
%   number = {2},
%   pages = {347--360},
%   title = {Induction of nilpotent orbits for real reductive groups and associated varieties of standard representations},
%   volume = {29},
%   year = {1999}
% }

% \bib{Ohta4}{article}{
%   title={Nilpotent orbits of $\mathbb{Z}_4$-graded Lie algebra and geometry of
%     moment maps associated to the dual pair $(\mathrm{U} (p, q), \mathrm{U} (r, s))$},
%   author={Ohta, T.},
%   journal={Publ. RIMS},
%   volume={41},
%   number={3},
%   pages={723--756},
%   year={2005}
% }

% \bib{PT}{article}{
%   title={Some small unipotent representations of indefinite orthogonal groups and the theta correspondence},
%   author={Paul, A.},
%   author={Trapa, P.},
%   journal={University of Aarhus Publ. Series},
%   volume={48},
%   pages={103--125},
%   year={2007}
% }


% \bib{PV}{article}{
%   title={Invariant Theory},
%   author={Popov, V. L.},
%   author={Vinberg, E. B.},
%   book={
%   title={Algebraic Geometry IV: Linear Algebraic Groups, Invariant Theory},
%   series={Encyclopedia of Mathematical Sciences},
%   volume={55},
%   year={1994},
%   publisher={Springer},}
% }




%\bib{PPz}{article}{
%author={Protsak, V.} ,
%author={Przebinda, T.},
%title={On the occurrence of admissible representations in the real Howe
%    correspondence in stable range},
%journal={Manuscr. Math.},
%volume={126},
%number={2},
%pages={135--141},
%year={2008}
%}


% \bib{PrzInf}{article}{
%       author={Przebinda, T.},
%        title={The duality correspondence of infinitesimal characters},
%         date={1996},
%      journal={Colloq. Math.},
%       volume={70},
%        pages={93--102},
% }


% \bib{Pz}{article}{
% author={Przebinda, T.},
% title={Characters, dual pairs, and unitary representations},
% journal={Duke Math. J. },
% volume={69},
% number={3},
% pages={547--592},
% year={1993}
% }

% \bib{Ra}{article}{
% author={Rallis, S.},
% title={On the Howe duality conjecture},
% journal={Compositio Math.},
% volume={51},
% pages={333--399},
% year={1984}
% }

\bib{RT1}{article}{
   author={Renard, D.},
   author={Trapa, P.},
   title={Irreducible genuine characters of the metaplectic group:
   Kazhdan-Lusztig algorithm and Vogan duality},
   journal={Represent. Theory},
   volume={4},
   date={2000},
   pages={245--295},
  % review={\MR{1795754}},
   doi={10.1090/S1088-4165-00-00105-9},
}

\bib{RT2}{article}{
   author={Renard, D.},
   author={Trapa, P.},
   title={Irreducible characters of the metaplectic group. II.
   Functoriality},
   journal={J. Reine Angew. Math.},
   volume={557},
   date={2003},
   pages={121--158},
   issn={0075-4102},
  % review={\MR{1978405}},
   doi={10.1515/crll.2003.028},
}

% \bib{RT3}{article}{
%    author={Renard, David A.},
%    author={Trapa, Peter E.},
%    title={Kazhdan-Lusztig algorithms for nonlinear groups and applications
%    to Kazhdan-Patterson lifting},
%    journal={Amer. J. Math.},
%    volume={127},
%    date={2005},
%    number={5},
%    pages={911--971},
%    issn={0002-9327},
%    review={\MR{2170136}},
% }


% \bib{Sa}{article}{
% author={Sahi, S.},
% title={Explicit Hilbert spaces for certain unipotent representations},
% journal={Invent. Math.},
% volume={110},
% number = {2},
% pages={409--418},
% year={1992}
% }

% \bib{Se}{article}{
% author={Sekiguchi, J.},
% title={Remarks on real nilpotent orbits of a symmetric pair},
% journal={J. Math. Soc. Japan},
% %publisher={The Mathematical Society of Japan},
% year={1987},
% volume={39},
% number={1},
% pages={127--138},
% }

\bib{SV}{article}{
author = {Schmid, W.},
author = {Vilonen, K.},
journal = {Annals of Math.},
number = {3},
pages = {1071--1118},
%publisher = {Princeton University, Mathematics Department, Princeton, NJ; Mathematical Sciences Publishers, Berkeley},
title = {Characteristic cycles and wave front cycles of representations of reductive Lie groups},
volume = {151},
year = {2000},
}


\bib{Soergel}{article}{
   author={Soergel, W.},
   title={Kategorie $\scr O$, perverse Garben und Moduln \"{u}ber den
   Koinvarianten zur Weylgruppe},
   language={German, with English summary},
   journal={J. Amer. Math. Soc.},
   volume={3},
   date={1990},
   number={2},
   pages={421--445},
   issn={0894-0347},
  % review={\MR{1029692}},
   doi={10.2307/1990960},
}


\bib{So}{article}{
author = {Sommers, E.},
title = {Lusztig's canonical quotient and generalized duality},
journal = {J. Algebra},
volume = {243},
number = {2},
pages = {790--812},
year = {2001},
}

\bib{Spa}{book}{
   author={Spaltenstein, N.},
   title={Classes unipotentes et sous-groupes de Borel},
   series={Lecture Notes in Math.},
   volume={946},
   publisher={Springer-Verlag, Berlin-New York},
   date={1982},
}

% \bib{SS}{book}{
%   author = {Springer, T. A.},
%   author = {Steinberg, R.},
%   title = {Seminar on algebraic groups and related finite groups; Conjugate classes},
%   series = {Lecture Notes in Math.},
%   volume = {131},
% publisher={Springer},
% year={1970},
% }

% \bib{SZ1}{article}{
% title={A general form of Gelfand-Kazhdan criterion},
% author={Sun, B.},
% author={Zhu, C.-B.},
% journal={Manuscripta Math.},
% pages = {185--197},
% volume = {136},
% year={2011}
% }


%\bib{SZ2}{article}{
%  title={Conservation relations for local theta correspondence},
%  author={Sun, B.},
%  author={Zhu, C.-B.},
%  journal={J. Amer. Math. Soc.},
%  pages = {939--983},
%  volume = {28},
%  year={2015}
%}

\bib{Tr.U}{article}{
   author={Trapa, P.},
   title={Annihilators and associated varieties of $A_{\mathfrak q}(\lambda)$
   modules for $\mathrm U(p,q)$},
   journal={Compositio Math.},
   volume={129},
   date={2001},
   number={1},
   pages={1--45},
   issn={0010-437X},
  % review={\MR{1856021}},
   doi={10.1023/A:1013115223377},
}

\bib{Tr.H}{article}{
  title={Special unipotent representations and the Howe correspondence},
  author={Trapa, P.},
  year = {2004},
  journal={University of Aarhus Publication Series},
  volume = {47},
  pages= {210--230}
}

% \bib{Wa}{article}{
%    author = {Waldspurger, J.-L.},
%     title = {D\'{e}monstration d'une conjecture de dualit\'{e} de Howe dans le cas $p$-adique, $p \neq 2$ in Festschrift in honor of I. I. Piatetski-Shapiro on the occasion of his sixtieth birthday},
%   journal = {Israel Math. Conf. Proc., 2, Weizmann, Jerusalem},
%  year = {1990},
% pages = {267-324},
% }

\bib{VGK}{article}{
   author={Vogan, D. A.},
   title={Gel\cprime fand-Kirillov dimension for Harish-Chandra modules},
   journal={Invent. Math.},
   volume={48},
   date={1978},
   number={1},
   pages={75--98},
   issn={0020-9910},
  % review={\MR{506503}},
   doi={10.1007/BF01390063},
}

\bib{Vtau}{article}{
   author={Vogan, D. A.},
   title={A generalized $\tau $-invariant for the primitive spectrum of a
   semisimple Lie algebra},
   journal={Math. Ann.},
   volume={242},
   date={1979},
   number={3},
   pages={209--224},
   issn={0025-5831},
  % review={\MR{545215}},
   doi={10.1007/BF01420727},
}


\bib{V1}{article}{
   author={Vogan, D. A.},
   title={Irreducible characters of semisimple Lie groups. I},
   journal={Duke Math. J.},
   volume={46},
   date={1979},
   number={1},
   pages={61--108},
   issn={0012-7094},
  % review={\MR{523602}},
}

\bib{Vg}{book}{
   author={Vogan, D. A.},
   title={Representations of real reductive Lie groups},
   series={Progress in Math.},
   volume={15},
   publisher={Birkh\"{a}user, Boston, Mass.},
   date={1981},
   pages={xvii+754},
   isbn={3-7643-3037-6},
  % review={\MR{632407}},
}


\bib{V4}{article}{
   author={Vogan, D. A.},
   title={Irreducible characters of semisimple Lie groups. IV.
   Character-multiplicity duality},
   journal={Duke Math. J.},
   volume={49},
   date={1982},
   number={4},
   pages={943--1073},
   issn={0012-7094},
  % review={\MR{683010}},
}

\bib{V3}{article}{
   author={Vogan, D. A.},
   title={Irreducible characters of semisimple Lie groups. III. Proof of Kazhdan-Lusztig conjecture in the integral case},
   journal={Invent. Math.},
   volume={71},
   date={1983},
   number={2},
   pages={381--417},
}

\bib{V.GL}{article}{
   author={Vogan, D. A.},
   title={The unitary dual of ${\rm GL}(n)$ over an Archimedean field},
   journal={Invent. Math.},
   volume={83},
   date={1986},
   number={3},
   pages={449--505},
   issn={0020-9910},
  % review={\MR{827363}},
   doi={10.1007/BF01394418},
}

\bib{VoICM}{article}{
author={Vogan, D. A.},
   title={Representations of reductive Lie groups},
   bookTitle={Proc. Intern. Congr. Math. (Berkeley, Calif., 1986)},
   publisher = {Amer. Math. Soc.},
  year = {1987},
pages={246--266},
}

\bib{VoBook}{book}{
author = {Vogan, D. A.},
  title={Unitary representations of reductive Lie groups},
  year={1987},
  series = {Ann. of Math. Stud.},
 volume={118},
  publisher={Princeton University Press}
}


\bib{Vo89}{article}{
  author = {Vogan, D. A.},
  title = {Associated varieties and unipotent representations},
 %booktitle ={Harmonic analysis on reductive groups, Proc. Conf., Brunswick/ME (USA) 1989,},
  bookTitle = {Harmonic analysis on reductive groups, Proc. Conf., Brunswick/ME
    (USA) 1989, Progress in Math., vol. 101},
  publisher = {Birkh\"{a}user, Boston-Basel-Berlin},
  year = {1991},
pages={315--388},
  editor = {W. Barker and P. Sally},
}

% \bib{Vo98}{article}{
%   author = {Vogan, D. A. },
%   title = {The method of coadjoint orbits for real reductive groups},
%  %booktitle ={Representation theory of Lie groups (Park City, UT, 1998)},
%  journal = {Representation theory of Lie groups (Park City, UT, 1998). IAS/Park City Math. Ser.},
%   volume={8},
%   publisher = {Amer. Math. Soc.},
%   year = {2000},
% pages={179--238},
% }



% \bib{Vo00}{article}{
%   author = {Vogan, D. A. },
%   title = {Unitary representations of reductive Lie groups},
%  %booktitle ={Mathematics towards the Third Millennium (Rome, 1999)},
%  journal ={Mathematics towards the Third Millennium (Rome, 1999). Accademia Nazionale dei Lincei, (2000)},
%   %series = {Accademia Nazionale dei Lincei, 2000},
%  %volume={9},
% pages={147--167},
% }


% \bib{Wa1}{book}{
%   title={Real reductive groups I},
%   author={Wallach, N. R.},
%   year={1988},
%   publisher={Academic Press Inc. }
% }

\bib{Wa2}{book}{
title={Real reductive groups II},
author={Wallach, N. R.},
year={1992},
publisher={Academic Press Inc. }
}


% \bib{Weyl}{book}{
%   title={The classical groups: their invariants and representations},
%   author={Weyl, H.},
%   year={1947},
%   publisher={Princeton University Press}
% }

% \bib{Ya}{article}{
%   title={Degenerate principal series representations for quaternionic unitary groups},
%   author={Yamana, S.},
%   year = {2011},
%   journal={Israel J. Math.},
%   volume = {185},
%   pages= {77--124}
% }


\bib{Zu}{article}{
  title={Tensor products of finite and infinite dimensional representations of semisimple Lie groups},
  author={Zuckerman, G.},
  year = {1977},
  journal={Ann. of Math. 106},
  volume = {106},
  pages= {295--308}
}


% \bib{EGAIV4}{article}{
%   title = {\'El\'ements de g\'eom\'etrie alg\'brique IV 4: \'Etude locale des
%     sch\'emas et des morphismes de sch\'emas},
%   author = {Grothendieck, Alexandre},
%   author = {Dieudonn\'e, Jean},
%   journal  = {Inst. Hautes \'Etudes Sci. Publ. Math.},
%   volume = {32},
%   year = {1967},
%   pages = {5--361}
% }



\end{biblist}
\end{bibdiv}

\end{document}


Write $\check V$ for the standard module of $\check \g$, which  either a complex symmetric bilinear space or a complex symplectic space. We say that a parabolic subalgebra
 $\check \p$ of $\check \g$ is $\check \CO$-relevant if the following conditions are satisfied:
\begin{itemize}
\item
it is the stabilizer of a totally isotropic subspace $\check V'_{\mathrm b}$ of $\check V$ of dimension $n_\mathrm b$;

\item
some (and hence all) Levi factor of $\check \p$ has nonempty intersection with $\check \CO$.
%\item
%if $\star\in\{D,D^*\}$ and $\check \CO$ has bad parity, then
%the number of positive entries in $\lambda_{\check \CO}$ has the same parity as $ \frac{l}{2}$.
%Here we have used the identifications
%\[
 %   \hha=\b/[\b,\b]=\prod_{i=1}^l \gl(V_i/V_{i-1}) =\C^l
%\]
%so that $\lambda_{\check \CO}\in (\frac{1}{2}, \frac{1}{2}, \dots, \frac{1}{2})+\Z^l\subset \C^l=\hha^*$,
%where $0=V_0\subset V_1\subset \cdots V_{l-1} \subset V_l$ is a full flag in $V_l$, and $\b$ is the Borel subalgebra of $\g$ stabilizing this flag.
\end{itemize}
Note that the first condition implies the second one, except for the case when $\star\in \{D, D^*\}$ and $\check \CO$ has bad parity and is nonempty. In all cases,   up to conjugation by $\Ad(\check \g)$ there exists a unique  parabolic subalgebra of $\check \g$ that is $\check \CO$-relevant. Fix such a parabolic subalgebra $\check \p$ and a Levi factor $\check \l$ of it. Then we have an obvious decomposition
\[
  \check \l= \check \g'_\mathrm b \times \check \g_\mathrm g
\]
such that there are natural isomorphism
\[
\check \g'_\mathrm b\cong \gl_{n_\mathrm b}(\C)
\]
and
\[
\check \g_\mathrm g\cong
  \begin{cases}
      \s\p_{2\nng}(\bC), &\quad  \text{if } \star \in \set{B,\wtC}; \\
  \o_{2\nng+1}(\bC), & \quad  \text{if } \star \in \set{C,C^{*}}; \\
    \o_{2\nng}(\bC), &\quad \text{if } \star \in \set{D,D^{*}}.\\
  \end{cases}
\]

We have a decomposition
\[
  \l\cap \check \CO=\check \CO'_\mathrm b\times \check \CO_\mathrm g
\]
where $\check \CO'_\mathrm b\in \overline \Nil(\check \g'_\mathrm b)$ is the nilpotent orbit whose Young diagram equals $\mathbf d'_\mathrm b$, and  $\check \CO_\mathrm g\in \overline \Nil(\check \g_\mathrm g)$ is the nilpotent orbit whose Young diagram equals $\mathbf d_\mathrm g$.


%%% Local Variables:
%%% coding: utf-8
%%% mode: latex
%%% ispell-local-dictionary: "en_US"
%%% End:
