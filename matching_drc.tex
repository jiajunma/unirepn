\documentclass[12pt,a4paper]{amsart}
\usepackage[margin=2.5cm,marginpar=2cm]{geometry}



% \usepackage{showkeys}
% \makeatletter
%   \SK@def\Cref#1{\SK@\SK@@ref{#1}\SK@Cref{#1}}
%   \SK@def\cref#1{\SK@\SK@@ref{#1}\SK@cref{#1}}
% \makeatother

\usepackage[bookmarksopen,bookmarksdepth=3]{hyperref}
\usepackage[nameinlink]{cleveref}

%% FONTS
\usepackage{amssymb}
%\usepackage{boisik}
%\usepackage{amsmath}
\usepackage{mathrsfs}
%\usepackage{amsrefs}
\usepackage{mathbbol,mathabx}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{braket}
%\usepackage[pointedenum]{paralist}
%\usepackage{paralist}

\usepackage{mathtools}

\usepackage{amsrefs}

\usepackage[all,cmtip]{xy}
\usepackage{rotating}
\usepackage{leftidx}
%\usepackage{arydshln}

%\DeclareSymbolFont{bbold}{U}{bbold}{m}{n}
%\DeclareSymbolFontAlphabet{\mathbbold}{bbold}


%\usepackage[dvipdfx,rgb,table]{xcolor}
\usepackage[rgb,table,dvipsnames]{xcolor}
%\usepackage{color}
%\usepackage{mathrsfs}

\setcounter{tocdepth}{1}
\setcounter{secnumdepth}{3}

%\usepackage[abbrev,shortalphabetic]{amsrefs}


\usepackage{imakeidx}
\def\idxemph#1{\emph{#1}\index{#1}}
\makeindex


\usepackage[normalem]{ulem}

% circled number
\usepackage{pifont}
\makeatletter
\newcommand*{\circnuma}[1]{%
  \ifnum#1<1 %
    \@ctrerr
  \else
    \ifnum#1>20 %
      \@ctrerr
    \else
      \mbox{\ding{\numexpr 171+(#1)\relax}}%
     \fi
  \fi
}
\makeatother

\usepackage[centertableaux]{ytableau}

%\usepackage[mathlines,pagewise]{lineno}
%\linenumbers

\usepackage{enumitem}
%% Enumitem
\newlist{enumC}{enumerate}{1} % Conditions in Lemma/Theorem/Prop
\setlist[enumC,1]{label=(\alph*),wide,ref=(\alph*)}
\crefname{enumCi}{condition}{conditions}
\Crefname{enumCi}{Condition}{Conditions}
\newlist{enumT}{enumerate}{3} % "Theorem"=conclusions in Lemma/Theorem/Prop
\setlist[enumT]{label=(\roman*),wide}
\setlist[enumT,1]{label=(\roman*),wide}
\setlist[enumT,2]{label=(\alph*),ref ={(\roman{enumTi}.\alph*)},left=2em}
\setlist[enumT,3]{label*=.(\arabic*), ref ={(\roman{enumTi}.\alph{enumTii}.\alph*)}}
\crefname{enumTi}{}{}
\Crefname{enumTi}{Item}{Items}
\crefname{enumTii}{}{}
\Crefname{enumTii}{Item}{Items}
\crefname{enumTiii}{}{}
\Crefname{enumTiii}{Item}{Items}
\newlist{enumPF}{enumerate}{3}
%\setlist[enumPF]{label=(\alph*),wide}
\setlist[enumPF,1]{label=(\roman*),wide}
\setlist[enumPF,2]{label=(\alph*),left=2em}
\setlist[enumPF,3]{label=\arabic*).,left=1em}
\newlist{enumS}{enumerate}{3} % Statement outside Lemma/Theorem/Prop
\setlist[enumS]{label=\roman*)}
\setlist[enumS,1]{label=\roman*)}
\setlist[enumS,2]{label=\alph*)}
\setlist[enumS,3]{label=\arabic*.}
\newlist{enumI}{enumerate}{3} % items
\setlist[enumI,1]{label=\roman*),leftmargin=*}
\setlist[enumI,2]{label=\alph*), leftmargin=*}
\setlist[enumI,3]{label=\arabic*), leftmargin=*}
\newlist{enumIL}{enumerate*}{1} % inline enum
\setlist*[enumIL]{label=\roman*)}
\newlist{enumR}{enumerate}{1} % remarks
\setlist[enumR]{label=\arabic*.,wide,labelwidth=!, labelindent=0pt}
\crefname{enumRi}{remark}{remarks}


%\definecolor{srcol}{RGB}{255,255,51}

%\definecolor{srcol}{RGB}{255,255,51}
\colorlet{srcol}{black!15}

\crefname{equation}{}{}
\Crefname{equation}{Equation}{Equations}
\Crefname{lem}{Lemma}{Lemma}
\Crefname{thm}{Theorem}{Theorem}

\newlist{des}{enumerate}{1}
\setlist[des]{font=\upshape\sffamily\bfseries, label={}}
%\setlist[des]{before={\renewcommand\makelabel[1]{\sffamily \bfseries ##1 }}}

% editing macros.
%\blendcolors{!80!black}
\long\def\okay#1{\ifcsname highlightokay\endcsname
{\color{red} #1}
\else
{#1}
\fi
}
\long\def\editc#1{{\color{red} #1}}
\long\def\mjj#1{{{\color{blue}#1}}}
\long\def\mjjr#1{{\color{red} (#1)}}
\long\def\mjjd#1#2{{\color{blue} #1 \sout{#2}}}
\def\mjjb{\color{blue}}
\def\mjje{\color{black}}
\def\mjjcb{\color{green!50!black}}
\def\mjjce{\color{black}}

\long\def\sun#1{{{\color{cyan}#1}}}
\long\def\sund#1#2{{\color{cyan}#1  \sout{#2}}}
\long\def\mv#1{{{\color{red} {\bf move to a proper place:} #1}}}
\long\def\delete#1{}

%\reversemarginpar
\newcommand{\lokec}[1]{\marginpar{\color{blue}\tiny #1 \mbox{--loke}}}
\newcommand{\mjjc}[1]{\marginpar{\color{green}\tiny #1 \mbox{--ma}}}


\def\showtrivial{\relax}

\newcommand{\trivial}[2][]{\if\relax\detokenize{#1}\relax
  {%\hfill\break
   % \begin{minipage}{\textwidth}
      \color{orange} \vspace{0em} $[$  #2 $]$
  %\end{minipage}
  %\break
      \color{black}
  }
  \else
\ifx#1h
\ifcsname showtrivial\endcsname
{%\hfill\break
 % \begin{minipage}{\textwidth}
    \color{orange} \vspace{0em}  $[$ #2 $]$
%\end{minipage}
%\break
    \color{black}
}
\fi
\else {\red Wrong argument!} \fi
\fi
}

\newcommand{\byhide}[2][]{\if\relax\detokenize{#1}\relax
{\color{orange} \vspace{0em} Plan to delete:  #2}
\else
\ifx#1h\relax\fi
\fi
}



\newcommand{\Rank}{\mathrm{rk}}
\newcommand{\cqq}{\mathscr{D}}
\newcommand{\rsym}{\mathrm{sym}}
\newcommand{\rskew}{\mathrm{skew}}
\newcommand{\fraksp}{\mathfrak{sp}}
\newcommand{\frakso}{\mathfrak{so}}
\newcommand{\frakm}{\mathfrak{m}}
\newcommand{\frakp}{\mathfrak{p}}
\newcommand{\pr}{\mathrm{pr}}
\newcommand{\rhopst}{\rho'^*}
\newcommand{\Rad}{\mathrm{Rad}}
\newcommand{\Res}{\mathrm{Res}}
\newcommand{\Hol}{\mathrm{Hol}}
\newcommand{\AC}{\mathrm{AC}}
%\newcommand{\AS}{\mathrm{AS}}
\newcommand{\WF}{\mathrm{WF}}
\newcommand{\AV}{\mathrm{AV}}
\newcommand{\AVC}{\mathrm{AV}_\bC}
\newcommand{\VC}{\mathrm{V}_\bC}
\newcommand{\bfv}{\mathbf{v}}
\newcommand{\depth}{\mathrm{depth}}
\newcommand{\wtM}{\widetilde{M}}
\newcommand{\wtMone}{{\widetilde{M}^{(1,1)}}}

\newcommand{\nullpp}{N(\fpp'^*)}
\newcommand{\nullp}{N(\fpp^*)}
%\newcommand{\Aut}{\mathrm{Aut}}

\def\mstar{{\medstar}}
\def\YD{{\mathsf{YD}}}
\def\SYD{{\mathsf{SYD}}}
\def\MYD{{\mathsf{MYD}}}

\def\KM{{\mathcal{K_{\mathsf{M}}}}}

\newcommand{\bfonenp}{\mathbf{1}^{-,+}}
\newcommand{\bfonepn}{\mathbf{1}^{+,-}}
\newcommand{\bfone}{\mathbf{1}}
\newcommand{\piSigma}{\pi_\Sigma}
\newcommand{\piSigmap}{\pi'_\Sigma}


\newcommand{\sfVprime}{\mathsf{V}^\prime}
\newcommand{\sfVdprime}{\mathsf{V}^{\prime \prime}}
\newcommand{\gminusone}{\mathfrak{g}_{-\frac{1}{m}}}

\newcommand{\eva}{\mathrm{eva}}

% \newcommand\iso{\xrightarrow{
%    \,\smash{\raisebox{-0.65ex}{\ensuremath{\scriptstyle\sim}}}\,}}

\def\Ueven{{U_{\rm{even}}}}
\def\Uodd{{U_{\rm{odd}}}}
\def\ttau{\tilde{\tau}}
\def\Wcp{W}
\def\Kur{{K^{\mathrm{u}}}}

\def\Im{\operatorname{Im}}


\providecommand{\bcN}{{\overline{\cN}}}



\makeatletter

\def\gen#1{\left\langle
    #1
      \right\rangle}
\makeatother

\makeatletter
\def\inn#1#2{\left\langle
      \def\ta{#1}\def\tb{#2}
      \ifx\ta\@empty{\;} \else {\ta}\fi ,
      \ifx\tb\@empty{\;} \else {\tb}\fi
      \right\rangle}
\def\binn#1#2{\left\lAngle
      \def\ta{#1}\def\tb{#2}
      \ifx\ta\@empty{\;} \else {\ta}\fi ,
      \ifx\tb\@empty{\;} \else {\tb}\fi
      \right\rAngle}
\makeatother

\makeatletter
\def\binn#1#2{\overline{\inn{#1}{#2}}}
\makeatother


\def\innwi#1#2{\inn{#1}{#2}_{W_i}}
\def\innw#1#2{\inn{#1}{#2}_{\bfW}}
\def\innv#1#2{\inn{#1}{#2}_{\bfV}}
\def\innbfv#1#2{\inn{#1}{#2}_{\bfV}}
\def\innvi#1#2{\inn{#1}{#2}_{V_i}}
\def\innvp#1#2{\inn{#1}{#2}_{\bfV'}}
\def\innp#1#2{\inn{#1}{#2}'}

% choose one of then
\def\simrightarrow{\iso}
\def\surj{\twoheadrightarrow}
%\def\simrightarrow{\xrightarrow{\sim}}

\newcommand\iso{\xrightarrow{
   \,\smash{\raisebox{-0.65ex}{\ensuremath{\scriptstyle\sim}}}\,}}

\newcommand\riso{\xleftarrow{
   \,\smash{\raisebox{-0.65ex}{\ensuremath{\scriptstyle\sim}}}\,}}









\usepackage{xparse}
\def\usecsname#1{\csname #1\endcsname}
\def\useLetter#1{#1}
\def\usedbletter#1{#1#1}

% \def\useCSf#1{\csname f#1\endcsname}

\ExplSyntaxOn

\def\mydefcirc#1#2#3{\expandafter\def\csname
  circ#3{#1}\endcsname{{}^\circ {#2{#1}}}}
\def\mydefvec#1#2#3{\expandafter\def\csname
  vec#3{#1}\endcsname{\vec{#2{#1}}}}
\def\mydefdot#1#2#3{\expandafter\def\csname
  dot#3{#1}\endcsname{\dot{#2{#1}}}}

\def\mydefacute#1#2#3{\expandafter\def\csname a#3{#1}\endcsname{\acute{#2{#1}}}}
\def\mydefbr#1#2#3{\expandafter\def\csname br#3{#1}\endcsname{\breve{#2{#1}}}}
\def\mydefbar#1#2#3{\expandafter\def\csname bar#3{#1}\endcsname{\bar{#2{#1}}}}
\def\mydefhat#1#2#3{\expandafter\def\csname hat#3{#1}\endcsname{\hat{#2{#1}}}}
\def\mydefwh#1#2#3{\expandafter\def\csname wh#3{#1}\endcsname{\widehat{#2{#1}}}}
\def\mydeft#1#2#3{\expandafter\def\csname t#3{#1}\endcsname{\tilde{#2{#1}}}}
\def\mydefu#1#2#3{\expandafter\def\csname u#3{#1}\endcsname{\underline{#2{#1}}}}
\def\mydefr#1#2#3{\expandafter\def\csname r#3{#1}\endcsname{\mathrm{#2{#1}}}}
\def\mydefb#1#2#3{\expandafter\def\csname b#3{#1}\endcsname{\mathbb{#2{#1}}}}
\def\mydefwt#1#2#3{\expandafter\def\csname wt#3{#1}\endcsname{\widetilde{#2{#1}}}}
%\def\mydeff#1#2#3{\expandafter\def\csname f#3{#1}\endcsname{\mathfrak{#2{#1}}}}
\def\mydefbf#1#2#3{\expandafter\def\csname bf#3{#1}\endcsname{\mathbf{#2{#1}}}}
\def\mydefc#1#2#3{\expandafter\def\csname c#3{#1}\endcsname{\mathcal{#2{#1}}}}
\def\mydefsf#1#2#3{\expandafter\def\csname sf#3{#1}\endcsname{\mathsf{#2{#1}}}}
\def\mydefs#1#2#3{\expandafter\def\csname s#3{#1}\endcsname{\mathscr{#2{#1}}}}
\def\mydefcks#1#2#3{\expandafter\def\csname cks#3{#1}\endcsname{{\check{
        \csname s#2{#1}\endcsname}}}}
\def\mydefckc#1#2#3{\expandafter\def\csname ckc#3{#1}\endcsname{{\check{
      \csname c#2{#1}\endcsname}}}}
\def\mydefck#1#2#3{\expandafter\def\csname ck#3{#1}\endcsname{{\check{#2{#1}}}}}

\cs_new:Npn \mydeff #1#2#3 {\cs_new:cpn {f#3{#1}} {\mathfrak{#2{#1}}}}

\cs_new:Npn \doGreek #1
{
  \clist_map_inline:nn {alpha,beta,gamma,Gamma,delta,Delta,epsilon,varepsilon,zeta,eta,theta,vartheta,Theta,iota,kappa,lambda,Lambda,mu,nu,xi,Xi,pi,Pi,rho,sigma,varsigma,Sigma,tau,upsilon,Upsilon,phi,varphi,Phi,chi,psi,Psi,omega,Omega,tG} {#1{##1}{\usecsname}{\useLetter}}
}

\cs_new:Npn \doSymbols #1
{
  \clist_map_inline:nn {otimes,boxtimes} {#1{##1}{\usecsname}{\useLetter}}
}

\cs_new:Npn \doAtZ #1
{
  \clist_map_inline:nn {A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z} {#1{##1}{\useLetter}{\useLetter}}
}

\cs_new:Npn \doatz #1
{
  \clist_map_inline:nn {a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z} {#1{##1}{\useLetter}{\usedbletter}}
}

\cs_new:Npn \doallAtZ
{
\clist_map_inline:nn {mydefsf,mydeft,mydefu,mydefwh,mydefhat,mydefr,mydefwt,mydeff,mydefb,mydefbf,mydefc,mydefs,mydefck,mydefcks,mydefckc,mydefbar,mydefvec,mydefcirc,mydefdot,mydefbr,mydefacute} {\doAtZ{\csname ##1\endcsname}}
}

\cs_new:Npn \doallatz
{
\clist_map_inline:nn {mydefsf,mydeft,mydefu,mydefwh,mydefhat,mydefr,mydefwt,mydeff,mydefb,mydefbf,mydefc,mydefs,mydefck,mydefbar,mydefvec,mydefdot,mydefbr,mydefacute} {\doatz{\csname ##1\endcsname}}
}

\cs_new:Npn \doallGreek
{
\clist_map_inline:nn {mydefck,mydefwt,mydeft,mydefwh,mydefbar,mydefu,mydefvec,mydefcirc,mydefdot,mydefbr,mydefacute} {\doGreek{\csname ##1\endcsname}}
}

\cs_new:Npn \doallSymbols
{
\clist_map_inline:nn {mydefck,mydefwt,mydeft,mydefwh,mydefbar,mydefu,mydefvec,mydefcirc,mydefdot} {\doSymbols{\csname ##1\endcsname}}
}



\cs_new:Npn \doGroups #1
{
  \clist_map_inline:nn {GL,Sp,rO,rU,fgl,fsp,foo,fuu,fkk,fuu,ufkk,uK} {#1{##1}{\usecsname}{\useLetter}}
}

\cs_new:Npn \doallGroups
{
\clist_map_inline:nn {mydeft,mydefu,mydefwh,mydefhat,mydefwt,mydefck,mydefbar} {\doGroups{\csname ##1\endcsname}}
}


\cs_new:Npn \decsyms #1
{
\clist_map_inline:nn {#1} {\expandafter\DeclareMathOperator\csname ##1\endcsname{##1}}
}

\decsyms{Mp,id,SL,Sp,SU,SO,GO,GSO,GU,GSp,PGL,Pic,Lie,Mat,Ker,Hom,Ext,Ind,reg,res,inv,Isom,Det,Tr,Norm,Sym,Span,Stab,Spec,PGSp,PSL,tr,Ad,Br,Ch,Cent,End,Aut,Dvi,Frob,Gal,GL,Gr,DO,ur,vol,ab,Nil,Supp,rank,Sign}

\def\abs#1{\left|{#1}\right|}
\def\norm#1{{\left\|{#1}\right\|}}


% \NewDocumentCommand\inn{m m}{
% \left\langle
% \IfValueTF{#1}{#1}{000}
% ,
% \IfValueTF{#2}{#2}{000}
% \right\rangle
% }
\NewDocumentCommand\cent{o m }{
  \IfValueTF{#1}{
    \mathop{Z}_{#1}{(#2)}}
  {\mathop{Z}{(#2)}}
}


\def\fsl{\mathfrak{sl}}
\def\fsp{\mathfrak{sp}}


%\def\cent#1#2{{\mathrm{Z}_{#1}({#2})}}


\doallAtZ
\doallatz
\doallGreek
\doallGroups
\doallSymbols
\ExplSyntaxOff


% \usepackage{geometry,amsthm,graphics,tabularx,amssymb,shapepar}
% \usepackage{amscd}
% \usepackage{mathrsfs}


\usepackage{diagbox}
% Update the information and uncomment if AMS is not the copyright
% holder.
%\copyrightinfo{2006}{American Mathematical Society}
%\usepackage{nicematrix}
\usepackage{arydshln}
\usepackage[mode=buildnew]{standalone}% requires -shell-escape

\usepackage{tikz,etoolbox}
\usetikzlibrary{matrix,arrows,positioning,backgrounds}
\usetikzlibrary{decorations.pathmorphing,decorations.pathreplacing}
\usetikzlibrary{cd}
% \usetikzlibrary{external}
%   \tikzexternalize
% \usetikzlibrary{cd}

%  \AtBeginEnvironment{tikzcd}{\tikzexternaldisable}
%  \AtEndEnvironment{tikzcd}{\tikzexternalenable}

%  \usetikzlibrary{matrix,arrows,positioning,backgrounds}
%  \usetikzlibrary{decorations.pathmorphing,decorations.pathreplacing}

% % externalization not work properly
% % \usetikzlibrary{external}
% \tikzexternalize[prefix=figures/]
% % % activate the following such that you can check the macro expansion in
% % % *-figure0.md5 manually
% %\tikzset{external/up to date check=diff}
% \usepackage{environ}

% \def\temp{&} \catcode`&=\active \let&=\temp

% \newcommand{\mytikzcdcontext}[2]{
%   \begin{tikzpicture}[baseline=(maintikzcdnode.base)]
%     \node (maintikzcdnode) [inner sep=0, outer sep=0] {\begin{tikzcd}[#2]
%         #1
%     \end{tikzcd}};
%   \end{tikzpicture}}

% \NewEnviron{mytikzcd}[1][]{%
% % In the following, we need \BODY to expanded before \mytikzcdcontext
% % such that the md5 function gets the tikzcd content with \BODY expanded.
% % Howerver, expand it only once, because the \tikz-macros aren't
% % defined at this point yet. The same thing holds for the arguments to
% % the tikzcd-environment.
% \def\myargs{#1}%
% \edef\mydiagram{\noexpand\mytikzcdcontext{\expandonce\BODY}{\expandonce\myargs}}%
% \mydiagram%
% }

\usepackage{upgreek}

\usepackage{listings}
\lstset{
    basicstyle=\ttfamily\tiny,
    keywordstyle=\color{black},
    commentstyle=\color{white}, % white comments
    stringstyle=\ttfamily, % typewriter type for strings
    showstringspaces=false,
    breaklines=true,
    emph={Output},emphstyle=\color{blue},
} 

\newcommand{\BA}{{\mathbb{A}}}
%\newcommand{\BB}{{\mathbb {B}}}
\newcommand{\BC}{{\mathbb {C}}}
\newcommand{\BD}{{\mathbb {D}}}
\newcommand{\BE}{{\mathbb {E}}}
\newcommand{\BF}{{\mathbb {F}}}
\newcommand{\BG}{{\mathbb {G}}}
\newcommand{\BH}{{\mathbb {H}}}
\newcommand{\BI}{{\mathbb {I}}}
\newcommand{\BJ}{{\mathbb {J}}}
\newcommand{\BK}{{\mathbb {U}}}
\newcommand{\BL}{{\mathbb {L}}}
\newcommand{\BM}{{\mathbb {M}}}
\newcommand{\BN}{{\mathbb {N}}}
\newcommand{\BO}{{\mathbb {O}}}
\newcommand{\BP}{{\mathbb {P}}}
\newcommand{\BQ}{{\mathbb {Q}}}
\newcommand{\BR}{{\mathbb {R}}}
\newcommand{\BS}{{\mathbb {S}}}
\newcommand{\BT}{{\mathbb {T}}}
\newcommand{\BU}{{\mathbb {U}}}
\newcommand{\BV}{{\mathbb {V}}}
\newcommand{\BW}{{\mathbb {W}}}
\newcommand{\BX}{{\mathbb {X}}}
\newcommand{\BY}{{\mathbb {Y}}}
\newcommand{\BZ}{{\mathbb {Z}}}
\newcommand{\Bk}{{\mathbf {k}}}

\newcommand{\CA}{{\mathcal {A}}}
\newcommand{\CB}{{\mathcal {B}}}
\newcommand{\CC}{{\mathcal {C}}}

\newcommand{\CE}{{\mathcal {E}}}
\newcommand{\CF}{{\mathcal {F}}}
\newcommand{\CG}{{\mathcal {G}}}
\newcommand{\CH}{{\mathcal {H}}}
\newcommand{\CI}{{\mathcal {I}}}
\newcommand{\CJ}{{\mathcal {J}}}
\newcommand{\CK}{{\mathcal {K}}}
\newcommand{\CL}{{\mathcal {L}}}
\newcommand{\CM}{{\mathcal {M}}}
\newcommand{\CN}{{\mathcal {N}}}
\newcommand{\CO}{{\mathcal {O}}}
\newcommand{\CP}{{\mathcal {P}}}
\newcommand{\CQ}{{\mathcal {Q}}}
\newcommand{\CR}{{\mathcal {R}}}
\newcommand{\CS}{{\mathcal {S}}}
\newcommand{\CT}{{\mathcal {T}}}
\newcommand{\CU}{{\mathcal {U}}}
\newcommand{\CV}{{\mathcal {V}}}
\newcommand{\CW}{{\mathcal {W}}}
\newcommand{\CX}{{\mathcal {X}}}
\newcommand{\CY}{{\mathcal {Y}}}
\newcommand{\CZ}{{\mathcal {Z}}}


\newcommand{\RA}{{\mathrm {A}}}
\newcommand{\RB}{{\mathrm {B}}}
\newcommand{\RC}{{\mathrm {C}}}
\newcommand{\RD}{{\mathrm {D}}}
\newcommand{\RE}{{\mathrm {E}}}
\newcommand{\RF}{{\mathrm {F}}}
\newcommand{\RG}{{\mathrm {G}}}
\newcommand{\RH}{{\mathrm {H}}}
\newcommand{\RI}{{\mathrm {I}}}
\newcommand{\RJ}{{\mathrm {J}}}
\newcommand{\RK}{{\mathrm {K}}}
\newcommand{\RL}{{\mathrm {L}}}
\newcommand{\RM}{{\mathrm {M}}}
\newcommand{\RN}{{\mathrm {N}}}
\newcommand{\RO}{{\mathrm {O}}}
\newcommand{\RP}{{\mathrm {P}}}
\newcommand{\RQ}{{\mathrm {Q}}}
%\newcommand{\RR}{{\mathrm {R}}}
\newcommand{\RS}{{\mathrm {S}}}
\newcommand{\RT}{{\mathrm {T}}}
\newcommand{\RU}{{\mathrm {U}}}
\newcommand{\RV}{{\mathrm {V}}}
\newcommand{\RW}{{\mathrm {W}}}
\newcommand{\RX}{{\mathrm {X}}}
\newcommand{\RY}{{\mathrm {Y}}}
\newcommand{\RZ}{{\mathrm {Z}}}

\DeclareMathOperator{\absNorm}{\mathfrak{N}}
\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\LAnn}{L-Ann}
\DeclareMathOperator{\RAnn}{R-Ann}
\DeclareMathOperator{\ind}{ind}
%\DeclareMathOperator{\Ind}{Ind}



\def\ckbfG{\check{\bfG}}

\newcommand{\cod}{{\mathrm{cod}}}
\newcommand{\cont}{{\mathrm{cont}}}
\newcommand{\cl}{{\mathrm{cl}}}
\newcommand{\cusp}{{\mathrm{cusp}}}

\newcommand{\disc}{{\mathrm{disc}}}



\newcommand{\Gm}{{\mathbb{G}_m}}



\newcommand{\I}{{\mathrm{I}}}

\newcommand{\Jac}{{\mathrm{Jac}}}
\newcommand{\PM}{{\mathrm{PM}}}


\newcommand{\new}{{\mathrm{new}}}
\newcommand{\NS}{{\mathrm{NS}}}
\newcommand{\N}{{\mathrm{N}}}

\newcommand{\ord}{{\mathrm{ord}}}

%\newcommand{\rank}{{\mathrm{rank}}}

\newcommand{\rk}{{\mathrm{k}}}
\newcommand{\rr}{{\mathrm{r}}}
\newcommand{\rh}{{\mathrm{h}}}

\newcommand{\Sel}{{\mathrm{Sel}}}
\newcommand{\Sim}{{\mathrm{Sim}}}

\newcommand{\wt}{\widetilde}
\newcommand{\wh}{\widehat}
\newcommand{\pp}{\frac{\partial\bar\partial}{\pi i}}
\newcommand{\pair}[1]{\langle {#1} \rangle}
\newcommand{\wpair}[1]{\left\{{#1}\right\}}
\newcommand{\intn}[1]{\left( {#1} \right)}
\newcommand{\sfrac}[2]{\left( \frac {#1}{#2}\right)}
\newcommand{\ds}{\displaystyle}
\newcommand{\ov}{\overline}
\newcommand{\incl}{\hookrightarrow}
\newcommand{\lra}{\longrightarrow}
\newcommand{\imp}{\Longrightarrow}
%\newcommand{\lto}{\longmapsto}
\newcommand{\bs}{\backslash}

\newcommand{\cover}[1]{\widetilde{#1}}

\renewcommand{\vsp}{{\vspace{0.2in}}}

\newcommand{\Norma}{\operatorname{N}}
\newcommand{\Ima}{\operatorname{Im}}
\newcommand{\con}{\textit{C}}
\newcommand{\gr}{\operatorname{gr}}
\newcommand{\ad}{\operatorname{ad}}
\newcommand{\der}{\operatorname{der}}
\newcommand{\dif}{\operatorname{d}\!}
\newcommand{\pro}{\operatorname{pro}}
\newcommand{\Ev}{\operatorname{Ev}}
% \renewcommand{\span}{\operatorname{span}} \span is an innernal command.
%\newcommand{\degree}{\operatorname{deg}}
\newcommand{\Invf}{\operatorname{Invf}}
\newcommand{\Inv}{\operatorname{Inv}}
\newcommand{\slt}{\operatorname{SL}_2(\mathbb{R})}
%\newcommand{\temp}{\operatorname{temp}}
%\newcommand{\otop}{\operatorname{top}}
%\renewcommand{\small}{\operatorname{small}}
\newcommand{\HC}{\operatorname{HC}}
\newcommand{\lef}{\operatorname{left}}
\newcommand{\righ}{\operatorname{right}}
\newcommand{\Diff}{\operatorname{DO}}
\newcommand{\diag}{\operatorname{diag}}
\newcommand{\sh}{\varsigma}
\newcommand{\sch}{\operatorname{sch}}
%\newcommand{\oleft}{\operatorname{left}}
%\newcommand{\oright}{\operatorname{right}}
\newcommand{\open}{\operatorname{open}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\triv}{\operatorname{triv}}
\newcommand{\Sh}{\operatorname{Sh}}
\newcommand{\oN}{\operatorname{N}}

\newcommand{\oc}{\operatorname{c}}
\newcommand{\od}{\operatorname{d}}
\newcommand{\os}{\operatorname{s}}
\newcommand{\ol}{\operatorname{l}}
\newcommand{\oL}{\operatorname{L}}
\newcommand{\oJ}{\operatorname{J}}
\newcommand{\oH}{\operatorname{H}}
\newcommand{\oO}{\operatorname{O}}
\newcommand{\oS}{\operatorname{S}}
\newcommand{\oR}{\operatorname{R}}
\newcommand{\oT}{\operatorname{T}}
%\newcommand{\rU}{\operatorname{U}}
\newcommand{\oZ}{\operatorname{Z}}
\newcommand{\oD}{\textit{D}}
\newcommand{\oW}{\textit{W}}
\newcommand{\oE}{\operatorname{E}}
\newcommand{\oP}{\operatorname{P}}
\newcommand{\PD}{\operatorname{PD}}
\newcommand{\oU}{\operatorname{U}}

\newcommand{\gC}{{\mathfrak g}_{\C}}
%\renewcommand{\sl}{\mathfrak s \mathfrak l}
\newcommand{\gl}{\mathfrak g \mathfrak l}


\newcommand{\re}{\mathrm e}

\renewcommand{\rk}{\mathrm k}

\newcommand{\Z}{\mathbb{Z}}
\DeclareDocumentCommand{\C}{}{\mathbb{C}}
\newcommand{\R}{\mathbb R}
\newcommand{\Q}{\mathbb Q}
\renewcommand{\H}{\mathbb{H}}
%\newcommand{\N}{\mathbb{N}}
\newcommand{\K}{\mathbb{K}}
%\renewcommand{\S}{\mathbf S}
\newcommand{\M}{\mathbf{M}}
\newcommand{\A}{\mathbb{A}}
\newcommand{\B}{\mathbf{B}}
%\renewcommand{\G}{\mathbf{G}}
\newcommand{\V}{\mathbf{V}}
\newcommand{\W}{\mathbf{W}}
\newcommand{\F}{\mathbf{F}}
\newcommand{\E}{\mathbf{E}}
%\newcommand{\J}{\mathbf{J}}
\renewcommand{\H}{\mathbf{H}}
\newcommand{\X}{\mathbf{X}}
\newcommand{\Y}{\mathbf{Y}}
%\newcommand{\RR}{\mathcal R}
\newcommand{\FF}{\mathcal F}
%\newcommand{\BB}{\mathcal B}
\newcommand{\HH}{\mathcal H}
%\newcommand{\UU}{\mathcal U}
%\newcommand{\MM}{\mathcal M}
%\newcommand{\CC}{\mathcal C}
%\newcommand{\DD}{\mathcal D}
%\def\eDD{\mathrm{d}^{e}}
%\def\eDD{\bigtriangledown}
\def\eDD{\overline{\nabla}}
\def\eDDo{\overline{\nabla}_1}
%\def\eDD{\mathrm{d}}
\def\DD{\nabla}
\def\DDc{\boldsymbol{\nabla}}
\def\gDD{\nabla^{\mathrm{gen}}}
\def\gDDc{\boldsymbol{\nabla}^{\mathrm{gen}}}
%\newcommand{\OO}{\mathcal O}
%\newcommand{\ZZ}{\mathcal Z}
\newcommand{\ve}{{\vee}}
\newcommand{\aut}{\mathcal A}
\newcommand{\ii}{\mathbf{i}}
\newcommand{\jj}{\mathbf{j}}
\newcommand{\kk}{\mathbf{k}}

\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\bp}{\bigskip}
\newcommand{\be}{\begin {equation}}
\newcommand{\ee}{\end {equation}}

\newcommand{\LRleq}{\stackrel{LR}{\leq}}

\numberwithin{equation}{section}


\def\flushl#1{\ifmmode\makebox[0pt][l]{${#1}$}\else\makebox[0pt][l]{#1}\fi}
\def\flushr#1{\ifmmode\makebox[0pt][r]{${#1}$}\else\makebox[0pt][r]{#1}\fi}
\def\flushmr#1{\makebox[0pt][r]{${#1}$}}


%\theoremstyle{Theorem}
% \newtheorem*{thmM}{Main Theorem}
% \crefformat{thmM}{main theorem}
% \Crefformat{thmM}{Main Theorem}
\newtheorem*{thm*}{Theorem}
\newtheorem{thm}{Theorem}[section]
\newtheorem{thml}[thm]{Theorem}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{obs}[thm]{Observation}
\newtheorem{lemt}[thm]{Lemma}
\newtheorem*{lem*}{Lemma}
\newtheorem{whyp}[thm]{Working Hypothesis}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{prpt}[thm]{Proposition}
\newtheorem{prpl}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
%\newtheorem*{prop*}{Proposition}
\newtheorem{claim}[thm]{Claim}
\newtheorem*{claim*}{Claim}
%\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{dfnl}[thm]{Definition}
\newtheorem*{IndH}{Induction Hypothesis}

\newtheorem*{eg*}{Example}
\newtheorem{eg}[thm]{Example}

\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem*{remarks}{Remarks}


\def\cpc{\sigma}
\def\ccJ{\epsilon\dotepsilon}
\def\ccL{c_L}

\def\wtbfK{\widetilde{\bfK}}
%\def\abfV{\acute{\bfV}}
\def\AbfV{\acute{\bfV}}
%\def\afgg{\acute{\fgg}}
%\def\abfG{\acute{\bfG}}
\def\abfV{\bfV'}
\def\afgg{\fgg'}
\def\abfG{\bfG'}

\def\half{{\tfrac{1}{2}}}
\def\ihalf{{\tfrac{\mathbf i}{2}}}
\def\slt{\fsl_2(\bC)}
\def\sltr{\fsl_2(\bR)}

% \def\Jslt{{J_{\fslt}}}
% \def\Lslt{{L_{\fslt}}}
\def\slee{{
\begin{pmatrix}
 0 & 1\\
 0 & 0
\end{pmatrix}
}}
\def\slff{{
\begin{pmatrix}
 0 & 0\\
 1 & 0
\end{pmatrix}
}}\def\slhh{{
\begin{pmatrix}
 1 & 0\\
 0 & -1
\end{pmatrix}
}}
\def\sleei{{
\begin{pmatrix}
 0 & i\\
 0 & 0
\end{pmatrix}
}}
\def\slxx{{\begin{pmatrix}
-\ihalf & \half\\
\phantom{-}\half & \ihalf
\end{pmatrix}}}
% \def\slxx{{\begin{pmatrix}
% -\sqrt{-1}/2 & 1/2\\
% 1/2 & \sqrt{-1}/2
% \end{pmatrix}}}
\def\slyy{{\begin{pmatrix}
\ihalf & \half\\
\half & -\ihalf
\end{pmatrix}}}
\def\slxxi{{\begin{pmatrix}
+\half & -\ihalf\\
-\ihalf & -\half
\end{pmatrix}}}
\def\slH{{\begin{pmatrix}
   0   & -\mathbf i\\
\mathbf i & 0
\end{pmatrix}}
}

\ExplSyntaxOn
\clist_map_inline:nn {J,L,C,X,Y,H,c,e,f,h,}{
  \expandafter\def\csname #1slt\endcsname{{\mathring{#1}}}}
\ExplSyntaxOff


\def\Mop{\fT}

\def\fggJ{\fgg_J}
\def\fggJp{\fgg'_{J'}}

\def\NilGC{\Nil_{\bfG}(\fgg)}
\def\NilGCp{\Nil_{\bfG'}(\fgg')}
\def\Nilgp{\Nil_{\fgg'_{J'}}}
\def\Nilg{\Nil_{\fgg_{J}}}
%\def\NilP'{\Nil_{\fpp'}}
\def\peNil{\Nil^{\mathrm{pe}}}
\def\dpeNil{\Nil^{\mathrm{dpe}}}
\def\nNil{\Nil^{\mathrm n}}
\def\eNil{\Nil^{\mathrm e}}


\NewDocumentCommand{\NilP}{t'}{
\IfBooleanTF{#1}{\Nil_{\fpp'}}{\Nil_\fpp}
}

\def\KS{\mathsf{KS}}
\def\MM{\bfM}
\def\MMP{M}

\NewDocumentCommand{\KTW}{o g}{
  \IfValueTF{#2}{
    \left.\varsigma_{\IfValueT{#1}{#1}}\right|_{#2}}{
    \varsigma_{\IfValueT{#1}{#1}}}
}
\def\IST{\rho}
\def\tIST{\trho}

\NewDocumentCommand{\CHI}{o g}{
  \IfValueTF{#1}{
    {\chi}_{\left[#1\right]}}{
    \IfValueTF{#2}{
      {\chi}_{\left(#2\right)}}{
      {\chi}}
  }
}
\NewDocumentCommand{\PR}{g}{
  \IfValueTF{#1}{
    \mathop{\pr}_{\left(#1\right)}}{
    \mathop{\pr}}
}
\NewDocumentCommand{\XX}{g}{
  \IfValueTF{#1}{
    {\cX}_{\left(#1\right)}}{
    {\cX}}
}
\NewDocumentCommand{\PP}{g}{
  \IfValueTF{#1}{
    {\fpp}_{\left(#1\right)}}{
    {\fpp}}
}
\NewDocumentCommand{\LL}{g}{
  \IfValueTF{#1}{
    {\bfL}_{\left(#1\right)}}{
    {\bfL}}
}
\NewDocumentCommand{\ZZ}{g}{
  \IfValueTF{#1}{
    {\cZ}_{\left(#1\right)}}{
    {\cZ}}
}

\NewDocumentCommand{\WW}{g}{
  \IfValueTF{#1}{
    {\bfW}_{\left(#1\right)}}{
    {\bfW}}
}




\def\gpi{\wp}
\NewDocumentCommand\KK{g}{
\IfValueTF{#1}{K_{(#1)}}{K}}
% \NewDocumentCommand\OO{g}{
% \IfValueTF{#1}{\cO_{(#1)}}{K}}
\NewDocumentCommand\XXo{d()}{
\IfValueTF{#1}{\cX^\circ_{(#1)}}{\cX^\circ}}
\def\bfWo{\bfW^\circ}
\def\bfWoo{\bfW^{\circ \circ}}
\def\bfWg{\bfW^{\mathrm{gen}}}
\def\Xg{\cX^{\mathrm{gen}}}
\def\Xo{\cX^\circ}
\def\Xoo{\cX^{\circ \circ}}
\def\fppo{\fpp^\circ}
\def\fggo{\fgg^\circ}
\NewDocumentCommand\ZZo{g}{
\IfValueTF{#1}{\cZ^\circ_{(#1)}}{\cZ^\circ}}

% \ExplSyntaxOn
% \NewDocumentCommand{\bcO}{t' E{^_}{{}{}}}{
%   \overline{\cO\sb{\use_ii:nn#2}\IfBooleanTF{#1}{^{'\use_i:nn#2}}{^{\use_i:nn#2}}
%   }
% }
% \ExplSyntaxOff

\NewDocumentCommand{\bcO}{t'}{
  \overline{\cO\IfBooleanT{#1}{'}}}

\NewDocumentCommand{\oliftc}{g}{
\IfValueTF{#1}{\boldsymbol{\vartheta} (#1)}{\boldsymbol{\vartheta}}
}
\NewDocumentCommand{\oliftr}{g}{
\IfValueTF{#1}{\vartheta_\bR(#1)}{\vartheta_\bR}
}
\NewDocumentCommand{\olift}{g}{
\IfValueTF{#1}{\vartheta(#1)}{\vartheta}
}
% \NewDocumentCommand{\dliftv}{g}{
% \IfValueTF{#1}{\ckvartheta(#1)}{\ckvartheta}
% }
\def\dliftv{\vartheta}
\NewDocumentCommand{\tlift}{g}{
\IfValueTF{#1}{\wtvartheta(#1)}{\wtvartheta}
}

\def\slift{\cL}

\def\BB{\bB}


\def\thetaO#1{\vartheta\left(#1\right)}

\def\bbThetav{\check{\mathbbold{\Theta}}}
\def\Thetav{\check{\Theta}}
\def\thetav{\check{\theta}}

\DeclareDocumentCommand{\NN}{g}{
\IfValueTF{#1}{\fN(#1)}{\fN}
}
\DeclareDocumentCommand{\RR}{m m}{
\fR({#1},{#2})
}

%\DeclareMathOperator*{\sign}{Sign}

% \NewDocumentCommand{\lsign}{m}{
% {}^l\mathrm{Sign}(#1)
% }

% \NewDocumentCommand{\bsign}{m}{
% {}^b\mathrm{Sign}(#1)
% }
%
\def\tsign{{}^t\mathrm{Sign}}
\def\lsign{{}^l\mathrm{Sign}}
\def\bsign{{}^b\mathrm{Sign}}
\def\ssign{\mathrm{Sign}}


\NewDocumentCommand\lnn{t+ t- g}{
  \IfBooleanTF{#1}{{}^l n^+\IfValueT{#3}{(#3)}}{
    \IfBooleanTF{#2}{{}^l n^-\IfValueT{#3}{(#3)}}{}
  }
}


% Fancy bcO, support feature \bcO'^a_b = \overline{\cO'^a_b}
\makeatletter
\def\bcO{\def\O@@{\cO}\@ifnextchar'\@Op\@Onp}
\def\@Opnext{\@ifnextchar^\@Opsp\@Opnsp}
\def\@Op{\afterassignment\@Opnext\let\scratch=}
\def\@Opnsp{\def\O@@{\cO'}\@Otsb}
\def\@Onp{\@ifnextchar^\@Onpsp\@Otsb}
\def\@Opsp^#1{\def\O@@{\cO'^{#1}}\@Otsb}
\def\@Onpsp^#1{\def\O@@{\cO^{#1}}\@Otsb}
\def\@Otsb{\@ifnextchar_\@Osb{\@Ofinalnsb}}
\def\@Osb_#1{\overline{\O@@_{#1}}}
\def\@Ofinalnsb{\overline{\O@@}}

% Fancy \command: \command`#1 will translate to {}^{#1}\bfV, i.e. superscript on the
% lift conner.

\def\defpcmd#1{
  \def\nn@tmp{#1}
  \def\nn@np@tmp{@np@#1}
  \expandafter\let\csname\nn@np@tmp\expandafter\endcsname \csname\nn@tmp\endcsname
  \expandafter\def\csname @pp@#1\endcsname`##1{{}^{##1}{\csname @np@#1\endcsname}}
  \expandafter\def\csname #1\endcsname{\,\@ifnextchar`{\csname
      @pp@#1\endcsname}{\csname @np@#1\endcsname}}
}

% \def\defppcmd#1{
% \expandafter\NewDocumentCommand{\csname #1\endcsname}{##1 }{}
% }



\defpcmd{bfV}
\def\KK{\bfK}\defpcmd{KK}
\defpcmd{bfG}
\def\A{\!A}\defpcmd{A}
\def\K{\!K}\defpcmd{K}
\def\G{G}\defpcmd{G}
\def\J{\!J}\defpcmd{J}
\def\L{\!L}\defpcmd{L}
\def\eps{\epsilon}\defpcmd{eps}
\def\pp{p}\defpcmd{pp}
\defpcmd{wtK}
\makeatother

\def\fggR{\fgg_\bR}
\def\rmtop{{\mathrm{top}}}
\def\dimo{\dim^\circ}

\NewDocumentCommand\LW{g}{
\IfValueTF{#1}{L_{W_{#1}}}{L_{W}}}
%\def\LW#1{L_{W_{#1}}}
\def\JW#1{J_{W_{#1}}}

\def\floor#1{{\lfloor #1 \rfloor}}

\def\KSP{K}
\def\UU{\rU}
\def\UUC{\rU_\bC}
\def\tUUC{\widetilde{\rU}_\bC}
\def\OmegabfW{\Omega_{\bfW}}


\def\BB{\bB}


\def\thetaO#1{\vartheta\left(#1\right)}

\def\Thetav{\check{\Theta}}
\def\thetav{\check{\theta}}

\def\Thetab{\bar{\Theta}}

\def\cKaod{\cK^{\mathrm{aod}}}

%G_V's or G
%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \def\GVr{G_{\bfV}}
% \def\tGVr{\wtG_{\bfV}}
% \def\GVpr{G_{\bfV'}}
% \def\tGVpr{\wtG_{\bfV'}}
% \def\GVpr{G_{\abfV}}
% \def\tGVar{\wtG_{\abfV}}
% \def\GV{\bfG_{\bfV}}
% \def\GVp{\bfG_{\bfV'}}
% \def\KVr{K_{\bfV}}
% \def\tKVr{\wtK_{\bfV}}
% \def\KV{\bfK_{\bfV}}
% \def\KaV{\bfK_{\acute{V}}}

% \def\KV{\bfK}
% \def\KaV{\acute{\bfK}}
% \def\acO{\acute{\cO}}
% \def\asO{\acute{\sO}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\GVr{G}
\def\tGVr{\wtG}
\def\GVpr{G'}
\def\tGVpr{\widetilde{G'}}
\def\GVar{G'}
\def\tGVar{\wtG'}
\def\GV{\bfG}
\def\GVp{\bfG'}
\def\KVr{K_{\bfV}}
\def\tKVr{\wtK_{\bfV}}
\def\KV{\bfK_{\bfV}}
\def\KaV{\bfK_{\acute{V}}}

\def\KV{\bfK}
\def\KaV{\acute{\bfK}}
\def\acO{{\cO'}}
\def\asO{{\sO'}}

\DeclareMathOperator{\sspan}{span}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\sp{{\mathrm{sp}}}

\def\bfLz{\bfL_0}
\def\sOpe{\sO^\perp}
\def\sOpeR{\sO^\perp_\bR}
\def\sOR{\sO_\bR}

\def\ZX{\cZ_{X}}
\def\gdliftv{\vartheta}
\def\gdlift{\vartheta^{\mathrm{gen}}}
\def\bcOp{\overline{\cO'}}
\def\bsO{\overline{\sO}}
\def\bsOp{\overline{\sO'}}
\def\bfVpe{\bfV^\perp}
\def\bfEz{\bfE_0}
\def\bfVn{\bfV^-}
\def\bfEzp{\bfE'_0}

\def\totimes{\widehat{\otimes}}
\def\dotbfV{\dot{\bfV}}

\def\aod{\mathrm{aod}}
\def\unip{\mathrm{unip}}


\def\ssP{{\ddot\cP}}
\def\ssD{\ddot{\bfD}}
\def\ssdd{\ddot{\bfdd}}
\def\phik{\phi_{\fkk}}
\def\phikp{\phi_{\fkk'}}
%\def\bbfK{\breve{\bfK}}
\def\bbfK{\wtbfK}
\def\brrho{\breve{\rho}}

\def\whAX{\widehat{A_X}}
\def\mktvvp{\varsigma_{{\bf V},{\bf V}'}}

\def\Piunip{\Pi^{\mathrm{unip}}}
\def\cf{\emph{cf.} }
\def\Groth{\mathrm{Groth}}
\def\Irr{\mathrm{Irr}}

\def\edrc{\mathrm{DRC}^{\mathrm e}}
\def\drc{\mathrm{DRC}}
\def\drcs{\mathrm{DRC}^{s}}
\def\drcns{\mathrm{DRC}^{ns}}
\def\LS{\mathrm{LS}}
\def\LLS{\mathrm{{}^{\ell} LS}}
\def\LSaod{\mathrm{LS^{aod}}}
\def\Unip{\mathrm{Unip}}
\def\lUnip{\mathrm{{}^{\ell}Unip}}
\def\tbfxx{\tilde{\bfxx}}


\newcommand{\noticed}{noticed }
\newcommand{\ess}{essential }

% Ytableau tweak
\makeatletter
\pgfkeys{/ytableau/options,
  noframe/.default = false,
  noframe/.is choice,
  noframe/true/.code = {%
    \global\let\vrule@YT=\vrule@none@YT
    \global\let\hrule@YT=\hrule@none@YT
  },
  noframe/false/.code = {%
    \global\let\vrule@YT=\vrule@normal@YT
    \global\let\hrule@YT=\hrule@normal@YT
  },
  noframe/on/.style = {noframe/true},
  noframe/off/.style = {noframe/false},
}
\makeatother
%\ytableausetup{noframe=on,smalltableaux}
\ytableausetup{noframe=on,boxsize=1.3em}
\let\ytb=\ytableaushort

\newcommand{\tytb}[1]{{\tiny\ytb{#1}}}

\makeatletter
\newcommand{\dotminus}{\mathbin{\text{\@dotminus}}}

\newcommand{\@dotminus}{%
  \ooalign{\hidewidth\raise1ex\hbox{.}\hidewidth\cr$\m@th-$\cr}%
}
\makeatother


\def\cOp{\cO^{\prime}}
\def\cOpp{\cO^{\prime\prime}}
\def\cLpp{\cL^{\prime\prime}}
\def\cLppp{\cL^{\prime\prime\prime}}
\def\pUpsilon{\Upsilon^+}
\def\nUpsilon{\Upsilon^-}
\def\pcL{\cL^+}
\def\ncL{\cL^-}
\def\pcE{\cE^+}
\def\ncE{\cE^-}
\def\pcC{\cC^+}
\def\ncC{\cC^-}
\def\pcLp{\cL^{\prime+}}
\def\ncLp{\cL^{\prime-}}
\def\pcLpp{\cL^{\prime\prime+}}
\def\ncLpp{\cL^{\prime\prime-}}
\def\pcB{\cB^+}
\def\ncB{\cB^-}
\def\uptaup{\uptau^{\prime}}
\def\uptaupp{\uptau^{\prime\prime}}
\def\uptauppp{\uptau^{\prime\prime\prime}}
\def\taup{\tau^{\prime}}
\def\taupp{\tau^{\prime\prime}}
\def\tauppp{\tau^{\prime\prime\prime}}
\def\cpT{\cT^+}
\def\cnT{\cT^-}
\def\cpB{\cB^+}
\def\cnB{\cB^-}

\def\deltas{\delta^s}
\def\deltans{\delta^{ns}}


\def\uum{{\dotminus}}
\def\uup{\divideontimes}

\def\umm{{=}}
\def\upp{{\ast}}
\def\upp{
  {{\setbox0\hbox{$\times$}
      \rlap{\hbox to \wd0{\hss$+$\hss}}\box0
    }}
}

\begin{document}


\title[]{Combinatorics for unipotent representations}

\author [D. Barbasch] {Dan M. Barbasch}
\address{the Department of Mathematics\\
  310 Malott Hall, Cornell University, Ithaca, New York 14853 }
\email{dmb14@cornell.edu}

\author [J.-J. Ma] {Jia-jun Ma}
\address{School of Mathematical Sciences\\
  Shanghai Jiao Tong University\\
  800 Dongchuan Road, Shanghai, 200240, China} \email{hoxide@sjtu.edu.cn}

\author [B. Sun] {Binyong Sun}
% MCM, HCMS, HLM, CEMS, UCAS,
\address{Academy of Mathematics and Systems Science\\
  Chinese Academy of Sciences\\
  Beijing, 100190, China} \email{sun@math.ac.cn}

\author [C.-B. Zhu] {Chen-Bo Zhu}
\address{Department of Mathematics\\
  National University of Singapore\\
  10 Lower Kent Ridge Road, Singapore 119076} \email{matzhucb@nus.edu.sg}




\subjclass[2000]{22E45, 22E46} \keywords{orbit method, unitary dual, unipotent
  representation, classical group, theta lifting, moment map}

% \thanks{Supported by NSFC Grant 11222101}
\maketitle


\tableofcontents


\delete{
\section{Relevent nilpotent orbits}

Let
\[\cO=(C_{2a},C_{2a-1}, \cdots, C_1,C_0,C_{-1}=0)\]
be a special orbit.  The dual orbit
\[ \ckcO = [R_{2a}\geq R_{2a-1}\geq \cdots \geq R_1\geq R_0].\] The $\ckcO$ is
given by add a box on the longest row of $\cO^T$ and then do $B$-collapse.


\begin{defn}
  Suppose $\bfG$ is type $C$.  An special orbit $\cO$ is called purely even if
  $\ckcO$ only has odd rows.
  This is equivalent to the condition on columns of $\cO$ such that (see \Cref{lem:C.even})
  \begin{enumC}
  \item $C_{2i} \equiv C_{2i-1} \pmod{2}$; 
  \item 
   If $C_{2i-1}$ is even,  $C_{2i-1} > C_{2i-2}$; 
  \item
    If $C_{2i}$ is odd, $C_{2i}=C_{2i-1}$. 
  \end{enumC}
  We call a purely even orbit $\cO$ is stablelly trivial when only even columns
  occures. This is equivalent to  
  \[
    C_{2i} \equiv C_{2i-1} \equiv 0 \pmod{2}  \text{ and } C_{2i-1}>
    C_{2i-2} \quad \forall i.
  \]
  {\color{red} In this case all LS in the unipotent representations are
    irreducible. }
  This is also equivalent to
  \[
    R_{2i}>R_{2i-1} \quad \forall i
  \]

  We call a purely even orbit $\cO$ is theta-admissible when each row columns
  appears at most $2$-times.
  {\color{red} All unipotent representations of these orbits are expected to
    constructed by theta correspondence. Moreover, they are parameterized by the
    their local systems. 
  }
  This is also equivalent to each row lenght appears at most $3$-times in
  $\ckcO$. 
\end{defn}

Suppose $\cO$ is purely even. 
The dual orbit 
$\ckcO = [R_{2a}\geq R_{2a-1}\geq \cdots \geq R_1\geq R_0]$
is calculated in the following way: 
\[
  [R_{2i},R_{2i-1}] = \begin{cases}
    [C_0+1, 0] & i=0\\
    [C_{2i}+1, C_{2i-1}-1] & i>0, C_{2i} \text{ is even} \\
    [C_{2i},C_{2i-1}] & i>0, C_{2i} \text{ is odd}
  \end{cases}
\]


\begin{defn}
  Suppose $\bfG$ is type $D$.  An special orbit
  \[
    \cO=(C_{2a-1}\ge\dots \ge C_0\geq C_{-1}=0) \quad C_{2i}\equiv
    C_{2i-1}\pmod{2}, C_{2a-1} \equiv 0 \pmod{2}
  \]
  is called purley even if
  $\ckcO$ only has odd rows.
  This is equivalent to the condition on columns of $\cO$ such that (see \Cref{lem:C.even})
  \begin{enumC}
  \item $C_{2i} \equiv C_{2i-1} \pmod{2}$; 
  \item 
   If $C_{2i-1}$ is even,  $C_{2i-1} > C_{2i-2}$; 
  \item
    If $C_{2i}$ is odd, $C_{2i}=C_{2i-1}$. 
  \end{enumC}
  Note that this is the same condition as the type C case. 
\end{defn}


Suppose $\cO$ is purely even. 
The dual orbit 
$\ckcO = [R_{2a-1}\geq \cdots \geq R_1\geq R_0, R_{-1}=0]$
is calculated in the following way: 
\[
  [R_{2i},R_{2i-1}] = \begin{cases}
    [C_0+1, 0] & i=0\\
    [0, C_{2a-1}-1] & i = a \\
    [C_{2i}+1, C_{2i-1}-1] & a> i>0, C_{2i} \text{ is even} \\
    [C_{2i},C_{2i-1}] & a>i>0, C_{2i} \text{ is odd}
  \end{cases}
\]
}


\section{Statement of the main result}
\subsection{Nilpotent Orbits}
Let $\bfG = \Sp,  \rO$, and $\cO\in \Nil(\bfG)$ is a complex nilpotent
orbit.
``Type M'' means that $\wtG$ is a metaplectic group. its dual group $\ckbfG$ is a symplectic
group with the same rank, and its duality means the metaplectic dual.
Let $\drc(\cO)$ be the set of dot-r-c diagrams parameterizing unipotent
representations of the real forms of $\bfG$.

We say an orbit $\ckcO\in \Nil(\ckbfG)$ is purely even (good parity in
Moeglin-Renard's notation) if
\begin{des}
 \item[] all row lengths of $\ckcO$ are even when $\ckbfG$ is a symplectic group.
 \item[]  all row lengths of $\ckcO$ are odd when $\ckbfG$ is an orthogonal group.
\end{des}

%The following set of orbit are the purely even case:

\begin{defn} \label{def:noticed}
  Now we describe the nilpotent orbit $\cO\in \Nil(\bfG)$ who is the
  Barbasch-Vogan dual of a purely even orbit $\ckcO$. If $G$ is
  \begin{des}
    \item [Type C] Then
          $\cO$ is special and it has columns
          \[
            ( C_{2k},C_{2k-1},\cdots, C_{1},C_{0}, C_{-1}=0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ if } C_{2i} \text{ is even for
            } i=0, \cdots, k-1.
          \]
           Note that, by the
          definition of special orbit,
          we have $C_{2i}\equiv C_{2i-1} \pmod{2}$, $C_{2i} = C_{2i-1}$ if
          $C_{2i}$ is odd for $i = 1, \cdots k$.
    \item [Type M] Then
          $\cO$ is metaplecitic special and it has columns
          \[
            ( C_{2k},C_{2k-1},\cdots, C_{1},C_{0}=0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ if } C_{2i} \text{ is odd for } i=0, \cdots, k-1.
          \]
          Note that, by the
          definition of metaplectic special,
          we have $C_{2i}\equiv C_{2i-1} \pmod{2}$, $C_{2i} = C_{2i-1}$ if
          $C_{2i}$ is even
          for $i = 1, \cdots k$.
    \item [Type D] and $\cO$ is special and it has columns
          \[
            ( C_{2k+1},C_{2k},C_{2k-1},\cdots, C_{1},C_{0}, C_{-1}=0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ if } C_{2i} \text{ is
              even for } i=0, \cdots, k.
          \]
          Note that, the
          condition is equivalent to $\DD(\cO)$ is purely even of type C and
          $C_{2k+1}$ is always even.
    \item [Type B] and $\cO$ is special and it has columns
          \[
            ( C_{2k+1},C_{2k},C_{2k-1},\cdots, C_{1},C_{0} =0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ if } C_{2i} \text{ is
              odd for } i=0, \cdots, k.
          \]
          Note that, the condition is equivalent to $\DD(\cO)$ is purely even of type M and
          $C_{2k+1}$ is always odd.
  \end{des}
  Let $\dpeNil(\star)$ the set of duals of purely even
  orbits for type $\star=$ B,C,D,M respectively.

  % Under the above notation, $\cO$ is called \emph{\ess} if
  % $C_{2i}=C_{2i-1}$ for all $i$.
\end{defn}


\subsection{Descent of orbits in the purely even case}
  For $\set{\star,\star'} = \set{C,D}, \set{B,M}$, we define the notion of
  descent of orbits. The descent map is defined in the following way
  (under the above notation):

  \[
    %\begin{tikzpicture}
    %\matrix[matrix of math nodes, column sep=0em, row sep=0em]{
    \begin{tikzcd}
      \eDD \colon & \dpeNil(\star) \ar[rr] & \hspace{3em} &
      \dpeNil(\star') \\
      & \cO \ar[rr, maps to] & & \cO'
    \end{tikzcd}
    % };
    %\end{tikzpicture}
  \]
  such that
  \begin{itemize}
    \item when $\star$ is B or D, $\cO':= \DD(\cO)$;
    \item when $\star$ is C or M,
          \[
          \cO':= \begin{cases}
             & \text{if $C_{2k}$ is even and $\star=B$}\\[-0.8em]
            \DD(\cO) & \\[-0.8em]
             & \text{or $C_{2k}$ is odd and $\star=M$};\\
            ( C_{2k-1}+1, C_{2k-2},C_{2k-3},\cdots, C_{0} )  & \text{otherwise}.
          \end{cases}
          \]
          In the second case,  $C_{2k}=C_{{2k-1}}$ and
          $\cO \mapsto \eDD(\cO)$ is a good generalized descent.
  \end{itemize}


The following set of orbit are essential to us:
\begin{defn} \label{def:noticed}
  A nilpotent orbit $\cO\in \Nil(\bfG)$ is called \emph{\noticed} if $G$ is
  \begin{des}
    \item [Type D] and $\cO$ is special and it has columns
          \[
            ( C_{2k+1},C_{2k},C_{2k-1},\cdots, C_{1},C_{0}, C_{-1}=0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ for } i=0, \cdots, k.
          \]
          % Note that, the
          % condition is equivalent to $\DD(\cO)$ is \noticed of type C, i.e.
          %  $C_{2i}\equiv C_{2i-1} \pmod{2}$ and $C_{2i} = C_{2i-1}$ if $C_{2i}$
          %  is odd for $i = 1, \cdots k$.
    \item [Type B] and $\cO$ is special and it has columns
          \[
            ( C_{2k+1},C_{2k},C_{2k-1},\cdots, C_{1},C_{0} =0 )
            \quad \text{such that } C_{2i+1}>C_{2i} \text{ for } i=0, \cdots, k.
          \]
          % Note that, the
          % condition is equivalent to $\DD(\cO)$ is \noticed of type M, i.e.
          %  $C_{2i}\equiv C_{2i-1} \pmod{2}$ and $C_{2i} = C_{2i-1}$ if $C_{2i}$
          %  is even for $i=1, \cdots, k$.
    \item [Type C] and $\eDD(\cO)$ is noticed of type $D$.

          % $\cO$ is special and it has columns
          % \[
          %   [C_{2k},C_{2k-1},\cdots, C_{1},C_{0}, C_{-1}=0]
          %   \quad \text{such that } C_{2i+1}>C_{2i} \text{ for } i=0, \cdots, k-1.
          % \]
          %  Note that, by the
          % definition of special orbit,
          % we have $C_{2i}\equiv C_{2i-1} \pmod{2}$, $C_{2i} = C_{2i-1}$ if
          % $C_{2i}$ is odd for $i = 1, \cdots k$.
    \item [Type M] and $\eDD(\cO)$ is notice of type $B$.
          % $\cO$ is metaplecitic special and it has columns
          % \[
          %   [C_{2k},C_{2k-1},\cdots, C_{1},C_{0}=0]
          %   \quad \text{such that } C_{2i+1}>C_{2i} \text{ for } i=0, \cdots, k-1.
          % \]
          % Note that, by the
          % definition of metaplectic special,
          % we have $C_{2i}\equiv C_{2i-1} \pmod{2}$, $C_{2i} = C_{2i-1}$ if
          % $C_{2i}$ is even
          % for $i = 1, \cdots k$.
  \end{des}
  Furthermore, We say a noticed orbit $\cO$ of type $D$ or $B$ is
  \emph{+noticed}
  if $C_{2k+1}-C_{2k}\geq 2$.
  % Let $\nNil(\star)$ be the set of noticed %and $\eNil(\star)$ be the sets of \noticed and \ess
  % orbits for type $\star=$ B,C,D,M respectively.
\end{defn}

The following inductive definition of noticed orbit is easy to verify.
\begin{lem}
  An orbit $\cO$ of type D (resp. type B) is noticed if and only if
  \begin{enumI}
    \item $\eDD^{2}(\cO)$ is noticed, when
    $C_{2k}$ is even (resp. odd), or
    \item $\eDD^{2}(\cO)$ is +noticed, when $C_{2k}$ is odd (resp. even). \qedhere
  \end{enumI}
\end{lem}

\subsection{Relavent Weyl group representations and dot-r-c diagrams}
Retain the notation  in \Cref{def:noticed}.
Now we describe all relevent representations of the Weyl group appear in the
counting algorithm.


\trivial[h]{
  We use ``$s$'' and ``$d$'' to denote ``$r'$'' and ``$c'$'' in Dan's notes respectively.
}

\begin{des}
  \item[Type D] We define $c_{i}$ as the following
  \[
    \begin{split}
      c_{2i} & := \floor{\frac{C_{2i}}{2}} \quad \text{and}\quad c_{2i-1} =\floor{\frac{C_{2i-1}+1}{2}}
      \quad \forall i=0,1, \cdots, k,\\
      c_{2k+1} & := \frac{C_{2k+1}}{2}
    \end{split}
  \]
  The (special) Weyl group representation associated to the special orbit $\cO$
  has columns
  \[
    \tau = \tau_L\times\tau_R=(c_{2k+1},c_{2k-1},\dots , c_1)\times (c_{2k},\dots ,c_0).
  \]
  The other representations is obtained from the special one by interchanging
  following pairs when $c_{2i-1}\neq c_{2i}+1$ and $i=1, \cdots, k$ (these are
  pairs coming from even length columns)
  \[
    (c_{2i-1},c_{2i} )\longleftrightarrow (c_{2i}+1,c_{2i-1}-1).
  \]
  \trivial[h]{ Note that we always have $c_{2i-1}-1 \geq c_{2i-2}$ by our
    assumptions of the shape of the orbit. }

  The dot-r-c diagrams of type D: For each representation
  $\tau = \tau_L\times \tau_R$, dots are filled in both sides forming the same
  shape of Young diagram, a column of ``$s$'' is added next to dots on the left
  side diagram, a column of ``$r$'' is added next to dots on the left side
  diagram, add a row of ``$c$''s and finally add a row of ``$d$''s on the left
  side of the diagram; Through this procedure, one must make sure that the shape
  of the diagram is a valid Young diagram after each step. \trivial[h]{At most
    one $r$/$s$ is added in each row of the existing dots diagram and at most
    one $c$/$d$ is added to each column.}

  In summary, $s/r/c/d$ are all added on the left diagram.
  Fixing the representation $\tau$, the left diagram $\uptau_{L}$ determin
  $\uptau_{R}$ completely.

  \item[Type C] Set $C_{2k+1}=0$. The Weyl group representations are obtained by
  the same formula of Type D.

  The dot-r-c diagrams of type C are obtained in almost the same way as that of
  type D, except that $s$ are added on the right side of the diagram.

  \item[Type B] We define $c_{i}$ as the following
  \[
    \begin{split}
      c_{2i} & := \floor{\frac{C_{2i}+1}{2}} \quad \text{and}\quad c_{2i-1} =\floor{\frac{C_{2i-1}}{2}}
      \quad \forall i=1,2, \cdots, k,\\
      c_{2k+1} & := \frac{C_{2k+1}-1}{2}
    \end{split}
  \]
 % \trivial[h]{Note that $C_{2k+1}$ is always odd and $C_{0}=0$}
  Note that $C_{2k+1}$ is always odd and $C_{0}=0$.
  The (special)
  Weyl group representation associated to the special orbit $\cO$ has columns
  \[
    \tau = \tau_L\times\tau_R= (c_{2k},\dots ,c_2) \times (c_{2k+1},c_{2k-1},\dots , c_1).
  \]
  The other representations is obtained from the special one by interchanging
  following pairs when $c_{2i-1}\neq c_{2i}+1$ and $i=1, \cdots, k$ (these are
  pairs coming from odd length columns)
  \[
    (c_{2i}, c_{2i-1})\longleftrightarrow (c_{2i-1}, c_{2i}).
  \]
  \trivial[h]{ Note that we always have $c_{2i-1} \geq c_{2i-2}$ by our
    assumptions of the shape of the orbit. }

  The dot-r-c diagrams of type B: For each representation
  $\tau = \tau_L\times \tau_R$, dots are filled in both sides forming the same
  shape of Young diagram, a column of ``$s$'' is added next to dots on the right
  side of the diagram, a column of ``$r$'' is added next to dots on the right
  side diagram, add a row of ``$d$''s on the right side of the diagram, and
  finally add a row of ``$c$''s on the left side of the diagram. Through this
  procedure, one must make sure that the shape of the diagram is a valid Young
  diagram after each step. \trivial[h]{At most one $r$/$s$ is added in each row
    of the existing dots diagram and at most one $c$/$d$ is added to each
    column.}

  In summary, $s/r/d$ are added on the right and $c$ is added on the left.

  Each dot-r-c diagram of type B is extended into two diagrams by adding an
  extra label ``$a$'' or ``$b$''. This extension helps us to determine the
  signature of special orthogonal groups.


  Fixing the representation $\tau$, the right diagram $\uptau_{R}$ determin
  $\uptau_{L}$ completely.

  \item[Type M] Set $C_{2k+1}=0$. The Weyl group representations are obtained by
  the same formula of Type B.

  The dot-r-c diagrams of type M are obtained in almost the same way as the type
  B except that $s$ are added on the left side of the diagram and we do not add
  labels a/b.
\end{des}

We let $\drc(\cO)$ denote the set of dot-r-c diagrams defined above.
Note that for type B, there is an additional mark $a$/$b$ attached to the
diagram.



In addition, for $\star=B,C,D,M$, let
\[
  \drc(\star) := \bigsqcup_{\cO\in \dpeNil(\star)} \drc(\cO).
\]


% By the counting argument established before, it is suffice to establish \Cref{thm:count} for
% \ess orbits.

\subsection{Main theorem}
Let $\LS(\cO)$ denote the Grothendieck group of $\wtbfK$-equivariant local
systems on $\cO$ for various real forms of $\bfG$.
The following is our main theorem on the counting of unipotent representations.

Let $\ckcO$ be a purely even orbit and $\cO$ be its dual orbit.

\begin{thm} \label{thm:count}
  We can define an injective map using convergence range theta lifting:
  \[
    \begin{tikzcd}[column sep=0em, row sep=0em]
      \uppi:& \drc(\cO) \ar[rr] &\hspace{2em} & \Unip(\cO)\\
      & \uptau \ar[rr,maps to] & & \uppi_{\uptau}\\
    \end{tikzcd}
  \]
\begin{enumS}
  \item
  When $\cO$ is of type C or type M, $\uppi$ is a bijection.
  %we have a bijective map
  % \[
  %   \begin{tikzcd}[column sep=0em, row sep=0em]
  %     \uppi:& \drc(\cO) \ar[rr] &\hspace{2em} & \Unip(\cO)\\
  %     & \uptau \ar[rr,maps to] & & \uppi_{\uptau}\\
  %   \end{tikzcd}
  % \]
%  \item
  \item
  When $\cO$ is of type D or type B, the following map is a bijection
  %Suppose $\cO$ is of type D or type B. we have a bijective map
  \[
    \begin{tikzcd}[column sep=0em, row sep=0em]
       \drc(\cO) \times \bZ/2\bZ \ar[rr] &\hspace{2em} & \Unip(\cO)\\
       (\uptau, \varepsilon) \ar[rr,maps to] & & \uppi_{\uptau}\otimes (\det)^{\varepsilon}\\
    \end{tikzcd}
  \]

\item
  All unipotent representations attached to $\cO$ are unitarizable.
\item
  Suppose $\cO$ is noticed. The associated character map is an injective map:
  \[
    \begin{tikzcd}[column sep=0em, row sep=0em]
      \Ch_{\cO}\colon& \Unip(\cO)  \ar[rr,hook] &\hspace{2em} & \LS(\cO)\\
  %    & \uppi \ar[rr,maps to] & & \cL_{\uppi}\\
    \end{tikzcd}
  \]
%\end{thm}
\item
Suppose $\cO$ is quasi-distinguished. The image of associated character map is
  exactly the set of admissible orbit data. In other words, we have a bijection
  \[
    \begin{tikzcd}[column sep=0em, row sep=0em]
      \Ch_{\cO}\colon& \Unip(\cO)  \ar[rr,hook,two heads] &\hspace{2em} & \LSaod(\cO)\\
  %    & \uppi \ar[rr,maps to] & & \cL_{\uppi}\\
    \end{tikzcd}
    %\Ch_{\cO}\colon \Unip(\cO)\longrightarrow \LS^{aod}(\cO).
  \]
\end{enumS}
\end{thm}

% \begin{thm} \label{cor:count}
%   When $\cO$ is dual purely even,
%   \[
%     \Unip(\cO) = \set{\Thetab_{\chi}\neq 0},
%   \]
%   i.e.  all unipotent representations attached to $\cO$ can be
%   constructed by iterated convergent range theta lifting and therefore unitary.

%   Suppose $\cO$ is noticed. Then the map
%   \[
%     \begin{tikzcd}
%       \Ch\colon \Unip(\cO) \ar[r] & \LS(\cO)
%     \end{tikzcd}
%   \]
%   is injective.
%   %% Moreover, every element in $\Unip(\cO)$ can be obtained by iterated theta lifting.
% \end{thm}

{\color{red} According to Moeglin-Renard's work, Arthur's unipotent Arthur packet
  (defined by endoscopic transfer) is constructed by iterated theta lifting.
  The theorem implies that ABV's unipotent Arthur packet coincide with Arthur's.}


Two unipotent representation $\pi_{1}$ and $\pi_{2}$ are called in the same
LS packet if $\cL_{\pi_{1}} = \cL_{\pi_{2}}$.
For a local system $\cL\in \LS(\cO)$, let
\[
  [\cL] = \set{\pi |\Ch_{\cO}(\pi) = \cL}
\]
denote the set of all unipotent representations attached to $\cL$. We call
$[\cL]$ a  LS packet.

\begin{remark}
  \begin{enumR}
    \item
    % The proof is by establish an explicit injection
    % $\drc(\cO)\longrightarrow \set{\Thetab_{\chi}\neq 0}$ inductively.
    We use convergence range theta lift to construct $\uppi$ inductively with
    respect to the number of columns in $\cO$.
    \item
    When $\cO$ is not noticed, a LS packet may not be a singleton
    and we use the injectivity of theta lifting for a fixed dual pair in an essential way.
    \item
    The size of LS packet $[\cL]$ could be arbitrary large  when the size of $\cO$
    groups.
    For example, $\cO$ is the regular orbit of $\Sp(2n,\bC)$, there is only 5 possible
    local systems when $n\geq 3$. But there are $2n+1$ unipotent
    representations. See \Cref{sec:C.reg}.
    \item One will see easily from the proof that the associated character
    $\Ch_{\cO}(\pi)$ for every $\pi\in \Unip(\cO)$ is always multiplicity free.
    Even when $\Ch_{\cO}(\pi)$ is not irreducible, the character of the local
    system attached the same row length in different irreducible components are
    always the same.
  \end{enumR}
\end{remark}

\section{Matching doc-r-c diagrams, local systems, and unipotent representations}



\subsection{Descent maps of dot-r-c diagram in the algorithm}

Suppose $\bfG$ is of type B or D, we define a map
\[
  \begin{tikzcd}[column sep=0em, row sep=0em]
    \Sign \colon&   \drc(B)\sqcup \drc(D) \ar[rr]& \hspace{3em} & \bN\times \bN \\
    & \uptau \ar[rr, maps to]& & (p,q)
  \end{tikzcd}
\]
Here $(p,q)$ is the signature of the orthogonal group $\rO(p,q)$ corresponding
to the dot-r-c diagram $\uptau$, which is calculated by the following formula
\[
  \begin{split}
    p &= \# \bullet+ 2 \# r + \# c + \# d + \# A\\
    q &= \# \bullet+ 2 \# s + \# c + \# d + \# B\\
  \end{split}
\]



Suppose $\cO$ is the trivial orbit of $\Sp(2c_{0},\bR)$ ($c_{0}\geq 0$) or
$\Mp(0,\bR)$ ($c_{0}=0$).
Let
\begin{equation}\label{eq:uptau0}
  \uptau_{\cO}=\ytb{\emptyset,\none,\none}\times\ytb{s,\vdots,s}
\end{equation}
such that there are $c_{0}$-entries marked by ``$s$'' in the right diagram.
Then $\drc(\cO) = \set{\uptau_{\cO}}$ is a singleton.
Define
$\uppi_{\uptau_{\cO}} = \bfone$ the trivial representation of $\Sp(2c_{0},\bR)$ or $\Mp(0,\bR) = \bfone$.
That by convention, $\Sp(0,\bR)=\Mp(0,\bR)$ is the trivial group.
Let
\[
  \drc_{0}(C) = \set{\uptau_{\cO}| \cO = (2c_{0}), c_{0}=0,1,2,\cdots}
  \text{ and }
  \drc_{0}(M) = \set{\uptau_{(0)}=\emptyset \times \emptyset}.
\]


The algorithm of matching dot-r-c diagrams is encoded in the descent map
 $\eDD$ of dot-r-c diagrams defined below.
%For $\set{\star,\star'} = \set{C,D}, \set{B,M}$,
For $(\star,\star') = (D,C), (B,M)$,
we define maps
\[
  \begin{tikzcd}[column sep=0em, row sep=0em]
    \eDD \colon & \drc(\star)\sqcup (\drc(\star')-\drc_{0}(\star')) \ar[rr] & \hspace{2em} &
    \left(\drc(\star')\sqcup \drc(\star) \right)\times \bZ/2\bZ\\
    & \uptau \ar[rr, maps to] &  & (\uptau', \upepsilon).
  \end{tikzcd}
\]
Here
\begin{enumI}
  \item $\uptau$ is in $\drc(\cO)$ where $\cO\in \dpeNil(\star)\sqcup \dpeNil(\star')$;
  \item $\uptau'\in \drc(\cO')$ where $\cO': = \eDD(\cO)$;
  \item i$\upepsilon = 0$ when $\cO\mapsto \cO'$ is a generalized descent from type
  C or M to type B or D.
\end{enumI}
To ease the notations, we define
\[
    \eDDo \colon  \drc(\star)\sqcup (\drc(\star')-\drc_{0}(\star')) \longrightarrow
    \left(\drc(\star')\sqcup \drc(\star) \right)
\]
such that $\eDDo(\uptau)$ is the first component of $\eDD(\uptau)$.

\medskip

We define $\cL$ and $\uppi$ inductively with respect to the number of
columns of $\cO$.
\begin{enumS}
  \item % Suppose $\cO=[C_{0}=0]$ and $\star =  C$ or  $M$. Then
  % $\drc(\cO) = \set{\uptau_{\emptyset}}$ is a singleton with $\uptau_{\emptyset}=(\emptyset,\emptyset)$.
  Our reduction terminates when $\cO$ is the trivial orbit of $\Sp(2c_{0},\bR)$ or
  $\Mp(0,\bR)$.
  In this case,
  $\drc(\cO) = \set{\uptau_{\cO}}$ which is attached to the trivial
  representation.
  We remark that the theta lift of the trivial representation
  $\uppi_{\uptau_{\cO}}=\bfone$ of $\Sp(0,\bR)$ or $\Mp(0,\bR)$ to $\rO(p,q)$ for
  any signature $p,q$ is the trivial representation $\bfone_{p,q}^{+,+}$ of
  $\rO(p,q)$.\footnote{When $c_{0}=0$, this is an assignment by convention.}
  \item Suppose $\cO\in \Nil(\star)\sqcup \Nil(\star')$ is a nontrivial orbit.
  Let $\uptau \in \drc(\cO)$ and
  \[
    (\uptau', \upepsilon) = \eDD(\tau)\in \drc(\cO')\times \bZ/2\bZ \text{ where }\cO' = \eDD(\cO).
  \]
  \begin{enumS}
    \item Suppose $\uptau\in \drc(C)$ or $\drc(M)$. Now $\wtG = \Sp(2n,\bR)$ or
    $\Mp(2n,\bR)$ with $n=\abs{\uptau}$. By induction, $\uptau'$ is attached to
    a unipotent representation $\uppi_{\uptau'}$ of $\wtG' = \rO(p,q)$ where
    $(p,q)=\Sign(\uptau')$. We define
    \[
      \uppi_{\uptau} := \Thetab_{\wtG',\wtG}(\uppi_{\uptau'}\otimes (\det)^{\upepsilon}).
    \]
    Here $\det$ is the determinant character of $\rO(p,q)$.
    \item Suppose $\uptau\in \drc(D)$ or $\drc(B)$. Now $\wtG = \rO(p,q)$ with
    $(p,q) = \Sign(\uptau)$. By induction, $\uptau'$ is attached to a
    unipotent representation of $\wtG'$ where $\wtG' = \Sp(2n,\bR)$ or
    $\Mp(2n,\bR)$ and $n=\abs{\uptau'}$. We define
    \[
      \uppi_{\uptau} := \Thetab_{\wtG',\wtG}(\uppi_{\uptau'})\otimes (\bfone_{p,q}^{+,-})^{\upepsilon}.
    \]
  \end{enumS}
\end{enumS}

We let
\[
  \begin{split}
    \sL_{\uptau} & := \Ch_{\cO}(\uppi_{\uptau}), \text{ and } \\
    % \lUnip(\cO) &= \set{\uppi_{\uptau}|\uptau \in \drc(\cO)} \\
    \LLS(\cO) & := \set{\cL_{\uptau}|\uptau \in \drc(\cO)}
  \end{split}
\]
to be the set of local systems obtained from our algorithm.

We summarize our definitions in the following diagram with $\star=\cO/C/D/B/M$.
% \[
%   \begin{tikzcd}[column sep=0em, row sep=0em]
%  &   \edrc(\star) \ar[rrrr,"\uppi"] \ar[dddd, "\cL"']  & & & & \Unip(\star) \ar[dddd, "\Ch"] \\
%  &   &  \uptau \ar[rr,maps to] \ar[dd,maps to]& \hspace{4em} & \pi_{\uptau}  \ar[lldd,maps to]&  \\[2em]
% \edrc(\star') \times \bZ/2\bZ \ar[ruu,leftarrow,"\eDD"] \ar[ddd,"\cL\times \id"']&   & & &   & \\[2em]
%  &   &\cL_{\uptau} & &   & \\
%  &  \LLS(\star)\ar[rrrr,hook]\ar[ld,"\eDD"] & & & & \LS(\star) \\[3.5em]
%  \LLS(\star')\times \bZ/2\bZ \ar[rrrr,hook]&   & & &\LS(\star')\ar[ru,dashed,"\vartheta"']  & \\
% \end{tikzcd}
% \]
% \[
%   \begin{tikzcd}[column sep=0em, row sep=0em]
%     \drc(\star) \ar[rrrr,"\uppi"] \ar[dddd, "\cL"']  & & & & \Unip(\star) \ar[dddd, "\Ch"] \\
%     &  \uptau \ar[rr,maps to] \ar[dd,maps to]& \hspace{4em} & \pi_{\uptau}  \ar[lldd,maps to]&  \\[2em]
%     &   & & &   & \\[2em]
%     &\cL_{\uptau} & &   & \\
%    \LLS(\star)\ar[rrrr,hook] & & & & \LS(\star) \\
% \end{tikzcd}
% \]
% Here
% \begin{enumC}
%   \item $\uptau$ is in $\drc(\cO)$ where $\cO$ is essential;
%   \item $\uppi_{\uptau}$ is a unipotent representation of $\wtG$ attached to $\cO$;
%   \item $\wtG$ is $\Mp(2n,\bR)$ or $\Sp(2n,\bR)$ if $\star = $ $C$ or $M$;
%   \item $\wtG$ is $\rO(p,q)$ if $\star=$  $B$ or $C$ and $(p,q)=\Sign(\uptau)$;
%   \item
%   % \item For each local system $\cL\in \LLS(\star)$, the descent map $\cL$
%   % \item the left commutative diagram says the descent map $\eDD$ is compatible
%   % with the local system, i.e. it sends
% \end{enumC}

% Let
% \[ \color{red}
% \]
%

\[
  \begin{tikzcd}[column sep=0em, row sep=0em]
    \drc(\star) \ar[rrrr,"\uppi"] \ar[dddd, "\cL"']  & & & & \Unip(\star) \ar[dddd, "\Ch"] \\
    &  \uptau \ar[rr,maps to] \ar[dd,maps to]& \hspace{4em} & \pi_{\uptau}  \ar[dd,maps to]&  \\[2em]
    &   & & &   & \\[2em]
    &\cL_{\uptau} \ar[rr,<->]& &  \sL_{\uptau} & \\
   \KM(\star)\ar[rrrr,hook,two heads] & & & & \LS(\star) \\
\end{tikzcd}
\]

Here $\KM(\star)$ is a combinatiorially defined monoid parameterizing the local
systems on the relevent nilpotent orbits, see.

\section{The definition of $\eDD$ }
\def\taur{\uptau_{R}}
\def\taul{\uptau_{L}}
\def\taulf{\uptau_{L,0}}
\def\tauls{\uptau_{L,1}}
\def\taurf{\uptau_{R,0}}
\def\taurs{\uptau_{R,1}}

\def\tauplf{\uptau'_{L,0}}
\def\taupls{\uptau'_{L,1}}
\def\tauprf{\uptau'_{R,0}}
\def\tauprs{\uptau'_{R,1}}
\def\tail{\mathrm{tail}}




From now on, we assume
\[
  \uptau = (\taulf,\tauls,\cdots)\times(\taurf,\taurs,\cdots).
\]

% The definition of sign $\upepsilon$
% \begin{enumS}
%   \item Suppose $\uptau$ is type D or B, $\upepsilon=0$ if and only if
%   $\# d (\uptau)> \#d(\uptau')$. This means:
%   \begin{enumS}
%     \item When $\uptau$ is type D,  $\tail(\taulf) = d$.
%     \item When $\uptau$ is type B,   $\tail(\taurf) = d$ or
%     $(\tail(\taulf),\tail(\taurf),\tail(\taurs)) = (c,r,d)$.
%   \end{enumS}
%   \item Suppose $\uptau$ is type C or M, $\upepsilon=0$ if and only if
%   $\abs{\taulf}\geq \abs{\taurf}$.
% \end{enumS}

For any $\uptau$ let $\uptau^{\bullet}$ be the subdiagram consisting of
$\bullet$ and $s$ entries only.


\subsection{dot-s switching algorithm}
\def\bipartl{\mathrm{bi\cP_L}}
\def\bipartr{\mathrm{bi\cP_R}}
\def\dsdiagl{\mathrm{DS_L}}
\def\dsdiagr{\mathrm{DS_R}}
\def\DDl{\eDD_\mathrm{L}}
\def\DDr{\eDD_\mathrm{R}}

We say a bipartition
$\tau = \tau_{L}\times \tau_{R}$
is interlaced with lager left part if  $\tau$ has columns
$(\tau_{L,0}\geq \tau_{L,1}, \cdots, )\times (\tau_{R,0},\tau_{R,1}, \cdots,)$
such that
\[
\tau_{L,0}\geq \tau_{R,0}\geq \tau_{L,1}\geq \tau_{R,1}\geq \tau_{L,2} \geq \cdots.
\]
$\bipartl$ denote the set of all interlaced bipartitions with larger left parts.
Similarly, define $\bipartr$ be the set of bipartitoins with larger right parts:
\[
  \bipartr = \set{\tau=(\tau_{L,0}\geq \tau_{L,1}, \cdots, )\times (\tau_{R,0},\tau_{R,1}, \cdots,)|
\tau_{L,0}\geq \tau_{R,0}\geq \tau_{L,1}\geq \tau_{R,1}\geq \tau_{L,2} \geq \cdots}
\]

Let $\dsdiagl$ (resp. $\dsdiagr$) be the set of of filled diagrams with only
``$s$'' entries on the left (resp. right) diagram and the rest are all ``$\bullet$''.

Note that for each $\uptau\in \dsdiagl$, its shape $\tau$ is in $\bipartl$.
On the other hand, for each $\tau\in \bipartl$, we can fill ``$\bullet$'' in
all entries on the right diagram and corresponding entries on the left, and than fill ``$s$''
in the rest entries on the left. This procedure yields a valid dot-s diagram.
In summary, $\bipartl$ and $\dsdiagl$ are naturally bijective to each other.

Let $\DDl\colon \bipartl\rightarrow \bipartr $ (resp.
$\DDr\colon \bipartr\rightarrow \bipartl$) be the operation
of deleting the longest column on the left (resp. on the right).
Then the operation gives a well defined maps between $\dsdiagl$ and $\dsdiagr$ making
the following diagrams commute (the vertical maps are the natural identification
discussed above):
\[
\begin{tikzcd}
  \bipartl \ar[r,"\DDl"] \ar[d,equal]& \bipartr \ar[d,equal] &
  \bipartr \ar[r,"\DDr"] \ar[d,equal]& \bipartl \ar[d,equal] \\
  \dsdiagl\ar[r,dashed,"\DDl"] & \dsdiagr & \dsdiagr\ar[r,dashed,"\DDr"] & \dsdiagl\\
\end{tikzcd}
\]
By abuse of notation, we also call the dashed arrow above $\DDl$ and $\DDr$.


\subsection{Bijection between ``special'' and ``non-special'' diagrams for type C}
We define a bijection between ``special'' diagram $\uptau^{s}$ and
``non-special'' diagrams $\uptau$.

\begin{defn}\label{def:sp-nsp.C.sp}
  Let $\cO = (C_{2k},C_{2k-1}, \cdots, C_{1},C_{0}, C_{-1}=0)\in \dpeNil(C)$
  with $k\geq 0$.
  Let
  \[
  \tau = (\tau_{2k-1}, \cdots, \tau_{1},\tau_{-1}=0) \times (\tau_{2k}, \cdots, \tau_{0}).
  \]
  be a Weyl group representation attached to $\cO\in \dpeNil(C)$.
  We say $\tau$ has
  \begin{itemize}
    \item \idxemph{special shape} if $\tau_{2k-1}\leq \tau_{2k}+1$;
    \item \idxemph{non-special shape} if $\tau_{2k-1}> \tau_{2k}+1$.
  \end{itemize}
  Clearly, this gives a partition of the set of Weyl group representations
  attached to $\cO$.

  Suppose $k\geq 1$, $C_{2k}=2c_{2k}$ and $C_{2k-1}=2c_{2k-1}$.
  The special shape representation $\tau^{s}$
  \[
    \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}=(c_{2k-1},\tau_{2k-3},\cdots, \tau_{1} )
    \times (c_{2k},\tau_{2k-2},\cdots, \tau_{0})
  \]
  is paired with the non-special shape representation
  \[
    \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} = (c_{2k}+1,\tau_{2k-3},\cdots, \tau_{1} )
    \times (c_{2k-1}-1,\tau_{2k-2},\cdots, \tau_{0})
  \]
  In the paring $\tau^{s}\leftrightarrow \tau^{ns}$, $\tau_{j}$  is unchanged for $j\leq 2k-2$.
  We call $\tau^{s}$ the \emph{special shape} and $\tau^{ns}$ the
  corresponding \emph{non-special shape}
\end{defn}



\begin{defn}\label{def:sp-nsp.C}
  Suppose $C_{2k}$ is even.
We retain the notation in \Cref{def:sp-nsp.C.sp} where the shapes $\tau^{s}$ and $\tau^{ns}$
correspond with each other.
We define a bijection between $\drc(\tau^{s})$ and $\drc(\tau^{ns})$:
\[
  \begin{tikzcd}[row sep=0em]
    \drc(\tau^{s}) \ar[rr,<->]&\hspace{2em} & \drc(\tau^{ns})\\
    \uptau^{s} \ar[rr,<->]& & \uptau^{ns}
  \end{tikzcd}
\]

Without loss of generality, we can assume
that $\uptau^{s}\in \drc(\tau^{s})$ and $\uptau^{ns}\in \drc(\tau^{ns})$ have the following shapes:
\begin{equation}\label{eq:sp-nsp.C}
  \uptau^{s}:\tytb{\cdots\cdots\cdots,{x_{0}}{\ast}{\cdots},{x_{1}}{x_{2}}{\cdots},\ ,\ ,\ ,\ }
  \times\tytb{\cdots\cdots\cdots,{v_{0}}{\cdots},{x_{3}},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ } \longleftrightarrow \hspace{2em}
  \uptau^{ns}:\tytb{\cdots\cdots\cdots,{y_{0}}{\ast}{\cdots},{*(srcol)r}{y_{2}}\cdots,
    {*(srcol)\vdots},{*(srcol)r},{y_{1}},{y_{3}} }
  \times\tytb{\cdots\cdots\cdots,{w_{0}}{\cdots},\ ,\ ,\ ,\ ,\ }
\end{equation}
(Here the grey parts have length $(C_{2k}-C_{2k-1})/2$ (could be zero length), the row contains
$x_{0}$ and $y_{0}$ may be empty, and $*$/$\cdots$ are
arbitrary entries. We remark that the value of $v_{0}$ and $w_{0}$ are
completely determined by $x_{0}$ and $y_{0}$. In particular, $v_{0}$ and $w_{0}$
are non-empty if and only if
$x_{0}/y_{0}\neq \emptyset$, i.e. $C_{2k-1}\geq 4$.)

% We marks the entries of $\uptau^{s}$ and $\uptau^{ns}$ as in
% \eqref{eq:sp-nsp.C}.
The correspondence between $(x_{0},x_{1}, x_{2}, x_3)$, with
$(y_{0},y_{1},y_{2},y_{3})$ is given by \Cref{tab:nonsp.C}.
The rest part of the diagrams are unchanged.

We define
\[
  \drcs(\cO) := \bigsqcup_{\tau^{s}} \drc(\tau^{s}) \quad \text{ and }\quad
  \drcns(\cO) := \bigsqcup_{\tau^{ns}} \drc(\tau^{ns})
\]
where $\tau^{s}$ (resp. $\tau^{ns}$) runs over all specail (resp. non-special) shape representations attached to $\cO$.
Clearly $\drc(\cO) = \drcs(\cO)\sqcup \drcns(\cO)$.
\end{defn}
It is easy to check the bijectivity in the above definition, which we leave it
to the reader.



\subsection{Special and non-special shapes of type D}
Now we define the notion of special and non-special shape of type D.
\begin{defn}\label{def:sp-nsp.D.sp}
  Let
  \[
  \tau = (\tau_{2k+1},\tau_{2k-1}, \cdots, \tau_{1})\times (\tau_{2k}, \cdots, \tau_{0})
  \]
  be a Weyl group representation attached to $\cO\in \dpeNil(D)$.
  We say $\tau$ has
  \begin{itemize}
    \item \idxemph{special shape} if $\tau_{2k-1}\leq \tau_{2k}+1$;
    \item \idxemph{non-special shape} if $\tau_{2k-1}> \tau_{2k}+1$.
  \end{itemize}

  Suppose
  $\cO=(C_{2k+1}=2c_{2k+1},C_{2k}=2c_{2k},C_{2k-1}=2c_{2k-1},\cdots,C_{0}\geq 0)$
  with $k\geq 1$.\footnote{Note that $C_{2k}$ and $C_{2k-1}$ are non-zero
    even integers.}
  A representation $\tau^{s}$ attached to $\cO$ has the shape
  \[
    \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}=(c_{2k+1},c_{2k-1},\tau_{2k-3},\cdots, \tau_{1} )
    \times (c_{2k},\tau_{2k-2},\cdots, \tau_{0})
  \]
  is paired with
  \[
    \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} = (c_{2k+1},c_{2k}+1,\tau_{2k-3},\cdots, \tau_{1} )
    \times (c_{2k-1}-1,\tau_{2k-2},\cdots, \tau_{0}).
  \]
  In the paring $\tau^{s}\leftrightarrow \tau^{ns}$, $\tau_{j}$  is unchanged for $j\leq 2k-2$.
  % We call $\tau^{s}$ the \emph{special shape} and $\tau^{ns}$ the
  % corresponding \emph{non-special shape}
\end{defn}

\begin{table}[hpb]
\[\tiny
\begin{array}{c|c|c:c|c}
  & \uptaup & \uptau^{s} & \uptau^{ns} \\
  \hline
           & \ytb{{x'_{0}}{\ast},{x'_{1}}{x'_{2}},\none,\none,\none,\none}
             \times \ytb{\ast,\none,\none,\none,\none,\none}
           &\ytb{{x_{0}}{\ast},{x_{1}}{x_{2}},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}{\ast},{x_{3}},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{y_{0}}{\ast},{*(srcol)r}{y_{2}},{*(srcol)\vdots},{*(srcol)r},{y_{1}},{y_{3}} }
    \times\ytb{{\ast}\ast,\ ,\ ,\ ,\ ,\ }\\
  \hline
  \ytb{{x'_{1}}{=}{s},{\text{then}},{z_{0}}{=}{\emptyset/}{s},{x_{0}}{=}{\emptyset/}{\bullet},{x_{1}}{=}{\bullet},
  {x_{2}}{=}{x'_{2}}}
  &
            \ytb{{x'_{0}}{\ast},{s}{x_{2}},\none,\none,\none,\none}
             \times \ytb{\ast,\none,\none,\none,\none,\none}
                &
                \ytb{{x_{0}}{\ast},{\bullet}{x_{2}},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}\ast,{\bullet},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{x_{0}}{\ast},{*(srcol)r}{x_{2}},{*(srcol)\vdots},{*(srcol)r},{c},{d} }
                          \times\ytb{{\ast}{\ast},\ ,\ ,\ ,\ ,\ }
          &x_{2}\neq r
  \\
  \cline{3-5} & &
                  \ytb{{x_{0}}{\ast},{\bullet}{r},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}\ast,{\bullet},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{x_{0}}{\ast},{*(srcol)r}{c},{*(srcol)\vdots},{*(srcol)r},{r},{d} }
    \times\ytb{{\ast}\ast,\ ,\ ,\ ,\ ,\ } & x_{2}=r \\
  \hline
\ytb{{x'_{1}}{\neq}{s},{\text{then}},{x_{1}}{=}{x'_{1}},{x_{2}}{=}{x'_{2}}}
  &
            \ytb{{x'_{0}}{\ast},{x'_{1}}{x_{2}},\none,\none,\none,\none}
             \times \ytb{\ast,\none,\none,\none,\none,\none}
   &
    \ytb{{x_{0}}{\ast},{x_{1}}{x_{2}},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}\ast,{s},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{x_{0}}{\ast},{*(srcol)r}{x_{2}},{*(srcol)\vdots},{*(srcol)r},{r},{x_{1}} }
       \times\ytb{{\ast}\ast,\ ,\ ,\ ,\ ,\ } &
     \ytb{{x'_{0}}{\neq}{c},{\text{then}},{x'_{0}}{=}{\emptyset/}{s/}{r},{x_{0}}{=}{\emptyset/}{\bullet/}{r}}
  \\
  %\hline
  \cline{3-5}
   & &
    \ytb{{c}{\ast},{d}{x_{2}},\ ,\ ,\ ,\ }
    \times\ytb{{\ast}\ast,{s},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\ }&
  \ytb{{r}{\ast},{*(srcol)r}{x_{2}},{*(srcol)\vdots},{*(srcol)r},{c},{d} }
  \times\ytb{{\ast}\ast,\ ,\ ,\ ,\ ,\ }&
  \ytb{{x'_{0}}{=}{c}\none\none,{\text{then}},{x_{0}}{=}{x'_{0}}{=}{c},{x_{1}}{=}{x'_{1}}{=}{d},{x_{2}}{=}{x'_{2}}{=}{\emptyset/d}}
  \\
  \hline
  \hline
\end{array}
\]
\caption{``special-non-special'' switch}
\label{tab:nonsp.C}
\end{table}


\subsection{Definition of $\eDD$ of Type D and C} \label{sec:alg.CD}

The induction starts with type C: For the trivial orbit $\cO$ of
$\wtG = \Sp(2c_{0},\bR)$, $\drc(\cO) = \set{\uptau_{\cO}}$ and
$\uppi_{\uptau_{\cO}}=\bfone$ is the trivial representation, see \eqref{eq:uptau0}.

\subsubsection{The defintion of $\upepsilon$.} \label{sec:upepsilon}
\begin{enumerate}[label=(\arabic*).,series=alg1]
  \item When $\uptau\in \drc(D)$, $\upepsilon$ is determined by the ``basal
  disk'' of $\uptau$ (see \eqref{eq:x.uptau} for the definition of $x_{\uptau}$):%escent from type D to type C,
  \[
    \upepsilon_{\uptau}:=
    \begin{cases}
      0, & \text{if $x_{\uptau}=d$;} \\
      1, & \text{otherwise.}
    \end{cases}
  \]
  \item When $\uptau\in \drc(C)$, the  $\upepsilon$  is determined by
  the lengths of $\taulf$ and $\taurf$:
  \[
    \upepsilon_{\uptau} :=
    \begin{cases}
      0, & \text{if $\uptau$ has special shape, i.e. } \abs{\taulf}-\abs{\taurf} \leq  1;\\
      1, & \text{if $\uptau$ has non-special shape, i.e. }\abs{\taulf} - \abs{\taurf}> 1.
    \end{cases}
  \]
\end{enumerate}
%To indicate the relation with $\uptau$, we will also w

\medskip

%{\bf Definition of the descent of diagram $\uptaup$.}

\subsubsection{Initial cases}
%For type D, %when $\cO$ must have odd number of column.
Let $\cO$ be a nilpotent orbit of type D with at most 2 columns.
\begin{enumerate}[resume*=alg1]
  \item Suppose $\cO = (2c_{1},2c_{0})$.
        Then
        $\cOp:=\eDD(\cO)$ is the trivial orbit of $\Sp(2c_{0},\bR)$. $\drc(\cO)$
        consists of diagrams of shape
        $\tau_{L}\times \tau_{R} =(c_{1},)\times (c_{0},)$.
        The set $\drc(\cOp)$ is a singleton $\set{\uptau_{\cOp}}$, and every element
        $\uptau \in \drc(\cO)$ maps to $\uptau_{\cOp}$ (see \eqref{eq:uptau0}):
        \[\tiny
          \drc(\cO)\ni \uptau: \hspace{1em} \ytb{\bullet,\vdots,\bullet,{x_{1}},\vdots,{x_{n}}}
          \times \ytb{\bullet,\vdots,\bullet,\none,\none,\none}
          \mapsto \uptau_{\cOp}:
          \ytb{\emptyset,\none,\none,\none,\none,\none}
          \times \ytb{s,\vdots,s,\none,\none,\none}
        \]
        We define
        \[
          \bfpp_{\uptau}:=\bfxx_{\uptau} := \tytb{{x_{1}},\vdots,{x_{n}}} \text{ and }x_{\uptau}:=x_{n}
        \]
        We call $\bfpp_{\uptau}=\bfxx_{\uptau}$ the ``peduncle'' part of $\uptau$ and
        $x_{\uptau}$ the
        ``basal disk'' of $\uptau$.
        Note that $\bfxx_{\uptau}$ consists of entries marked by $s/r/c/d$.
\end{enumerate}


\subsubsection{The descent from C to D}
The descent of a special shape diagram is simple, the descent of a non-special shape
reduces to the corresponding special one:
\begin{enumerate}[resume*=alg1]
  \item Suppose $\abs{\taulf} - \abs{\taurf} < 2$, i.e. $\uptau$ has special
        shape. Keep $r,c,d$ unchanged, delete $\taurf$ and fill the remaining
        part with ``$\bullet$'' and ``$s$'' by $\DDr(\uptau^{\bullet})$ using
        the dot-s switching algorithm.
  \item Suppose $\abs{\taulf} - \abs{\taurf} \geq 2$. We define
        \[\uptaup=\eDDo(\uptau):=\eDDo(\uptau^{s})\] where $\uptau^{s}$ is the
        special diagram corresponding to $\uptau$ defined in
        \Cref{def:sp-nsp.C}.
\end{enumerate}

\begin{lem}\label{lem:ds.CD}
  Suppose $\cO = (C_{2k},C_{2k-1}, \cdots, C_{0})$ with $k\geq 1$ and $C_{2k}$ even.
  Let $\cOp := \eDD(\cO)=(C_{2k-1},\cdots, C_{0})$.
  Then
  \[
    \begin{split}
      \drcs(\cO) &\xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \drc(\cOp) \\
      \drcns(\cO)&
      \xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \drc(\cOp)
    \end{split}
  \]
  are a bijections.
\end{lem}
\begin{proof}
  The claim for $\drcs(\cO)$ is clear by the definition of descent.
  The claim for $\drcns(\cO)$ reduces to that of $\drcs(\cO)$ using \Cref{def:sp-nsp.C}.
\end{proof}

\begin{lem}\label{lem:gd.CD}
  Suppose $\cO = (C_{2k},C_{2k-1}, \cdots, C_{0})$ with $k\geq 1$ and $C_{2k}$ odd.
  Let $\cOp := \eDD(\cO)=(C_{2k-1}+1,\cdots, C_{0})$.
  Then the following map is a bijection
  \[
      \drc(\cO) \xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \set{\uptaup\in \drc(\cOp)| x_{\uptau}\neq s}. %\subsetneq \drc(\cOp).
  \]
\end{lem}
\begin{proof}
  This is clear by the descent algorithm.
\end{proof}
\subsubsection{Descent from $D$ to $C$} Now we consider the general case of the
descent from type $D$ to type $C$. So we assume $\cO$ has at least 3 columns.
First note that the shape of $\uptau' = \eDD(\uptau)$ is the shape of $\uptau$ deleting the
longest column on the left.

% We assume $\uptau$ and $\uptau'$ has the following shape where $(y_{1},y_{2})$
% could be empty and $w_{0}$ is non-empty if $\uptau_{R}\neq \emptyset$.
The definition splits in cases below. In all these cases we define
\begin{equation}\label{eq:x.uptau}
\bfxx_{\uptau} := x_{1}\cdots x_{n} \text{ and } x_{\uptau} := x_{n}
\end{equation}
which is marked by $s/r/c/d$.
For the part marked by $*/\cdots$ , $\eDD$ keeps $r,c,d$ and maps the rest part consisting of $\bullet$ and $s$ by dot-s switching algorithm.
\begin{enumerate}[resume*=alg1]
  \item When $C_{2k}=C_{2k-1}$ is odd, we could assume $\uptau$ and $\uptaup$ hase
        the following forms with $n = (C_{2k+1}-C_{2k}+1)/2$.
      \[
        \uptau: \hspace{1em} \tytb{\cdots\cdots\cdots,{\ast}{\ast}{\cdots},{x_{1}}{y_{1}}\cdots,{\vdots},{x_{n}}}
        \times \tytb{\cdots\cdots\cdots,{w_{0}}{\ast}{\cdots},\none,\none,\none}
        \mapsto
        \uptaup:  \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none{z_{1}}\cdots,\none,\none}
        \times \tytb{\cdots\cdots\cdots,{w_{0}}{\ast}{\cdots},\none,\none,\none}
      \]
        Suppose $y_{1} = c$ and $(x_{1}, \cdots, x_{n}) = (r, \cdots, r)$ or
        $(r, \cdots, r,d)$, then let $z_{1}= r$; otherwise, set $z_{1}:= y_{1}$.
        We define
        \[
        \bfpp_{\uptau}:=\tytb{{x_{1}}{y_{1}},\vdots,{x_{n}}}.
        \]
  \item When $C_{2k}$ is even and $\uptau$ has special shape, the descent is given by the following diagram
      \[\tiny
        \uptau: \hspace{1em}
        \ytb{
        \cdots\cdots\cdots,
        {\ast}{\ast}{\cdots},
        {*(srcol)\bullet},
        {*(srcol)\vdots},{*(srcol)\bullet},{x_1},\vdots,{x_n}}
        \times \ytb{\cdots\cdots\cdots,{\ast}{\ast}{\cdots},{*(srcol)\bullet},{*(srcol)\vdots},{*(srcol)\bullet},\none,\none,\none}
        \mapsto
       \uptaup: \ytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none}
        \times \ytb{\cdots\cdots\cdots,{\ast}{\ast}{\cdots},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\none,\none,\none}
      \]
  \item When $C_{2k}$ is even and $\uptau$ has non-special shape, then
        \[
        \uptau:\tytb{{\cdots}\cdots\cdots\cdots,{\ast}{\ast}{\cdots}{\cdots},{*(srcol)s}{*(srcol)r}{\cdots}\cdots,
        {*(srcol)\vdots}{*(srcol)\vdots},{*(srcol)s}{*(srcol)r},{x_{0}}{y_{1}},{x_{1}}{y_{2}},{\vdots},{x_{n}}}
        \times\tytb{{\cdots}\cdots\cdots,{\ast}{\cdots}\cdots,\ ,\ ,\ ,\ ,\ ,\ ,\ }
        \mapsto \uptau':
        \tytb{\cdots\cdots\cdots,{\ast}{\ast}{\cdots},{*(srcol)r}{\ast}\cdots,{*(srcol)\vdots},{*(srcol)r},{z_{1}},{z_{2}},\ ,\ }
        \times\tytb{{\cdots}\cdots\cdots,{\ast}{\cdots}\cdots,\ ,\ ,\ ,\ ,\ ,\ ,\ }
        \]
      where $y_{1},y_{2}$ are non empty.
      In most of the case, we just delete the longest column on the left and set
      $(z_{1},z_{2})=(y_{1},y_{2})$. The exceptional cases are listed below:
      \begin{itemize}
        \item When
 $x_{0}=r$, we have $(y_{1},y_{2})=(c,d)$. We let
      \[
          \tytb{{x_{0}}{y_{1}}\none{r}{c},{x_{1}}{y_{2}}{=}{x_{1}}{d},\vdots\none\none\vdots,{x_{n}}\none\none{x_{n}}}
          \mapsto \tytb{{z_{1}}\none{r},{z_{2}}{:=}r,\none,\none}
        \]

        \item When $x_{0}=c$, we have $n=1$ and $(x_{0},x_{1})=(y_{1},y_{2})=(c,d)$. We let
        \[
          \tytb{{x_{0}}{y_{1}},{x_{1}}{y_{2}}} = \tytb{cc,dd}
          \mapsto \tytb{{z_{1}},{z_{2}}}:=\tytb{r,c}.
      \]
      \item
      We remark that $x_{0}$ never equals to $d$.
  \end{itemize}
\end{enumerate}

\subsubsection{A key property in the descent case}
We retain the notation in \Cref{def:sp-nsp.D.sp}, where
\[
\cO=(C_{2k+1}=2c_{2k+1},C_{2k}=2c_{2k},C_{2k-1}=2c_{2k-1},\cdots, C_{0}) \text{
  such that } k\geq 1.
\]
Let $\cOp=\eDD(\cO)$ and $\cOpp=\eDD(\cOp)$.
The following lemma is the key property satisfied by our definition
\begin{lem}\label{lem:sp-nsp.D}
  Let $\tau^{s}$ and $\tau^{ns}$ are two representations attached to $\cO$ as in
  \Cref{def:sp-nsp.D.sp}.
  Then
  \begin{enumS}
    \item \label{lem:sp-nsp.D.1} For every $\uptau\in \drc(\tau^{s})\sqcup \drc(\tau^{ns})$, the shape
    of $\eDD^{2}(\uptau)$ is
    \[
      \taupp = (c_{2k-1},\tau_{2k-3},\tau_{1})\times (\tau_{2k-2},\cdots, \tau_{0})
    \]
    \item \label{lem:sp-nsp.D.2} Let $\cO_{1}= (2(c_{2k+1}-c_{2k}),)\in \Nil(D)$ be the trivial orbit
    of $\rO(2(c_{2k-1}-c_{2k}),\bC)$.
    We define $\delta\colon \drc(\cO)\rightarrow \drc(\cOpp)$ by $\delta(\uptau) = (\eDD^{2}(\uptau),\bfxx_{\uptau})$.
    The following maps are bijections
    \[
      \begin{tikzcd}[row sep=0em]
        \drc(\tau^{s})\ar[r,"\delta"] & \drc(\taupp)\times \drc(\cO_{1}) &\ar[l,"\delta"'] \drc(\tau^{ns})\\
        \uptau^{s}\ar[r,maps to] & (\eDD^{2}(\uptau^{s}), \bfxx_{\uptau^{s}})&\\
        & (\eDD^{2}(\uptau^{ns}), \bfxx_{\uptau^{ns}})& \uptau^{ns}\ar[l,maps to]\\
      \end{tikzcd}
    \]
    In particular, we obtain an one-one correspondence
    $\uptau^{s}\leftrightarrow \uptau^{ns}$ such that $\delta(\uptau^{s})=\delta(\uptau^{ns})$.
    \item\label{lem:sp-nsp.D.3}
    Suppose $\uptau^{s}$ and $\uptau^{ns}$ correspond as the above such that
    $\delta(\uptau^{s})=\delta(\uptau^{ns})=(\uptaupp,\bfxx)$. Then
    \begin{equation} \label{eq:sp-nsp-sig}
      \ssign(\uptau^{s})=\ssign(\uptau^{ns})=(C_{2k},C_{2k})+\ssign(\uptaupp)+\ssign(\bfxx).
    \end{equation}
  \end{enumS}
\end{lem}
\begin{proof}
  Suppose $\uptau^{s}$ has special shape.
  the the behavior of $\uptau^{s}$ under the descent map $\eDD$ is illostrated
  as the following:
  \[\tiny
    \uptau^{s}: \hspace{1em}
    \ytb{
      {*(srcol)\cdots}\cdots\cdots,
      {*(srcol)\ast}{\ast}{\cdots},
      {*(srcol)\bullet},
      {*(srcol)\vdots},{*(srcol)\bullet},{x_1},\vdots,{x_n}}
    \times
    \ytb{{*(srcol)\cdots}\cdots\cdots,
      {*(srcol)\ast}{\ast}{\cdots},{*(srcol)\bullet},{*(srcol)\vdots},{*(srcol)\bullet},\none,\none,\none}
    \mapsto
    \uptau'^{s}
     \ytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none}
    \times \ytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)\ast}{\ast}{\cdots},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},\none,\none,\none}
    \mapsto
    \uptaupp:
    \ytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none}
    \times \ytb{\none\cdots\cdots,{\none}{\ast}{\cdots},\none,\none,\none,\none,\none,\none}
  \]
  Note that $\uptau^{s}$ is obtained from $\taupp$ by attaching the grey part
  consisting totally $2c_{2k}$ dots and $\bfxx$. Now the claims for $\uptau^{s}$ is
  clear.


  Now consider the descent of a non-special diagram $\uptau^{ns}$:
  \[\tiny
    \uptau^{ns}:\ytb{{*(srcol)\cdots}\cdots\cdots\cdots,{*(srcol)\ast}{y_{0}}{\ast}{\cdots},{*(srcol)s}{*(srcol)r}{y_{2}}\cdots,
      {*(srcol)\vdots}{*(srcol)\vdots},{*(srcol)s}{*(srcol)r},{x_{0}}{y_{1}},{x_{1}}{y_{3}},{\vdots},{x_{n}} }
    \times\ytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)u_{0}}{\cdots},\ ,\ ,\ ,\ ,\ ,\ ,\ }
    \mapsto
    \uptau'^{ns}:\ytb{\cdots\cdots\cdots,{y'_{0}}{\ast}{\cdots},{*(srcol)r}{y'_{2}}\cdots,
      {*(srcol)\vdots},{*(srcol)r},{y'_{1}},{y'_{3}},\ ,\ }
    \times\ytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)w_{0}}{\cdots},\ ,\ ,\ ,\ ,\ ,\ ,\ }
    \mapsto
    \uptaupp:\hspace{1em}
            \ytb{{\cdots}{\cdots}{\cdots},{x'_{0}}{\ast}{\cdots},{x'_{1}}{x'_{2}}\cdots,\none,\none,\none,\none,\none,\none}
            \times
            \ytb{{\cdots}{\cdots},{\cdots}\none,\none,\none,\none,\none,\none,\none,\none}
            % \ytb{\emptyset,\none,\none,\none,\none,\none}
  \]
  The bijection follows from the observation that 1. $\uptau^{ns}$ is obtained by
  attaching the grey part $x_{0},\cdots,x_{n}$ and $y_{0},y_{1},y_{2},y_{3}$
  to the $\ast/\cdots$ part of $\uptaupp$;
  2. the value of $(y_{0},y_{1},y_{2},y_{3})$ is completely determined by
  $(x'_{0},x'_{1},x'_{2})$ and $\bfxx=x_{1}\cdots x_{n}$.

  We leave it to the reader for checking case by case that the grey part of $\uptau^{ns}$ has signature
  $(C_{2k}-2,C_{2k}-2)$ and
  \[\ssign(x_{0}y_{0}y_{1}y_{2}y_{3})-\ssign(x'_{0}x'_{1}x'_{2})=(2,2).
  \]
 Therefore \eqref{eq:sp-nsp-sig} follows.

 \trivial[]{
   First assume that $C_{2k}=2$. Note that we can not/(or now?) assume $k=1$, consider the
   orbit $\cOpp=(2,1,1,1,1)$.
   \begin{enumPF}
     \item
     $x'_{1}=s$, now $y'_{0} = \emptyset/\bullet$ when $x'_{0}=\emptyset/s$
     \begin{enumPF}
       \item Suppose $x'_{2}\neq r$. Then $(y'_{2},y'_{1},y'_{3}) = (x'_{2},r,d)$,
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,x'_{0}, x'_{2},c,d)$.
       Therefore, the sign difference is $\ssign(s,c,d)-\ssign(s)=(2,2)$.
       \item Suppose $x'_{2} = r$. Then $(y'_{2},y'_{1},y'_{3}) = (c,r,d)$.
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,x'_{0},c,r,d)$.
       Therefore, the sign difference is $\ssign(s,c,r,d)-\ssign(s,r)=(2,2)$.
     \end{enumPF}
     \item $x'_{1}\neq s$.
     \begin{enumPF}
       \item Suppose $x'_{0}\neq c$.
       Then $x'_{0}=\emptyset/s/r$, $x'_{1}=r/c/d$, $(y'_{0}, y'_{2},y'_{1},y'_{3}) = (\emptyset/\bullet/r,x'_{2},r,x'_{1})$.
       \begin{enumPF}
         \item $x'_{1}=r$. Then
         $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (r,x'_{0},x'_{2},c,d)$.
         Therefore, the sign difference is $\ssign(r,c,d)-\ssign(r)=(2,2)$.
         \item $x'_{1}=c$. Then  $x_{1}=d$.
         $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (c,x'_{0},x'_{2},c,d)$.
         Therefore, the sign difference is $\ssign(c,c,d)-\ssign(c)=(2,2)$.
         \item $x'_{1}=d$. Then
         $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,x'_{0},y'_{2},y'_{1},y'_{3})=(s,x'_{0},x'_{2},r,d)$.
         Therefore, the sign difference is $\ssign(s,r,d)-\ssign(d)=(2,2)$.
       \end{enumPF}
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,r,x'_{2},c,d)$.
       Therefore, the sign difference is $\ssign(s,r,x'_{2},c,d)-\ssign(c,d,x'_{2})=(2,2)$.
       \item Suppose $x'_{0} = c$.
       Then $x'_{1}=d$, $(y'_{0}, y'_{2},y'_{1},y'_{3}) = (r,x'_{2},c,d)$.
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,r,x'_{2},c,d)$.
       Therefore, the sign difference is $\ssign(s,r,x'_{2},c,d)-\ssign(c,d,x'_{2})=(2,2)$.
     \end{enumPF}
   \end{enumPF}
   }
 \end{proof}





\section{Convention on the local system}
An irreducible local system is represented by a {\emph{marked Young
    diagram}\index{Young Diagram}}. A general local system is understand as the
union of irreducible ones. By our computation later, it would be clear that the
local systems appeared in our cases are always \emph{multiplicity one}.


\subsection{Commutative free monoid}
Given a  set $\sfA$, the commutative free monoid $\sfC(\bA)$ on $\bfA$ consists all finite multisets with
elements drawn from $\sfA$.
It is equipped with the binary operation, say $\bullet$ such that
\[
  \set{a_{1},\cdots, a_{k_{1}}}\bullet \set{b_{1},\cdots, b_{k_{2}}} :=
  \set{a_{1},\cdots, a_{k_{1}},b_{1},\cdots, b_{k_{2}}}.
\]
In the following, we always identify $\sfA$ with the subset of $\sfC(\sfA)$
consists of singletons.

Suppose $\sfM$ is a commutative monoid, a map $f\colon \sfA\rightarrow \sfM$ is
uniquelly extends to a morphism $\sfC(\sfA)\rightarrow \sfM$ which is still
called $f$ by abuse of notations.

In particular a map $f\colon \sfA\rightarrow \sfB$ between sets uniquely extends to an morphism
$f\colon \sfC(\sfA)\rightarrow \sfC(\sfB)$ by
\[
  f(\set{a_{1},\cdots, a_{k}}) = \set{f(a_{1}), \cdots, f(a_{k})}.
\]

\subsection{Marked Young diagram}
We now explain the combinatiorial objects parameterizing local systems.
Basically ,we use $+/-$ (resp. $\upp/\umm$) to denote the associated character on the
corresponding factor of the isotropic group.
Let $\star=B,C,D,M$.


\begin{itemize}
  \item {\bf Young diagram } Let $\YD$ be the commutative free monoid
        $\sfC(\bN^{+})$ on the set of positive integers $\bZ_{\geq 1}$. An
        element $\cO = \set{R_{1}, \cdots, R_{k}}$ is identified with the Young
        diagram whose set of row lengths is $\cO$. Therefore, we identify $\YD$
        with the set of Young diagrams. Let
        \[
        \abs{ \ \ }\colon \YD \longrightarrow \bN
        \]
        be the map sending $\set{R_{1},\cdots R_{k}}$ to $\sum_{i=1}^{k} R_{i}$.

        Let $\YD(\star)$ to denote the Young diagrams corresponding to
        partitions of type $\star$. The set $\YD(\star)$ parameterizes the set
        of nilpotent orbits of type $\star$. Note that $\YD(C)=\YD(M)$.



  \item {\bf Signed Young diagram } Let $\sfS$ be the set of non-empty finite
        length strings of alternating signs of the form $+-+\cdots$ or
        $-+-\cdots$. Let $\SYD :=\sfC(\sfS)$ be the monoid on $\sfS$.

        The monoid $\SYD$ is identified with the set of all signed Young
        diagrams: $\sO=\set{\bfrr_{1}, \cdots, \bfrr_{k}}\in \SYD$ is identified
        with the signed Young diagram whose rows are filled by $\bfrr_{j}$. The
        map $ \sfS\rightarrow \bZ_{\geq 1}$ sending a string to its length
        extends to the morphism
        \[
        \begin{tikzcd}[row sep=0em]
          \cY\colon \SYD \ar[r] & \YD\\
          \set{\bfrr_{1},\cdots, \bfrr_{k}} \ar[r,maps to] & \set{\abs{\bfrr_{1}},\cdots, \abs{\bfrr_{k}}}
        \end{tikzcd}
        \]
        where $\abs{\bfrr_{j}}$ denote the length of the string $\bfrr_{j}$. By
        abused of notation, we also denote $\abs{\ \ }\circ \cY$ by
        $\abs{\ \ }$.

        We define $\SYD(\star)$ to be a subset of the preimage of $\YD(\star)$
        under the above map: When $\star=C,M$ (resp. $\star=D,B$),
        \[
        \SYD(\star) = \Set{ \sO\in \SYD| \begin{minipage}{15em}
            $\cY(\sO)\in \YD(\star)$\\
            For each positive odd number (resp. even number) $r$, the strings $+-\cdots$ and
            $-+\cdots$ of the length $r$ appears in $\sO$ with the same
            multiplicity (could be 0).
          \end{minipage}
        }
        \]

        The set $\SYD(\star)$ parameterizes the real nilpotent orbits of type
        $\star$ and $\bfK$-orbits in $\fpp$.

        We define two signature maps $\sfS\rightarrow \bN\times \bN$ as the
        following. For $\bfrr\in \sfS$, define
        \[
        \begin{split}
          \ssign(\bfrr)& := (\#+(\bfrr), \#-(\bfrr)) \quad \text{and}\\
          \lsign(\bfrr)& := \begin{cases}
            (1,0) & \text{if } \bfrr = +\cdots\\
            (0,1) & \text{if } \bfrr = -\cdots\\
          \end{cases}.
        \end{split}
        \]
        The above defined signature maps naturally extends to signature maps
        $\ssign\colon \SYD\rightarrow \bN\times \bN$ and
        $\ssign\colon \SYD\rightarrow \bN\times \bN$.



  \item {\bf Marked Young diagram} Let $\sfM$ be the set of finite length
        strings of alternating marks of the form $+-+\cdots$,$-+-\cdots$,
        $\upp\umm\upp\cdots$, or $\umm\upp\umm\cdots$.

        Let $\MYD:=\sfC(\sfM)$ which is identified with the set of Young
        diagrams marked with alternating marks $+/-$, $\upp/\umm$. Define
        $\sF\colon \sfM \rightarrow \sfS$ by the formula
        \[
        \sF(\bfrr) := \begin{cases}
          +-+\cdots & \text{ if } \bfrr = +-+\cdots \text{ or } \upp\umm\upp\cdots\\
          -+-\cdots & \text{ if } \bfrr = -+-\cdots \text{ or } \umm\upp\umm\cdots\\
        \end{cases} \quad \forall \bfrr\in \sfM
        \]
        such that $\sF(\bfrr)$ and $\bfrr$ have the same length. $\sF$ extends
        to the map $\sF: \MYD \rightarrow \SYD$.

        By abused of notation, we also denote $\abs{\ \ }\circ \cY$ by
        $\abs{\ \ }$.

        For $\cL\in\MYD$, we define
        \[
        \ssign(\cL) = \ssign(\sF(\cL)) \quad \text{and} \quad \lsign(\cL) = \lsign(\sF(\cL)).
        \]
        We define $\MYD(\star)$ to be a subset of the preimage of the above map:
        \[
        \MYD(\star) =\Set{\cL\in \MYD(\star)|\begin{minipage}{18em}
            $\sF(\cL)\in \SYD(\star)$;\\
            $\bfrr_{1}=\bfrr_{2}$ if $\bfrr_1, \bfrr_2\in \cL$ and
            $\sF(\bfrr_{1})=\sF(\bfrr_{2})$;\\
            $\bfrr = +-+\cdots $ or $-+-\cdots $ if the length of $\bfrr$ is odd
            (resp. even ) when $\star \in \set{C,M}$ (resp.
            $\star\in \set{B,D}$).
          \end{minipage}
        }
        \]
        We will use $\MYD(\star)$ to parameterize irreducible local systems
        attached to the nilpotent orbits of type $\star$.
\end{itemize}
For monoid  $\YD$, $\SYD$ or $\MYD$, the identity element is the empty set
$\emptyset$, and the monoid binary operator is denoted by
``$\cdot$''.
The  $\emptyset$ is  always in
$\MYD(\star)$ by convention.
According to the definition of $\MYD(\star)$.  it could happen that $\cL_{1}\cdot \cL_{2}\notin \MYD(\star)$ for
$\cL_{1},\cL_{2}\in \MYD(\star)$.

% We will represent an element $\cL$ in $\SYD$ or $\MYD$ by the Young diagram whose
% rows are filled with the strings in $\cL$.
%
%Let $\bZ/2\bZ\times \sfM\rightarrow \sfM$ by

We define an involution
\begin{equation}\label{eq:def.bar}
 \overline{\phantom{+}}\colon \sfM\rightarrow \sfM
\end{equation}
on $\sfM$  by
switching the symbols $+$ with $\upp$  and $-$ with $\umm$.
For example $\overline{+-+}= \upp\umm\upp$ and $\overline{ \umm\upp } = -+$.
% \[
%   \meltese(\bfrr) =\begin{cases}
%     +-\cdots & \text{if } \bfrr= \upp\umm\cdots
%     -+\cdots & \text{if } \bfrr= \upp\umm\cdots
%     \upp-\cdots & \text{if } \bfrr= \upp\umm\cdots
%   \end{cases}
% \]

We define the map
\begin{equation}\label{eq:def.dagger}
  \dagger\colon \sfM\rightarrow \sfM
\end{equation}
by extending the length of
the strings to the left by one.
For example $\dagger(+-+) = -+-+$ and $\dagger(\umm\upp)=\upp\umm\upp$.

For  $\cL,\cC\in \MYD$, the expression $\cL\succ\cC$ means that there is $\cB\in \MYD$
such that the
factorization $\cL = \cB\cdot \cC$ holds.

In the following, we will represent an element $\cL\in \MYD$ by the Young diagram whose rows are
filled with the strings in $\cL$. The terminology ``$l$-row'' means a row of length $l$.
If we do not care whether the mark is $\upp$ or $+$ (resp.  $\umm$ or $=$), we will use $\uup$ (resp. $\uum$)
to mark the corresponding position.

\begin{eg}
  The following two diagrams $\ddagger_{p,q}$ and $\dagger_{p,q}$ are in
  $\MYD(B)\cup \MYD(D)$.
  \[
    \ddagger_{p,q} := \tytb{+,\vdots,+,=,\vdots,=}
  \]
  represents the local system on the trivial orbit of $\rO(p,q)$ which has the
  trivial character on $\rO(p)$ and $\det$ on $\rO(q)$. Similarly,
  \[
    \dagger_{p,q}:= \tytb{+,\vdots,+,-,\vdots,-}
  \]
  represents the trivial local system on the trivial orbit.
\end{eg}



\subsubsection{Local systems}
We define  $\KM$ to be the free commutative monoid generated by $\MYD$.
The binary operation in $\KM$ is denoted by ``$+$''.

The operation ``$\cdot$'' naturally extends to $\KM$:
\[
  (\sum_{i}  m_{i}\cL_{i})\cdot (\sum_{j} m_{j}\cL'_{j}) := \sum_{i,j} m_{i}m_{j}(\cL_{i}\cdot \cL'_{j}).
\]
where $\cL_{i},\cL'_{j}\in \MYD$, $m_{i},m_{j}\in \bZ_{\geq 0}$.

Now $(\KM, +, \cdot)$ is in fact a commutative semiring. We let $0$ be the
additive identity element in $\KM$ and $\emptyset$ is the multiplicative
identify. Note that $\cL\cdot 0=0$ for any
 $\cL\in \KM$ by definition.

For $\cL,\cD\in \KM$, $\cL\succ \cD$ means that there exists $\cB\in \KM$ such that
$\cL=\cB\cdot \cD$.
In addition, we write $\cL\supset \cD$ if there is $\cL_{1},\cL_{2}\in \KM$ such
that $\cL_{1}\succ \cD$ and $\cL_{1}+\cL_{2}=\cL$.

Let $\KM(\star)$ be the sub-monoid of $\KM$ generated by $\MYD(\star)$.
Note that $\KM(\star)$ is not a sub semi-ring of $\KM$.

For $\cL = \sum_{i=1}^{k}\cL_{i}\in \KM$ with $\cL_{i}\in \MYD$, we let
\[
  \ssign(\cL)= \Set{\ssign(\cL_{i})|i=1,\cdots,k}\text{ and }
  \lsign(\cL)= \Set{\lsign(\cL_{i})|i=1,\cdots,k}
\]

\subsection{Operations on $\KM(\star)$}
\def\npp{\#_{+}}
\def\nmm{\#_{-}}
% We use $\npp(\cS)$ to denote the number of $+$ and $\upp$ in the object $\cS$.
% For example $\npp(\tytb{\upp\umm\upp,+})=3$.

% The involution $\overline{\phantom{+}}$ defined in \eqref{eq:def.bar} extends to
% an in

The operation $\dagger$ defined in \eqref{eq:def.dagger} extends to an operation
\[
  \dagger \colon \KM\longrightarrow \KM
\]
on $\KM$ which adding a column on the left of the original marked Young diagram.


\subsubsection{Character twists on $\KM(D)$ and $\KM(B)$}
\label{sec:tchar.DB}
Recall that  $\bZ/2\bZ\times \bZ/2\bZ$ paramterizes
the characters of a indefinite orthogonal group $\rO(p,q)$:
\[
  \chi=(\chi^{+},\chi^{-})\longleftrightarrow (\bfone^{-,+})^{\chi^{+}}\otimes (\bfone^{+,-})^{\chi^{-}}.
\]

We define the action of $\bZ/2\bZ \times \bZ/2\bZ$ action on $\sfM$ by:
\[
  \bfrr \otimes \chi := \begin{cases}
    \overline{\bfrr} & \text{if } p+q \equiv 1 \text{ and }\chi^{+}p + \chi^{-} q\equiv 1 \pmod{2}\\
    \bfrr & \text{otherwise}%\text{if } \chi^{+}p + \chi^{-}q\equiv 0 \pmod{2} \\
  \end{cases}
\]
where $\bfrr\in \sfM, \chi=(\chi^{+},\chi^{-}) \in \bZ/2\bZ\times \bZ/2\bZ$ and
$(p,q)=\ssign(\bfrr)$.

The $\bZ/2\bZ\times \bZ/2\bZ$ action extends to actions on $\KM(D)$ and $\KM(B)$.
% Now $\bZ/2\bZ\times \bZ/2\bZ$ has an action on $\KM(D)$ and $\KM(B)$ defined as
% the following:

% Let $\chi\in \bZ/2\bZ\times \bZ/2\bZ$ and $\set{}$


% We use $\cB\cdot\cC$ to denote attach the local system $\cC$ below $\cB$ and the
% operation is distributive. And use $\cup$ or $+$ to denote the union of local systems
% systems.

\subsubsection{Twists on $\KM(C)$ and $\KM(M)$}
We define an involution $\maltese_{C} \colon \sfM\rightarrow \sfM$ on $\sfM$ by
\[
  \maltese(\bfrr):= \begin{cases}
    \overline{\bfrr} & \text{if } \abs{\bfrr} \equiv 2 \pmod{4}\\
    \bfrr & \text{otherwise}.
  \end{cases}
\]
The involution $\maltese$ extends to an involution on $\KM$.%$(C)$.
We will only apply $\maltese$ on $\cL\in \KM(C)$ or $\KM(M)$.

% Now fix a signature $(p,q)\in \bN\times \bN$ such that $p+q$ is even.
% For $\cL\in \KM(C)$, we define
% \[
%   \maltese_{(p,q)}(\cL) := \maltese^{\frac{p-q}{2}}(\cL)= \begin{cases}
%     \cL & \text{if } p-q \equiv 0 \pmod{4}\\
%     \maltese(\cL) & \text{if } p-q \equiv 2 \pmod{4}\\
%   \end{cases}
% \]
% For $\cL\in \KM(M)$, let
% \[
%   \maltese_{(p,q)}:=\maltese^{\frac{p-q-1}/2} =
%   \begin{case}
%     \cL & \text{if } p-q\equiv 1 \pmod{4}\\
%     \maltese{\cL} & \text{if } p-q\equiv 3 \pmod{4}
%   \end{case}
% \]

% \[
%   \maltese^{(p,q)}:=\maltese^{\frac{p-q+1}/2} =
%   \begin{case}
%     \cL & \text{if } p-q\equiv 3 \pmod{4}\\
%     \maltese{\cL} & \text{if } p-q\equiv 1 \pmod{4}
%   \end{case}
% \]
% We define the action of $\bZ/2\bZ \times \bZ/2\bZ$ action on $\sfM$ by:
% \[
%   \bfrr \otimes \chi := \begin{cases}
%     \overline{\bfrr} & \text{if } p+q \equiv 1 \text{ and }\chi^{+}p + \chi^{-} q\equiv 1 \pmod{2}\\
%     \bfrr & \text{otherwise}%\text{if } \chi^{+}p + \chi^{-}q\equiv 0 \pmod{2} \\
%   \end{cases}
% \]
% where $\bfrr\in \sfM, \chi=(\chi^{+},\chi^{-}) \in \bZ/2\bZ\times \bZ/2\bZ$ and
% $(p,q)=\ssign(\bfrr)$.

% The $\bZ/2\bZ\times \bZ/2\bZ$ action extends to actions on $\KM(D)$ and $\KM(B)$.

\subsubsection{Truncations}% on $\KM(D)$ and $\KM(B)$}.

\def\Tpp{\sfT^+}
\def\Tmm{\sfT^-}
\def\Tpm{\sfT^{\pm}}

We define the Truncation maps %$\Tpp$ and $\Tmm$
\[
  \Tpp \colon \KM\longrightarrow \KM
\]
such that for $\cL\in \MYD$
\[
\Tpp(\cL) = \begin{cases}
  \cL_{1} & \text{if there is $\cL_{1}\in \MYD$ such that $\cL_{1}\cdot + = \cL $}\\
  0 & \text{otherwise}
\end{cases}
\]
We define $\Tmm\colon \KM \longrightarrow \KM$ similarly such that
$\cL=\Tmm(\cL)\cdot - $ if $\cL\succ -$ and $\Tmm(\cL)=0$
otherwise for $\cL\in \MYD$.

To symplify the notation, we write $\sL^{\pm} := \Tpm(\sL)$ for $\cL\in \KM$.

\subsection{Theta lifts of local systems}


\subsubsection{Lift from type C to D}

For each signature $(p,q)\in \bN\times \bN$ such that $p+q$ is even, we define a map
\[
  \vartheta_{CD,(p,q)} \colon \KM(C)\rightarrow \KM(D)
\]
as the following:
Let $\cL\in \MYD(C)$. Let $(p_{1},q_{1})=\lsign(\cL)$ and
\[
(p_{0}, q_{0})  = (p,q) -\ssign(\cL)-(q_{1},p_{1}).
\]
We define
\[
  \vartheta_{CD,(p,q)}(\cL) =
  \begin{cases}
    (\dagger \maltese^{\frac{p-q}{2}}(\cL))\cdot \dagger_{p_{0}, q_{0}} &
    \text{if } p_{0}\geq 0 \text{ and } q_{0} \geq 0 \\
    0 & \text{otherwise}
  \end{cases}
\]


\subsubsection{Lift from type D to type C}

For each non-zero integer $n\in \bN$, we define a map
\[
  \vartheta_{DC,n} \colon \KM(D)\rightarrow \KM(C)
\]
as the following:
Let $\cL\in \MYD(D)$. Let $(p_{1},q_{1})=\lsign(\cL)$ and
$(p,q) = \ssign(\cL)$.
Let
\[
  n_{0} = n - (p+q)/2 - (p_{1}+q_{1})/2
\]
We define
\[
  \vartheta_{DC,n}(\cL) =
  \begin{cases}
    \maltese^{\frac{p-q}{2}}((\dagger \cL)\cdot \dagger_{n_{0}, n_{0}}) &
    \text{if } n_{0}\in \bZ_{\geq 0}\\
    \maltese^{\frac{p-q}{2}}(\dagger \cL^{+}  + \dagger \cL^{-})& \text{if } n_{0}=-1\\
    0&\text{otherwise}
  \end{cases}
\]
We remark that
$\maltese^{\frac{p-q}{2}}((\dagger \cL)\cdot \dagger_{n_{0}, n_{0}})= (\maltese^{\frac{p-q}{2}}(\dagger\cL))\cdot \dagger_{n_{0},n_{0}}$.

\trivial{
  We take a splitting $\rO(p,q)\times \Sp(n,\bR)$ in to the big metaplectic
  group $\Mp$ such that $\rO(p,\bC)\times\rO(q,\bC)$ acts on the Fock model linearly.
  The maximal compact $K_{\Sp(n,\bR)}= \rU(2n)$ acts on the Fock model by the
  character $\zeta=\det^{(p-q)/2}$.
  For the component of the rational nilpotent orbit $\Sp(2n,\bR)$,
  the factor of the component group is $\Sp$ if the corresponding row has odd
  length.
  Otherwise the component group is $\rO(p_{2k})\times\rO(q_{2k})$ where
  $(p_{2k},q_{2k})$ is the signature corresponding to the $2k$-rows.
  $\zeta|_{\rO(p_{2k})}= \det^{(p-q)k/2}_{\rO(p_{2k})}$ which is nontrivial if
  and only if $p-q\equiv 2\pmod{4}$ and $2k\equiv 2\pmod{4}$.
  This gives the formula above.
}


{
  \color{red}
  In the proof later, we don't care above the marks for rows with length longer
  than 1 in the most of the case. So we will omit $\maltese_{(p,q)}$.
  When there is no confusion, we will simply write $\vartheta$ for
  $\vartheta_{CD,(p,q)}$ and $\vartheta_{CD,(p,q)}$.
}


\subsubsection{Lift from type M to B}

For each signature $(p,q)\in \bN\times \bN$ such that $p+q$ is odd, we define a map
\[
  \vartheta_{MB,(p,q)} \colon \KM(M)\rightarrow \KM(B)
\]
as the following:
Let $\cL\in \MYD(M)$. Let $(p_{1},q_{1})=\lsign(\cL)$ and
\[
(p_{0}, q_{0})  = (p,q) -\ssign(\cL)-(q_{1},p_{1}).
\]
We define
\[
  \vartheta_{MB,(p,q)}(\cL) =
  \begin{cases}
    (\dagger \maltese^{\frac{p-q+1}{2}}(\cL))\cdot \dagger_{p_{0}, q_{0}} &
    \text{if } p_{0}\geq 0 \text{ and } q_{0} \geq 0\\
    0 & \text{otherwise}
  \end{cases}
\]


\subsubsection{Lift from type B to type M}

For each non-zero integer $n\in \bN$, we define a map
\[
  \vartheta_{BM,n} \colon \KM(B)\rightarrow \KM(M)
\]
as the following:
Let $\cL\in \MYD(D)$. Let $(p_{1},q_{1})=\lsign(\cL)$ and
$(p,q) = \ssign(\cL)$.
Let
\[
  n_{0} = n - (p+q)/2 - (p_{1}+q_{1})/2
\]
We define
\[
  \vartheta_{BM,n}(\cL) =
  \begin{cases}
    \maltese^{\frac{p-q-1}{2}}((\dagger \cL)\cdot \dagger_{n_{0}, n_{0}}) &
    \text{if } n_{0}\in \bZ_{\geq 0}\\
    \maltese^{\frac{p-q-1}{2}}(\dagger \cL^{+}  + \dagger \cL^{-})& \text{if } n_{0}=-1\\
    0&\text{otherwise}
  \end{cases}
\]
We remark that
$\maltese^{\frac{p-q-1}{2}}((\dagger \cL)\cdot \dagger_{n_{0}, n_{0}})= (\maltese^{\frac{p-q-1}{2}}(\dagger\cL))\cdot \dagger_{n_{0},n_{0}}$.

\trivial{
  For odd orthogonal-metaplectic group case, we still take the splitting such
  that $\rO(p,q)$ acts linearly.

  The maximal compact $\wtK_{\Sp(n,\bR)}= \widetilde{\rU(2n)}$ acts on the Fock model by the
  character $\zeta=\det^{(p-q)/2}$.

  Then
  $\det^{(p-q)/2}|_{\rO(p_{2k})\times \rO(q_{2k})}=\det^{\frac{(p-q)k}{2}}_{\rO(p_{2k})}\boxtimes
  \det^{\frac{(p-q)k}{2}}_{\rO(q_{2k})}. $
  Note that $p-q$ is an odd number.
  When $k$ is even the character on $\widetilde{\rO(p_{2k})}/\widetilde{\rO(q_{2k})}$ are
  $\bfone$ or $\det$. When $k$ is odd the character would be $\det^{\half}$ or
  $\det^{\half+1}$.

  We assume the default character on $2k$-rows is $\det^{\frac{k}{2}}$, and
  we use $+/-$ to mark the row. Otherwise, we use $\upp/\umm$ to mark the rows.
}

\subsection{Examples and remarks}

\subsubsection{Example}
\begin{eg}
  Let
  $\cT :=\dagger\dagger (\dagger_{2,1}) + \dagger\dagger(\dagger_{{1,2}})$ and $\cP= \ddagger_{1,3}$.
  Then
  \[
    \cT\cdot \cP = \tytb{\uup\uum\uup,\uup\uum\uup,\uum\uup\uum,+,=,=,=}
    \cup
    \tytb{\uup\uum\uup,\uum\uup\uum,\uum\uup\uum,+,=,=,=}.
  \]
\end{eg}


% For each local system $\cL$ of type B/D, define $\pcL$ (resp. $\ncL$) be the
% part of $\cL$ obtained by deleting a ``$+$''-symbol (resp. ``$-$''=symbol) among 1-rows.
% $\pcL:=0$ (resp. $\ncL:=0$) if there is no ``$+$''-symbol (resp.
% ``$-$''-symbol).

% For an local system $\cL$, $\cL\succeq\cC$ means there is a
% factorization of $\cL = \cB\cdot \cC$;
% $\cL\supset \cC$ means there is an irreducible component $\cL_{1}$ of $\cL$ such
% that $\cL_{1}\succeq \cC$.


% \subsubsection{}

%\subsection{Definition of $\eDD$}
\subsubsection{Signs of the local systems obtained by iterated lifting}


Suppose $\cL\in \KM$ is obtained by iterated theta lifting and character
twisting in \Cref{sec:tchar.DB}.
Then the set $\lsign(\cL)$ has restricted possibilities.
First, $\ssign(\cL)$ is always a singleton.

When $\cO$ is of type B/D, $\lsign(\cL)$ is a singleton $\set{(p_{1},q_{1})}$
where
\[
  (p_{1},q_{1})= \ssign(\cL) - (n_{0},n_{0}) \quad \text{and} \quad 2n_{0} = \abs{\eDD(\cO)}.
\]

When $\cO$ is of type C/M,
$\lsign( \cL ) =\set{ (p_{1},q_{1})}$ is a singleton in the most of the case.
The $\lsign(\cL)$
may have two elements if $\cL$ is obtained by good generalized lifting, and it has the form
$\lsign( \cL ) = \set{(p_{1}+1,q_{1}),(p_{1},q_{1}+1)}$.

% Another important invariant is $\bsign( \cL )$ which indicates the signature of
% the local system of length one rows in $\cL$.


\section{Proof of main theorem in the type C/D case}
We do induction on the number of columns of the nilpotent orbits.
\subsection{Notation}
In this section, $\cO$ is always an nilpotent orbit of type D in $\dpeNil(D)$.
We always let
\[
  \begin{split}
    \cO &= (C_{2k+1}, C_{2k}, C_{2k-1}, \cdots,C_{1},C_{0}),\\
    \cOp &=\eDD(\cO)=(C_{2k}, C_{2k-1},\cdots,C_{1},C_{0} ).
    \end{split}
\]
When  $k\geq 1$, we let
\[
    \cOpp  = \eDD^{2}(\cO) =
    \begin{cases}
      (C_{2k-1},\cdots,C_{1},C_{0} ) & \text{when  $C_{2k}$ is even},\\
      (C_{2k-1}+1,\cdots,C_{1},C_{0} ) & \text{when  $C_{2k}$ is odd}.\\
    \end{cases}
\]

For a $\uptau\in \drc(\cO)$, we let
\[
(\uptaup,\upepsilon)=\eDD(\uptau) \quad\text{ and }\quad
   (\uptaupp,\upepsilon')=\eDD(\uptaup) \text{ (when $k\geq 1$)}.
 \]

 \subsubsection{Main proposition}
The aim of this section is to prove the following main proposition holds for
$\cO\in \dpeNil(D)$.
% with only one column.

%Inductively, we will assume the following claims holds for $\cOpp$.

\begin{prop}\label{prop:CD}
   We have:
  \begin{enumS}
    \item \label{p:drcls.0} $\cL_{\uptau}$ is non-zero. In particular,
    $\uppi_{\uptau}\neq 0$.
    \item %\label{p:drcls.4}
    Suppose $\uptaup_{1}\neq \uptaup_{2}\in\drc(\cOp)$, then $\uppi_{\uptaup_{1}}\neq \uppi_{\uptaup_{2}}$.
    \item \label{p:drcls.4}
    Suppose $\uptau_{1}\neq \uptau_{2}\in\drc(\cO)$, then $\uppi_{\uptau_{1}}\neq \uppi_{\uptau_{2}}$.
    \item \label{p:drcls.1}
    The local system $\cL_{\uptau}$ is disjoint with their determinant twist:
    \begin{equation}\label{eq:LS.dis}
      \set{\cL_{\uptau} | \uptau \in \drc(\cO)} \cap \set{\cL_{\uptau}\otimes \det| \uptau\in \drc(\cO)} = \emptyset.
    \end{equation}
    % \item \label{p:drcls.4}
    % Suppose $\uptau_{1}\neq \uptau_{2}$, then $\uppi_{\uptau_{1}}\neq \uppi_{\uptau_{2}}$.
    % \item \label{p:drcls.2}
    % Compatible with LS lifting: Suppose $\uptaup_{1}\in [\cL_{\uptaup}]$ and
    % $\uptaup_{1}\neq \uptaup$, then
    % there is (a unique) $\uptau_{1}\in \cL_{\uptau}$ such that
    % $\eDD(\uptau_{1}) = (\uptaup_{1},\upepsilon)$ and $\uptau_{1}\neq \uptau$.

    % \item  \label{p:drcls.3}
    % Suppose $\upepsilon=0$.
    % $\cL_{\uptau}\neq \cL_{\uptau}\otimes \bfonepn$.
    %Therefore $\lUnip(\cO)=\Unip(\cO)$.
    \item  $x_{\uptau}$ determine the factorization of local system described in
    \Cref{tab:ls.factor}:
    \[
      \cL_{\uptau} = \sum_{i=-k}^{k} \cB_{\uptau,i}\cdot \cD_{\uptau,i}.
    \]
    %Here $i$ running over a finite index set.
    The key properties of the factorization are
    \begin{equation}\label{eq:bd.prop}
      \begin{split}
        (\cB_{\uptau,i}\cdot\cD_{\uptau,i})^{+} &=
        \begin{cases}
          \cB_{\uptau,i}\cdot (\cD_{\uptau,i})^{+} & \text{for } i \geq 0\\
          0 & \text{for }i < 0\\
        \end{cases}
        ,\\
        (\cB_{\uptau,i}\cdot\cD_{\uptau,i})^{-} &=
        \begin{cases}
          0 &\text{for } i > 0\\
          \cB_{\uptau,i}\cdot (\cD_{\uptau,i})^{-} &\text{for } i \leq 0\\
        \end{cases}\\
        \text{and } \quad \lsign(\cD_{\uptau,i}) & = \ssign(\bfxx_{\uptau}).
      \end{split}
    \end{equation}

    % \begin{equation}\label{eq:ls.factor}
  %   \begin{array}{c|c|c|c}
  %     x_{\uptau} & \cL_{\uptau} & \cD_{\uptau} &\\
  %     \hline
  %     s & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cD_{\uptau,i} & \cD_{\uptau,1}=\tytb{=,=},
  %                                                                        \cD_{\uptau,2}= \tytb{\uum\cdots,=}
  %     &\begin{minipage}{10em}exactly one of $\cB_{\uptau,1}$ and $\cB_{\uptau,2}$ is non-zero \end{minipage} \\
  %     \hline
  %     r & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cD_{\uptau,i} & \cD_{\uptau,1}=\tytb{+,+},
  %                                                                        \cD_{\uptau,2} = \tytb{\uup\cdots,+}
  %     & \begin{minipage}{10em}exactly one of $\cB_{\uptau,1}$ and $\cB_{\uptau,2}$ is non-zero \end{minipage} \\
  %     \hline
  %     %\ytb{sd\cdots,\vdots,s,c} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cD_{\uptau,i} &  \cD_{\uptau,1} = \ytb{\uum\cdots,+},
  %     %                                                                                      \cD_{\uptau,2}=\ytb{\uup\cdots,=}
  %     %                                         &  \#s \geq 0\\
  %     %\hdashline
  %     %\ytb{\star\cdots,\vdots, c} & \cB_{\uptau,1}\cD_{\uptau,1} &  \cD_{\uptau,1} = \ytb{\uum\cdots,+} & \\
  %     %& & & \cB_{\uptau,2}\neq \emptyset \text{only if
  %     %      } \bfxx_{\uptau} = (s\cdots sc)^{t}\\
  %    c
  %                    & \displaystyle\sum_{i=1}^{2} \cB_{\uptau,i}\cdot\cD_{\uptau,i}
  %                                   &  \cD_{\uptau,1} = \tytb{\uum\cdots,+},
  %                                     \cD_{\uptau,2}= \tytb{\uup\cdots,=}
  %                                                  & \cB_{\uptau,1}\neq \emptyset.
  %     \\
  %     %& & & \cB_{\uptau,2}\neq \emptyset \text{only if
  %     %      } \bfxx_{\uptau} = (s\cdots sc)^{t}\\
  %    \hline
  %    d & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cD_{\uptau,i} &  \cD_{\uptau,1} = \tytb{\uum\cdots,+},
  %                                                                                            \cD_{\uptau,2}=\tytb{\uup\cdots,-}
  %                                              &\cB_{\uptau,1}\text{ and }\cB_{\uptau,2}\neq \emptyset\\
  %   \end{array}
  % \end{equation}
  \begin{table}[pb]
    \[
      \begin{array}{c|c|c|c}
        x_{\uptau} & \cL_{\uptau} & \cD_{\uptau} &\\
        \hline
        s & \displaystyle\sum_{i=0}^{k}\cB_{\uptau,-i}\cdot\cD_{\uptau,-i}
                                  & %\cD_{\uptau,1}=\tytb{=,=},
                                    \cD_{\uptau,i}=\begin{cases}
                                      0 & \text{when } i>0\\
                                    \tytb{\uum\cdots\uum,=}  & \text{when
                                    } i\leq 0
                                  \end{cases}
          & \exists i\geq 0 \text{ s.t. } \cB_{\uptau,-i}\neq 0 \\
        \hline
        r & \displaystyle\sum_{i=0}^{k}\cB_{\uptau,i}\cdot\cD_{\uptau,i}
                                  & \cD_{\uptau,i}=
                                    \begin{cases}
                                      \tytb{\uup\cdots\uup,+} & \text{when } i\geq 0\\
                                      0&  \text{when } i<0
                                    \end{cases}
                                  & \exists i\geq 0 \text{ s.t. } \cB_{\uptau,i}\neq 0 \\
        \hline
        c
                   & \displaystyle\sum_{i=-k}^{k} \cB_{\uptau,i}\cdot\cD_{\uptau,i}
                                  &  \cD_{\uptau,i} =\begin{cases} \tytb{\uum\cdots\uum,+} & \text{when
                                    } i\geq 0,\\
                                    \tytb{\uup\cdots\uup,=} & \text{when }i <0
                                  \end{cases}
                                  &  \exists i\geq 0 \text{ s.t. } \cB_{\uptau,i}\neq 0.
        \\
        \hline
        d
                   & \displaystyle\sum_{i=-k}^{k} \cB_{\uptau,i}\cdot\cD_{\uptau,i}
                                  &  \cD_{\uptau,i} =\begin{cases} \tytb{\uum\cdots\uum,+} & \text{when
                                    } i\geq 0,\\
                                    \tytb{\uup\cdots\uup,-} & \text{when }i <0
                                  \end{cases}
                                  &  \exists i,j\geq 0 \text{ s.t. }
                                    \begin{cases}
                                      \cB_{\uptau,i}\neq 0,\\% &\\ %\text{and} \\
                                      \cB_{\uptau,-j}\neq 0.% &.  \\
                                    \end{cases}

      \end{array}
    \]
  In the above table $\uup\cdots\uup$ or $\uum\cdots\uum$ has length $2i+1$
  where we do not specify the associated character of the local system on these rows when $i\neq 0$.

  (The associated character depends on $\uptau$ and can be
  specified inductively.)

  The local system of $\cD_{\uptau,0}$ is specified in the following
  table:
  \begin{equation}\label{eq:ls.srcd}
   \begin{array}{c|c|c|c|c}
      x_{\uptau} &  s & r & c &d \\
      \hline
      \cD_{\uptau,0} & \tiny \tytb{=,=} &\tiny \tytb{+,+} & \tiny \tytb{+,=} &\tiny \tytb{+,-}
    \end{array}
  \end{equation}
    \caption{Factorization of the local system}
    \label{tab:ls.factor}
    \label{eq:ls.factor}
  \end{table}
  \item
  In particular, we have:
  \begin{enumT}
    \item $x_{\uptau} = s$, then $\pcL_{\uptau} = \ncL_{\uptau} = 0$.
    \item $x_{\uptau} = r/c$, then $\pcL_{\uptau} \neq 0$ and $\ncL_{\uptau}=0$.
    \item $x_{\uptau} = d$, then $\pcL_{\uptau}\neq 0$ and $\ncL_{\uptau}\neq 0$.
  \end{enumT}
  % \item
  % When $x_{\uptau}=c$, $\cD_{\uptau,2}\neq \emptyset$ only if
  % $\bftt_{\uptau} = \ytb{sd\cdots, \vdots,s,c}$.
  \item If $\cOp \leadsto \cOpp$ is a usual descent, we have a simpler
  factorization:
  \begin{equation}\label{eq:d.factor}
    \cL_{\uptau} = \cB_{\uptau,0}\cdot \cD_{\uptau,0}
  \end{equation}
  where $\cD_{\uptau,0}$ is given by \eqref{eq:ls.srcd}.

  In particular, $\cD_{\uptau,0}=\tytb{=,=}$ (resp.
  $\cD_{\uptau,0}=\tytb{+,+}$) if and only if all 1-rows
  of $\cL_{\uptau}$ have ``$=$'' marks (resp. ``+'' marks), i.e. $x_{\uptau}=s$
  (resp. $x_{\uptau}=r$).
  \item When $\cOp$ is noticed, the map
  $\cL\colon \drc( \cOp )\longrightarrow \LLS(\cOp)$ is a bijection.
  \item When $\cO$ is noticed, the map
  $\cL\colon \drc(\cO)\longrightarrow \LLS(\cO)$ is a bijection.
    \item When $\cO$ is +noticed, the maps
    % $\pUpsilon_{1}:=\pr_{1}\circ \Upsilon$
    \[
      \begin{tikzcd}[row sep=0em]
        \pUpsilon_{\cO} \colon \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0} \ar[r] & \set{\pcL_{\uptau}}\\
       \cL_{\uptau} \ar[r,maps to] & \pcL_{\uptau}& \text{and}\\
        \nUpsilon_{\cO} \colon \set{\cL_{\uptau}|\ncL_{\uptau}\neq 0} \ar[r] & \set{\ncL_{\uptau}}&\\
       \cL_{\uptau} \ar[r,maps to] & \ncL_{\uptau}
      \end{tikzcd}
    \]
    are injective.
    % \item If $C_{2k+1}-C_{2k}\geq 2$ and $\bfxx_{\uptau}$ ends with $d$, $\cL_{\uptau}$ has an irreducible
    % component $\succeq \dagger_{(1,1)}$. In particular, if $\cO$ is +noticed and
    % $\bfxx_{\uptau}$ ends with $d$, we have
    % $\cL_{\uptau}\supset \dagger_{(1,1)}$.
    \item When $\cO$ is noticed, the map
    \begin{equation}\label{eq:up}
      \begin{tikzcd}[row sep=0em]
        \Upsilon_{\cO} \colon \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0} \ar[r] & \set{(\pcL_{\uptau},\ncL_{\uptau})|\pcL_{\uptau}\neq 0} \\
        \cL_{\uptau} \ar[r,maps to] & (\pcL_{\uptau},\ncL_{\uptau})
      \end{tikzcd}
    \end{equation}
    is injective.\footnote{In fact, we only need to know whether $\ncL_{\uptau}$ is
      non-zero or not.}
  \end{enumS}
\end{prop}

Note that, $\drc(\cO)$ counts the unipotent representations of special
orthogonal groups a priori. But \Cref{prop:CD}~\eqref{p:drcls.1}, implies that the representation
$\uppi_{\uptau}$ and $\uppi_{\uptau}\otimes \det$ are two different
representations of the orthogonal groups. Therefore $\drc(\cO)\times \bZ/2\bZ$
counts the set of unipotent representations of orthogonal groups.

The factorization \eqref{eq:ls.srcd} also holds in more general cases, we
indicate when it holds in the proof of \Cref{prop:CD}.

The main theorem would be a consequence of \Cref{prop:CD}.

\subsubsection{How to think about the factorization of local systems}
When % $C_{2k}$ is even, i.e.
$\cOp\leadsto \cOpp$ is the usual descent,
the local system $\cL_{\uptau}$ could be compared to a water hydra, see in
\Cref{fig:wh}.
\begin{figure}[pb]
\includestandalone[width=.5\textwidth]{hydra}
 % \includegraphics[scale=0.5]{abc.pdf}
  \caption{Freshwater hydra}
  \label{fig:wh}
\end{figure}

The tentacles part $\cT_{\uptau} = \dagger \cL_{\uptaup}$
could be reducible. The peduncle part $\cP_{\uptau} := \cL_{\bfxx_{\uptau}}$ and
$\cL_{\uptau} = \cT_{\uptau}\cdot \cP_{\uptau}$.

On the other hand, $\cL_{\uptau}$ also could be factorized into the body part
and the basal
disk part:
\[
  \cL_{\uptau} = \cB_{\uptau,0}\cdot \cD_{\uptau,0}.
\]
Here $\cD_{\uptau,0}$ is given in \eqref{eq:ls.srcd}.
% ) which will be used in the
% generalized descent case.

\medskip

When $\cOp\leadsto \cOpp$ is a generalized descent, the situation is more
complicated as the local system $\cL_{\uptau}$ may consists of several ``hydras''.

To ease the notation, we will set $\cB_{\uptau} :=\cB_{\uptau,0}$  and
$\cD_{\uptau} :=\cD_{\uptau,0}$
in the following proof.
% %On the other hand, $x_{\uptau}$ could been detected from the following list of 1-rows:
% \[
% \begin{array}{c|c|c|c|c}
%   x_{\uptau} &  s & r & c &d \\
%   \hline
%   \cD_{\uptau} & \tiny \ytb{=,=} &\tiny \ytb{+,+} & \tiny \ytb{+,=} &\tiny \ytb{+,-}
% \end{array}
% \]

% Here $x_{\uptau}=s$ (resp. $x_{n}=r$) is equivalent to that only $=$ (resp. $+$)
% occurs in 1-rows of $\cL_{\uptau}$.


% Therefore
% \[
% \cL_{\uptau} = \vartheta(\cL_{\uptaup})\otimes (\bfone^{+,-})^{\upepsilon}\mapsto (\cL_{\uptaup}, \upepsilon)
% \]
% is a bijection on $\LLS(\cO,\rO(p,q))$
% In particular, \Cref{prop:CD.1} \ref{p:drcls.1}% ,  \ref{p:drcls.2}
% and \ref{p:drcls.3} can be read
% off from the character twist action on the local systems in the above
% table.

% \Cref{prop:CD.1}~\ref{p:drcls.4} follows from the fact that $\lUnip(\cO')=\Unip(\cO')$.
% Note that in this case $\uptaupp$ is the subdiagram of $\uptau$ and $*$'s above
% $x_{1}$ must be $\bullet$.

% \subsubsection{descent of nonspecial dot-r-c diagram} \label{sec:dd.nonsep}
% In the most of the case the $\uptaup$ is obtained by deleting the most left
% column of $\uptau$ and then apply the dot-s switch algorithm.

% Now we list the exceptional case:
% \[
% \begin{array}{c|c|c}
%   \ytb{{x_{0}}{y_{1}},{x_{1}}{y_{2}},\vdots,{x_{n}}}= & \ytb{rc,{x_{1}}d,\vdots,{x_{n}}} & \ytb{cc,dd,\ ,\ }\\
%   \hline
%   \ytb{{z_{1}},{z_{2}}}= & \ytb{r,r} & \ytb{r,c}\\
% \end{array}
% \]

% \subsubsection{specail-nonspecial twist} \label{sec:nsp.twist}
% Let $\uptau$ and $\uptaup$ be two diagram in $\drc(\cO)$ with the following
% shape. We assume $\cOp\leadsto \cOpp$ is a usual descent.
% Fix the leg $\bfxx = x_{1}\cdots x_{n}$.
% \begin{claim}
%   There is an bijection between diagrams
% \[
%   \uptau_{1} = \ytb{\bullet{w_{0}}\cdots,\bullet{w_{1}}{w_{2}}\cdots,{x_{1}},{x_{2}},\vdots,{x_{n}}}\times
%   \ytb{\bullet\cdots,\bullet,\ ,\ ,\ ,\ }
%   \longleftrightarrow
%   \uptau_{2} = \ytb{\bullet{y_{0}}\cdots\cdots,{x_{0}}{y_{1}}{y_{2}}\cdots,{x_{1}}{y_{3}},{x_{2}},\vdots,{x_{n}}}\times
%   \ytb{\bullet\cdots,\ ,\ ,\ ,\ ,\ }
% \]
% such that
% $\uptaup_{2} = \eDD(\uptau_{2})$ is the non-special twist of $\uptaup_{1} = \eDD(\uptau_{1})$ (see \eqref{eq:nonsp.twist}).
% Moreover, $\ssign(\uptau_{1}) = \ssign(\uptau_{2})$.
% \end{claim}
% \begin{proof}
%   This is by \eqref{eq:nonsp.twist} and \eqref{eq:d.nonsp.e}.
%   {\color{red}Detail is needed to be written.}
% \end{proof}

%\subsection{Proof of \Cref{thm:count} for type C/D}

\subsection{The initial case:}\label{sec:pfDC.init}
When $k=0$, $\cO = (C_{1}=2c_{1},C_{0}=2c_{0})$ has  at most
two columns.
Now $\uppi_{\uptaup}$ is the trivial representation of $\Sp(2c_{0},\bR)$.
The lift $\uppi_{\uptaup} \mapsto \Thetab(\uppi_{\uptaup})$ is in fact a stable
range theta lift.%, and therefore $\uppi_{\uptau}\neq 0$.
For $\uptau\in \drc(\cO)$, let $(p_{1},q_{1}) = \ssign(\bfxx_{\uptau})$ and
$x_{\uptau}$ be the foot of $\uptau$. It is easy to see that  (using associated
character formula)
\[
  \cL_{\uppi_{\uptau}} = \cT_{\uptau}\cdot \cP_{\uptau},
  \text{ where }\cT_{\uptau}:=\dagger \dagger_{c_{0},c_{0}},
  \text{ and } \cP_{\uptau}:=\begin{cases}
    \ddagger_{p_{1},q_{1}}&  x_{\uptau} \neq d,\\
    \dagger_{p_{1},q_{1}}& x_{\uptau} = d.\\
  \end{cases}
\]
Note that $\cL_{\uppi_{\uptau}}$ is irreducible.

Let $\cO_{1} = (2(c_{1}-c_{0}))\in \dpeNil(D)$. Using the above formula,
one can check that the following maps are bijections
\[
  \begin{tikzcd}[row sep=0em]
    \drc(\cO_{1}) &\ar[l] \drc(\cO) \ar[r] & \LLS(\cO)\\
    \bfxx_{\uptau} & \ar[l,maps to] \uptau \ar[r,mapsto] & \cL_{\uptau}.
  \end{tikzcd}
\]
To see that $\drc(\cO)\ni\uptau\mapsto \cL_{\uptau}$ is an injection, one check the
following claim holds:
\begin{claim}\label{c:init.CD}
  The map $\drc(\cO_{1})\longrightarrow \bN^{2}\times \bZ/2\bZ$ given by
  $\uptau\mapsto (\ssign(\uptau),\upepsilon_{\uptau})$ is injective (see
  \Cref{sec:upepsilon} for the definition of $\upepsilon_{\uptau}$). Moreover,
  $\upepsilon_{\uptau}=0$ only if $\ssign(\uptau)\geq (0,1)$. \qedhere
\end{claim}


Moreover, $\cL_{\uptau}\otimes \det \notin \LLS(\cO)$ for any $\uptau\in \drc(\cO)$.
In fact, if $\ssign(\bfxx_{\uptau})\succeq (1,0)$, $\cL_{\uptau}$
on the 1-rows with $+$-signs is trivial and $\cL_{\uptau}\otimes \det$ has
non-trivial restriction. When $\ssign(\bfxx_{\uptau})\nsucceq (1,0)$,
$\bfxx_{\uptau}=s\cdots s$, all 1-rows of $\cL_{\uptau}$ are marked by ``$=$'' and
all 1-rows of $\cL_{\uptau}\otimes \det$ are  marked by ``$-$''.

Obviously we have a factoriation of the peduncle:
\begin{equation}\label{eq:ped.factor1}
  \cP_{\uptau} = \cL_{\bfxx_{\uptau}} = \cB_{\bfxx_{\uptau}}\cdot \cD_{\bfxx_{\uptau}}
  \text{ with }
  \cB_{\bfxx_{\uptau}}:=\begin{cases}
    \ddagger_{\ssign(x_{1}\cdots x_{n-1})} & \text{when }x_{\uptau} \neq d\\
    \dagger_{\ssign(x_{1}\cdots x_{n-1})} & \text{when }x_{\uptau} = d\\
  \end{cases}
\end{equation}
and $\cD_{\bfxx_{\uptau}}$ given in \eqref{eq:ls.srcd}.
Now
\begin{equation}\label{eq:bd.factor2}
  \cL_{\uptau} = \cB_{\uptau}\cdot \cD_{\uptau} \text{ with
  } \cB_{\uptau}:=\cT_{\uptau} \cdot \cB_{\bfxx_{\uptau}} \text{ and }
  \cD_{\uptau} := \cD_{\bfxx_{\uptau}}.
\end{equation}
and so the factorization \eqref{eq:d.factor} holds.
% For the above discussion, one can immediately deduce the factorization of local
% system of $\cL_{\uptau}$ in \eqref{eq:ls.factor}.



Therefore, our main theorem, \Cref{thm:count}, holds for $\cO$.


\subsection{The descent case}
Now we assume $k\geq 1$ and $C_{2k}$ is even. In this case $\cOp\leadsto \cOpp$
is a usual descent.

\subsubsection{Unipotent representations attached to $\cOp$}
Therefore, $\LS(\cOpp)\longrightarrow \LS(\cOp)$ given by
$\cL\mapsto \vartheta(\cL)$ is an injection between abelian groups.


For $\cLpp\in \LLS(\cOpp)\sqcup \LLS(\cOpp)\otimes \det$, let $(p_{1},q_{1}) = \lsign(\cL)$ and
$(p_2,q_2)=(C_{2k}-q_{1},C_{2k}-p_{1})$. Then
\[
  \vartheta(\cLpp) = \dagger\cLpp \cdot \dagger_{p_{2},q_{2}}.
\]

By \eqref{eq:LS.dis}, we have a injection
\begin{equation}\label{eq:LS.CD.inj}
  \begin{tikzcd}[row sep=0em]
    \LLS(\cOpp)\times \bZ/2\bZ \ar[r] &\LLS(\cOp)\\
    (\cLpp,\upepsilon') \ar[r,maps to] & \vartheta(\cLpp\otimes \det^{\upepsilon'}).
  \end{tikzcd}
\end{equation}
In particular, we have $\cL_{\uptaup}\neq 0$ and $\uppi_{\uptaup}\neq 0$ for every
$\uptaup\in \drc(\cOp)$.



\subsubsection{Unipotent representations attached to $\cO$}
Now suppose $\uptaup_{1}\neq \uptaup_{2}\in \drc(\cOp)$ and
$\cL_{\uptaup_{1}}=\cL_{\uptaup_{2}}$. By \eqref{eq:LS.CD.inj},
$\upepsilon'_{1}=\upepsilon'_{2}$ and $\cL_{\uptaupp_{1}}=\cL_{\uptaupp_{2}}$.
In particular,  $\uptaupp_{1}$ and $\uptaupp_{2}$  have the same signature. %, say $(p'',q'')$.% are dot-r-c diagrams for the
% same real orthogonal group.
By \Cref{lem:ds.CD} and the induction hypothesis, $\uptaupp_{1}\neq \uptaupp_{2}$ and so
$\uppi_{\uptaupp_{1}}\otimes {\det}^{\upepsilon'_{1}} \neq \uppi_{\uptaupp_{2}}\otimes {\det}^{\upepsilon'_{2}}$.
Now the injectivity of theta lifting yields
\[
  \uppi_{\uptaup_{2}} = \Thetab(\uppi_{\uptaupp_{1}}\otimes {\det}^{\upepsilon'_{1}})
  \neq \Thetab(\uppi_{\uptaupp_{2}}\otimes {\det}^{\upepsilon'_{2}}) = \uppi_{\uptaup_{2}}
\]
Suppose $\cOp$ is noticed. Then $\cOpp = \eDD(\cOp)$ is noticed by definition
and
$(\uptaupp,\upepsilon')\mapsto \Ch(\uppi_{\uptaupp}\otimes{\det}^{\upepsilon'})$
is an injection into $\LS(\cOpp)$.
Now \eqref{eq:LS.CD.inj} implies $\uptaup\mapsto\cL_{\uptaup}$ is also an injection.

Suppose $\cOp$ is quasi-distingushed. Then $\cOpp = \eDD(\cOp)$ is
quasi-distingushed by definition
and
$(\uptaupp,\upepsilon')\mapsto \Ch(\uppi_{\uptaupp}\otimes{\det}^{\upepsilon'})$
is  a bijection with $\LSaod(\cOpp)$.
Since the component group of each K-nilpotent orbit in $\cOp$ is naturally
isomorphic to the component group of its descent. So we deduce that $\uptaup \mapsto \cL_{\uptaup}$
is a bijection onto $\LSaod(\cOp)$.

This proves the main proposition for $\cOp$.


Now let $\uptau\in \drc(\cO)$. % and $(p_{0},q_{0}):=\ssign(\bfxx_{\uptau})$.
By \eqref{eq:sp-nsp-sig}, we have
\begin{equation}\label{eq:LS.D.ds}
  \cL_{\uptau} =  \cT_{\uptau}\cdot \cP_{\uptau}\neq 0, \text{ where
  }\cT_{\uptau} := \dagger\cL_{\uptaup}, \text{ and } \cP_{\uptau}:=\cL_{\bfxx_{\uptau}}.
\end{equation}
In particular, $\uppi_{\uptau}\neq 0$ and we could determine $\bfxx_{\uptau}$ from
the marks on the 1-rows of $\cL_{\uptau}$.

The factorization of $\cL_{\uptau}$ in the fashion of \eqref{eq:ls.factor} is also given by
\eqref{eq:ped.factor1} and \eqref{eq:bd.factor2}.
% When $\upepsilon=0$, $(p_{0},q_{0})\succeq \ssign(d)=(1,1)$ and so
% $\cL_{\uptau}\neq \cL_{\uptau}\otimes \bfone_{\ssign(\uptau)}^{+,-}$.

Now suppose $\uptau_{1} \neq \uptau_{2}$ and
$\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$. By \eqref{eq:LS.D.ds}, the result in
\Cref{sec:pfDC.init} and
\Cref{lem:sp-nsp.D}~\eqref{lem:sp-nsp.D.2},
we have
$\bfxx_{\uptau_{1}}=\bfxx_{\uptau_{2}}$,  $\upepsilon_1=\upepsilon_{2}$ and
$\uptaupp_{1}\neq \uptaupp_{2}$.
By \eqref{eq:LS.D.ds}, we have
$\cL_{\uptaup_{1}}=\cL_{\uptaup_{2}}$.
Applying the main proposition of $\cOp$, we have
$\upepsilon'_{1}=\upepsilon'_{2}$ and $\uptaup_{1}\neq \uptaup_{2}$.
Now by the injectivity of theta lifing, we conclude that
\[
  \uppi_{\uptau_{2}} = \Thetab(\uppi_{\uptaup_{1}})\otimes (\bfone^{+,-})^{\upepsilon_{1}}
  \neq \Thetab(\uppi_{\uptaup_{2}})\otimes (\bfone^{+,-})^{\upepsilon_{2}} = \uppi_{\uptaup_{2}}
\]

\subsubsection{}

Note that $\cL_{\uptau}$ is obtained from $\cL_{\uptaup}$ by attaching the peduncle
determined by $\bfxx_{\uptau}$. The claims about noticed and
quasi-distinguished orbit are easy to verify. We leave them to the reader.


%\subsection{}

% For a dot-r-c diagram $\uptau\in \drc(D)$, we have the following three cases:
% (The top rows are either empty or $w_{0}\neq \emptyset$.)


% {\bf Case I: } $x_{1}\neq \emptyset$. In this case $\cOpp\leadsto \cOp$ is usual
% lift and $\upepsilon'=0$.
% \[
% \begin{tikzpicture}
%   \matrix[matrix of math nodes, row sep={1.5em,between origins},column sep={1.5em,between origins}]{
%   \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%   *      & *      & *      & *      & \times                   & w_{0}  & *      & *      & *      & \\
%   x_{1}  &        &        &            &                          &        &        &        &        & \\
%   \vdots &        &        &        &                          &        &        &        &        & \\
%   x_{n}   &        &        &        &                          &        &        &        &        & \\
%   };
% \end{tikzpicture}
% \]
% We define $\bfxx_{\uptau}=\bftt_{\uptau} = \ytb{{x_{1}},\vdots,{x_{n}}}$.


% {\bf Case II:} $y_{2}\neq \emptyset$. In this case $\cOpp\leadsto \cOp$ is usual
% lift and $\upepsilon'=1$.
% \[
% \begin{tikzpicture}
%   \matrix[matrix of math nodes, row sep={1.5em,between origins},column sep={1.5em,between origins}]{
%   \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%   *      & *      & *      & *      & \times                   & w_{0}  & *      & *      & *      & \\
%   x_{0}  & y_{1}  &  *     &  \cdots    &                          &        &        &        &        & \\
%   x_{1}  & y_{2}  &        &        &                          &        &        &        &        & \\
%   \vdots &        &        &        &                          &        &        &        &        & \\
%   x_{n}  &    &        &        &                          &        &        &        &        & \\
%   };
% \end{tikzpicture}
% \]
% We define $\bfxx_{\uptau}=\bftt_{\uptau} = \ytb{{x_{1}},\vdots,{x_{n}}}$.


% {\bf Case III:} $y_{1}\neq \emptyset$. In this case $\cOpp\leadsto \cOp$ is a
% generalized lift and $\upepsilon'=0$.
% \[
% \begin{tikzpicture}
%   \matrix[matrix of math nodes, row sep={1.5em,between origins},column sep={1.5em,between origins}]{
%   \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%   *      & *      & *      & *      & \times                   & w_{0}  & *      & *      & *      & \\
%   x_{1}  & y_{1}  &  *     &  \cdots    &                          &        &        &        &        & \\
%   \vdots &        &        &        &                          &        &        &        &        & \\
%   x_{n}  &    &        &        &                          &        &        &        &        & \\
%   };
% \end{tikzpicture}
% \]
% We define $\bfxx_{\uptau}:= \ytb{{x_{1}},\vdots,{x_{n}}}$ and $\bftt_{\uptau}:= \ytb{{x_{1}}{y_{1}},\vdots,{x_{n}}}$.

% We call $\bftt_{\uptau}$ the ``leg'' of $\uptau$ and $x_{\uptau}:=x_{n}$ the ``foot'' of $\uptau$.

% In case I/II, the sign of length-1 row in $\cL_{\uptau}$ is
% \[
% \bsign{\uptau} = \Sign{\bfxx_{\uptau}}
% \]
% We factorize $\cL_{\uptau} = \cB_{\uptau}\cdot \cC_{\uptau}$. Here
% $\lsign{\cT_{\uptau}}$ is a constant on each irreducible components.
% $\lsign{\cB_{\uptau}}=\bsign{\uptau}$.


% In case III, the sign of lenght-1 row with a plus length row  is determined by
% \[
% \bsign{\uptau} = \Sign{\bfxx_{\uptau}}
% \]

% $\cL_{\uptau} = \cpT_{\uptau}\cdot \cpB_{\uptau} + \cnT_{\uptau}\cdot \cnB_{\uptau}$.
% We allow $\cnB=\emptyset$, and $\cpB$ is assumed to have
% more length-1 row marked by $+$ than that of $\cnB$.
% We still have sign of $\cpT$ and $\cnT$ are the same. More importantly,
% $\lsign{\cpB} = \Sign{\bfxx_{\uptau}}$, and $\lsign{\cnB}=\Sign{\bfxx_{\uptau}}$
% if $\cnB\neq \emptyset$.
% We call $x_{n}$ the tail of $\uptau$.

% The key property is that the lifting of local system is controlled by the leg $\bftt_{\uptau}$.

% Moreover, we claim that all $\uptau$ in a LS-packet $[\cL]$ has the same
% tail $x_{n}$.

%We will establish this by induction.


% \subsection{Descent case}
% We assume now $\cOp\leadsto \cOpp$ is a usual descent.

% When $\upepsilon' = 0$, the dot-r-c diagrams have the following shape:
% \[
%   \begin{tikzcd}[row sep={1.5em,between origins},column sep={1.5em,between origins}]
%              & \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%     \uptau:  & *      & *      & *      & *      & \times                   &   *     & *      & *      & *      & \\
%              & x_{1}  &        &        &            &                          &        &        &        &        & \\
%              & \vdots &        &        &        &                          &        &        &        &        & \\
%              & x_{n}  &        &        &        & \  \ar[d,maps to,"\eDD"] &        &        &        &        & \\[1em]
%              &        &        &        &        & \                        &        &        &        &        & \\
%              &        & \cdots & \cdots & \cdots & \                        & \cdots & \cdots & \cdots & \cdots & \\
%     \uptau': &        & *      & *      & *      & \times                   & *      & *      & *      & *      & \\
%              &        &        &        &        & \ \ar[d,maps to,"\eDD"]   &        &        &        &        & \\[1em]
%              &        & \cdots & \cdots & \cdots & \                        &        & \cdots & \cdots & \cdots & \\
%     \uptaupp:
%              &        & *      & *      & *      & \times                   &        & *      & *      & *      & \\
%              &        &        &        &        &                          &        &        &        &        & \\
%   \end{tikzcd}
% \]


% When $\upepsilon'=1$, the dot-r-c diagrams have the following shape:
% \[
%   \begin{tikzcd}[row sep={1.5em,between origins},column sep={1.5em,between origins}]
%              & \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots \\
%     \uptau:  & *      & *      & *      & *      & \times                   & *      & *      & *      & *      \\
%              & x_{0}  & y_{1}  &        &        &                          &        &        &        &        \\
%              & x_{1}   & y_{2}  &        &        &                          &        &        &        &        \\
%              & \vdots  &        &        &        &                          &        &        &        &        \\
%              & x_{n}  &        &        &        & \  \ar[d,maps to,"\eDD"] &        &        &        &        \\[1em]
%              &        &        &        &        & \                        &        &        &        &        \\
%              &        & \cdots & \cdots & \cdots & \                        & \cdots & \cdots & \cdots & \cdots \\
%     \uptau': &        & *      & *      & *      & \times                   & *      & *      & *      & *      \\
%              &        & z_{1}  &        &        & \                        &        &        &        &        \\
%              &        & z_{2}  &        &        & \ \ar[d,maps to,"\eDD"]  &        &        &        &        \\[1em]
%     \uptaupp:
%              &        & \cdots & \cdots & \cdots & \                        &        & \cdots & \cdots & \cdots & \\
%              &        & *      & *      & *      & \times                   &        & *      & *      & *      \\
%              &        & w_{1}  &        &        &                          &        &        &        &        \\
%   \end{tikzcd}
% \]
% The actual definition of $\uptau\mapsto \uptaup$ is in \Cref{sec:alg.CD}. %\Cref{sec:dd.nonsep}.

% Consider the following map of local system
% \[
%   \begin{tikzcd}[row sep=0em]
%     \LLS(\cOpp) \times \bZ/2\bZ \ar[r]& \LS(\cO')\\
%     (\cLpp, \upepsilon') \ar[r,maps to] & \vartheta(\cLpp\otimes {\det}^{\upepsilon'}).
%   \end{tikzcd}
% \]
% Its image is always non-zero and it is an injection by
% \Cref{prop:CD.1}~\ref{p:drcls.1} for $\cOpp$.

% Therefore the theta lift $ \uppi_{\uptaup}:= \Thetab(\uppi_{\uptaupp}\otimes {\det}^{\upepsilon'})$ is always
% non-vanishing and $\uppi_{\uptaup}$ are distinct with each other.
% %Hence $\lUnip(\cO') = \Unip(\cO')$.
% Hence $\Unip(\cO') = \set{\uppi_{\uptaup}}$.

% We now prove that we have a factorization of local system:
% \[
%   \cL_{\uptau} = \cB_{\uptau}\cdot \cC_{\uptau},
% \]
% here $\cC_{\uptau}$ is determined by $\bfxx_{\uptau} = x_{1}\cdots x_{n}$.

% Since $C_{2k}=C_{2k-1}$ is even,  $\cOpp\leadsto \cOp$ is a usual lifting and
% $\det\otimes \cL_{\uptaupp}\notin \LLS(\cOpp)$,
% \[
% \cL_{\uptaup} = \vartheta(\cL_{\uptaupp}\otimes (\det)^{\upepsilon'}) \mapsto (\cL_{\uptaupp}, \upepsilon')
% \]
% is a well defined map and restricted on $\LLS(\cO, \rO(p,q))$ is a bijection.



% Using our algorithm, we compute
% $\Sign(\uptau)-\Sign(\uptaupp) = (2a+p_{1},2a+q_{1})$. Here $a$ is the number of
% entries in $\taulf$ above $x_{1}$ and
% $(p_{1},q_{1})=\Sign((x_{1}, \cdots, x_{n})^{T})$ (see \Cref{sec:nsp.twist} for
% the non-special representation case).

% Therefore, the components in the local system $\cL_{\uptau}$ is given by:
% Attach two columns on the left of the irreducible LS of $\cL_{\uptaupp}$,
% and $2n$ 1-rows with siginature $(p_{1},q_{1})$.

% The tail $x_{n}$ determine the twisting character $(\bfonepn)^{\upepsilon}$.
% When $x_{n} = r$ (resp. $x_{n}=s$), $q_{1}=0$ (resp. $p_{1}=0$).

%\subsection{The general case}
% We will prove two aspects: 1. the liftings $\uppi_{\uptau}\neq 0$; 2. they are
% non-isomorphic.

% Here $\cB$ stands for ``body'', $\cD$ stands for ``foot'.
% Later $\cC$ stands for ``leg'' (crus in Latin)

% We always assume $\uptau$ is a type D dot-r-c diagram.
% Inductively we establish the following properties.

% \begin{claim}
% \begin{enumT}
%   \item  $x_{\uptau}$ determine the factorization of local system:
%   \begin{equation}\label{eq:ls.factor}
%     \begin{array}{c|c|c|c}
%       \bftt_{\uptau} & \cL_{\uptau} & \cF_{\uptau} &\\
%       \hline
%       \ytb{s\cdots,\vdots,s} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cF_{\uptau,i} & \cF_{\uptau,1}=\ytb{=,=},
%                                                                                          \cF_{\uptau,2}= \ytb{\uum\cdots,=} &\\
%       \hline
%       \ytb{\star\cdots,\vdots,r} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cF_{\uptau,i} & \cF_{\uptau,1}=\ytb{+,+}, \cF_{\uptau,2} = \ytb{\uup\cdots,+}\\
%       \hline
%       %\ytb{sd\cdots,\vdots,s,c} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cF_{\uptau,i} &  \cF_{\uptau,1} = \ytb{\uum\cdots,+},
%       %                                                                                      \cF_{\uptau,2}=\ytb{\uup\cdots,=}
%       %                                         &  \#s \geq 0\\
%       %\hdashline
%       %\ytb{\star\cdots,\vdots, c} & \cB_{\uptau,1}\cF_{\uptau,1} &  \cF_{\uptau,1} = \ytb{\uum\cdots,+} & \\
%       %& & & \cB_{\uptau,2}\neq \emptyset \text{only if
%       %      } \bfxx_{\uptau} = (s\cdots sc)^{t}\\
%       \ytb{\star\cdots,\vdots, c}
%                      & \displaystyle\sum_{i=1}^{2} \cB_{\uptau,i}\cdot\cF_{\uptau,i}
%                                     &  \cF_{\uptau,1} = \ytb{\uum\cdots,+},
%                                       \cF_{\uptau,2}= \ytb{\uup\cdots,=}
%                                                    & \cB_{\uptau,1}\neq \emptyset.
%       \\
%       %& & & \cB_{\uptau,2}\neq \emptyset \text{only if
%       %      } \bfxx_{\uptau} = (s\cdots sc)^{t}\\
%      \hline
%       \ytb{\star\cdots,\vdots,d} & \displaystyle\sum_{i=1}^{2}\cB_{\uptau,i}\cdot\cF_{\uptau,i} &  \cF_{\uptau,1} = \ytb{\uum\cdots,+},
%                                                                                              \cF_{\uptau,2}=\ytb{\uup\cdots,-}
%                                                &\cB_{\uptau,1}\text{ and }\cB_{\uptau,2}\neq \emptyset\\
%     \end{array}
%   \end{equation}
%   When $x_{\uptau}=c$, $\cF_{\uptau,2}\neq \emptyset$ only if
%   $\bftt_{\uptau} = \ytb{sd\cdots, \vdots,s,c}$.
%   \item If $\cOp \leadsto \cOpp$ is a usual descent, we have a simpler
%   factorization:
%   $\cL_{\uptau} = \cB_{\uptau} \cF_{\uptau}$.
%   \begin{equation}\label{eq:ls.srcd}
%     \begin{array}{c|c} x_{\uptau} & \cF_{\uptau} \\
%       \hline
%       s &  \ytb{=,=}\\
%       \hline
%       r & \ytb{+,+}\\
%       \hline
%       c & \ytb{+,=}\\
%       \hline
%       d & \ytb{+,-}\\
%       \hline
%     \end{array}
%   \end{equation}
%   \item
%   From the above table, we have:
%   \begin{enumT}
%     \item $x_{\uptau} = s$, then $\pcL = \ncL = 0$.
%     \item $x_{\uptau} = r/c$, then $\pcL \neq 0$ and $\ncL=0$.
%     \item $x_{\uptau} = d$, then $\pcL$ and $\ncL$ are both non-zero.
%   \end{enumT}
%   \item
%     The set of lifted local system are and disjoint with their determinant twist:
%     \[
%       \set{\cL_{\uptau} | \uptau \in \drc(\cO)} \cap \set{\cL_{\uptau}\otimes \det| \uptau\in \drc(\cO)} = \emptyset.
%     \]
% %  \item
% % \ref{p:drcls.1} follows from the above properties.
% %   \[
% %   \begin{array}{c|c|c|c|c}
% %     x_{\uptau} & s & r &c &d\\
% %     \hline
% %     \pcL_{\uptau} & \emptyset &  \sum_{i=1}^{2} \cB_{\uptau_{i}} \cT_{\uptau_{i}} & \\
% %     \ncL_{\uptau} & \emptyset & \emptyset & \emptyset &
% %   \end{array}
% % \]
%   % \item We have
%   % $\set{\cL_{\uptau}|\pcL_{\uptau}\neq 0} \rightarrow \set{\pcL_{\uptau}}$ given
%   % by $\cL_{\uptau}\mapsto \pcL_{\uptau}$ is injective if $n\geq 2$ or
%   % $\cOp\leadsto \cOpp$ is a usual descent..

%     \item If $\cO$ is noticed,
%     \[
%       \begin{tikzcd}[row sep=0em]
%         \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0} \ar[r] & \set{\pcL_{\uptau}}\times \set{T,F} &\\
%         & (\pcL_{\uptau},F)
%         \arrow[dd, start anchor=north west, end anchor=south west, no head, xshift=-1em, decorate, decoration={brace,mirror}]
%         & \ncL_{\uptau} = \emptyset
%         \\[-1em]
%         \cL_{\uptau} \ar[r,mapsto, end anchor={[xshift=-2em]west}] & \phantom{(\pcL_{\uptau},F)} & \\[-1em]
%         &(\pcL_{\uptau},T) &  \ncL_{\uptau} \neq \emptyset
%       \end{tikzcd}
%     \]
%     is injection.
%     \item If $\cO$ is +noticed, the composition of the above map with $\pr_{1}$
%     is injective.
%     \item If $C_{2k+1}-C_{2k}\geq 2$ and $\bfxx_{\uptau}$ ends with $d$, $\cL_{\uptau}$ has an irreducible
%     component $\succ \dagger_{(1,1)}$. In particular, if $\cO$ is +noticed and
%     $\bfxx_{\uptau}$ ends with $d$, we have
%     $\cL_{\uptau}\supset \dagger_{(1,1)}$.
% \end{enumT}

% \end{claim}




% \subsubsection{Usual descent case}
% When $\cOp \rightarrow \cOpp$ is a usual descent, the non-vanishing is clear and
% the above properties are easily follows.
% Moreover, the signature of $1$-rows in $\cL_{\uptau}$ is given by
% $\ssign(\bfxx_{\uptau})$. Note that, (1). the lift of $\LS(\cOpp)\longrightarrow\LS(\cOp)$ is
% an injection, we could read the twisting character $\upepsilon_{\uptaup}$ from
% $\cL_{\uptaup}$.

% On the other hand, the twisting character $\upepsilon_{\uptau}$ could be read
% from the restriction on 1-rows of $\cL_{\uptau}$.  In fact, in the most of the
% case $\upepsilon_{\uptau}=1$. $\upepsilon_{\uptau}=0$ if and only if $x_{\uptau}=d$
% where $\cL_{\uptau}$ must contain an irreducible component  whose 1-rows contain a
%  $-$ sign.

% \subsubsection{Proof of Generalized descent case}



% Non-vanishing of the lifting:

% The dot-r-c diagrams have the following shape:
% \[
%   \begin{tikzcd}[row sep={1.5em,between origins},column sep={1.5em,between origins}]
%              & \cdots & \cdots & \cdots & \cdots &                          & \cdots & \cdots & \cdots & \cdots & \\
%     \uptau:  & *      & *      & *      & *      & \times                   &   *     & *      & *      & *      & \\
%              & x_{0}  & y_{1}   & w_{1}   & \cdots &                          &        &        &        &        & \\
%              & \vdots &        &        &        &                          &        &        &        &        & \\
%              & x_{n}  &        &        &        & \  \ar[d,maps to,"\eDD"] &        &        &        &        & \\[1em]
%              &        &        &        &        & \                        &        &        &        &        & \\
%              &        & \cdots & \cdots & \cdots & \                        & \cdots & \cdots & \cdots & \cdots & \\
%     \uptau': &        & *      & *      & *      & \times                   & *      & *      & *      & *      & \\
%              &        & z_{1}  & w_{1}   &  \cdots   & \ \ar[d,maps to,"\eDD"]   &        &        &        &        & \\[1em]
%              &        & \cdots & \cdots & \cdots & \                        &        & \cdots & \cdots & \cdots & \\
%     \uptaupp:
%              &        & *      & *      & *      & \times                   &        & *      & *      & *      & \\
%              &        & z_{1}   & w_{1}  &        &                          &        &        &        &        & \\
%   \end{tikzcd}
% \]


\subsection{The general descent case}
%We now starts with induction:
We  assume $k\geq 1$ and all the properties are satisfied by $\uptaupp\in \drc(\cOpp)$.

We now assume that $\cOp\leadsto \cOpp$ is the generalized descent.
Without loss of generality, we can assume the dot-r-c diagrams have the
following shapes with $n = (C_{2k+1}-C_{2k}+1)/2$:
\begin{equation}\label{eq:gd2.drc}
  \uptau:\tytb{
    {*(srcol)\cdots}\cdots\cdots\cdots,
    {*(srcol)\ast}{\ast}{\ast}{\ast},
    {x_{1}}{y_{1}}{w_{1}}\cdots,
    \vdots,
    {x_{n}}
  }
  \times
\tytb{{*(srcol)\cdots}\cdots\cdots,
    {*(srcol)\ast}{\ast}{\cdots},
    \none,\none,\none}
  \xmapsto{\hspace{1em}\eDDo\hspace{1em}}
  \uptaup:\tytb{
    \cdots\cdots\cdots,
    {\ast}{\ast}{\ast},
    {z_{1}}{w_{1}}\cdots,
    \none,
    \none
  }
  \times
\tytb{{*(srcol)\cdots}\cdots\cdots,
    {*(srcol)\ast}{\ast}{\cdots},
    \none,\none,\none}
  \xmapsto{\hspace{1em}\eDDo\hspace{1em}}
  \uptaupp:\tytb{
    \cdots\cdots\cdots,
    {\ast}{\ast}{\ast},
    {z_{1}}{w_{1}}\cdots,
    \none,
    \none
  }
  \times
\tytb{\cdots\cdots,
    {\ast}{\cdots},
    \none,\none,\none}
\end{equation}

The diagram $\uptau$ is obtained from the diagram of $\uptau$ by adding
$\bullet$ at the
grey parts, changing $z_{1}$ to $y_{1}$ and attaching $x_{1}\cdots x_{n}$.


In the following proof, we let
\[
\bfpp_{\uptau}:=\tytb{{x_{1}}{y_{1}},\vdots,{x_{n}}}
\]
and call $\bfpp_{\uptau}$ the peduncle part of $\uptau$. Also note that
$z_{1}$ is exactly the $x_{\uptaupp}$.

\begin{lem}\label{lem:gd.inj}
  The map $\drc(\cO)\rightarrow \drc(\cOpp) \times \bN^{2}\times \bZ/2\bZ$
  given by $\uptau\mapsto (\eDDo^{2}(\uptau), \ssign(\uptau),\upepsilon_{\uptau})$ is injective.
\end{lem}
\begin{proof}
  Let $\uptaupp:=\eDDo^{2}(\uptau)$ and
  \begin{equation}\label{eq:def.u}
    \bfuu_{\uptau}:=u_{1} \cdots u_{n} =
    \begin{cases}
      r\cdots r c, & \text{when } \bfpp_{\uptau} = \tytb{rc,\vdots,r}\\
      r\cdots c d, & \text{when } \bfpp_{\uptau} = \tytb{rc,\vdots,d}\\
      x_{1}\cdots, x_{n} & \text{otherwise}.
    \end{cases}
  \end{equation}
  Then $\uptau\mapsto (\uptaupp,\bfuu_{\uptau})$ is injective and
  \[
  \ssign(\uptau) =\ssign(\uptaupp) + (n_1,n_{1})+\ssign(\bfuu_{\uptau}) \text{ where }2n_{1}+1 = C_{2k}.
  \]
  Now the lemma follows from
  $\bfuu_{\uptau}\mapsto (\ssign(\bfuu_{\uptau}), \upepsilon)$ is injective by \Cref{c:init.CD}.
\end{proof}

% One of the key property for generalized descent is:
% $\cL_{\uptau}\mapsto \pcL_{\uptau}$ is an injection for $x_{n}\neq s$.
% We will establish this by induction.
% Note that if $\cOpp\leadsto \cOp$ is a usual lift, the claim is clear.

% \subsubsection{Initial step, starting from the usual descent}
% Suppose the second longest row of $\cOpp$ is also even.
% This is a simpler case.
% $\bsign{\cL_{\uptaupp}}\succ (+2,0)$ when $z_{1}  = r$.
% $\bsign{\cL_{\uptaupp}}\succ (+1,-1)$ when $z_{1}  = c$.
% $\bsign{\cL_{\uptaupp}}\succ (+1,+1)$ when $z_{1}  = d$.

% We could write $\cL_{\uptaupp} = \cT_{\uptaupp}\cB_{\uptaupp}$.
% Then $\pcL_{\uptaupp} = \cT_{\uptaupp}\pcB_{\uptaupp}$
% and $\ncL_{\uptaupp} = \cT_{\uptaupp}\ncB_{\uptaupp}$.
% \[
% \begin{array}{c|c|c|c|c}
%   z_{1}  & s& r & c &d\\
%   \hline
%   \cB_{\uptaupp} & \ytb{=,=} & \ytb{+,+} & \ytb{+,=} & \ytb{+,-}\\
%   \hline
%   \pcB_{\uptaupp} & & \ytb{+} & \ytb{=} & \ytb{-}\\
%   \hline
%   \ncB_{\uptaupp} & &   &   & \ytb{+}
% \end{array}
% \]

% Note that
% $\pcL_{\uptaupp}$ contains full information of $\cL_{\uptaupp}$
% since $\cL_{\uptaupp} = \pcL_{\uptaupp} \cdot +$
% (when $y_{1}=d$,
% $\ncL_{\uptaupp}$ also contains the full information).
%



%\subsubsection{Lift of local systems}
% In this section, we
\subsubsection{Local systems}
We now describe the local systems $\cL_{\uptaup}$ and $\cL_{\uptau}$ more
precisely using our formula of the associated character and the induction
hypothesis. Note that these local systems are always non-zero which implies that
$\uppi_{\uptaup}$ and $\uppi_{\uptau}$ are unipotent representations attached to
$\cOp$ and $\cO$ respectively.

First note that in $\uptaup$ and $\uptaupp$, $z_{1}\neq s$ by the definition of
dot-r-c diagram.
\footnote{
  Suppose $\uptaupp\in \drc(\cOpp)$ has the shape in \eqref{eq:gd2.drc} and
  $z_{1}=s$. By the induction hypothesis,   $\pcL_{\uptaupp}=\ncL_{\uptaupp}=0$ and so
  the theta lift of $\uppi_{\uptaupp}$ vanishes.
}
% in generalized descent.
By the induction hypothesis, $\cL_{\uptaupp}^{+}\neq 0$.
% , and so
% \[
%   \cL_{\uptaup} = \vartheta(\cL_{\uptaupp}) = \dagger \cL_{\uptaupp}^{+}\cup
%   \dagger \cL_{\uptaupp}^{-} \neq 0.
% \]

% Now for each $\uptaup\in \drc(\cOp)$, $\uptaupp$


Let $(p''_{1},q''_{1}) := \lsign(\cL_{\uptaupp})$.
Then
\begin{equation}\label{eq:lsign.1}
\lsign(\pcL_{\uptaupp}) = (p_{0}-1,q_{0}), \text{ and }
\lsign(\ncL_{\uptaupp})=(p_{0},q_{0}-1) \text{ if } \ncL_{\uptaupp}\neq \emptyset.
\end{equation}
\begin{equation}\label{eq:LS.taup}
  \cL_{\uptaup} = \vartheta(\cL_{\uptaupp}) = \dagger \pcL_{\uptaupp} + \dagger \ncL_{\uptaupp} \neq 0
\end{equation}
where
$\lsign(\dagger\pcL_{\uptaupp}) = (q''_{1}, p''_{1}-1)$ and
$\lsign(\dagger\ncL_{\uptaupp})=(q''_{1}-1,p''_{1})$ (if
$\dagger\ncL_{\uptaupp}\neq 0$).

Let $(p_{1},q_{1}) := \lsign(\cL_{\uptau})$ and
$(e,f):=(p_{1}-p''_{1}+1, q_{1}-q''_{1}+1)$. Using \eqref{eq:bd.prop} and
\eqref{eq:def.u}, one can show that
\[
  (e,f)=\ssign(\bfuu_{\uptau}).
\]
\trivial[]{ It suffice to consider the most left three columns of the peduncle
  part: this part has signature
  $\lsign(\cP_{\uptau}) +(1,1) = \ssign(\bfuu_{\uptau}x_{\uptaupp})= \ssign(\bfuu_{\uptau})+\lsign(\cD_{\uptaupp})$.
  Therfore,
  \[\ssign(\bfuu_{\uptau}) = \lsign(\cP_{\uptau})-\lsign(\cD_{\uptaupp})
  + (1,1) = \lsign(\cL_{\uptau})-\lsign(\cL_{\uptaupp})+(1,1).
  \]
}

Now
\begin{equation}\label{eq:gd.ls}
  \cL_{\uptau} = \dagger\dagger \pcL_{\uptaupp} \cdot \pcE_{\uptau}   + \dagger\dagger \ncL_{\uptaupp}  \cdot \ncE_{\uptau}
\end{equation}
where
\[
  \begin{split}
    \pcE_{\uptau}& = \begin{cases} \ddagger_{e,f-1} & \text{when
      } f\geq 1 \text{ and } x_{\uptau}\neq d \\
      \dagger_{e,f-1} & \text{when
      } f\geq 1 \text{ and } x_{\uptau}= d \\
      0 & \text{otherwise}
    \end{cases}\\
    \ncE_{\uptau}& = \begin{cases} \ddagger_{e-1,f} & \text{when
      } e\geq 1 \text{ and } x_{\uptau}\neq d \\
      \dagger_{e-1,f} & \text{when
      } e\geq 1 \text{ and } x_{\uptau}= d \\
      0 & \text{otherwise}
    \end{cases}.\\
  \end{split}
\]
%
% $\pcE$ and $\ncE$ are 1-rows of sign $(p_{1}-p''_{1}+1,q_{1}-q''_{1})$ and
% $(p-p'',q-q''+1)$ respectively.

\medskip

By induction hypothesis, we have
a factorization of $\cL_{\uptaupp}$ as in \eqref{eq:ls.factor}
\[
  \cL_{\uptaupp} = \sum_{i=-(k-1)}^{k-1}\cB_{\uptaupp,i}\cdot \cD_{\uptaupp,i}.
\]
%where $\abs{i}\leq k-1$ in the above formula.
Then we have the following factorization of $\cL_{\uptau}$:
\[
\cL_{\uptau}=\sum_{i\neq 0} \cT_{\uptau,i}\cdot \cP_{\uptau,i}, \text{ with
} \cT_{\uptau,i}:=
\begin{cases}
\dagger\dagger \cB_{\uptaupp,i-1} & i\geq 1 \\
\dagger\dagger \cB_{\uptaupp,i+1} & i\leq -1.
\end{cases}
\]
Now we describle $\cP_{\uptau,i}$ according to $z_{1}$ case by case. In the
following discussion,
\[
  \uup\cdots\uup\quad \text{ and }\quad  \uum\cdots\uum
\]
always denote a row has length
$2i+1$ with unspecified associated character.
%We have the following cases
%\subsubsection{}
%First note that $z_{1}\neq s$ in generalized descent.

 \subsubsection{Case $z_{1}=r$}\label{sec:z.r}
 We will see that the factorization \eqref{eq:d.factor} always holds
 when $z_{1}=x_{\uptaupp}=r$ and $n\geq 2$.
 % according to the about list.
  %\item $z_{1}=r$. %In this case, all length $3$ rows ends with $+$ sign!
  % So
  % $\bsign{\bfxx_{\uptaupp}} \succ (2,0)$, $\pcL_{\uptaupp}\neq 0$ has tail with
  % sign $+$, and $\ncL_{\uptaupp}=0$.
  We have three sub-cases:
  \begin{enumT}
  \item $\bfpp_{\uptau} = \tytb{rc\cdots,\vdots,r}$. Then
  $\cL_{\uptau}=\sum_{i=1}^{k} (\dagger\dagger \cB_{\uptaupp,i-1})\cdot \cP_{\uptau,i}$, where
  \begin{equation}\label{eq:rr.c}
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,+,\vdots,+} \quad \forall i\geq 1.
  \end{equation}

 When $n\geq 2$, we have $\cP_{\uptau,i}\succeq \tytb{+,+}$ and the
 factorization \eqref{eq:d.factor} holds.

 When $n=1$, we set
 \begin{equation} \label{eq:gd.rr}
   \cB_{\uptau,0} = 0,
   \cB_{\uptau,i} = \cT_{\uptau,i} \text{ and
   } \cD_{\uptau,i} = \cP_{\uptau,i} \text{ for } i\geq 1.
 \end{equation}
 Now $\cL_{\uptau} = \sum_{i=1}^{k} \cB_{\uptau,i}\cdot \cD_{\uptau,i}$.
%where $i$ is the index such that $\cB_{\uptaupp,i}\neq 0$.

 \item $\bfpp_{\uptau} = \tytb{rc\cdots,\vdots,r,d}$.
 In this case, $n\geq 2$.
  \begin{equation}\label{eq:rd.c}
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,-,+,\vdots,+} \succ \tytb{-,+} \quad  \forall i\geq 1
  % \cP_{\uptau,1}  = \tytb{\uup\uum\uup,-,+,\vdots,+}\quad
  % \cP_{\uptau,2}  = \tytb{\uup\uum\uup\cdots,-,+,\vdots,+}
  \end{equation}
In particular, \eqref{eq:d.factor} holds.
% $\cP_{\uptau,i}\succeq \ddagger_{(2,1)}\succ \dagger_{(1,1)}$ and the
% factorization
% $\cL_{\uptau} = \cB_{\uptau,1}\cdot \cD_{\uptau,1}$ such that $\cD_{\uptau,1}=\tytb{+,-}$.
 \item $\bfpp_{\uptau} = \tytb{sr\cdots,\vdots,s,{x_{j}},\vdots,{x_{n}}}$.
% $y_{1}=z_{1}=r$ and $\bfxx_{\uptau} = s\cdots sx_{j}\cdots x_{n}$ with
 In this case $\#s(\bfxx_{\uptau})\geq 1$.

 When $n\geq 2$, the factorization \eqref{eq:d.factor} holds.
 More precisely, we have four cases according to the mark of $x_{n}$.
 \begin{enumT}
   \item $x_{n}=s$, i.e. $\bfxx_{\uptau} = s\cdots s$. Then
   \[
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,=,\vdots,=} \quad \forall i \geq 1
   \]
   When $n= 1$,
   $\cL_{\uptau} = \sum_{i=-1}^{-k} \cB_{\uptau,i}\cdot \cD_{\uptau,i}$
   with $\cB_{\uptau,i} = \cT_{\uptau,i}$ and $\cD_{\uptau,i} = \cP_{\uptau,i}$.
   % and the
   % factorization is also given by the formula \eqref{eq:gd.rr}.
   \item $x_{n}=r$. Then $n\geq 2$ and
   \[
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,+,\vdots,+,=,\vdots,=} \succeq \tytb{+,+,=}\succ \tytb{+,+,\none}
  \quad \forall i\geq 1
  \]
   \item $x_{n}=c$. Then $n\geq 2$ and
   \[
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,+,\vdots,+,=,\vdots,=} \succeq \tytb{+,=,=}\succ \tytb{+,=,\none}
  \quad \forall i\geq 1
  %\cP_{\uptau,2}  = \tytb{\uup\uum\uup\cdots,+,\vdots,+,=,\vdots,=} \succeq \tytb{+,=,=}\succ \tytb{+,=,\none}
   \]
   \item $x_{n}=d$. Then $n\geq 2$ and
   \[
  \cP_{\uptau,i}  = \tytb{\uup\cdots\uup,+,\vdots,+,-,\vdots,-}  \succeq \tytb{+,-,-}\succ \tytb{+,-,\none}
  \quad \forall i\geq 1
  %\cP_{\uptau,2}  = \tytb{\uup\uum\uup\cdots,+,\vdots,+,-,\vdots,-} \succeq \tytb{+,-,-}\succ \tytb{+,-,\none}
   \]
 \end{enumT}
 % Suppose $\Sign(\bfxx_{\uptau})=(p_{1},q_{1})$ with $p_{1}+q_{1}=2n$
  % \begin{equation}%\cL_{\uptau} = \dagger\dagger \pcL_{\uptaupp} \cdot \ytableaushort{+,\vdots,+,{-/=},\cdots,{-/=}}
  %   \cB_{\uptau}  =
  %   \tytb{+-+,+,\vdots,+,-,\vdots,-}  \text{ when } x_{n} = d \text{ or  } \tytb{+-+,+,\vdots,+,=,\vdots,=}
  %   \text{ when } x_{n} = r/c
  % \end{equation}
  % \[
  %   \cB_{\uptau} = \tytb{+-+,=,\vdots,=} \text{ when } x_{n}=s.
  % \]
  % Note that, we have at least one $-$ sign in 1-rows.
  % At least two $-$ signs if $x_{n}=c/d$.

  %  We have  $\cB_{\uptau}\succeq \ddagger_{(0,2)}$  when $x_{n}=s$;
  %  $\cB_{\uptau}\succeq \ddagger_{(2,1)}$  when $x_{n}=r$;
  % $\cB_{\uptau}\succeq \ddagger_{(2,1)}$ when $x_{n}=c$;
  % $\cB_{\uptau}\succeq \dagger_{(2,1)}$ when $x_{n}=d$.
  \end{enumT}


  \subsubsection{Case $z_{1}=c$}\label{sec:z.c}
  % In this case, the length $3$-rows will contain at least one $-$ sign.
  %$\pcL_{\uptaupp}\neq 0$ has tail sign $=$, and $\ncL_{\uptaupp}=0$.
  %We assume $\Sign(\bfxx_{\uptau})=(p_{1},q_{1})$.
  We always have $\cP_{\uptau,2}=\emptyset$.
  \begin{enumT}
    \item  $x_{n} =  s$. In this case $x_{\uptau}=s\cdots s$.
    \begin{equation}\label{eq:ss.c}
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,=,\vdots,=} \quad \forall i\geq 1.
    \end{equation}
    When $n\geq 2$, the  factorization \eqref{eq:d.factor} holds.

    When $n=1$, we have
    \begin{equation}\label{eq:gd.ss}
      \cL_{\uptau} = \sum_{i=-1}^{-k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}
      \text{ where } \cB_{\uptau,i}=\cT_{\uptau,-i}
      \text{ and }\cD_{\uptau,i}=\cP_{\uptau,-i}.
  \end{equation}
  \item $x_{n} = r$.
    In this case, $\bfxx_{\uptau}= s\cdots sr\cdots r$ where
    $\#s(\bfxx_{\uptau})>1$ and $n\geq 2$.
   \[
     \cP_{\uptau,i}  = \tytb{\uum\cdots\uum,=,\vdots,=,+,\vdots,+,} \succeq \tytb{=,+,+}\succ\tytb{\none,+,+}
     \quad \forall i\geq 1.
   \]
   In particular, \eqref{eq:d.factor} holds.
   \item $x_{n} = c$.
   % In this case, $\bfxx_{\uptau}= s\cdots s r\cdots r$ where number of
   \begin{enumT}
     \item
     When $\#s(\bfxx_{\uptau})>1$ and so $n\geq 2$.
     \[
       \cP_{\uptau,i}  = \tytb{\uum\cdots\uum,+,\vdots,+,=,\vdots,=} \succ \tytb{+,=}
     \quad \forall i\geq 1.
     \]
     % The
     % Otherwise, $\cP_{\uptau,1}\succ \ddagger_{1,1}$.
     The factorization \eqref{eq:d.factor} holds.
     \item
     When $\bfxx_{\uptau}=r\cdots rc$ with $n_{r}:=\#r(\bfxx_{\uptau}) \geq 0$.
     \[
       \cP_{\uptau,i}  = \tytb{\uum\cdots\uum,+,\vdots,+} %\quad \forall i\geq 1. \succ \tytb{+}.
       \quad \forall i\geq 1.
     \]
     We have $\cL_{\uptau} = \sum_{i=1}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}$  where $\cD_{\uptau,i} = \tytb{\uum\cdots\uum,+}$ and
     $\cB_{\uptau,i} = \cT_{\uptau,i}\cdot \ddagger_{2n_{r},0}$.
   \end{enumT}
   \item $x_{n} = d$. In this case, $n\geq 2$ and
   $\#s(\bfxx_{\uptau})+\#c(\bfxx_{\uptau})\geq 1$. Therefore,
    \begin{equation}\label{eq:ss.c}
      \cP_{\uptau,i} = \tytb{\uum\uup\uum\cdots,-,\vdots,-,+,\vdots,+}\succ \tytb{-,+}, \quad \forall i\geq 1
    \end{equation}
    and the factorization \eqref{eq:d.factor} holds.
  \end{enumT}

  \subsubsection{Case $z_{1}=d$}\label{sec:z.d}
  In this case, $\bfxx_{\uptau}$ could be anything.
%  Then
  %$\pcL_{\uptaupp} = \cT_{\uptaupp} \cdot \pcB_{\uptaupp}$ and $\ncL_{\uptaupp}=\cT_{\uptaupp} \cdot \ncB_{\uptaupp}$.
 % We assume $\bsign{\pcL_{\uptaupp}}=(p-1,q)$ and $\bsign{\ncL_{\uptaupp}}=(p,q-1)$.
  % \[
  %   \cL_{\uptau} = \dagger \dagger \cT_{\uptaupp}\cdot \cB_{\uptau}.
  % \]
  \begin{enumT}
    \item $\bfxx_{\uptau}=s\cdots s$. We have
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,=,\vdots,=} \quad \forall i\geq 1.
    \]
    When $n\geq 2$, the factorization \eqref{eq:d.factor} holds.
% Clearly $\pcL_{\uptau}=\emptyset$.
    When $n=1$, the factorizaton is given by \eqref{eq:gd.ss}.
    \item $\bfxx_{\uptau}=r\cdots r$.
    \[
      \cP_{\uptau,i} = \tytb{\uup\cdots\uup,+,\vdots,+} \quad \forall i\leq -1.
    \]
    When $n\geq 2$, the factorization \eqref{eq:d.factor} holds.

    When $n=1$,
    \[
    \cL_{\uptau} = \sum_{i=1}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i} \text{
      where } \cB_{\uptau,i} = \cT_{\uptau,-i} \text{ and } \cD_{\uptau,i} = \cP_{\uptau,-i}.
    \]
    \item $\bfxx_{\uptau} = s\cdots sr\cdots r$ with $n_{s}:=\#s(\bfxx_{\uptau})\geq 1$
    and $n_{r}:=\#r(\bfxx_{\uptau})\geq 1$
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,=,+,+,+,\vdots,+,=,\vdots,=}
      \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,+,=,=,+,\vdots,+,=,\vdots,=}
      \quad \forall i\geq 1
    \]
    %Clearly $\cP_{\uptau,i}\succ \ddagger_{(1,1)}$ and $n\geq 2$.
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}.
    \]
    Here
      \begin{align*}
        \cB_{\uptau,0} &= \sum_{i=1}^{k} \cT_{\uptau,i}\cdot \tytb{\uum\cdots\uum,=} \cdot\ddagger_{2n_{r}-2,2n_{s}-2}, &
        \cD_{\uptau,0} &= \tytb{+,+},\\
        \cB_{\uptau,i} &= \cT_{\uptau,-i}\cdot \ddagger_{2n_{r}-2,2n_{s}},  &
        \cD_{\uptau,i} &= \tytb{\uup\cdots\uup,+}, \quad \forall i\geq 1\\
      \end{align*}
    \item $\bfxx_{\uptau} = s\cdots sc$ where $n_{s}:=\#s(\bfxx_{\uptau})\geq 0$.
    \begin{equation}\label{eq:ped.ssc}
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,=,\vdots,=} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,=,=,\vdots,=} \quad \forall i\geq 1
    \end{equation}
    We have
    \[
      \cL_{\uptau} = \sum_{i=1}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}+ \sum_{i=1}^{k}\cB_{\uptau,-i}\cdot \cD_{\uptau,-i}.
    \]
    For $i\geq 1$,
      \begin{align*}
        \cB_{\uptau,i} &= \cT_{\uptau,i}\cdot \ddagger_{0,2n_{s}}, &
        \cD_{\uptau,i} &= \tytb{\uum\cdots\uum,+},\\
        \cB_{\uptau,-i} &= \cT_{\uptau,-i}\cdot \ddagger_{0,2n_{s}},  &
        \cD_{\uptau,-i} &= \tytb{\uup\cdots\uup,=}. %, \quad \forall i\geq 1\\
      \end{align*}
    \item $\bfxx_{\uptau} = r\cdots rc$ where $n_{r} = \#r(\bfxx_{\uptau})\geq 1$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,=,+,\vdots,+}
      \quad \forall i\geq 1
    \]
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}.
    \]
    where
      \begin{align*}
        \cB_{\uptau,0} &= \sum_{i=1}^{k}\cT_{\uptau,-i}\cdot \tytb{\uup\cdots\uup,+} \cdot \ddagger_{2n_{r}-2,0}, &
        \cD_{\uptau,0} &= \tytb{=,+},\\
        \cB_{\uptau,i} &= \cT_{\uptau,i}\cdot \ddagger_{2n_{r},0},  &
        \cD_{\uptau,i} &= \tytb{\uum\cdots\uum,+}  \quad \forall i\geq 1.\\
      \end{align*}
    \item $\bfxx_{\uptau} = s\cdots sr\cdots rc$ where
    $n_{s} := \#s(\bfxx_{\uptau})\geq 1, n_{r}:=\#r(\bfxx_{\uptau})\geq 1$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+,=,\vdots,=}\succ \tytb{+,=},
      \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,=,+,\vdots,+,=,\vdots,=}\succ \tytb{+,=} \quad \forall i\geq 1
    \]
    %Note that $\cP_{\uptau,i}\succ \ddagger_{(1,1)}$.
    Now the factorization \eqref{eq:d.factor} holds.
    \item $\bfxx_{\uptau} = s\cdots sd$ where $\#s(\bfxx_{\uptau})\geq 1$.
    \begin{equation}\label{eq:ped.ssd}
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,-,\vdots,-} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-,-,\vdots,-}
      \quad \forall i\geq 1
    \end{equation}
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,-i}\cdot \cD_{\uptau,-i}.
    \]
    where
      \begin{align*}
        \cB_{\uptau,0} &= \sum_{i=1}^{k}\cT_{\uptau,i}\cdot \tytb{\uum\cdots\uum,-} \cdot \dagger_{0,2n_{s}-2}, &
        \cD_{\uptau,0} &= \tytb{+,-},\\
        \cB_{\uptau,-i} &= \cT_{\uptau,-i}\cdot \ddagger_{0,2n_{s}},  &
        \cD_{\uptau,-i} &= \tytb{\uup\cdots\uup,-}  \quad \forall i\geq  1.\\
      \end{align*}
    \item $\bfxx_{\uptau} = r\cdots rd$ where $n_{r}=\#r(\bfxx_{\uptau})\geq 1$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-,+,\vdots,+}
      \quad \forall i\geq 1
    \]
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}.
    \]
    where
      \begin{align*}
        \cB_{\uptau,0} &= \sum_{i=1}^{k}\cT_{\uptau,-i}\cdot \tytb{\uup\cdots\uup,+} \cdot \dagger_{2n_{r}-2,0}, &
        \cD_{\uptau,0} &= \tytb{-,+},\\
        \cB_{\uptau,i} &= \cT_{\uptau,i}\cdot \dagger_{2n_{r},0},  &
        \cD_{\uptau,i} &= \tytb{\uum\cdots\uum,+}  \quad \forall i\geq  1.\\
      \end{align*}
    \item $\bfxx_{\uptau} = s\cdots sr\cdots rd$ where
    $\#s(\bfxx_{\uptau})\geq 1, \#r(\bfxx_{\uptau})\geq 1$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+,-,\vdots,-} \succ\tytb{+,-},
      \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-,+,\vdots,+,-,\vdots,-} \succ\tytb{+,-}
      \quad \forall i\geq 1.
    \]
    Now the factorization \eqref{eq:d.factor} holds.
    \item $\bfxx_{\uptau} = s\cdots sr\cdots rcd$ where
    $\#s(\bfxx_{\uptau})\geq 0, \#r(\bfxx_{\uptau})\geq 0$.
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+,+,\vdots,+,-,\vdots,-}\succ\tytb{+,-},
      \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-,+,\vdots,+,-,\vdots,-}\succ\tytb{+,-}
      \quad \forall i\geq 1.
    \]
    Now the factorization \eqref{eq:d.factor} holds.
    \item $\bfxx_{\uptau}=d$. In this case, $\bfpp_{\uptau} = dd\cdots$
    \[
      \cP_{\uptau,i} = \tytb{\uum\cdots\uum,+} \quad \cP_{\uptau,-i} = \tytb{\uup\cdots\uup,-}
      \quad \forall i \geq 1
    \]
    We have
    \[
      \cL_{\uptau} = \sum_{i=0}^{k}\cB_{\uptau,i}\cdot \cD_{\uptau,i}+\sum_{i=0}^{k}\cB_{\uptau,-i}\cdot \cD_{\uptau,-i}.
    \]
    where
    \[
        \cB_{\uptau,i} = \cT_{\uptau,i}, \quad
        \cD_{\uptau,i} = \cP_{\utau,i}  \quad \forall i = -k, \cdots, -1,1,\cdots, k.\\
    \]
  \end{enumT}

\subsubsection{Summary of the factorization}
We have the non-vanishing of the lifted local system $\cL_{\uptau}$ and the
factorization described in
\Cref{eq:ls.factor} holds.

\subsubsection{Unipotent representations attached to $\cOp$}
In this section, we let $\uptaup\in \drc(\cOp)$ and
$\uptaupp  = \eDDo(\uptaup)\in \drc(\cOpp)$. First note that
$x_{\uptaupp}\neq s$ and so $\pcL_{\uptaupp}$ always non-zero.

Recall \eqref{eq:LS.taup}.
We claim that we can recover $\pcL_{\uptaupp}$ and
$\ncL_{\uptaupp}$ from $\cL_{\uptaup}$:
\begin{claim}\label{c:gd.C1}
  The map $\Omega_{\cOp}\colon \cL_{\uptaup}\mapsto (\pcL_{\uptaupp},\ncL_{\uptaupp})$ is a well
  defined map.
\end{claim}
\begin{proof}
  When $\lsign(\cL_{\uptaup})$ has two elements, $x_{\uptaupp}=d$ and
  $\lsign(\cL_{\uptaup}) = \set{(q''_{1},p''_{1}-1),(q''_{1}-1,p''_{1})}$. In
  \eqref{eq:LS.taup}, $\dagger\pcL_{\uptaupp}$ (resp. $\dagger\ncL_{\uptaupp}$)
  consists of components whose first column has siginature $(q''_{1},p''_{1}-1)$
  (resp. $(q''_{1}-1,p''_{1})$). When $\lsign(\cL_{\uptaup})$ has only one
  elements, $x_{\uptau}=r/c$,
  $\lsign(\cL_{\uptaup}) = \set{(q''_{1},p''_{1}-1)}$,
  $\cL_{\uptaup} = \dagger\pcL_{\uptaupp}$ and $\ncL_{\uptaupp}=0$
  % \trivial[h]{
  %   Note that, $\lsign( \dagger\pcL_{\uptaupp} ) = (q_{0},p_{0}-1)$ and
  %   $\lsign( \dagger\ncL_{\uptaupp} ) = (q_{0}-1,p_{0})$ (if it is none-zero) by
  %   \eqref{eq:lsign.1}. }

  In any case, we get
  % recover $\lsign(\cL_{\uptaupp})=(p_{0},q_{0})$ and
  \begin{equation}\label{eq:uptaupp.sign}
    \ssign(\uptaupp) = (n_{0},n_{0})+(p_{0},q_{0})\quad \text{where }
    2n_{0} = \abs{\DD(\cOpp)}.
  \end{equation}
% $+\half \abs{\DD(\cOpp)} \cdot(1,1)$.
  Using the signature $\ssign(\uptaupp)$, we could recover the twisting
  characters in the theta lifting of local system. Therefore
  $\pcL_{\uptaupp}$ and $\ncL_{\uptaupp}$ can be recovered from  $\cL_{\uptaup}$.
\end{proof}


\begin{claim}\label{c:gd.C3}
  Suppose $\uptaup_{1}\neq \uptaup_{2}\in \drc(\cOp)$. Then
  $\uppi_{\uptaup_{1}}\neq \uppi_{\uptaup_{2}}$.
\end{claim}
\begin{proof}
  It suffice to consider the case when $\cL_{\uptaup_{1}} = \cL_{\uptaup_{2}}$.
 By \eqref{eq:uptaupp.sign} in the proof of \Cref{c:gd.C1},
 $\ssign(\uptaupp_{1}) = \ssign(\uptaupp_{2})$.
 On the other hand, $\upepsilon_{1}=\upepsilon_{2}=0$ and
 $\uptaupp_{1}\neq \uptaupp_{2}$ by \Cref{lem:gd.CD}. So
 \[
   \uppi_{\uptaup_{1}} = \Thetab(\uppi_{\uptaupp_{1}})\neq\Thetab(\uppi_{\uptaupp_{2}}) = \uppi_{\uptaup_{2}}
 \]
  by the injectivity of theta lift.
\end{proof}


%\medskip

% When $\bfpp_{\uptau} = \tytb{sd\cdots,\vdots,s,{c/d}}$,
% $\pcL_{\uptau} = (\dagger\dagger \cB_{\uptaupp,1} \cP_{\uptau,1})^{+}$
% and this is the only case that $\pcL_{\uptau}\neq \emptyset$ has less irreducible
% components than that of $\cL_{\uptau}$.

% {
%   \color{red}
%   The above computation also tells the shape of legs of $\cL_{\uptau}$ according
%   to $\bfpp_{\uptau}$.
% }

% , $\cOpp$ is noticed when
% $C_{2k}$ is even or $\cOpp$ is +notice when $\cO_{2k}$ is odd.

\subsubsection{Unipotent representations attached to $\cO$}

\begin{claim}\label{c:gd.D1}
  Suppose $\uptau_{1}\neq \uptau_{2}\in \drc(\cO)$. Then $\uppi_{\uptau_{1}}\neq \uppi_{\uptau_{2}}$.
\end{claim}
\begin{proof}
 It suffice to consider the case that $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$.
 Clearly, $\ssign(\uptau_{1})=\ssign(\uptau_{2})$. On the other hand,
 the twisting $\upepsilon_{\uptau_{1}}=\upepsilon_{\uptau_{2}}$ since it is
 determined by the  local system:
 $\upepsilon_{\uptau_{i}}=0$ if and only if $\cL_{\uptau_{i}}\supset \tytb{-}$.
 %(see \eqref{eq:gd.ls}).

 We conclude that $\uptaupp_{1}\neq \uptaupp_{2}$ and $\uptaup_{1}\neq \uptaup_{2}$
 by \Cref{lem:gd.inj} and \Cref{lem:gd.CD}.
 By \Cref{c:gd.C3} and the injectivity of theta lift,
 \[
   \uppi_{\uptau_{1}} = \Thetab(\pi_{\uptaup_{1}})\otimes (\bfone^{+,-})^{\upepsilon_{\uptau_{1}}}
  \neq \Thetab(\pi_{\uptaup_{2}})\otimes (\bfone^{+,-})^{\upepsilon_{\uptau_{2}}} = \uppi_{\uptau_{2}}
 \]
\end{proof}


\subsubsection{Noticed orbits}

% \begin{claim}
% Suppose $\uptau_{1}\neq \uptau_{2}$ and
% $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$. Then, $\uptaup_{1}\neq \uptaup_{2}$ and
% $\upepsilon_{1}=\upepsilon_{2}$.
% \end{claim}
% \begin{proof}
% First note taht $\upepsilon_{i}$ is completely determined by the shape of local
% system $\cL_{\uptau_{i}}$.
% Observe that
% $\abs{\ssign(\uptau)} - \abs{\ssign(\uptaupp)} = \abs{\ssign(\bfxx_{\uptau}y_{1})} - \abs{\ssign(z_{1})}$.
% This implies that the signature of $\uptau$ is completely determined by
% $\bfxx_{\uptau}y_{1}$ and $\uptaupp$.
% Also observe that $\uptaupp$ is determined by $\uptaup$.

% By our algorithm we see that, for every fixing $\uptaup, \upepsilon$,
% the map
% \[
% \set{\uptau | \eDD(\uptau)= (\uptaup,\upepsilon)} \rightarrow \bZ
% \]
% defined by $\uptau\mapsto \abs{\ssign(\bfxx_{\uptau}y_{1})} - \abs{\ssign(z_{1})}$ is
% injective.

% Now $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$ implies
% $\ssign(\uptau_{1})=\ssign(\uptau_{2})$.

% Suppose $\uptaup:=\uptaup_{1}=\uptaup_{2}$ and $\upepsilon=\upepsilon_{1}=\upepsilon_{2}$, $\uptau_{1}$ and $\uptau_{2}$ are two
% elements in the above set with the same image in $\bZ$. This yields an
% contradiction.
% \end{proof}


% Now fix signature $(p,q)$. We will show that
% \[
%   \set{\cL_{\uptau}| \lsign(\cL_{\uptau}) = (p,q)}\longrightarrow \set{\cL_{\uptaup}}
% \]
% is injective when $\cO$ is noticed.


In this section, we prove the claims about noticed and +noticed orbits.

% \begin{claim}\label{c:gd.C2}
%   Suppose $\cOpp$ is +noticed. Then
%   \begin{enumT}
%     \item \label{c:gd.C2.1}The map
% $\set{\cL_{\uptaupp}| x_{\uptaupp}\neq s}\rightarrow \set{\cL_{\uptaup}}$ given by
% $\cL_{\uptaupp}\mapsto \cL_{\uptaup}=\vartheta(\cL_{\uptaupp})$ is a bijection.
% \item
% The map $\drc(\cOp)\rightarrow \LLS(\cOp)$ given by $\uptaup\mapsto \cL_{\uptaup}$ is a bijection.
% \end{enumT}
% \end{claim}
% \begin{proof} %Recall \eqref{eq:LS.taup}.
%   Let $\uptaup\in \drc(\cOp)$.
%   By \Cref{c:gd.C1}, we have a well defined map
%   $\cL_{\uptaup}\mapsto \pcL_{\uptaupp}$ with $\pcL_{\uptaupp}\neq 0$.
%   Since $\cOpp$ is +noticed, $\pcL_{\uptaupp}$ uniquely determines the local
%   system $\cL_{\uptaupp}$ by inductive hypothesis. Therefore,
%   $\cL_{\uptaup}\mapsto \pcL_{\uptaupp}\mapsto \cL_{\uptaupp}$ gives the inverse
%   map in the claim.

%   Now suppose $\uptaup_{1}\neq \uptaup_{2}\in \drc(\cOp)$. By \Cref{lem:gd.CD},
%   $\uptaupp_{1}\neq \uptaupp_{2}$. Hence
%   $\cL_{\uptaupp_{1}}\neq\cL_{\uptaupp_{2}}$ by the induction hypothesis.
%   Therefore, $\cL_{\uptaup_{1}}\neq \cL_{\uptaup_{2}}$ by part \eqref{c:gd.C2.1}
%   of the claim.
% % Case $x_{\uptaupp}=d$:
% %   When $\lsign(\cL_{\uptaupp}) = \set{(q_{0},p_{0}-1),(q_{0}-1,p_{0})}$ has two
% %   elements,
% %   we let $\pcL_{\uptaup}$ (resp. $\ncL_{\uptaup}$) be the parts whose
% %   $\lsign = (q_{0},p_{0}-1)$ (resp. $=(q_{0}-1,p_{0})$).
% %   If $\bsign(\cL_{\uptaup})= \set{(0,0)}$,
% %   $\cL_{\uptaupp} = \DD(\pcL_{\uptaup})\cdot + \cup \DD(\ncL_{\uptaup})\cdot - $.
% %   Otherwise, if every component of $\cL_{\uptaupp}$ $\succ \dagger_{(1,0)}$,
% %   we have $\cL_{\uptaupp} = \DD(\pcL_{\uptaup})\cdot +$; if
% %   $\cL_{\uptaupp} \succ \dagger_{(0,1)}$,
% %   $\cL_{\uptaupp} = \DD(\ncL_{\uptaup})\cdot -$.

% % Case $x_{\uptapp}=r/c$:
% % Since $\cOpp$ is +noticed, we have
% % $\cL_{\uptaup} = \dagger\pcL_{\uptaupp}\mapsto \pcL_{\uptaupp}\mapsto \cL_{\uptaupp}$
% % is well defined, and bijective with $\set{\cL_{\uptaupp}|\pcL_{\uptaupp}\neq \emptyset}$.
% % $\cL_{\uptaupp}\mapsto \pcL_{\uptaupp}$ is injective. Hence
% % $\cL_{\uptaup}\mapsto \cL_{\uptaupp}$ is injective.
% \end{proof}

% \begin{prop}\label{c:gd.pnoticed}
%     Suppose $\cO$ is +noticed.
%     The map $\Upsilon \colon \set{\uptau\in\drc{\cO}|x_{\uptau}}
%     \longrightarrow \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0}\longrightarrow \set{\pcL_{\uptau}\neq 0}$
%     is injective.
%   %   \item
%   %   Suppose $\cO$ is noticed the map $\Upsilon$ defined in \eqref{eq:up} is injective.
%   % \end{enumC}
% \end{prop}

\begin{claim}\label{c:gd.C2}
  Suppose $\cOp$ is noticed. Then
  \begin{enumT}
    \item \label{c:gd.C2.1}The map
$\set{\cL_{\uptaupp}| x_{\uptaupp}\neq s}\longrightarrow \set{\cL_{\uptaup}}=\LLS(\cOp)$ given by
$\cL_{\uptaupp}\mapsto \cL_{\uptaup}=\vartheta(\cL_{\uptaupp})$ is a bijection.
\item
The map $\drc(\cOp)\rightarrow \LLS(\cOp)$ given by $\uptaup\mapsto \cL_{\uptaup}$ is a bijection.
\end{enumT}
\end{claim}
\begin{proof} %Recall \eqref{eq:LS.taup}.
  \begin{enumPF}
    \item
  Note that $\cOpp$ is noticed by definition. Hence $\Upsilon_{\cOpp}$ is invertible.
  % Let $\uptaup\in \drc(\cOp)$.
  % By  and the induction hypothesis , we have a well defined map
  % $\cL_{\uptaup}\mapsto \pcL_{\uptaupp}$ with $\pcL_{\uptaupp}\neq 0$.
  % Since $\cOpp$ is +noticed, $\pcL_{\uptaupp}$ uniquely determines the local
  % system $\cL_{\uptaupp}$ by inductive hypothesis. Therefore,
  %
  Recall \Cref{c:gd.C1}, we see that
  \[
    (\Upsilon_{\cOpp})^{-1}\circ \Omega_{\cOp}\colon
    \cL_{\uptaup}\mapsto (\pcL_{\uptaupp},\ncL_{\uptaupp})\mapsto \cL_{\uptaupp}
  \]
  gives the inverse of the map in the claim.
  \item
  Suppose $\uptaup_{1}\neq \uptaup_{2}\in \drc(\cOp)$. By \Cref{lem:gd.CD},
  $\uptaupp_{1}\neq \uptaupp_{2}$. Hence
  $\cL_{\uptaupp_{1}}\neq\cL_{\uptaupp_{2}}$ by the induction hypothesis.
  Therefore, $\cL_{\uptaup_{1}}\neq \cL_{\uptaup_{2}}$ by \ref{c:gd.C2.1}
  of the claim.
\end{enumPF}
\end{proof}

\begin{claim}\label{c:noticed.bij}
 Suppose $\cO$ is noticed, $\cL \colon \drc(\cO)\mapsto \LLS(\cO)$ given by
 $\uptau\mapsto \cL_{\uptau}$ is bijective.
% Moreover, $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$ implies $\cL_{\uptaup_{1}}=\cL_{\uptaup_{2}}$.
\end{claim}
\begin{proof}
We prove the claim by contradiction. We assume $\uptau_{1}\neq \uptau_{2}$ such
that $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$.


Recall \eqref{eq:gd.ls}: there is an pair of non-negative integers
$(e_{i},f_{i})=\ssign(\bfuu_{\uptau})$ such that
\[
  \cL_{\uptau_{i}} = \dagger\dagger \pcL_{\uptaupp_{i}}\cdot \pcE_{\uptau_{i}}
  + \dagger\dagger \ncL_{\uptaupp} \cdot \ncE_{\uptau_{i}}.
\]

\begin{enumPF}
  \item
Suppose that $\cL_{\uptau_{i}}$ contains a 1-row marked by $-$ or $=$. Then we
have
%\begin{enumI}
%  \item
$\upepsilon_{\uptau_{1}}=\upepsilon_{\uptau_{2}}$, which can be read from the mark $-/=$.
Moreover, the term
$\dagger\dagger\pcL_{\uptaupp_{i}}\cdot \pcE_{\uptau_{i}}\neq 0$ and we can
recover it from $\cL_{\uptau_{i}}$. So $\pcL_{\uptaupp_{1}} = \pcL_{\uptaupp_{2}}$.
Since $\cOpp$ is +noticed, $\uptaupp_{1}=\uptaupp_{2}$ by
\eqref{c:gd.pnoticed} and the induction hypothesis.
Note that $\ssign(\uptau_{1})=\ssign(\uptau_{2})$, we get
$\uptau_{1}=\uptau_{2}$ by \Cref{lem:gd.inj} which is contradict to our assumption.

% as the parts.. must contains the term
 % where $\pcE_{i}$ and $\ncE_{i}$ are columns of sign $(p_{i},q_{i}-1)$ and
 % $(p_{i}-1,q_{i})$ respectively.
 % Here we adapt the convention that $\pcE_{i} = \emptyset$ (resp. $\ncE_{i}$) if
 % $q_{i}-1<0$ (resp. $p_{i}-1<0$).

% Therefore, we have $\cL_{\uptaup_{i}}= \DD(\cL_{\uptau_{i}}) $ if $\cL_{\uptau}$ contains a 1-row
% of $+$ sign and a 1-row of $-$ sign.
\item
Now we assume that $\cL_{\uptau_{i}}$ does not contains a 1-row marked by $-/=$.
By checking the list in \Cref{sec:z.r,sec:z.c,sec:z.d}, we conclude that
$\bfpp_{\uptau_{i}}$ must have one of the following form:
% The exceptioinal cases are:
% \begin{enumT}
%   \item $(p_{i},q_{i}) = (2a,0)$ and so $\pcE_{i}=\emptyset$.
%   In this case, $\set{\bfpp_{\uptau_{i}}}$ must consists of the following three elements
  \[
    \bfpp_{1} =\tytb{rc,\vdots,r,r}, \quad \bfpp_{2}=\tytb{rc,\vdots,r,c}, \quad\text{and}
    \quad\bfpp_{3}= \tytb{rd,\vdots,r,r}\\
  \]
  We consider case by case according to the set $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}}$:
  \begin{enumPF}
    \item Suppose
    $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}}=\set{\bfpp_{1}}$ or $ \set{\bfpp_{2}}$.
    In these cases, $\upepsilon_{\uptau_{1}}=\upepsilon_{\uptau_{2}}$ and
    $\uptaupp_{1}\neq \uptaupp_{2}$ by \Cref{lem:gd.inj}.
    On the other hand, $\pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}$ by \eqref{eq:gd.ls}.
    Since $\cOpp$ is +noticed, we get $\uptaupp_{1}=\uptaupp_{2}$ a contradiction.
    \item Suppose
    $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}}=\set{\bfpp_{3}}$.
    We still have $\upepsilon_{\uptau_{1}}=\upepsilon_{\uptau_{2}}$ and
    $\uptaupp_{1}\neq \uptaupp_{2}$ by \Cref{lem:gd.inj}.
    On the other hand, $\ncL_{\uptaupp_{1}}=\ncL_{\uptaupp_{2}}$ by \eqref{eq:gd.ls}.
    This again contradict to the injectivity of $\cL_{\uptaupp}\mapsto \ncL_{\uptaupp}$.
    %Since $\cOpp$ is +noticed, we get $\uptaupp_{1}=\uptaupp_{2}$ a contradiction.
    \item  Suppose
    $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}} = \set{\bfpp_{1},\bfpp_{2}}$.
    The the argument above, we have $\pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}$
    Now $\uptaupp_{1}\neq \uptaupp_{2}$ since $\set{x_{\uptaupp_{1}},x_{\uptaupp_{2}}}=\set{r,c}$.
    This contradict to that $\cOpp$ is +noticed again.
    \item\label{it:c:noticed.bij.4} Suppose $\bfpp_{\uptau_{1}} = \bfpp_{1} \text{ or } \bfpp_{2}, \bfpp_{\uptau_{2}}=\bfpp_{3}$.
    Then
    $\cL_{\uptau_{1}} = \dagger\dagger\pcL_{\uptaupp_{1}}\cdot \pcE_{\uptaupp_{1}}$
    and
    $\cL_{\uptau_{2}} = \dagger\dagger\ncL_{\uptaupp_{2}}\cdot \ncE_{\uptaupp_{2}}$.
    This implies
    $\dagger \pcL_{\uptaupp_{1}}= \dagger\ncL_{\uptaupp_{2}}$ and
    $\abs{\ssign(\uptaupp_{1})} \equiv \abs{\ssign(\uptaupp_{2})}+2 \pmod{4}$.

    By the list in \Cref{sec:z.r,sec:z.c,sec:z.d}, we see that
    $\cL_{\uptaupp_{2}}\supset \tytb{-,+}$ and
    $\ncL_{\uptaupp_{2}}\supset \tytb{+}$.

    This leads to a contradiction: Thanks to the character twist in the theta
    lifting formula of the local system, we see that the the associated
    character restricted on the 2-row $\tytb{-+}$ of $\pcL_{\uptau_{1}}$ and
    $\ncL_{\uptau_{2}}$ must be are different.

    % Note that  $\cL_{\uptau_{2}}\succ \dagger_{(1,1)}$ implies that
    % $\ncL_{\uptau_{2}}\succ \dagger_{(1,0)}$. So $\dagger\ncL_{\uptau_{2}}$ has
    % a 2-row of sign $\tytb{-+}$.
    % On the other hand, $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$ implies
    % $\dagger \pcL_{\uptau_{1}}=\pcL_{\uptaup_{1}} = \ncL_{\uptaup_{2}}= \dagger\ncL_{\uptau_{2}}$. So
    % $\abs{\ssign(\uptaupp_{1})} \equiv \abs{\ssign(\uptaupp_{2})}+2 \pmod{4}$.
    % , i.e.
    % \[\cL_{\uptau_{1}}=\dagger \pcL_{\uptaupp_{1}} \cdot \dagger_{(2a-1,0)}
    %   \neq \ddagger\ncL_{\uptaup_{2}}\cdot \ddagger_{(2a-1,0)} = \cL_{\uptau_{2}}.
    % \]
    % \item $\bfpp_{\uptau_{1}} = \bfpp_{2},\bfpp_{\uptau_{2}}=\bfpp_{3}$.
    % On argue by the same way as the case \eqref{} and yield a contRadiction.
  \end{enumPF}
%   \item $(p_{i},q_{i}) = (0,2a)$ and so $\ncE_{i}=\emptyset$.
%   In this case, $\set{\bfpp_{\uptau_{i}}}$ must consists of two the following three elements
%   \[
%     \bfpp_{1} =\tytb{sc,\vdots,s}, \quad \bfpp_{2}=\tytb{sr,\vdots,s}, \quad\text{and}
%     \quad\bfpp_{3}= \tytb{sd,\vdots,s}\\
%   \]
%   This case is also easy.
%   $ \uptau_{1}\neq \uptau_{2} $ implies $\uptaupp_{1}\neq \uptaupp_{2}$.
%   But $\cL_{\uptau_{1}}=\cL_{\uptau_{2}}$ implies
%   $\cL_{\uptaupp_{1}} = \DD^{2}(\cL_{\uptau_{1}})\cdot + \neq \DD^{2}(\cL_{\uptau_{2}})\cdot + = \cL_{\uptaupp_{2}}$.
%   This contradict to the bijection between local systems with dot-r-c diagrams
%   for the +noticed orbit $\cOpp$.
%   %$\uptaupp_{1} = \DD^{2}(\uptau_{1})\neq \DD^{2}(\uptau_{2})  = \uptaupp_{2}$
% \end{enumT}
% \end{enumI}
\end{enumPF}
  We finished the proof of the claim.
\end{proof}

\subsubsection{The maps $\pUpsilon_{\cO}$, $\nUpsilon_{\cO}$ and $\Upsilon_{\cO}$}

\begin{claim}\label{c:gd.pnoticed}\label{c:gd.pnoticed.p}
    Suppose $\cO$ is +noticed.
    The map
    $\pUpsilon_{\cO} \colon \set{\cL_{\uptau}|\pcL_{\uptau}\neq 0}\rightarrow \set{\pcL_{\uptau}\neq 0}$
    is injective.
\end{claim}
\begin{proof}
    %First assume $\cO$ is +noticed.
    We have two cases:
    \begin{enumPF}
      \item $\cL_{\uptau}$ contain an irreducible component $\succ \tytb{+,+}$.
      This is equivalent to $\pcL_{\uptau}$ has an irreducible component
      $\succ\tytb{+}$. Now all irreducible components of
      $\cL_{\uptau} \succ \tytb{+}$ and $\cL_{\uptau}\mapsto \pcL_{\uptau}$ will
      not kill any irreducible components. Hence we could recover $\cL_{\uptau}$
      from $\pcL_{\uptau}$.%, and the map $\Upsilon_{1}$.
      \item Suppose that $\cL_{\uptau_{1}}\neq \cL_{\uptau_{2}}$ do not contain
      a component $\succ \tytb{+,+}$.

      By \Cref{c:noticed.bij}
      $\uptau_{1}\neq \uptau_{2}$.\footnote{$\cL_{\uptau_{1}}\neq \cL_{\uptau_{2}}$
        clearly implies $\uptau_{1}\neq \uptau_{2}$.} We now show that
      $\pcL_{\uptau_{1}}=\pcL_{\uptau_{2}}\neq 0$ leads to a contradiction.
      Clearly, $\ssign(\uptau_{1})=\ssign(\uptau_{2})$ By checking the list in
      \Cref{sec:z.r,sec:z.c,sec:z.d}, for $i=1,2$, we have
      \[
        \bfpp_{\uptau_{i}} = \tytb{s{x_{\uptaupp}},\vdots,s,{x_{\uptau_{i}}}} \quad \text{
          where }x_{\uptaupp_{i}}=c/d, x_{\uptau_{i}}=c/d.
      \]
      By looking at \eqref{eq:ped.ssc} and \eqref{eq:ped.ssd}, we see that
      $\pcL_{\uptau_{1}}=\pcL_{\uptau_{2}}$ implies
      \begin{equation}\label{eq:pnoticed.1}
        \pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}.
      \end{equation}

      Moreover, we see that every components of $\cL_{\uptau_{i}}$ has a 1-row
      of mark ``$-/=$'' and we can determine $\upepsilon_{\uptau_{i}}$ by the
      mark $-/=$ of the 1-row appeared in $\pcL_{\uptau_{i}}$. In particular, we
      have $\upepsilon_{1}=\upepsilon_{2}$. Now \Cref{lem:gd.inj} implies
      $\uptaupp_{1}\neq \uptaupp_{2}$. This is contradict to
      \eqref{eq:pnoticed.1} and our induction hypothesis since $\cOpp$ is also
      +noticed.

      % On the other hand, $\cOpp$ is also +noticed. But \eqref{eq:ped.ssc} and
      % \eqref{eq:ped.ssd} also imply that
      % $\pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}$ which is a contradiction to
      % our
      % induction hypothesis.
      % % By our descent algorithm $\eDD$, we have
      % % $\uptaupp_{1}\neq \uptaupp_{2}$.
      % % Note that the collision implies
      % % $\pcL_{\uptaupp_{1}} =\pcL_{\uptaupp_{2}}$,
      % % which is impossible by induction.
    \end{enumPF}
% \item
%  Suppose $\cO$ is noticed, we many need to consider the additional case where
%  $\bfpp_{\uptau} = \tytb{{x_{1}} y}$ where $x_{1}= c/d$. But $x_{1}=d$ is
%  equivalent to the non-vanishing of $\ncL_{\uptau}$.
% \end{enumPF}
\end{proof}


\begin{claim}\label{c:gd.noticed.inj}
  Suppose $\cO$ is noticed. Then the map $\Upsilon_{\cO}\colon \cL_{\uptau}\mapsto (\pcL_{\uptau},\ncL_{\uptau})$ is injective.
\end{claim}
\begin{proof}
  It suffice to consider the case where $\cO$ is noticed but not +noticed, i.e.
  $C_{2k+1}=C_{2k}+1$. In this case, $n=1$.
  The peduncle $\bfpp_{\uptau}$ have four possible cases:
  \[
    \tytb{rc}, \quad \tytb{cc}, \quad \tytb{cd},\quad \text{or}\quad  \tytb{dd}.
  \]
  By \eqref{eq:gd.ls}, $\pcL_{\uptau} = \dagger\dagger\pcL_{\uptaupp}$.
  % \[
  %   \bfpp_{1} = \tytb{rc}, \bfpp_{2}=\tytb{cc}, \bfpp_{3} = \tytb{cd}, \bfpp_{4} = \tytb{dd}.
  % \]

  Now suppose $\uptau_{1}\neq \uptau_{2}$ such that
  $\pcL_{\uptau_{1}}=\pcL_{\uptau_{2}}$.
  Since $\cOpp$ is +noticed, we have $\uptaupp_{1}=\uptaupp_{2}$ by the induction
  hypothesis (see \Cref{c:gd.pnoticed.p}).
  By \Cref{lem:gd.inj}, this only happens when
  $\set{\bfpp_{\uptau_{1}},\bfpp_{\uptau_{2}}}=\set{\tytb{cd},\tytb{dd}}$.
  Since one of $\ncL_{\uptau_{i}}$ is zero and the other is non-zero, we
  conclude that $\Upsilon_{\cO}(\cL_{\uptau_{1}})\neq \Upsilon_{\cO}(\cL_{\uptau_{2}})$.
\end{proof}

\begin{claim}\label{c:gd.pnoticed.n}
    Suppose $\cO$ is +noticed.
    The map $\nUpsilon_{\cO}\colon \set{\cL_{\uptau}|\ncL_{\uptau}\neq 0}\rightarrow \set{\ncL_{\uptau}\neq 0}$
    is injective.
\end{claim}
\begin{proof}
  The proof is similar to that of \Cref{c:gd.pnoticed.p}.
    We have two cases:
    \begin{enumPF}
      \item $\cL_{\uptau}$ contain an irreducible component $\succ \tytb{-,-}$.
      This is equivalent to $\ncL_{\uptau}$ has an irreducible component
      $\succ\tytb{-}$ and $\cL_{\uptau}\mapsto \ncL_{\uptau}$ will
      not kill any irreducible components. Hence we could recover $\cL_{\uptau}$
      from $\ncL_{\uptau}$.%, and the map $\Upsilon_{1}$.

      \item Now we make a weaker assumption that $\uptau_{1}\neq \uptau_{2}\in \drc(\cO)$ such that
      $\cL_{\uptau_{1}}$ and $\cL_{\uptau_{2}}$ do not contain a component
      $\succ \tytb{-,-}$.
      % We now show that  $\ncL_{\uptau_{1}}=\ncL_{\uptau_{2}}\neq 0$ leads to a
      % contradiction.
      % Clearly,
      % $\ssign(\uptau_{1})=\ssign(\uptau_{2})$

      By checking the list in \Cref{sec:z.r,sec:z.c,sec:z.d}, for $i=1,2$, we
      have $\bfpp_{\uptau_{i}}$ must be one of the following
      \[
        \bfpp_{1}=  \tytb{rc,\vdots,r,d} \quad \text{ or } \quad \bfpp_{2}= \tytb{rd,\vdots,r,d}.
      \]
      Without of loss of generality, we have the following possibilities:
      \begin{enumPF}
        \item $\bfpp_{\uptau_{1}}=\bfpp_{\uptau_{2}}=\bfpp_{1}$. We have
        $\pcL_{\uptaupp_{1}}=\pcL_{\uptaupp_{2}}$ and obtain the contradiction.
        \item $\bfpp_{\uptau_{1}}=\bfpp_{\uptau_{2}}=\bfpp_{2}$. We have
        $\ncL_{\uptaupp_{1}}=\ncL_{\uptaupp_{2}}$ and obtain the contradiction.
        \item $\bfpp_{\uptau_{1}}=\bfpp_{1}$ and $\bfpp_{\uptau_{2}}=\bfpp_{2}$.
        We get $\dagger\pcL_{\uptaupp_{1}}=\dagger \ncL_{\uptaupp_{2}}$.
        Note that $x_{\uptaupp_{1}}=r$.
        We inspect the list \Cref{sec:z.r,sec:z.c,sec:z.d} for the generalized descent case and
        the factorization \eqref{eq:ls.srcd} for the descent case. We conclude
        that $\pcL_{\uptaupp_{1}}$ must contain a 1-row with
        $+$ mark. We obtain the contradiction to
        $\dagger \pcL_{\uptaupp_{1}}=\dagger\ncL_{\uptaupp_{2}}$
        by looking at the associated
        character on the $\tytb{-+}$ row by the same argument in the
        case~\ref{it:c:noticed.bij.4} of the proof of \Cref{c:noticed.bij}.
      \end{enumPF}
    \end{enumPF}
    This finished the proof.
\end{proof}

\section{Type B/M case}


\subsection{``Special'' and ``non-special'' diagrams}
\subsubsection{type M}

\begin{defn}\label{def:sp-nsp.M.sp}
  Let $\cO = (C_{2k},C_{2k-1}, \cdots, C_{1},C_{0}=0)\in \dpeNil(M)$
  with $k\geq 1$.
  Let
  \[
  \tau =  (\tau_{2k}, \cdots, \tau_{2})\times  (\tau_{2k-1}, \cdots, \tau_{1}).
  \]
  be a Weyl group representation attached to $\cO\in \dpeNil(M)$.
  We say $\tau$ has
  \begin{itemize}
    \item \idxemph{special shape} if $\tau_{2k}\geq \tau_{2k-1}$;
    \item \idxemph{non-special shape} if $\tau_{2k}< \tau_{2k-1}$.
  \end{itemize}
  Clearly, this gives a partition of the set of Weyl group representations
  attached to $\cO$.

  Suppose $k\geq 1$, $C_{2k}=2c_{2k}-1$ and $C_{2k-1}=2c_{2k-1}+1$.
  The special shape representation $\tau^{s}$
  \[
    \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}
    = (c_{2k},\tau_{2k-2}, \cdots, \tau_{2})\times (c_{2k-1},\tau_{2k-3} \cdots, \tau_{1}).
  \]
  is paired with the non-special shape representation
  \[
    \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} =
     (c_{2k-1},\tau_{2k-2},\cdots, \tau_{2})\times (c_{2k},\tau_{2k-3},\cdots, \tau_{1} )
  \]
  In the paring $\tau^{s}\leftrightarrow \tau^{ns}$, $\tau_{j}$  is unchanged for $j\leq 2k-2$.
  We call $\tau^{s}$ the \emph{special shape} and $\tau^{ns}$ the
  corresponding \emph{non-special shape}
\end{defn}
% We define a bijection between ``special'' diagram $\uptau^{s}$ and
% ``non-special'' diagrams $\uptau^{ns}$.

% \begin{defn}\label{def:sp-nsp.M.sp}

%   Let $\cO\in \Nil(M)$ such that $C_{2k}=2c_{2k}-1$ and $C_{2k-1}=2c_{2k-1}+1$.
%   A representation $\tau^{s}$ attached to $\cO$ has the shape
%   \[
%     \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}=
%     (c_{2k},\tau_{2k-2},\cdots, \tau_{2}) \times (c_{2k-1},\tau_{2k-3},\cdots, \tau_{1})
%   \]
%   is paired with
%   \[
%     \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} =
%     (c_{2k-1},\tau_{2k-2},\cdots, \tau_{2}) \times (c_{2k},\tau_{2k-3},\cdots, \tau_{1})
%   \]
%   where the $c_{j}$ are unchanged for $j\leq 2k-2$.
%   We call $\tau^{s}$ the \emph{special shape} and $\tau^{ns}$ the
%   corresponding \emph{non-special shape}
% \end{defn}

% Note that the shape
% $\tau = (\tau_{2k},\cdots, \tau_{2},0)\times (\tau_{2k-1},\cdots, \tau_{1})$
% is a special shape if and only if $\tau_{2k}>\tau_{2k-1}$.



\begin{defn}\label{def:sp-nsp.M}
  Suppose $C_{2k}$ is odd.
We retain the notation in \Cref{def:sp-nsp.M.sp} where the shapes $\tau^{s}$ and $\tau^{ns}$
correspond with each other.
We define a bijection between $\drc(\tau^{s})$ and $\drc(\tau^{ns})$:
\[
  \begin{tikzcd}[row sep=0em]
    \drc(\tau^{s}) \ar[rr,<->]&\hspace{2em} & \drc(\tau^{ns})\\
    \uptau^{s} \ar[rr,<->]& & \uptau^{ns}
  \end{tikzcd}
\]
Without loss of generality, we can assume
that $\uptau^{s}\in \drc(\tau^{s})$ and $\uptau^{ns}\in \drc(\tau^{ns})$ have the following shapes:
\begin{equation}\label{eq:sp-nsp.M}
  \uptau^{s}:
  \tytb{\cdots\cdots\cdots,{y_{1}}\cdots\cdots,{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},{y_{2}}}
  \times
  \tytb{\cdots\cdots\cdots,{x_{0}}{\cdots}{\cdots},\ ,\ ,\ ,\ }
  \longleftrightarrow \hspace{2em}
  \uptau^{ns}:
  \tytb{\cdots\cdots\cdots,{y_{0}}\cdots\cdots,\ ,\ ,\ ,\ }
  \times
  \tytb{\cdots\cdots\cdots,{x_{1}}{\cdots}\cdots,{*(srcol)r},
    {*(srcol)\vdots},{*(srcol)r},{x_{2}} }
\end{equation}
Here the grey parts have length $(C_{2k}-C_{2k-1})/2$ (could be zero length).
The entries $x_{0}$, $x_{1}$, $y_{0}$ and $y_{1}$ are either all empty or all
non-empty.
% and the rows contains them may be empty. % We remark that the
% value of $v_{0}$ and $w_{0}$ are completely determined by $x_{0}$ and $y_{0}$.
% In particular, $v_{0}$ and $w_{0}$ are non-empty if and only if
% $x_{0}/y_{0}\neq \emptyset$, i.e. $C_{2k-1}\geq 4$.
% We marks the entries of $\uptau^{s}$ and $\uptau^{ns}$ as in
% \eqref{eq:sp-nsp.C}.
The correspondence between $(x_{0},x_{1}, x_{2})$, with
$(y_{0},y_{1},y_{2})$ is given by switching $r$ and $s$,  $d$ and $c$. i.e.
\[
  \begin{cases}
    y_{i} = s \Leftrightarrow x_{i} = r\\
    y_{i} = c \Leftrightarrow x_{i} = d\\
  \end{cases}
  \quad \text{for } i=0,1,2.
\]

We define
\[
  \drcs(\cO) := \bigsqcup_{\tau^{s}} \drc(\tau^{s}) \quad \text{ and }\quad
  \drcns(\cO) := \bigsqcup_{\tau^{ns}} \drc(\tau^{ns})
\]
where $\tau^{s}$ (resp. $\tau^{ns}$)runs over all specail (resp. non-special) shape representations attached to $\cO$.
Clearly $\drc(\cO) = \drcs(\cO)\sqcup \drcns(\cO)$.
\end{defn}
It is easy to check the bijectivity in the above definition, which we leave it
to the reader.



\subsubsection{Special and non-special shapes of type B}
Now we define the notion of special and non-special shape of type B.
\begin{defn}\label{def:sp-nsp.B.sp}
  Let
  \[
    \tau = (\tau_{2k}, \cdots, \tau_{2}) \times (\tau_{2k+1},\tau_{2k-1}, \cdots, \tau_{1})
  \]
  be a Weyl group representation attached to $\cO\in \dpeNil(B)$. We say $\tau$
  has
  \begin{itemize}
    \item \idxemph{special shape} if $\tau_{2k}\geq \tau_{2k-1}$;
    \item \idxemph{non-special shape} if $\tau_{2k} < \tau_{2k-1}$.
  \end{itemize}

  Suppose $k\geq 1$ and
  \begin{equation} \label{eq:B.orb.ds}
    \cO=(C_{2k+1}=2c_{2k+1}+1,C_{2k}=2c_{2k}-1,C_{2k-1}=2c_{2k-1}+1,\cdots,C_{1}>0, C_{0}=0).
  \end{equation}
  A representation $\tau^{s}$ attached to $\cO$ has the shape
  \[
    \tau^{s} = \tau_{L}^{s}\times \tau_{R}^{s}= (c_{2k},\tau_{2k-2},\cdots, \tau_{2}) \times (c_{2k+1},c_{2k-1},\tau_{2k-3},\cdots, \tau_{1})
  \]
  is paired with
  \[
    \tau^{ns} = \tau_{L}^{ns}\times \tau_{R}^{ns} = (c_{2k-1},\tau_{2k-2},\cdots, \tau_{2}) \times (c_{2k+1},c_{2k},\tau_{2k-3},\cdots, \tau_{1}).
  \]
  In the paring $\tau^{s}\leftrightarrow \tau^{ns}$ described as the above,
  $\tau_{j}$ are unchanged for $j\leq 2k-2$.
\end{defn}




\subsection{Definition of $\eDD$ for type B and M}


\subsubsection{The defintion of $\upepsilon$.} \label{sec:upepsilon}
\begin{enumerate}[label=(\arabic*).,series=alg1]
  \item When $\uptau\in \drc(D)$, $\upepsilon$ is determined by the ``basal
  disk'' of $\uptau$ (see \eqref{eq:x.uptau} for the definition of $x_{\uptau}$):
  \[
    \upepsilon_{\uptau}:=
    \begin{cases}
      0, & \text{if $x_{\uptau}=d$;} \\
      1, & \text{otherwise.}
    \end{cases}
  \]
  \item When $\uptau\in \drc(C)$, the  $\upepsilon$  is determined by
  the lengths of $\taulf$ and $\taurf$:
  \[
    \upepsilon_{\uptau} :=
    \begin{cases}
      0, & \text{if }\abs{\taulf} - \abs{\taurf} \geq  0;\\
      1, & \text{if }\abs{\taulf} - \abs{\taurf}<0.
    \end{cases}
  \]
\end{enumerate}


\subsubsection{Initial cases}

\begin{enumerate}[resume*=alg1]
  \item Suppose $\cO = (2c_{1}+1)$ has only one column. Then
        $\cOp_{0}:=\eDD(\cO)$ is the trivial orbit of $\Mp(0,\bR)$. $\drc(\cO)$
        consists of diagrams of shape
        $\tau_{L}\times \tau_{R} =\emptyset\times (c_{1},)$.
        The set $\drc(\cOp_{0})$ is a singleton $\set{\uptaup_{0}=\emptyset\times \emptyset}$, and every element
        $\uptau \in \drc(\cO)$ maps to $\uptau_{0}$ (see \eqref{eq:uptau0}):
        \[\tiny
          \drc(\cO)\ni \uptau:= \hspace{1em} \ytb{\emptyset,\none,\none,\none}
          \times \ytb{{x_{1}},\vdots,{x_{n}},{m_{\uptau}}}
          \mapsto \uptaup_{0}:=\emptyset\times \emptyset
        \]
        Here $m_{\uptau}=a$ or $b$ is the mark of $\uptau$.
        We define
        \[
          \bfpp_{\uptau}:=\bfxx_{\uptau} := x_{1}\cdots x_{n} m_{\uptau}.%  \text{ and }x_{\uptau}:=x_{n}
        \]
        We call $\bfpp_{\uptau}=\bfxx_{\uptau}$ the ``peduncle'' part of
        $\uptau$.
\end{enumerate}

\subsubsection{The descent from M to B}
The descent of a special shape diagram is simple, the descent of a non-special shape
reduces to the corresponding special one:
\begin{enumerate}[resume*=alg1]
  \item Suppose $\abs{\taulf} \geq \abs{\taurf} $, i.e. $\uptau$ has special
        shape. Keep $r,d$ unchanged, delete $\taulf$ and fill the remaining part
        with ``$\bullet$'' and ``$s$'' by $\DDr(\uptau^{\bullet})$ using the
        dot-s switching algorithm. The mark $m_{\uptaup}$ of
        $\uptaup:=\eDDo(\uptau)$ is given by the following formula:
        % \footnote{Note that $\taulf$ ends with $s$ or $c$ since
        % $\abs{\taulf}>\abs{\taurf}$}
        \[
        m_{\uptaup}:= \begin{cases}
          a & \text{if  $\taulf$ ends with $s$ or $\bullet$},\\
          b & \text{if $\taulf$ ends with $c$}.
        \end{cases}
        \]

  \item Suppose $\abs{\taulf} < \abs{\taurf}$, i.e. $\uptau$ has non-special
        shape. We define
        \[\eDDo(\uptau):=\eDDo(\uptau^{s})\]
        where $\uptau^{s}$ is the special diagram corresponding to $\uptau$
        defined in \Cref{def:sp-nsp.M}.
\end{enumerate}

\begin{lem}\label{lem:ds.BM}
  Suppose $\cO = (C_{2k},C_{2k-1}, \cdots, C_{0})$ with $k\geq 1$ and $C_{2k}$
  is odd.
  Let $\cOp := \eDD(\cO)=(C_{2k-1},\cdots, C_{0})$.
  Then
  \[
    \begin{split}
      \drcs(\cO) &\xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \drc(\cOp) \\
      \drcns(\cO)&
      \xrightarrow{\hspace{2em}\eDDo\hspace{2em}} \drc(\cOp)
    \end{split}
  \]
  are a bijections.
\end{lem}
\begin{proof}
  The claim for $\drcs(\cO)$ is clear by the definition of descent.
  The claim for $\drcns(\cO)$ reduces to that of $\drcs(\cO)$ using \Cref{def:sp-nsp.M}.
\end{proof}

\begin{lem}\label{lem:gd.BM}
  Suppose $\cO = (C_{2k},C_{2k-1}, \cdots, C_{0})$ with $k\geq 1$ and $C_{2k}$ even.
  Let $\cOp := \eDD(\cO)=(C_{2k-1}+1,\cdots, C_{0})$.
  Then the following map is a bijection
  \[
    \drc(\cO) \xrightarrow{\hspace{2em}\eDDo\hspace{2em}}
    \Set{\uptaup\in \drc(\cOp)| \begin{minipage}{11em}
        $m_{\uptaup}\neq b$ and\\
         $\uptaup_{R,0}$ dose not ends with $s$.
      \end{minipage}
    }. %\subsetneq \drc(\cOp).
  \]
\end{lem}
\begin{proof}
  This is clear by the descent algorithm.
\end{proof}


\subsubsection{Descent from $B$ to $M$}
Now we consider the general case of the
descent from type $D$ to type $C$. So we assume $\cO$ has at least 3 columns.
First note that the shape of $\uptau' = \eDD(\uptau)$ is the shape of $\uptau$ deleting the
longest column on the left.

% We assume $\uptau$ and $\uptau'$ has the following shape where $(y_{1},y_{2})$
% could be empty and $w_{0}$ is non-empty if $\uptau_{R}\neq \emptyset$.
The definition splits in cases below. In all these cases we define
\begin{equation}\label{eq:x.uptau}
 \bfpp_{\uptau}:= \bfxx_{\uptau} := x_{1}\cdots x_{n}m_{\uptau} \text{ and } x_{\uptau} := x_{n}
\end{equation}
which is marked by $s/r/c/d$.
For the part marked by $*/\cdots$ , $\eDD$ keeps $r,c,d$ and maps the rest part consisting of $\bullet$ and $s$ by dot-s switching algorithm.
\begin{enumerate}[resume*=alg1]
  \item When $C_{2k}=C_{2k-1}$ is odd, we could assume $\uptau$ and $\uptaup$ hase
        the following forms with $n = (C_{2k+1}-C_{2k}+1)/2$.
      \[
        \uptau: \hspace{1em} \tytb{\cdots\cdots\cdots,{\ast}{\ast}{\cdots},{x_{1}}{y_{1}}\cdots,{\vdots},{x_{n}}}
        \times \tytb{\cdots\cdots\cdots,{w_{0}}{\ast}{\cdots},\none,\none,\none}
        \mapsto
        \uptaup:  \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none{z_{1}}\cdots,\none,\none}
        \times \tytb{\cdots\cdots\cdots,{w_{0}}{\ast}{\cdots},\none,\none,\none}
      \]
        Suppose $y_{1} = c$ and $(x_{1}, \cdots, x_{n}) = (r, \cdots, r)$ or
        $(r, \cdots, r,d)$, then let $z_{1}= r$; otherwise, set $z_{1}:= y_{1}$.
  \item When $C_{2k}$ is odd and $\uptau$ has special shape, the descent is given by the following diagram
      \[
        \uptau: \hspace{1em}
        \tytb{
        \cdots\cdots\cdots,
        {\ast}{\cdots}{\cdots},
        {*(srcol)\bullet},
        {*(srcol)\vdots},{*(srcol)\bullet},{y_0},\none,\none,\none}
      \times
      \tytb{\cdots\cdots\cdots,
        {\ast}{\ast}{\cdots},
        {*(srcol)\bullet},
        {*(srcol)\vdots},
        {*(srcol)\bullet},
        {x_{1}},{\vdots},{x_{n}},{m_{\uptau}}}
        \mapsto
       \uptaup: \tytb{\cdots\cdots\cdots,{\ast}{\cdots}{\cdots},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},{y'_{0}},\none,\none,\none}
        \times \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none,\none}
      \]
      The  ``$\ast/\cdots$'' part of $\uptaup$ is given by keeping the corresponding
      entries marked by $r/d/c$ in
       $\uptau$ unchange and filling $s/\bullet$ accordingly in the rest of the
       entries.
       The entry $y'_{0}$ of $\uptaup$ is given by the following formula:
       \[
         y'_{0} := \begin{cases}
           s & \text{if $x_{1}=\bullet$ or $x_{1}\cdots x_{n}= r\cdots r$ \footnote{In this case, $y_{0}=c$.}}\\
           c & \text{otherwise\footnote{In this case, $x_{1}=s$ or
               $x_{1}\cdots x_{n}=r\cdots rd.$}}
         \end{cases}
       \]
       We define $\tbfxx_{\uptau}$ be the diagram by replacing $\bullet$ to $s$
       in $\bfxx_{\uptau}$.
  \item When $C_{2k}$ is odd and $\uptau$ has non-special shape, then
      \[
        \uptau: \hspace{1em}
        \tytb{
        {\cdots}\cdots\cdots,
        {\ast}{\cdots}{\cdots},
        \none,\none,\none,\none,\none,\none,\none}
      \times
      \tytb{\cdots\cdots\cdots,
        {\ast}{\ast}{\cdots},
        {*(srcol)s}{*(srcol)r},
        {*(srcol)\vdots}{*(srcol)\vdots},
        {*(srcol)s}{*(srcol)r},
        {x_{1}}{x_{0}},{\vdots},{x_{n}},{m_{\uptau}}}
        \mapsto
       \uptaup: \tytb{\cdots\cdots\cdots,{\cdots}{\cdots}{\cdots},\none,\none,\none,\none,\none,\none,\none}
        \times \tytb{\none\cdots\cdots,\none{\cdots}{\cdots},\none{*(srcol)r},\none{*(srcol)\vdots},\none{*(srcol)r},\none{x'_{0}},\none,\none,\none}
      \]
      The  ``$\ast/\cdots$'' part of $\uptaup$ is given by keeping the corresponding
      entries marked by $r/d/c$ in
       $\uptau$ unchange and filling $s/\bullet$ accordingly in the rest of the
       entries.
       The entry $x'_{0}$ of $\uptaup$ is given by the following formula:
       \[
         x'_{0} := \begin{cases}
           r & \text{if $x_{1}\cdots x_{n}= r\cdots r$ \footnote{In this case, $x_{0}=d$.}}\\
           x_{0} & \text{otherwise}
         \end{cases}
       \]
       We define $\tbfxx_{\uptau}:=\bfxx_{\uptau}$.
\end{enumerate}


\subsubsection{}
Now we assume $\cO$ is given by \eqref{eq:B.orb.ds}
Let $\cOp=\eDD(\cO)$ and $\cOpp=\eDD(\cOp)$.
The following lemma is the key property satisfied by our definition
\begin{lem}\label{lem:sp-nsp.B}
  Suppose $k\geq 1$ and
  $\tau^{s}$ and $\tau^{ns}$ are two representations attached to $\cO$ as in
  \Cref{def:sp-nsp.B.sp}.
  Then
  \begin{enumS}
    \item \label{lem:sp-nsp.B.1} For every $\uptau\in \drc(\tau^{s})\sqcup \drc(\tau^{ns})$, the shape
    of $\eDD^{2}(\uptau)$ is
    \[
      \taupp = (\tau_{2k-2},\cdots, \tau_{2})\times  (c_{2k-1},\tau_{2k-3},\tau_{1})
    \]
    \item \label{lem:sp-nsp.B.2} Let $\cO_{1}= (C_{2k+1}-C_{2k}+1,)\in \Nil(B)$ be the trivial orbit
    of $\rO(C_{2k+1}-C_{2k}+1,\bC)$.
    We define $\delta\colon \drc(\cO)\rightarrow \drc(\cOpp)$ by $\delta(\uptau) = (\eDD^{2}(\uptau),\tbfxx_{\uptau})$.
    The following maps are injections with the same image
    \[
      \begin{tikzcd}[row sep=0em]
        \drc(\tau^{s})\ar[r,"\delta"] & \drc(\taupp)\times \drc(\cO_{1}) &\ar[l,"\delta"'] \drc(\tau^{ns})\\
        \uptau^{s}\ar[r,maps to] & (\eDD^{2}(\uptau^{s}), \bfxx_{\uptau^{s}})&\\
        & (\eDD^{2}(\uptau^{ns}), \bfxx_{\uptau^{ns}})& \uptau^{ns}\ar[l,maps to]\\
      \end{tikzcd}
    \]
    In particular, we obtain an one-one correspondence
    $\uptau^{s}\leftrightarrow \uptau^{ns}$ such that $\delta(\uptau^{s})=\delta(\uptau^{ns})$.
    \item\label{lem:sp-nsp.B.3}
    Suppose $\uptau^{s}$ and $\uptau^{ns}$ correspond as the above such that
    $\delta(\uptau^{s})=\delta(\uptau^{ns})=(\uptaupp,\tbfxx)$. Then
    \begin{equation} \label{eq:sp-nsp-sig}
      \ssign(\uptau^{s})=\ssign(\uptau^{ns})=(C_{2k},C_{2k})+\ssign(\uptaupp)+\tsign(\tbfxx).
    \end{equation}
    with
    \[
      \tsign(\tbfxx) = \begin{cases}
        \ssign(\tbfxx) - (1,0) & \text{if $x_{1}\cdots x_{n}=r\cdots r$}\\
        \ssign(\tbfxx) - (0,1) & \text{otherwise.}\\
      \end{cases}
    \]
  \end{enumS}
\end{lem}
\begin{proof}
  By our assumption, we have $c_{2k+1}\geq c_{2k}>c_{2k-1}$ and
  \[
    \tau^{s} = (c_{2k},\tau_{2k-2},\cdots, \tau_{2})\times (c_{2k+1}, c_{2k-1}).
  \]
  The the behavior of $\uptau^{s}$ under the descent map $\eDD$ is illostrated
  as the following:
  \[
    \uptau^{s}: \hspace{1em}
    \tytb{
      {*(srcol)\cdots}\cdots\cdots,
      {*(srcol)\ast}{\ast}{\cdots},
      {*(srcol)\bullet},
      {*(srcol)\vdots},{*(srcol)\bullet},{x_0},\none,\none,\none}
    \times
    \tytb{{*(srcol)\cdots}\cdots\cdots,
      {*(srcol)\ast}{\ast}{\cdots},{*(srcol)\bullet},{*(srcol)\vdots},{*(srcol)\bullet},{x_{1}},\vdots,{x_{n}},m}
    \mapsto
    \uptau'^{s}: \hspace{1em}
    \tytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)\ast}{\ast}{\cdots},{*(srcol)s},{*(srcol)\vdots},{*(srcol)s},{x'_{0}},
      \none,\none,\none}
    \times \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none,\none}
    \mapsto
    \uptaupp:
    \tytb{\none\cdots\cdots,\none{\ast}{\cdots},\none,\none,\none,\none,\none,\none,\none}
    \times \tytb{\none\cdots\cdots,{\none}{\ast}{\cdots},\none{m'},\none,\none,\none,\none,\none,\none}
  \]
  Note that $\uptau^{s}$ is obtained from $\taupp$ by attaching the grey part
  consisting totally $2c_{2k}$ dots and $\bfxx$. Now the claims for $\uptau^{s}$ is
  clear.


  Now consider the descent of a non-special diagram $\uptau^{ns}$:
  \[\tiny
    \uptau^{ns}:\ytb{{*(srcol)\cdots}\cdots\cdots\cdots,{*(srcol)\ast}{y_{0}}{\ast}{\cdots},{*(srcol)s}{*(srcol)r}{y_{2}}\cdots,
      {*(srcol)\vdots}{*(srcol)\vdots},{*(srcol)s}{*(srcol)r},{x_{0}}{y_{1}},{x_{1}}{y_{3}},{\vdots},{x_{n}} }
    \times\ytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)u_{0}}{\cdots},\ ,\ ,\ ,\ ,\ ,\ ,\ }
    \mapsto
    \uptau'^{ns}:\ytb{\cdots\cdots\cdots,{y'_{0}}{\ast}{\cdots},{*(srcol)r}{y'_{2}}\cdots,
      {*(srcol)\vdots},{*(srcol)r},{y'_{1}},{y'_{3}},\ ,\ }
    \times\ytb{{*(srcol)\cdots}\cdots\cdots,{*(srcol)w_{0}}{\cdots},\ ,\ ,\ ,\ ,\ ,\ ,\ }
    \mapsto
    \uptaupp:\hspace{1em}
            \ytb{{\cdots}{\cdots}{\cdots},{x'_{0}}{\ast}{\cdots},{x'_{1}}{x'_{2}}\cdots,\none,\none,\none,\none,\none,\none}
            \times
            \ytb{{\cdots}{\cdots},{\cdots}\none,\none,\none,\none,\none,\none,\none,\none}
            % \ytb{\emptyset,\none,\none,\none,\none,\none}
  \]
  The bijection follows from the observation that 1. $\uptau^{ns}$ is obtained by
  attaching the grey part $x_{0},\cdots,x_{n}$ and $y_{0},y_{1},y_{2},y_{3}$
  to the $\ast/\cdots$ part of $\uptaupp$;
  2. the value of $(y_{0},y_{1},y_{2},y_{3})$ is completely determined by
  $(x'_{0},x'_{1},x'_{2})$ and $\bfxx=x_{1}\cdots x_{n}$.

  We leave it to the reader for checking case by case that the grey part of $\uptau^{ns}$ has signature
  $(C_{2k}-2,C_{2k}-2)$ and
  \[\ssign(x_{0}y_{0}y_{1}y_{2}y_{3})-\ssign(x'_{0}x'_{1}x'_{2})=(2,2).
  \]
 Therefore \eqref{eq:sp-nsp-sig} follows.

 \trivial[]{
   First assume that $C_{2k}=2$. Note that we can not/(or now?) assume $k=1$, consider the
   orbit $\cOpp=(2,1,1,1,1)$.
   \begin{enumPF}
     \item
     $x'_{1}=s$, now $y'_{0} = \emptyset/\bullet$ when $x'_{0}=\emptyset/s$
     \begin{enumPF}
       \item Suppose $x'_{2}\neq r$. Then $(y'_{2},y'_{1},y'_{3}) = (x'_{2},r,d)$,
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,x'_{0}, x'_{2},c,d)$.
       Therefore, the sign difference is $\ssign(s,c,d)-\ssign(s)=(2,2)$.
       \item Suppose $x'_{2} = r$. Then $(y'_{2},y'_{1},y'_{3}) = (c,r,d)$.
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,x'_{0},c,r,d)$.
       Therefore, the sign difference is $\ssign(s,c,r,d)-\ssign(s,r)=(2,2)$.
     \end{enumPF}
     \item $x'_{1}\neq s$.
     \begin{enumPF}
       \item Suppose $x'_{0}\neq c$.
       Then $x'_{0}=\emptyset/s/r$, $x'_{1}=r/c/d$, $(y'_{0}, y'_{2},y'_{1},y'_{3}) = (\emptyset/\bullet/r,x'_{2},r,x'_{1})$.
       \begin{enumPF}
         \item $x'_{1}=r$. Then
         $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (r,x'_{0},x'_{2},c,d)$.
         Therefore, the sign difference is $\ssign(r,c,d)-\ssign(r)=(2,2)$.
         \item $x'_{1}=c$. Then  $x_{1}=d$.
         $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (c,x'_{0},x'_{2},c,d)$.
         Therefore, the sign difference is $\ssign(c,c,d)-\ssign(c)=(2,2)$.
         \item $x'_{1}=d$. Then
         $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,x'_{0},y'_{2},y'_{1},y'_{3})=(s,x'_{0},x'_{2},r,d)$.
         Therefore, the sign difference is $\ssign(s,r,d)-\ssign(d)=(2,2)$.
       \end{enumPF}
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,r,x'_{2},c,d)$.
       Therefore, the sign difference is $\ssign(s,r,x'_{2},c,d)-\ssign(c,d,x'_{2})=(2,2)$.
       \item Suppose $x'_{0} = c$.
       Then $x'_{1}=d$, $(y'_{0}, y'_{2},y'_{1},y'_{3}) = (r,x'_{2},c,d)$.
       $(x_{0},y_{0},y_{2},y_{1},y_{3}) = (s,r,x'_{2},c,d)$.
       Therefore, the sign difference is $\ssign(s,r,x'_{2},c,d)-\ssign(c,d,x'_{2})=(2,2)$.
     \end{enumPF}
   \end{enumPF}
   }
 \end{proof}



\section{An example}\label{sec:C.reg}
Consider the case that
$\cO = (2,\underbrace{1, \cdots, 1}_{(t+1)\text{-terms}})\in \Nil(D)$.
%$[2k+2,2k+1, \cdots, 2k+1, 2l, 2l,\cdots ]$.
%here we have $2k+1$-columns $2t$.

Then $\cOp$ is a regular orbit of the corresponding symplectic group. $\cOp$ is
the opposite case compared to the noticed oribts. It is very ``degenerate''.

By the calculation above, we have
\[
  \cL_{\uptaupp} = \cB_{\uptaupp} \cdot \cP_{\bfpp_{\uptaupp}}.
\]

Now the


\begin{equation} \label{eq:B1-2}
  \begin{array}{c|c|c}
   \bfpp_{\uptaup}=\bfpp_{\uptau}=x_{1}y_{1}  &   \cP_{\uptaupp} & \cP_{\uptaup}\\
    \hline
    sr & \tytb{+-+,=} & \\
    \hline
    sc & \tytb{-+-,=} & \\
    \hline
    sd & \tytb{=\ast=,=} &\\
    \hline
    rc & \tytb{\ast=\ast,+} & \tytb{=\ast=\ast}\\
    \hline
    rd & \tytb{+-+,+} & \tytb{-+-+}\\
    \hline
    cc & \tytb{=\ast=,+} &  \tytb{\ast=\ast=} \\
    \hline
    cd & \tytb{-+-,+} \cup \tytb{\ast=\ast,=} &\tytb{+-+-} \\
    \hline
    dd & \tytb{-+-,+}\cup\tytb{+-+,-} &\tytb{+-+-} \cup \tytb{-+-+}\\
  \end{array}
\end{equation}


% \begin{equation} \label{eq:B1-2}
% \begin{array}{cc|c|cc}
%   \bfxx_{\uptaupp} & \cP_{\uptaupp}         & \cP_{\uptaup} & \bfxx_{\uptau} & \cP_{\uptaupp} \\
%   \hline
%   src              & \tytb{\ast=\ast=\ast,=} &                                                 \\
%   \hline
%   srd              & \tytb{+-+-+,=}          &                                                 \\
%   \hline
%   scc              & \tytb{-+-+-,=}          &                                                 \\
%   \hline
%   scd              & \tytb{=\ast=\ast=,=} &                                                 \\
%   sdd              & %\tytb{=\ast=\ast=,=}
%                                             &                                                 \\
%   \hline
%   rcc              & \tytb{\ast=\ast=\ast,+} & \tytb{-+-+-+}                                                \\
%   \hline
%   rcd              & \tytb{+-+-+,+} & \tytb{=\ast=\ast=\ast}                             \\
%   rdd              & %\tytb{+-+-+,+} & \tytb{=\ast=\ast=\ast}                             \\
%                                 & \\
%   \hline
%   ccc              & \tytb{-+-+-,+}          & \tytb{+-+-+-}                                               \\
%   \hline
%   ccd              & \tytb{=\ast=\ast=,+}          & \tytb{+-+-+-}                                               \\
%   \hline
%   cdd              & \tytb{=\ast=\ast=,+}\cup \tytb{+-+-+,=} & \\
%   \hline
%   ddd              & \tytb{-+-+-,+}\cup \tytb{+-+-+,-}          &                                                 \\
% \end{array}
% \end{equation}

\begin{equation} \label{eq:B1-2}
\begin{array}{cc|c|cc}
  \bfxx_{\uptaupp} & \cP_{\uptaupp}         & \cP_{\uptaup} & \bfxx_{\uptau} & \cP_{\uptaupp} \\
  \hline
  src              & \tytb{\ast\cdots ,=} &                                                 \\
  \hline
  srd              & \tytb{+\cdots,=}          &                                                 \\
  \hline
  scc              & \tytb{-\cdots,=}          &                                                 \\
  \hline
  scd              & \tytb{=\cdots,=} &                                                 \\
  sdd              & %\tytb{=\ast=\ast=,=}
                                            &                                                 \\
  \hline
  rcc              & \tytb{\ast\cdots,+} & \tytb{-\cdots}                                                \\
  \hline
  rcd              & \tytb{+\cdots,+} & \tytb{=\cdots}                             \\
  rdd              & %\tytb{+-+-+,+} & \tytb{=\ast=\ast=\ast}                             \\
                                & \\
  \hline
  ccc              & \tytb{-\cdots,+}          & \tytb{+\cdots}                                               \\
  \hline
  ccd              & \tytb{=\cdots,+}          & \tytb{\ast\cdots}                                             \\
  cdd              & \tytb{=\cdots,+}\cup \tytb{+\cdots,=} & \\
  \hline
  ddd              & \tytb{-\cdots,+}\cup \tytb{+\cdots,-}  &
                                                            \tytb{+\cdots} \cup\tytb{-\cdots}                     \\
\end{array}
\end{equation}

When $t$ is even.
In the following
%$\cA_{8}\cap\cA_{9}=\emptyset$.
$\set{\cA_{1},\cA_{2}, \cA_{3},\cA_{4}}$ are disjoint, $\set{\cA_{5},\cA_{6}}$ are disjoint,
and $\set{\cA_{7},\cA_{8},\cA_{9}}$ % and $\set{\cA_{9},\cA_{10}}$
are disjoint.
$\cA_{9}=\set{d\cdots d}$
\begin{equation} \label{eq:B1-2}
\begin{array}{cc|c|cc}
  \bfxx_{\uptaupp} & \cP_{\uptaupp}         & \cP_{\uptaup} & \bfxx_{\uptau} & \cP_{\uptau} \\
  \hline
  s\cA_{1}              & \tytb{\ast\cdots ,=} &                                                 \\
  \hline
  s\cA_{2}              & \tytb{+\cdots,=}          &                                                 \\
  \hline
  s\cA_{3}              & \tytb{-\cdots,=}          &                                                 \\
  \hline
  s\cA_{4}              & \tytb{=\cdots,=} &                                                 \\
  \hline
  r\cA_{5}              & \tytb{\ast\cdots,+} & \tytb{-\cdots}  & sr\cA_{5} & \tytb{\ast\cdots, =}                            \\
                        &                    &                & rc\cA_{5} &\tytb{+\cdots,+}                                   \\
  \hline
  r\cA_{6}              & \tytb{+\cdots,+} & \tytb{=\cdots}    & sr\cA_{6} &  \tytb{+\cdots,=}                        \\
                        &                    &                & rc\cA_{6} &\tytb{\ast\cdots,+}                                   \\
  \hline
  c\cA_{7}              & \tytb{-\cdots,+}          & \tytb{+\cdots} & sc\cA_{7} & \tytb{=\cdots,=}                                        \\
                        &                    &                & cc\cA_{7} &\tytb{-\cdots,+}                                   \\
  \hline
  c\cA_{8}              & \tytb{=\cdots,+}          & \tytb{\ast\cdots} & sc(\cA_{8}\cup \cA_{9}) & \tytb{-\cdots,=}                                   \\
   c\cA_{9}           &   \tytb{=\cdots,+}\cup \tytb{+\cdots,=}     &                & cc(\cA_{8}\cup \cA_{9}) &\tytb{=\cdots,+}                                   \\
  \hline
  d\cA_{9}              & \tytb{-\cdots,+}\cup \tytb{+\cdots,-}  &
                                        \tytb{+\cdots} \cup\tytb{-\cdots}    & sd\cA_{9} & \tytb{=\cdots,=}                 \\
                        &                    &                & rd\cA_{9} &\tytb{+\cdots,+}                                   \\
                        &                    &                & cd\cA_{9} &\tytb{-\cdots,+}  \cup \tytb{\ast\cdots,=}                \\
                        &                    &                & dd\cA_{9} &\tytb{-\cdots,+} \cup \tytb{+\cdots,-}                       \\
\end{array}
\end{equation}

We observe that there are two coincidences:
\begin{enumT}
  \item $\tytb{+\cdots,+}$: clearly $rc\cA_{5}$ and $rd\cA_{9}$ are disjoint.
  \item $\tytb{=\cdots,=}$: clearly $sc\cA_{7}$ and $sd\cA_{9}$ are also disjoint.
\end{enumT}


When $t$ is odd.
In the following
%$\cA_{8}\cap\cA_{9}=\emptyset$.
$\set{\cA_{1},\cA_{2}, \cA_{3},\cA_{4}}$ are disjoint, $\set{\cA_{5},\cA_{6}}$ are disjoint,
and $\set{\cA_{7},\cA_{8},\cA_{9}}$ % and $\set{\cA_{9},\cA_{10}}$
are disjoint.
$\cA_{9}=\set{d\cdots d}$
\begin{equation} \label{eq:B1-2}
\begin{array}{cc|c|cc}
  \bfxx_{\uptaupp} & \cP_{\uptaupp}         & \cP_{\uptaup} & \bfxx_{\uptau} & \cP_{\uptau} \\
  \hline
  s\cA_{1}              & \tytb{\ast\cdots ,=} &                                      \\
  \hline
  s\cA_{2}              & \tytb{+\cdots,=}          &                                     \\
  \hline
  s\cA_{3}              & \tytb{-\cdots,=}          &                                 \\
  \hline
  s\cA_{4}              & \tytb{=\cdots,=} &                                      \\
  \hline
  r\cA_{5}              & \tytb{\ast\cdots,+} & \tytb{=\cdots}  & sr\cA_{5} & \tytb{\ast\cdots,=}                      \\
                        &                    &                & rc\cA_{5} &\tytb{\ast\cdots,+}                         \\
  \hline
  r\cA_{6}              & \tytb{+\cdots,+} & \tytb{-\cdots}    & sr\cA_{6} &  \tytb{+\cdots,=}                    \\
                        &                    &                & rc\cA_{6} &\tytb{+\cdots,+}                          \\
  \hline
  c\cA_{7}              & \tytb{=\cdots,+}          & \tytb{\ast\cdots} & sc\cA_{7} & \tytb{-\cdots,=}                                        \\
                        &                    &                & cc\cA_{6} &\tytb{-\cdots,+}                                \\
  \hline
  c\cA_{8}              & \tytb{-\cdots,+}          & \tytb{+\cdots} & sc(\cA_{8}\cup \cA_{9}) &\tytb{=\cdots,=}             \\
                        &                    &                & cc(\cA_{8}\cup \cA_{9}) &\tytb{=\cdots,+}                                   \\
  c\cA_{9}              & \tytb{-\cdots,+}\cup \tytb{\ast\cdots,=} & \\
  \hline
  d\cA_{9}              & \tytb{-\cdots,+}\cup \tytb{+\cdots,-}  &
                                                            \tytb{+\cdots} \cup\tytb{-\cdots}    & sd\cA_{9} & \tytb{=\cdots,=}                 \\
                        &                    &                & rd\cA_{9} &\tytb{+\cdots,+}                                   \\
                        &                    &                & cd\cA_{9} &\tytb{=\cdots,+}  \cup \tytb{+\cdots,=}                \\
                        &                    &                & dd\cA_{9} &\tytb{-\cdots,+} \cup \tytb{+\cdots,-}                       \\
\end{array}
\end{equation}

% Now we back to a the situation $t$ is even.


% % In this case, one check that all the claim holds for $\cL_{\uptau}$.
% Case by case check, yields that we can recover $(\bfxx_{\uptau}, z_{1})$ for the
% local system $\cL_{\uptau}$, and then we could recover the packet $[\cL_{\uptaupp}]$


% Now assume the second longest row of $\cOpp$ is odd.
% In this case, the step leads to $\cOpp$ is also an generalized descent.

% Then $\abs{\tauls}-\abs{\taurs}=1$.

% We observe the following facts for $\LLS{\uptau}$.
% Suppose $(x_{0},\cdots,x_{n})=(s,\cdots, s,c)$ and $y_{1}=$

% Assume 1. $C_{2k}=C_{2k-1}$ is even or 2. $C_{2k}$ is odd and $C_{2k+1}>C_{2k}+2$.
% If $\uptau$ ends with $s$ then
% $(\pcL_{\uptau},\ncL_{\uptau})=(\emptyset, \emptyset)$.
% If $\taulf$ ends with $c/r/d$, $\pcL_{\uptau}\mapsto \pcL_{\uptau}$ is a well defined
% injective map. Hence the generalized lift of these local system $\pcL_{\uptau}$ to
% $(C_{2k+1}-1, C_{2k+1}-1, C_{2k}, \cdots)$ is injective.



% Properties:
% \begin{enumS}
% \item If the first row of $\uptau$ ends with $s$, $\pcL = \ncL = 0$.
% \item If the first row of $\uptau$ ends with $c/r$, $\pcL \neq 0$ and $\ncL=0$.
% \item If the first ro
% \end{enumS}
% \ref{p:drcls.1} follows from the above properties.

% Assume the properties above are satisfied by $\cOpp$.

% The local system $\cL_{\uptaup}$ is given by attaching a column on the left of
% $\pcL_{\uptaupp}+\ncL_{\uptaupp}$.

% Assume $\bsign{\cL_{\uptaupp}} = (p_{1},q_{1})$.
% Note that
% \begin{enumI}
% \item the descent $\uptaupp$ of $\uptaup$ never ends with $s$.
% \item When $\uptaup_{0}$ ends with $c/r$, $p_{1}\geq 1$ ans so $\bsign{\cL_{\uptaup}} = (p_{1}-1,q_{1})$.
% \item When $\uptaup_{0}$ ends with $d$,  $\bsign{\cL_{\uptaup}}=\set{(p_{1},q_{1}-1),(p_{1}-1,q_{1})}$
% \end{enumI}


% We now deal with the case
% \[
%   \cO = [C_{2k+1},C_{2k} =  C_{2k-1}\cdots C_{2k-2a+1} > C_{2k-2a},\cdots ]
% \]


% \subsection{}

% To prove \Cref{thm:count}, % is a consequence of the followingwe will establish the following set of properties of $\eDD$.

% \begin{prop}
%   %The map $\cL$ is a well-defined injection. More precisely, we have
%   We have
%   \begin{enumS}
%     \item $\cL_{\uptau}$ is non-zero for each $\uptau\in \edrc(\star)$.
%     \item % For each \ess orbit $\cO$ of type C or M,
%     When $\star = C$ or $M$,
%     the following is an
%     injection
%     \[
%       \begin{tikzcd}[row sep=0em]
%         \drc(\star) \ar[r] & \LS(\star) \\
%         \uptau \ar[r,maps to] & \Ch(\uppi_{\uptau}) = \cL_{\uptau}
%       \end{tikzcd}
%     \]
%     \item
%     When $\star = C$ or $M$,
%     % For each \ess orbit $\cO$ of type D or B,
%     the following is an
%     injection
%     \[
%       \begin{tikzcd}[row sep=0em]
%         \drc(\star)\times \bZ/2\bZ \ar[r] & \LS(\star)\\
%         (\uptau,\upepsilon) \ar[r,maps to] & \Ch(\uppi_{\uptau}\otimes (\bfone_{p,q}^{-,-})^{\upepsilon})
%         %= \cL_{\uptau}\otimes (\bfone_{p,q}^{-,-})^{\upepsilon}
%       \end{tikzcd}
%     \]
%   \end{enumS}
% \end{prop}


% {\color{red} The details of the definition of $\eDD$ and the proof of the above
%   proposition will be supplied later.}


\appendix
\delete{
\clearpage
\section*{\color{blue} Progress reports and questions}
I have written a program which realizes the algorithm of mataching dot-r-c
diagram with local system for both even orthogonal-symplectic dual pairs and odd
orthogonal-metaplectic dual pairs.
The algorithm has been tested numerically. Some examples:
\begin{enumerate}
  \item
        Consider the type $C$ partition with columns
        $(9, 9, 8, 8, 7, 7, 5, 5, 3, 3, 1, 1)$.
        All unipotent representations are theta lifts. Here are some data
        generated by the program:

        \vspace{-0.5em}
\begin{lstlisting}
Type D partition: (2,)
Number of DRCS: 4
Type C partition: (1, 1)
Number of DRCS: 3
Type D partition: (4, 1, 1)
Number of DRCS: 20
Type C partition: (3, 3, 1, 1)
Number of DRCS: 17
Type D partition: (6, 3, 3, 1, 1)
Number of DRCS: 116
Type C partition: (5, 5, 3, 3, 1, 1)
Number of DRCS: 99
Type D partition: (8, 5, 5, 3, 3, 1, 1)
Number of DRCS: 676
Type C partition: (7, 7, 5, 5, 3, 3, 1, 1)
Number of DRCS: 577
Type D partition: (8, 7, 7, 5, 5, 3, 3, 1, 1)
Number of DRCS: 1632
Type C partition: (8, 8, 7, 7, 5, 5, 3, 3, 1, 1)
Number of DRCS: 3264
Type D partition: (10, 8, 8, 7, 7, 5, 5, 3, 3, 1, 1)
Number of DRCS: 13056
Type C partition: (9, 9, 8, 8, 7, 7, 5, 5, 3, 3, 1, 1)
Number of DRCS: 9792
\end{lstlisting}
\item
        Consider the type $M$ partition with columns
        $(9,9,8,8,7,7,6,6,4,4,2,2,1,1)$.
        All unipotent representations are theta lifts:
        \vspace{-0.5em}
\begin{lstlisting}
Type B partition: (1,)
Number of DRCS: 1
Type M partition: (1, 1)
Number of DRCS: 4
Type B partition: (3, 1, 1)
Number of DRCS: 8
Type M partition: (2, 2, 1, 1)
Number of DRCS: 12
Type B partition: (5, 2, 2, 1, 1)
Number of DRCS: 40
Type M partition: (4, 4, 2, 2, 1, 1)
Number of DRCS: 68
Type B partition: (7, 4, 4, 2, 2, 1, 1)
Number of DRCS: 232
Type M partition: (6, 6, 4, 4, 2, 2, 1, 1)
Number of DRCS: 396
Type B partition: (7, 6, 6, 4, 4, 2, 2, 1, 1)
Number of DRCS: 560
Type M partition: (7, 7, 6, 6, 4, 4, 2, 2, 1, 1)
Number of DRCS: 2240
Type B partition: (9, 7, 7, 6, 6, 4, 4, 2, 2, 1, 1)
Number of DRCS: 4480
Type M partition: (8, 8, 7, 7, 6, 6, 4, 4, 2, 2, 1, 1)
Number of DRCS: 6720
Type B partition: (9, 8, 8, 7, 7, 6, 6, 4, 4, 2, 2, 1, 1)
Number of DRCS: 8960
Type M partition: (9, 9, 8, 8, 7, 7, 6, 6, 4, 4, 2, 2, 1, 1)
Number of DRCS: 35840
\end{lstlisting}
  \item The algorithm having the essentially the same shape of Barbasch's notes.
        It using the information encoded in the longest 4 columns of the left
        and right dot-r-c diagrams. So the proof of the validity of the
        algorithm should be reduced to the case where at most 4 columns appears
        in the Young diagram of the nilpotent orbit.
  \item Through the theta lifting process, number of irreducible components in the
        associated variety can be decreasing. This situation are very rare and
        could be easily identified from the dot-r-c diagram.
\end{enumerate}

\subsection*{TODO}
\begin{enumerate}
  \item I am working on the proof of the algorithm.
  \item {\color{red} Question:}
        Our goal is to construct all unipotent representations for all purely
        even orbit ${}^{L}\cO$. The remaining cases consist the orbits which are
        note noticed. In these case, local systems on the associated variety are
        not enough to separate the representations.

        Let us consider the simplest case, a type $C$ orbit $\cO$ with columns
        $(1,1,1,1,1,1)$.

        Now $\#\drc(\cO) = 7$, however theta lifting only generates $5$ possible
        local systems.

        In fact, for the type C orbit $\cO$ with a single row of length $2r$,
        $\#\drc(\cO) = 1+2r$ . When $2r\geq 4$, theta lifting only generates $5$ different
        local systems: $4$ local systems have irreducible associated variety,
        and $1$ local system support on
        the union of the two real orbits.
  \item
         In Dan's notes and email, the rest
        cases are expected to be treated by parabolic and
        cohomological inductions. However, I have no idea how it should work precisely.
        Continue with the notation in the previous item.
        I now explain my confusion by the example.

        Let $\cO_{0}$ be the orbit of type C with columns $(1,1)$ and let
        $\cO = (1,1,1,1,1,1)$. Now $\#\Unip(\cO_{0})=3$. For each unipotent representation
        $\uppi_{0}\in \Unip(\cO_{0})$,
        we can form parabolic induced representations
        \[
        \Ind_{\GL(1,\bR)\times \GL(1,\bR)\times \Sp(2,\bR)}^{\Sp(6,\bR)} \chi_{1} \boxtimes \chi_{2}\boxtimes \uppi_{0}
        \]
        where $\chi_{1}$ and $\chi_{2}$ are trivial or determinant characters.

        By the argument in Section~4.2.4 of our preprint arXiV:1712.05552, we
        could identify {\color{red} the irreducible components of} these induced representations with double theta liftings,
        and therefore {\color{red} some of the representations are reducible}
        (this is pointed out by Binyong.)

        However, for each $\uppi_{0}$, there are $3$ possible choices of
        $\chi_{0}$ and $\chi_{1}$ up to permutation.
        Therefore, there must be some {\color{red} coincidence} among these induced
        representations, as $3\times 3 >7$.
        The known coincidence for theta lifts might give all possible coincidences.
        Hopefully these case are exactly all the coincidences and the
        theta lifts yield all unipotent representations.
        I {\color{red} verified} the case where $\cO$ has a single row of length $10$
        by hand.
        The idea might be tested numerically, and I will update my program later.

        On the other hand, one may also use cohomological induction by inducing from
        $\rU(1)\times \rU(1)\times \Sp(2,\bR)$ and put trivial representations
        on the $\rU(1)$ factors. I have no idea about the
        {\color{red} irreducibility} of them. Is it possible that these
        cohomologically induced representations {\color{red} coincide} with
        certain parabolically induced modules described as above?
\end{enumerate}
}


\printindex

\begin{bibdiv}
  \begin{biblist}
% \bib{AB}{article}{
%   title={Genuine representations of the metaplectic group},
%   author={Adams, Jeffrey},
%   author = {Barbasch, Dan},
%   journal={Compositio Mathematica},
%   volume={113},
%   number={01},
%   pages={23--66},
%   year={1998},
% }

\bib{Ad83}{article}{
  author = {Adams, J.},
  title = {Discrete spectrum of the reductive dual pair $(O(p,q),Sp(2m))$ },
  journal = {Invent. Math.},
  number = {3},
 pages = {449--475},
 volume = {74},
 year = {1983}
}

%\bib{Ad07}{article}{
%  author = {Adams, J.},
%  title = {The theta correspondence over R},
%  journal = {Harmonic analysis, group representations, automorphic forms and invariant theory,  Lect. Notes Ser. Inst. Math. Sci. Natl. Univ. Singap., 12},
% pages = {1--39},
% year = {2007}
% publisher={World Sci. Publ.}
%}


\bib{ABV}{book}{
  title={The Langlands classification and irreducible characters for real reductive groups},
  author={Adams, J.},
  author={Barbasch, B.},
  author={Vogan, D. A.},
  series={Progress in Math.},
  volume={104},
  year={1991},
  publisher={Birkhauser}
}

\bib{AC}{article}{
  title={Algorithms for representation theory of
    real reductive groups},
  volume={8},
  DOI={10.1017/S1474748008000352},
  number={2},
  journal={Journal of the Institute of Mathematics of Jussieu},
  publisher={Cambridge University Press},
  author={Adams, Jeffrey}
  author={du Cloux,
    Fokko},
  year={2009},
  pages={209-259}
}

\bib{ArPro}{article}{
  author = {Arthur, J.},
  title = {On some problems suggested by the trace formula},
  journal = {Lie group representations, II (College Park, Md.), Lecture Notes in Math. 1041},
 pages = {1--49},
 year = {1984}
}


\bib{ArUni}{article}{
  author = {Arthur, J.},
  title = {Unipotent automorphic representations: conjectures},
  %booktitle = {Orbites unipotentes et repr\'esentations, II},
  journal = {Orbites unipotentes et repr\'esentations, II, Ast\'erisque},
 pages = {13--71},
 volume = {171-172},
 year = {1989}
}

\bib{AK}{article}{
  author = {Auslander, L.},
  author = {Kostant, B.},
  title = {Polarizations and unitary representations of solvable Lie groups},
  journal = {Invent. Math.},
 pages = {255--354},
 volume = {14},
 year = {1971}
}

\bib{B.Uni}{article}{
  author = {Barbasch, D.},
  title = {Unipotent representations for real reductive groups},
 %booktitle = {Proceedings of ICM, Kyoto 1990},
 journal = {Proceedings of ICM (1990), Kyoto},
   % series = {Proc. Sympos. Pure Math.},
 %   volume = {68},
     pages = {769--777},
 publisher = {Springer-Verlag, The Mathematical Society of Japan},
      year = {2000},
}

\bib{B.W}{article}{
  author={Barbasch, Dan},
  author={Vogan, David},
  editor={Trombi, P. C.},
  title={Weyl Group Representations and Nilpotent Orbits},
  bookTitle={Representation Theory of Reductive Groups:
    Proceedings of the University of Utah Conference 1982},
  year={1983},
  publisher={Birkh{\"a}user Boston},
  address={Boston, MA},
  pages={21--33},
  %doi={10.1007/978-1-4684-6730-7_2},
}



\bib{B.Orbit}{article}{
  author = {Barbasch, D.},
  title = {Orbital integrals of nilpotent orbits},
 %booktitle = {The mathematical legacy of {H}arish-{C}handra ({B}altimore,{MD}, 1998)},
    journal = {The mathematical legacy of {H}arish-{C}handra, Proc. Sympos. Pure Math.},
    %series={The mathematical legacy of {H}arish-{C}handra, Proc. Sympos. Pure Math},
    volume = {68},
     pages = {97--110},
 publisher = {Amer. Math. Soc., Providence, RI},
      year = {2000},
}



\bib{B10}{article}{
  author = {Barbasch, D.},
  title = {The unitary spherical spectrum for split classical groups},
  journal = {J. Inst. Math. Jussieu},
% number = {9},
 pages = {265--356},
 volume = {9},
 year = {2010}
}



\bib{B17}{article}{
  author = {Barbasch, D.},
  title = {Unipotent representations and the dual pair correspondence},
  journal = {J. Cogdell et al. (eds.), Representation Theory, Number Theory, and Invariant Theory, In Honor of Roger Howe. Progress in Math.}
  %series ={Progress in Math.},
  volume = {323},
  pages = {47--85},
  year = {2017},
}

\bib{BVUni}{article}{
 author = {Barbasch, D.},
 author = {Vogan, D. A.},
 journal = {Annals of Math.},
 number = {1},
 pages = {41--110},
 title = {Unipotent representations of complex semisimple groups},
 volume = {121},
 year = {1985}
}

\bib{Br}{article}{
  author = {Brylinski, R.},
  title = {Dixmier algebras for classical complex nilpotent orbits via Kraft-Procesi models. I},
  journal = {The orbit method in geometry and physics (Marseille, 2000). Progress in Math.}
  volume = {213},
  pages = {49--67},
  year = {2003},
}

\bib{Carter}{book}{
   author={Carter, Roger W.},
   title={Finite groups of Lie type},
   series={Wiley Classics Library},
   %note={Conjugacy classes and complex characters;
   %Reprint of the 1985 original;
   %A Wiley-Interscience Publication},
   publisher={John Wiley \& Sons, Ltd., Chichester},
   date={1993},
   pages={xii+544},
   isbn={0-471-94109-3},
   %review={\MR{1266626}},
}
\bib{Ca89}{article}{
 author = {Casselman, W.},
 journal = {Canad. J. Math.},
 pages = {385--438},
 title = {Canonical extensions of Harish-Chandra modules to representations of $G$},
 volume = {41},
 year = {1989}
}



\bib{Cl}{article}{
  author = {Du Cloux, F.},
  journal = {Ann. Sci. \'Ecole Norm. Sup.},
  number = {3},
  pages = {257--318},
  title = {Sur les repr\'esentations diff\'erentiables des groupes de Lie alg\'ebriques},
  url = {http://eudml.org/doc/82297},
  volume = {24},
  year = {1991},
}

\bib{CM}{book}{
  title = {Nilpotent orbits in semisimple Lie algebra: an introduction},
  author = {Collingwood, D. H.},
  author = {McGovern, W. M.},
  year = {1993}
  publisher = {Van Nostrand Reinhold Co.},
}


% \bib{Dieu}{book}{
%    title={La g\'{e}om\'{e}trie des groupes classiques},
%    author={Dieudonn\'{e}, Jean},
%    year={1963},
% 	publisher={Springer},
%  }

\bib{DKPC}{article}{
title = {Nilpotent orbits and complex dual pairs},
journal = {J. Algebra},
volume = {190},
number = {2},
pages = {518 - 539},
year = {1997},
author = {Daszkiewicz, A.},
author = {Kra\'skiewicz, W.},
author = {Przebinda, T.},
}

\bib{DKP2}{article}{
  author = {Daszkiewicz, A.},
  author = {Kra\'skiewicz, W.},
  author = {Przebinda, T.},
  title = {Dual pairs and Kostant-Sekiguchi correspondence. II. Classification
	of nilpotent elements},
  journal = {Central European J. Math.},
  year = {2005},
  volume = {3},
  pages = {430--474},
}


\bib{DM}{article}{
  author = {Dixmier, J.},
  author = {Malliavin, P.},
  title = {Factorisations de fonctions et de vecteurs ind\'efiniment diff\'erentiables},
  journal = {Bull. Sci. Math. (2)},
  year = {1978},
  volume = {102},
  pages = {307--330},
}

%\bibitem[DM]{DM}
%J. Dixmier and P. Malliavin, \textit{Factorisations de fonctions et de vecteurs ind\'efiniment diff\'erentiables}, Bull. Sci. Math. (2), 102 (4),  307-330 (1978).



%\bib{Du77}{article}{
% author = {Duflo, M.},
% journal = {Annals of Math.},
% number = {1},
% pages = {107-120},
% title = {Sur la Classification des Ideaux Primitifs Dans
%   L'algebre Enveloppante d'une Algebre de Lie Semi-Simple},
% volume = {105},
% year = {1977}
%}

\bib{Du82}{article}{
 author = {Duflo, M.},
 journal = {Acta Math.},
  volume = {149},
 number = {3-4},
 pages = {153--213},
 title = {Th\'eorie de Mackey pour les groupes de Lie alg\'ebriques},
 year = {1982}
}



\bib{GZ}{article}{
author={Gomez, R.},
author={Zhu, C.-B.},
title={Local theta lifting of generalized Whittaker models associated to nilpotent orbits},
journal={Geom. Funct. Anal.},
year={2014},
volume={24},
number={3},
pages={796--853},
}

\bib{EGAIV2}{article}{
  title = {\'El\'ements de g\'eom\'etrie alg\'brique IV: \'Etude locale des
    sch\'emas et des morphismes de sch\'emas. II},
  author = {Grothendieck, A.},
  author = {Dieudonn\'e, J.},
  journal  = {Inst. Hautes \'Etudes Sci. Publ. Math.},
  volume = {24},
  year = {1965},
}


\bib{EGAIV3}{article}{
  title = {\'El\'ements de g\'eom\'etrie alg\'brique IV: \'Etude locale des
    sch\'emas et des morphismes de sch\'emas. III},
  author = {Grothendieck, A.},
  author = {Dieudonn\'e, J.},
  journal  = {Inst. Hautes \'Etudes Sci. Publ. Math.},
  volume = {28},
  year = {1966},
}


\bib{HLS}{article}{
    author = {Harris, M.},
    author = {Li, J.-S.},
    author = {Sun, B.},
     title = {Theta correspondences for close unitary groups},
 %booktitle = {Arithmetic Geometry and Automorphic Forms},
    %series = {Adv. Lect. Math. (ALM)},
    journal = {Arithmetic Geometry and Automorphic Forms, Adv. Lect. Math. (ALM)},
    volume = {19},
     pages = {265--307},
 publisher = {Int. Press, Somerville, MA},
      year = {2011},
}

\bib{HS}{book}{
 author = {Hartshorne, R.},
 title = {Algebraic Geometry},
publisher={Graduate Texts in Mathematics, 52. New York-Heidelberg-Berlin: Springer-Verlag},
year={1983},
}

\bib{He}{article}{
author={He, H.},
title={Unipotent representations and quantum induction},
journal={arXiv:math/0210372},
year = {2002},
}

\bib{HL}{article}{
author={Huang, J.-S.},
author={Li, J.-S.},
title={Unipotent representations attached to spherical nilpotent orbits},
journal={Amer. J. Math.},
volume={121},
number = {3},
pages={497--517},
year={1999},
}


\bib{HZ}{article}{
author={Huang, J.-S.},
author={Zhu, C.-B.},
title={On certain small representations of indefinite orthogonal groups},
journal={Represent. Theory},
volume={1},
pages={190--206},
year={1997},
}



\bib{Howe79}{article}{
  title={$\theta$-series and invariant theory},
  author={Howe, R.},
  book = {
    title={Automorphic Forms, Representations and $L$-functions},
    series={Proc. Sympos. Pure Math},
    volume={33},
    year={1979},
  },
  pages={275-285},
}

\bib{HoweRank}{article}{
author={Howe, R.},
title={On a notion of rank for unitary representations of the classical groups},
journal={Harmonic analysis and group representations, Liguori, Naples},
pages={223-331},
year={1982},
}

\bib{Howe89}{article}{
author={Howe, R.},
title={Transcending classical invariant theory},
journal={J. Amer. Math. Soc.},
volume={2},
pages={535--552},
year={1989},
}

\bib{Howe95}{article}{,
  author = {Howe, R.},
  title = {Perspectives on invariant theory: Schur duality, multiplicity-free actions and beyond},
  journal = {Piatetski-Shapiro, I. et al. (eds.), The Schur lectures (1992). Ramat-Gan: Bar-Ilan University, Isr. Math. Conf. Proc. 8,},
  year = {1995},
  pages = {1-182},
}

\bib{JLS}{article}{
author={Jiang, D.},
author={Liu, B.},
author={Savin, G.},
title={Raising nilpotent orbits in wave-front sets},
journal={Represent. Theory},
volume={20},
pages={419--450},
year={2016},
}

\bib{Ki62}{article}{
author={Kirillov, A. A.},
title={Unitary representations of nilpotent Lie groups},
journal={Uspehi Mat. Nauk},
volume={17},
issue ={4},
pages={57--110},
year={1962},
}


\bib{Ko70}{article}{
author={Kostant, B.},
title={Quantization and unitary representations},
journal={Lectures in Modern Analysis and Applications III, Lecture Notes in Math.},
volume={170},
pages={87--208},
year={1970},
}


\bib{KP}{article}{
author={Kraft, H.},
author={Procesi, C.},
title={On the geometry of conjugacy classes in classical groups},
journal={Comment. Math. Helv.},
volume={57},
pages={539--602},
year={1982},
}

\bib{KR}{article}{
author={Kudla, S. S.},
author={Rallis, S.},
title={Degenerate principal series and invariant distributions},
journal={Israel J. Math.},
volume={69},
pages={25--45},
year={1990},
}


\bib{Ku}{article}{
author={Kudla, S. S.},
title={Some extensions of the Siegel-Weil formula},
journal={In: Gan W., Kudla S., Tschinkel Y. (eds) Eisenstein Series and Applications. Progress in Mathematics, vol 258. Birkh\"auser Boston},
%volume={69},
pages={205--237},
year={2008},
}





\bib{LZ1}{article}{
author={Lee, S. T.},
author={Zhu, C.-B.},
title={Degenerate principal series and local theta correspondence II},
journal={Israel J. Math.},
volume={100},
pages={29--59},
year={1997},
}

\bib{LZ2}{article}{
author={Lee, S. T.},
author={Zhu, C.-B.},
title={Degenerate principal series of metaplectic groups and Howe correspondence},
journal = {D. Prasad at al. (eds.), Automorphic Representations and L-Functions, Tata Institute of Fundamental Research, India,},
year = {2013},
pages = {379--408},
}

\bib{Li89}{article}{
author={Li, J.-S.},
title={Singular unitary representations of classical groups},
journal={Invent. Math.},
volume={97},
number = {2},
pages={237--255},
year={1989},
}

\bib{LiuAG}{book}{
  title={Algebraic Geometry and Arithmetic Curves},
  author = {Liu, Q.},
  year = {2006},
  publisher={Oxford University Press},
}

\bib{LM}{article}{
   author = {Loke, H. Y.},
   author = {Ma, J.},
    title = {Invariants and $K$-spectrums of local theta lifts},
    journal = {Compositio Math.},
    volume = {151},
    issue = {01},
    year = {2015},
    pages ={179--206},
}

\bib{LS}{article}{
   author = {Lusztig, G.},
   author = {Spaltenstein, N.},
    title = {Induced unipotent classes},
    journal = {j. London Math. Soc.},
    volume = {19},
    year = {1979},
    pages ={41--52},
}

\bib{Lu.I}{article}{
   author={Lusztig, G.},
   title={Intersection cohomology complexes on a reductive group},
   journal={Invent. Math.},
   volume={75},
   date={1984},
   number={2},
   pages={205--272},
   issn={0020-9910},
   review={\MR{732546}},
   doi={10.1007/BF01388564},
}
	

\bib{Ma}{article}{
   author = {Mackey, G. W.},
    title = {Unitary representations of group extentions},
    journal = {Acta Math.},
    volume = {99},
    year = {1958},
    pages ={265--311},
}


\bib{Mc}{article}{
   author = {McGovern, W. M},
    title = {Cells of Harish-Chandra modules for real classical groups},
    journal = {Amer. J.  of Math.},
    volume = {120},
    issue = {01},
    year = {1998},
    pages ={211--228},
}

\bib{Mo96}{article}{
 author={M{\oe}glin, C.},
    title = {Front d'onde des repr\'esentations des groupes classiques $p$-adiques},
    journal = {Amer. J. Math.},
    volume = {118},
    issue = {06},
    year = {1996},
    pages ={1313--1346},
}

\bib{Mo17}{article}{
  author={M{\oe}glin, C.},
  title = {Paquets d'Arthur Sp\'eciaux Unipotents aux Places Archim\'ediennes et Correspondance de Howe},
  journal = {J. Cogdell et al. (eds.), Representation Theory, Number Theory, and Invariant Theory, In Honor of Roger Howe. Progress in Math.}
  %series ={Progress in Math.},
  volume = {323},
  pages = {469--502}
  year = {2017}
}


\bib{MVW}{book}{
  volume={1291},
  title={Correspondances de Howe sur un corps $p$-adique},
  author={M{\oe}glin, C.},
  author={Vign\'eras, M.-F.},
  author={Waldspurger, J.-L.},
  series={Lecture Notes in Mathematics},
  publisher={Springer}
  ISBN={978-3-540-18699-1},
  date={1987},
}

\bib{NOTYK}{article}{
   author = {Nishiyama, K.},
   author = {Ochiai, H.},
   author = {Taniguchi, K.},
   author = {Yamashita, H.},
   author = {Kato, S.},
    title = {Nilpotent orbits, associated cycles and Whittaker models for highest weight representations},
    journal = {Ast\'erisque},
    volume = {273},
    year = {2001},
   pages ={1--163},
}

\bib{NOZ}{article}{
  author = {Nishiyama, K.},
  author = {Ochiai, H.},
  author = {Zhu, C.-B.},
  journal = {Trans. Amer. Math. Soc.},
  title = {Theta lifting of nilpotent orbits for symmetric pairs},
  volume = {358},
  year = {2006},
  pages = {2713--2734},
}


\bib{NZ}{article}{
   author = {Nishiyama, K.},
   author = {Zhu, C.-B.},
    title = {Theta lifting of unitary lowest weight modules and their associated cycles},
    journal = {Duke Math. J.},
    volume = {125},
    issue = {03},
    year = {2004},
   pages ={415--465},
}



\bib{Ohta}{article}{
  author = {Ohta, T.},
  %doi = {10.2748/tmj/1178227492},
  journal = {Tohoku Math. J.},
  number = {2},
  pages = {161--211},
  publisher = {Tohoku University, Mathematical Institute},
  title = {The closures of nilpotent orbits in the classical symmetric
    pairs and their singularities},
  volume = {43},
  year = {1991}
}

\bib{Ohta2}{article}{
  author = {Ohta, T.},
  journal = {Hiroshima Math. J.},
  number = {2},
  pages = {347--360},
  title = {Induction of nilpotent orbits for real reductive groups and associated varieties of standard representations},
  volume = {29},
  year = {1999}
}

\bib{Ohta4}{article}{
  title={Nilpotent orbits of $\mathbb{Z}_4$-graded Lie algebra and geometry of
    moment maps associated to the dual pair $(\mathrm{U} (p, q), \mathrm{U} (r, s))$},
  author={Ohta, T.},
  journal={Publ. RIMS},
  volume={41},
  number={3},
  pages={723--756},
  year={2005}
}

\bib{PT}{article}{
  title={Some small unipotent representations of indefinite orthogonal groups and the theta correspondence},
  author={Paul, A.},
  author={Trapa, P.},
  journal={University of Aarhus Publ. Series},
  volume={48},
  pages={103--125},
  year={2007}
}


\bib{PV}{article}{
  title={Invariant Theory},
  author={Popov, V. L.},
  author={Vinberg, E. B.},
  book={
  title={Algebraic Geometry IV: Linear Algebraic Groups, Invariant Theory},
  series={Encyclopedia of Mathematical Sciences},
  volume={55},
  year={1994},
  publisher={Springer},}
}




%\bib{PPz}{article}{
%author={Protsak, V.} ,
%author={Przebinda, T.},
%title={On the occurrence of admissible representations in the real Howe
%    correspondence in stable range},
%journal={Manuscr. Math.},
%volume={126},
%number={2},
%pages={135--141},
%year={2008}
%}


\bib{PrzInf}{article}{
      author={Przebinda, T.},
       title={The duality correspondence of infinitesimal characters},
        date={1996},
     journal={Colloq. Math.},
      volume={70},
       pages={93--102},
}


\bib{Pz}{article}{
author={Przebinda, T.},
title={Characters, dual pairs, and unitary representations},
journal={Duke Math. J. },
volume={69},
number={3},
pages={547--592},
year={1993}
}

\bib{Ra}{article}{
author={Rallis, S.},
title={On the Howe duality conjecture},
journal={Compositio Math.},
volume={51},
pages={333--399},
year={1984}
}

\bib{Sa}{article}{
author={Sahi, S.},
title={Explicit Hilbert spaces for certain unipotent representations},
journal={Invent. Math.},
volume={110},
number = {2},
pages={409--418},
year={1992}
}

\bib{Se}{article}{
author={Sekiguchi, J.},
title={Remarks on real nilpotent orbits of a symmetric pair},
journal={J. Math. Soc. Japan},
%publisher={The Mathematical Society of Japan},
year={1987},
volume={39},
number={1},
pages={127--138},
}

\bib{SV}{article}{
  author = {Schmid, W.},
  author = {Vilonen, K.},
  journal = {Annals of Math.},
  number = {3},
  pages = {1071--1118},
  %publisher = {Princeton University, Mathematics Department, Princeton, NJ; Mathematical Sciences Publishers, Berkeley},
  title = {Characteristic cycles and wave front cycles of representations of reductive Lie groups},
  volume = {151},
year = {2000},
}

\bib{So}{article}{
author = {Sommers, E.},
title = {Lusztig's canonical quotient and generalized duality},
journal = {J. Algebra},
volume = {243},
number = {2},
pages = {790--812},
year = {2001},
}

\bib{SS}{book}{
  author = {Springer, T. A.},
  author = {Steinberg, R.},
  title = {Seminar on algebraic groups and related finite groups; Conjugate classes},
  series = {Lecture Notes in Math.}
  volume = {131}
publisher={Springer},
year={1970},
}

\bib{SZ1}{article}{
title={A general form of Gelfand-Kazhdan criterion},
author={Sun, B.},
author={Zhu, C.-B.},
journal={Manuscripta Math.},
pages = {185--197},
volume = {136},
year={2011}
}


%\bib{SZ2}{article}{
%  title={Conservation relations for local theta correspondence},
%  author={Sun, B.},
%  author={Zhu, C.-B.},
%  journal={J. Amer. Math. Soc.},
%  pages = {939--983},
%  volume = {28},
%  year={2015}
%}



\bib{Tr}{article}{
  title={Special unipotent representations and the Howe correspondence},
  author={Trapa, P.},
  year = {2004},
  journal={University of Aarhus Publication Series},
  volume = {47},
  pages= {210--230}
}

% \bib{Wa}{article}{
%    author = {Waldspurger, J.-L.},
%     title = {D\'{e}monstration d'une conjecture de dualit\'{e} de Howe dans le cas $p$-adique, $p \neq 2$ in Festschrift in honor of I. I. Piatetski-Shapiro on the occasion of his sixtieth birthday},
%   journal = {Israel Math. Conf. Proc., 2, Weizmann, Jerusalem},
%  year = {1990},
% pages = {267-324},
% }

\bib{V4}{article}{
   author={Vogan, D. A. },
   title={Irreducible characters of semisimple Lie groups. IV.
   Character-multiplicity duality},
   journal={Duke Math. J.},
   volume={49},
   date={1982},
   number={4},
   pages={943--1073},
   issn={0012-7094},
   review={\MR{683010}},
}
\bib{VoBook}{book}{
author = {Vogan, D. A. },
  title={Unitary representations of reductive Lie groups},
  year={1987},
  series = {Ann. of Math. Stud.},
 volume={118},
  publisher={Princeton University Press}
}


\bib{Vo89}{article}{
  author = {Vogan, D. A. },
  title = {Associated varieties and unipotent representations},
 %booktitle ={Harmonic analysis on reductive groups, Proc. Conf., Brunswick/ME (USA) 1989,},
  journal = {Harmonic analysis on reductive groups, Proc. Conf., Brunswick/ME
    (USA) 1989, Prog. Math.},
 volume={101},
  publisher = {Birkh\"{a}user, Boston-Basel-Berlin},
  year = {1991},
pages={315--388},
  editor = {W. Barker and P. Sally},
}

\bib{Vo98}{article}{
  author = {Vogan, D. A. },
  title = {The method of coadjoint orbits for real reductive groups},
 %booktitle ={Representation theory of Lie groups (Park City, UT, 1998)},
 journal = {Representation theory of Lie groups (Park City, UT, 1998). IAS/Park City Math. Ser.},
  volume={8},
  publisher = {Amer. Math. Soc.},
  year = {2000},
pages={179--238},
}

\bib{Vo00}{article}{
  author = {Vogan, D. A. },
  title = {Unitary representations of reductive Lie groups},
 %booktitle ={Mathematics towards the Third Millennium (Rome, 1999)},
 journal ={Mathematics towards the Third Millennium (Rome, 1999). Accademia Nazionale dei Lincei, (2000)},
  %series = {Accademia Nazionale dei Lincei, 2000},
 %volume={9},
pages={147--167},
}


\bib{Wa1}{book}{
  title={Real reductive groups I},
  author={Wallach, N. R.},
  year={1988},
  publisher={Academic Press Inc. }
}

\bib{Wa2}{book}{
  title={Real reductive groups II},
  author={Wallach, N. R.},
  year={1992},
  publisher={Academic Press Inc. }
}


\bib{Weyl}{book}{
  title={The classical groups: their invariants and representations},
  author={Weyl, H.},
  year={1947},
  publisher={Princeton University Press}
}

\bib{Ya}{article}{
  title={Degenerate principal series representations for quaternionic unitary groups},
  author={Yamana, S.},
  year = {2011},
  journal={Israel J. Math.},
  volume = {185},
  pages= {77--124}
}



% \bib{EGAIV4}{article}{
%   title = {\'El\'ements de g\'eom\'etrie alg\'brique IV 4: \'Etude locale des
%     sch\'emas et des morphismes de sch\'emas},
%   author = {Grothendieck, Alexandre},
%   author = {Dieudonn\'e, Jean},
%   journal  = {Inst. Hautes \'Etudes Sci. Publ. Math.},
%   volume = {32},
%   year = {1967},
%   pages = {5--361}
% }



\end{biblist}
\end{bibdiv}


\end{document}


%%% Local Variables:
%%% coding: utf-8
%%% mode: latex
%%% TeX-engine: xetex
%%% ispell-local-dictionary: "en_US"
%%% End:
